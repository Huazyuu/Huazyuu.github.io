<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>0x11Plan</title>
    <url>/2023/09/11/0x11Plan/</url>
    <content><![CDATA[<p>1.Leetcode per pra<br>2.Feishu doc<br>3.goweb<br>4.CS English<br>5.OS<br>6.redis</p>
]]></content>
      <categories>
        <category>Planning</category>
      </categories>
      <tags>
        <tag>Planning</tag>
      </tags>
  </entry>
  <entry>
    <title>9.4leetcode449</title>
    <url>/2023/09/04/9-4leetcode449/</url>
    <content><![CDATA[<h1 id="Serialize-and-Deserialize-BST"><a href="#Serialize-and-Deserialize-BST" class="headerlink" title="Serialize and Deserialize BST"></a><a href="https://leetcode.cn/problems/serialize-and-deserialize-bst/">Serialize and Deserialize BST</a></h1><p>Serialization is converting a data structure or object into a sequence of bits so that it can be stored in a file or memory buffer, or transmitted across a network connection link to be reconstructed later in the same or another computer environment.</p>
<p>Design an algorithm to serialize and deserialize a <strong>binary search tree</strong>. There is no restriction on how your serialization&#x2F;deserialization algorithm should work. You need to ensure that a binary search tree can be serialized to a string, and this string can be deserialized to the original tree structure.</p>
<p><strong>The encoded string should be as compact as possible.</strong></p>
<p><strong>Constraints:</strong></p>
<ul>
<li>The number of nodes in the tree is in the range <code>[0, 104]</code>.</li>
<li><code>0 &lt;= Node.val &lt;= 104</code></li>
<li>The input tree is <strong>guaranteed</strong> to be a binary search tree.</li>
</ul>
<span id="more"></span>

<h2 id="Resolution"><a href="#Resolution" class="headerlink" title="Resolution"></a>Resolution</h2><h3 id="standard-library"><a href="#standard-library" class="headerlink" title="standard library"></a>standard library</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;encoding/json&quot;</span></span><br><span class="line"><span class="comment">//leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * type TreeNode struct &#123;</span></span><br><span class="line"><span class="comment"> *     Val int</span></span><br><span class="line"><span class="comment"> *     Left *TreeNode</span></span><br><span class="line"><span class="comment"> *     Right *TreeNode</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Codec <span class="keyword">struct</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Constructor</span><span class="params">()</span></span> Codec &#123;</span><br><span class="line">	<span class="keyword">return</span> Codec&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Serializes a tree to a single string.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Codec)</span></span> serialize(root *TreeNode) <span class="type">string</span> &#123;</span><br><span class="line">	b, _ := json.Marshal(root)</span><br><span class="line">	<span class="keyword">return</span> <span class="type">string</span>(b)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Deserializes your encoded data to tree.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Codec)</span></span> deserialize(data <span class="type">string</span>) *TreeNode &#123;</span><br><span class="line">	p := <span class="built_in">new</span>(TreeNode)</span><br><span class="line">	_ = json.Unmarshal([]<span class="type">byte</span>(data), &amp;p)</span><br><span class="line">	<span class="keyword">return</span> p</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your Codec object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * ser := Constructor()</span></span><br><span class="line"><span class="comment"> * deser := Constructor()</span></span><br><span class="line"><span class="comment"> * tree := ser.serialize(root)</span></span><br><span class="line"><span class="comment"> * ans := deser.deserialize(tree)</span></span><br><span class="line"><span class="comment"> * return ans</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="BST-PreTraverse"><a href="#BST-PreTraverse" class="headerlink" title="BST PreTraverse"></a>BST PreTraverse</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;strconv&quot;</span></span><br><span class="line">	<span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//449  2023-09-04 07:51:04</span></span><br><span class="line"><span class="comment">//leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * type TreeNode struct &#123;</span></span><br><span class="line"><span class="comment"> *     Val int</span></span><br><span class="line"><span class="comment"> *     Left *TreeNode</span></span><br><span class="line"><span class="comment"> *     Right *TreeNode</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Codec <span class="keyword">struct</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Constructor</span><span class="params">()</span></span> Codec &#123;</span><br><span class="line">	<span class="keyword">return</span> Codec&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Serializes a tree to a single string.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Codec)</span></span> serialize(root *TreeNode) <span class="type">string</span> &#123;</span><br><span class="line">	arr := []<span class="type">string</span>&#123;&#125;</span><br><span class="line">	<span class="keyword">var</span> dfs <span class="function"><span class="keyword">func</span><span class="params">(node *TreeNode)</span></span></span><br><span class="line">	dfs = <span class="function"><span class="keyword">func</span><span class="params">(node *TreeNode)</span></span> &#123;</span><br><span class="line">		<span class="keyword">if</span> node == <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		arr = <span class="built_in">append</span>(arr, strconv.Itoa(node.Val))</span><br><span class="line">		dfs(node.Left)</span><br><span class="line">		dfs(node.Right)</span><br><span class="line">	&#125;</span><br><span class="line">	dfs(root)</span><br><span class="line">	<span class="keyword">return</span> strings.Join(arr, <span class="string">&quot; &quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Deserializes your encoded data to tree.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Codec)</span></span> deserialize(data <span class="type">string</span>) *TreeNode &#123;</span><br><span class="line">	<span class="keyword">if</span> data == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	arr := strings.Split(data, <span class="string">&quot; &quot;</span>)</span><br><span class="line">	<span class="keyword">var</span> dfsUnmarshal <span class="function"><span class="keyword">func</span><span class="params">(<span class="type">int</span>, <span class="type">int</span>)</span></span> *TreeNode</span><br><span class="line">	dfsUnmarshal = <span class="function"><span class="keyword">func</span><span class="params">(min, max <span class="type">int</span>)</span></span> *TreeNode &#123;</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(arr) == <span class="number">0</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">		&#125;</span><br><span class="line">		val, _ := strconv.Atoi(arr[<span class="number">0</span>])</span><br><span class="line">		<span class="keyword">if</span> val &lt; min || val &gt; max &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">		&#125;</span><br><span class="line">		arr = arr[<span class="number">1</span>:]</span><br><span class="line">		<span class="keyword">return</span> &amp;TreeNode&#123;</span><br><span class="line">			Val:   val,</span><br><span class="line">			Left:  dfsUnmarshal(min, val<span class="number">-1</span>),</span><br><span class="line">			Right: dfsUnmarshal(val+<span class="number">1</span>, max),</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> dfsUnmarshal(<span class="number">-1</span>, <span class="number">10001</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your Codec object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * ser := Constructor()</span></span><br><span class="line"><span class="comment"> * deser := Constructor()</span></span><br><span class="line"><span class="comment"> * tree := ser.serialize(root)</span></span><br><span class="line"><span class="comment"> * ans := deser.deserialize(tree)</span></span><br><span class="line"><span class="comment"> * return ans</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Tree</tag>
        <tag>BST</tag>
      </tags>
  </entry>
  <entry>
    <title>0X10Plan</title>
    <url>/2023/09/02/0X10Plan/</url>
    <content><![CDATA[<p>ğŸ’®Learn Graph algorithm<br>ğŸ’®Gin and Gorm<br>ğŸ’®OS two chapters<br>ğŸ’®Golang related books<br>ğŸ’®Running more than three days<br>ğŸ’®Leetcode one easy of middle problem per day<br>ğŸ’®Daily learning outcomes are clocked into the Markdown document</p>
]]></content>
      <categories>
        <category>Planning</category>
      </categories>
      <tags>
        <tag>Planning</tag>
      </tags>
  </entry>
  <entry>
    <title>DisjointSetUnion(DSU)</title>
    <url>/2023/09/04/DisjointSetUnion-DSU/</url>
    <content><![CDATA[<h1 id="Disjoint-Set-Union"><a href="#Disjoint-Set-Union" class="headerlink" title="Disjoint Set Union"></a>Disjoint Set Union</h1><p>DSU:use a element in set to represent the set</p>
<p>commonly used to solve connectivity problems<br>whether two elements are in the same set</p>
<p>implement methods including <code>Init</code> <code>Union</code> <code>Find</code> <code>IsSame</code> </p>
<span id="more"></span>

<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> DSU <span class="keyword">struct</span> &#123;</span><br><span class="line">	Father []<span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d *DSU)</span></span> Init(n <span class="type">int</span>) &#123;</span><br><span class="line">	d.Father = <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		d.Father[i] = i</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d *DSU)</span></span> Union(i, j <span class="type">int</span>) &#123;</span><br><span class="line">	iFather := d.Find(i)</span><br><span class="line">	jFather := d.Find(j)</span><br><span class="line">	<span class="keyword">if</span> iFather == jFather &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	d.Father[i] = j</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d *DSU)</span></span> Find(i <span class="type">int</span>) <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> i == d.Father[i] &#123;</span><br><span class="line">		<span class="keyword">return</span> i</span><br><span class="line">	&#125;</span><br><span class="line">	d.Father[i] = d.Find(d.Father[i])</span><br><span class="line">	<span class="keyword">return</span> d.Father[i]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d *DSU)</span></span> IsSame(i, j <span class="type">int</span>) <span class="type">bool</span> &#123;</span><br><span class="line">	iFather := d.Find(i)</span><br><span class="line">	jFather := d.Find(j)</span><br><span class="line">	<span class="keyword">return</span> iFather == jFather </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	n := <span class="number">10</span> <span class="comment">// Set BSU size</span></span><br><span class="line">	<span class="keyword">var</span> dsu DSU</span><br><span class="line">	dsu.Init(n)</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//0-&gt;1</span></span><br><span class="line">	<span class="comment">//	 â†‘</span></span><br><span class="line">	<span class="comment">//2-&gt;3</span></span><br><span class="line">	<span class="comment">//	 â†‘</span></span><br><span class="line">	<span class="comment">//4-&gt;5</span></span><br><span class="line">	<span class="comment">//7-&gt;8</span></span><br><span class="line">	dsu.Union(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">	dsu.Union(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">	dsu.Union(<span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line">	dsu.Union(<span class="number">3</span>, <span class="number">1</span>)</span><br><span class="line">	dsu.Union(<span class="number">5</span>, <span class="number">3</span>)</span><br><span class="line">	dsu.Union(<span class="number">7</span>, <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//Find</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;Root of 0:&quot;</span>, dsu.Find(<span class="number">0</span>))</span><br><span class="line">	fmt.Println(<span class="string">&quot;Root of 1:&quot;</span>, dsu.Find(<span class="number">1</span>))</span><br><span class="line">	fmt.Println(<span class="string">&quot;Root of 2:&quot;</span>, dsu.Find(<span class="number">2</span>))</span><br><span class="line">	fmt.Println(<span class="string">&quot;Root of 3:&quot;</span>, dsu.Find(<span class="number">3</span>))</span><br><span class="line">	fmt.Println(<span class="string">&quot;Root of 4:&quot;</span>, dsu.Find(<span class="number">4</span>))</span><br><span class="line">	fmt.Println(<span class="string">&quot;Root of 5:&quot;</span>, dsu.Find(<span class="number">5</span>))</span><br><span class="line">	<span class="comment">//IsSame</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;root0 root1 have the same father&quot;</span>, dsu.IsSame(<span class="number">0</span>, <span class="number">1</span>))</span><br><span class="line">	fmt.Println(<span class="string">&quot;root7 root8 have the same father&quot;</span>, dsu.IsSame(<span class="number">7</span>, <span class="number">8</span>))</span><br><span class="line">	fmt.Println(<span class="string">&quot;root4 root1 have the same father&quot;</span>, dsu.IsSame(<span class="number">4</span>, <span class="number">1</span>))</span><br><span class="line">	fmt.Println(<span class="string">&quot;root7 root1 have the same father&quot;</span>, dsu.IsSame(<span class="number">7</span>, <span class="number">1</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">go run main.go</span></span><br><span class="line">Root of 0: 1</span><br><span class="line">Root of 1: 1</span><br><span class="line">Root of 2: 1</span><br><span class="line">Root of 3: 1</span><br><span class="line">Root of 4: 1</span><br><span class="line">Root of 5: 1</span><br><span class="line">root0 root1 have the same father: true</span><br><span class="line">root7 root8 have the same father: true</span><br><span class="line">root4 root1 have the same father: true</span><br><span class="line">root7 root1 have the same father: false</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Tree</tag>
        <tag>DSU</tag>
      </tags>
  </entry>
  <entry>
    <title>GO-Gin-Zap</title>
    <url>/2023/09/06/GO-Gin-Zap/</url>
    <content><![CDATA[<h1 id="GO-Gin-Zap"><a href="#GO-Gin-Zap" class="headerlink" title="GO-Gin-Zap"></a>GO-Gin-Zap</h1><p>ginçš„ä¸­é—´ä»¶,ä½¿ç”¨zapä»£æ›¿ginè‡ªå¸¦çš„logè®°å½•</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Default</span><span class="params">()</span></span> *Engine &#123;</span><br><span class="line">	debugPrintWARNINGDefault()</span><br><span class="line">	engine := New()</span><br><span class="line">	engine.Use(Logger(), Recovery())</span><br><span class="line">	<span class="keyword">return</span> engine</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<p>è‡ªå·±é‡å†™ ginçš„Defaultä¸­çš„<code>engin.Use(Logger(),Recovery())</code>å»æ”¶é›†æ—¥å¿—</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// GinLogger æ¥æ”¶ginæ¡†æ¶é»˜è®¤çš„æ—¥å¿—</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GinLogger</span><span class="params">(logger *zap.Logger)</span></span> gin.HandlerFunc &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		start := time.Now()</span><br><span class="line">		path := c.Request.URL.Path</span><br><span class="line">		query := c.Request.URL.RawQuery</span><br><span class="line">		c.Next()</span><br><span class="line"></span><br><span class="line">		cost := time.Since(start)</span><br><span class="line">		logger.Info(path,</span><br><span class="line">			zap.Int(<span class="string">&quot;status&quot;</span>, c.Writer.Status()),</span><br><span class="line">			zap.String(<span class="string">&quot;method&quot;</span>, c.Request.Method),</span><br><span class="line">			zap.String(<span class="string">&quot;path&quot;</span>, path),</span><br><span class="line">			zap.String(<span class="string">&quot;query&quot;</span>, query),</span><br><span class="line">			zap.String(<span class="string">&quot;ip&quot;</span>, c.ClientIP()),</span><br><span class="line">			zap.String(<span class="string">&quot;user-agent&quot;</span>, c.Request.UserAgent()),</span><br><span class="line">			zap.String(<span class="string">&quot;errors&quot;</span>, c.Errors.ByType(gin.ErrorTypePrivate).String()),</span><br><span class="line">			zap.Duration(<span class="string">&quot;cost&quot;</span>, cost),</span><br><span class="line">		)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GinRecovery recoveræ‰é¡¹ç›®å¯èƒ½å‡ºç°çš„panic</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GinRecovery</span><span class="params">(logger *zap.Logger, stack <span class="type">bool</span>)</span></span> gin.HandlerFunc &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">			<span class="keyword">if</span> err := <span class="built_in">recover</span>(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">				<span class="comment">// Check for a broken connection, as it is not really a</span></span><br><span class="line">				<span class="comment">// condition that warrants a panic stack trace.</span></span><br><span class="line">				<span class="keyword">var</span> brokenPipe <span class="type">bool</span></span><br><span class="line">				<span class="keyword">if</span> ne, ok := err.(*net.OpError); ok &#123;</span><br><span class="line">					<span class="keyword">if</span> se, ok := ne.Err.(*os.SyscallError); ok &#123;</span><br><span class="line">						<span class="keyword">if</span> strings.Contains(strings.ToLower(se.Error()), <span class="string">&quot;broken pipe&quot;</span>) || strings.Contains(strings.ToLower(se.Error()), <span class="string">&quot;connection reset by peer&quot;</span>) &#123;</span><br><span class="line">							brokenPipe = <span class="literal">true</span></span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				httpRequest, _ := httputil.DumpRequest(c.Request, <span class="literal">false</span>)</span><br><span class="line">				<span class="keyword">if</span> brokenPipe &#123;</span><br><span class="line">					logger.Error(c.Request.URL.Path,</span><br><span class="line">						zap.Any(<span class="string">&quot;error&quot;</span>, err),</span><br><span class="line">						zap.String(<span class="string">&quot;request&quot;</span>, <span class="type">string</span>(httpRequest)),</span><br><span class="line">					)</span><br><span class="line">					<span class="comment">// If the connection is dead, we can&#x27;t write a status to it.</span></span><br><span class="line">					c.Error(err.(<span class="type">error</span>)) <span class="comment">// nolint: errcheck</span></span><br><span class="line">					c.Abort()</span><br><span class="line">					<span class="keyword">return</span></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> stack &#123;</span><br><span class="line">					logger.Error(<span class="string">&quot;[Recovery from panic]&quot;</span>,</span><br><span class="line">						zap.Any(<span class="string">&quot;error&quot;</span>, err),</span><br><span class="line">						zap.String(<span class="string">&quot;request&quot;</span>, <span class="type">string</span>(httpRequest)),</span><br><span class="line">						zap.String(<span class="string">&quot;stack&quot;</span>, <span class="type">string</span>(debug.Stack())),</span><br><span class="line">					)</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					logger.Error(<span class="string">&quot;[Recovery from panic]&quot;</span>,</span><br><span class="line">						zap.Any(<span class="string">&quot;error&quot;</span>, err),</span><br><span class="line">						zap.String(<span class="string">&quot;request&quot;</span>, <span class="type">string</span>(httpRequest)),</span><br><span class="line">					)</span><br><span class="line">				&#125;</span><br><span class="line">				c.AbortWithStatus(http.StatusInternalServerError)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;()</span><br><span class="line">		c.Next()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®ä¾‹</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;go.uber.org/zap&quot;</span></span><br><span class="line">	<span class="string">&quot;go.uber.org/zap/zapcore&quot;</span></span><br><span class="line">	<span class="string">&quot;gopkg.in/natefinch/lumberjack.v2&quot;</span></span><br><span class="line">	<span class="string">&quot;net&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http/httputil&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;runtime/debug&quot;</span></span><br><span class="line">	<span class="string">&quot;strings&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> logger *zap.Logger</span><br><span class="line"><span class="keyword">var</span> sugarLogger *zap.SugaredLogger</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">initLogger</span><span class="params">()</span></span> &#123;</span><br><span class="line">	writeSyncer := getLogWriter()</span><br><span class="line">	encoder := getEncoder()</span><br><span class="line">	core := zapcore.NewCore(encoder, writeSyncer, zapcore.DebugLevel)</span><br><span class="line">	logger = zap.New(core, zap.AddCaller())</span><br><span class="line">	sugarLogger = logger.Sugar()</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getEncoder</span><span class="params">()</span></span> zapcore.Encoder &#123;</span><br><span class="line">	<span class="keyword">return</span> zapcore.NewConsoleEncoder(zapcore.EncoderConfig&#123;</span><br><span class="line">		TimeKey:        <span class="string">&quot;ts&quot;</span>,</span><br><span class="line">		LevelKey:       <span class="string">&quot;level&quot;</span>,</span><br><span class="line">		NameKey:        <span class="string">&quot;logger&quot;</span>,</span><br><span class="line">		CallerKey:      <span class="string">&quot;caller&quot;</span>,</span><br><span class="line">		MessageKey:     <span class="string">&quot;msg&quot;</span>,</span><br><span class="line">		StacktraceKey:  <span class="string">&quot;stacktrace&quot;</span>,</span><br><span class="line">		LineEnding:     zapcore.DefaultLineEnding,</span><br><span class="line">		EncodeLevel:    zapcore.LowercaseLevelEncoder,</span><br><span class="line">		EncodeTime:     zapcore.ISO8601TimeEncoder,</span><br><span class="line">		EncodeDuration: zapcore.SecondsDurationEncoder,</span><br><span class="line">		EncodeCaller:   zapcore.ShortCallerEncoder&#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getLogWriter</span><span class="params">()</span></span> zapcore.WriteSyncer &#123;</span><br><span class="line">	<span class="keyword">return</span> zapcore.AddSync(&amp;lumberjack.Logger&#123;</span><br><span class="line">		Filename:   <span class="string">&quot;./test.log&quot;</span>,</span><br><span class="line">		MaxSize:    <span class="number">1</span>,</span><br><span class="line">		MaxAge:     <span class="number">5</span>,</span><br><span class="line">		MaxBackups: <span class="number">30</span>,</span><br><span class="line">		Compress:   <span class="literal">false</span>,</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// GinLogger æ¥æ”¶ginæ¡†æ¶é»˜è®¤çš„æ—¥å¿—</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GinLogger</span><span class="params">(logger *zap.Logger)</span></span> gin.HandlerFunc &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		start := time.Now()</span><br><span class="line">		path := c.Request.URL.Path</span><br><span class="line">		query := c.Request.URL.RawQuery</span><br><span class="line">		c.Next()</span><br><span class="line"></span><br><span class="line">		cost := time.Since(start)</span><br><span class="line">		logger.Info(path,</span><br><span class="line">			zap.Int(<span class="string">&quot;status&quot;</span>, c.Writer.Status()),</span><br><span class="line">			zap.String(<span class="string">&quot;method&quot;</span>, c.Request.Method),</span><br><span class="line">			zap.String(<span class="string">&quot;path&quot;</span>, path),</span><br><span class="line">			zap.String(<span class="string">&quot;query&quot;</span>, query),</span><br><span class="line">			zap.String(<span class="string">&quot;ip&quot;</span>, c.ClientIP()),</span><br><span class="line">			zap.String(<span class="string">&quot;user-agent&quot;</span>, c.Request.UserAgent()),</span><br><span class="line">			zap.String(<span class="string">&quot;errors&quot;</span>, c.Errors.ByType(gin.ErrorTypePrivate).String()),</span><br><span class="line">			zap.Duration(<span class="string">&quot;cost&quot;</span>, cost),</span><br><span class="line">		)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GinRecovery recoveræ‰é¡¹ç›®å¯èƒ½å‡ºç°çš„panic</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GinRecovery</span><span class="params">(logger *zap.Logger, stack <span class="type">bool</span>)</span></span> gin.HandlerFunc &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">			<span class="keyword">if</span> err := <span class="built_in">recover</span>(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">				<span class="comment">// Check for a broken connection, as it is not really a</span></span><br><span class="line">				<span class="comment">// condition that warrants a panic stack trace.</span></span><br><span class="line">				<span class="keyword">var</span> brokenPipe <span class="type">bool</span></span><br><span class="line">				<span class="keyword">if</span> ne, ok := err.(*net.OpError); ok &#123;</span><br><span class="line">					<span class="keyword">if</span> se, ok := ne.Err.(*os.SyscallError); ok &#123;</span><br><span class="line">						<span class="keyword">if</span> strings.Contains(strings.ToLower(se.Error()), <span class="string">&quot;broken pipe&quot;</span>) || strings.Contains(strings.ToLower(se.Error()), <span class="string">&quot;connection reset by peer&quot;</span>) &#123;</span><br><span class="line">							brokenPipe = <span class="literal">true</span></span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				httpRequest, _ := httputil.DumpRequest(c.Request, <span class="literal">false</span>)</span><br><span class="line">				<span class="keyword">if</span> brokenPipe &#123;</span><br><span class="line">					logger.Error(c.Request.URL.Path,</span><br><span class="line">						zap.Any(<span class="string">&quot;error&quot;</span>, err),</span><br><span class="line">						zap.String(<span class="string">&quot;request&quot;</span>, <span class="type">string</span>(httpRequest)),</span><br><span class="line">					)</span><br><span class="line">					<span class="comment">// If the connection is dead, we can&#x27;t write a status to it.</span></span><br><span class="line">					c.Error(err.(<span class="type">error</span>)) <span class="comment">// nolint: errcheck</span></span><br><span class="line">					c.Abort()</span><br><span class="line">					<span class="keyword">return</span></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> stack &#123;</span><br><span class="line">					logger.Error(<span class="string">&quot;[Recovery from panic]&quot;</span>,</span><br><span class="line">						zap.Any(<span class="string">&quot;error&quot;</span>, err),</span><br><span class="line">						zap.String(<span class="string">&quot;request&quot;</span>, <span class="type">string</span>(httpRequest)),</span><br><span class="line">						zap.String(<span class="string">&quot;stack&quot;</span>, <span class="type">string</span>(debug.Stack())),</span><br><span class="line">					)</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					logger.Error(<span class="string">&quot;[Recovery from panic]&quot;</span>,</span><br><span class="line">						zap.Any(<span class="string">&quot;error&quot;</span>, err),</span><br><span class="line">						zap.String(<span class="string">&quot;request&quot;</span>, <span class="type">string</span>(httpRequest)),</span><br><span class="line">					)</span><br><span class="line">				&#125;</span><br><span class="line">				c.AbortWithStatus(http.StatusInternalServerError)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;()</span><br><span class="line">		c.Next()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//r := gin.Default()</span></span><br><span class="line">	initLogger()</span><br><span class="line">	r := gin.New()</span><br><span class="line">	r.Use(GinLogger(logger), GinRecovery(logger, <span class="literal">true</span>))</span><br><span class="line">	r.GET(<span class="string">&quot;/hello&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.String(http.StatusOK, <span class="string">&quot;hello gin&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">	<span class="keyword">defer</span> logger.Sync()</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Golang</category>
      </categories>
      <tags>
        <tag>Golang</tag>
        <tag>Gin</tag>
      </tags>
  </entry>
  <entry>
    <title>GoGorm</title>
    <url>/2023/09/03/Go-Gorm/</url>
    <content><![CDATA[<h1 id="Gorm"><a href="#Gorm" class="headerlink" title="Gorm"></a><a href="https://gorm.io/zh_CN/docs/index.html">Gorm</a></h1><p>Gorm is an ORM framework written in Go.<br>It is well-documented, developer-friendly, and supports mainstream databases.</p>
<p>Official Quick Start Code</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;gorm.io/gorm&quot;</span></span><br><span class="line">  <span class="string">&quot;gorm.io/driver/sqlite&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Product <span class="keyword">struct</span> &#123;</span><br><span class="line">  gorm.Model</span><br><span class="line">  Code  <span class="type">string</span></span><br><span class="line">  Price <span class="type">uint</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  db, err := gorm.Open(sqlite.Open(<span class="string">&quot;test.db&quot;</span>), &amp;gorm.Config&#123;&#125;)</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="built_in">panic</span>(<span class="string">&quot;failed to connect database&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿ç§» schema</span></span><br><span class="line">  db.AutoMigrate(&amp;Product&#123;&#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Create</span></span><br><span class="line">  db.Create(&amp;Product&#123;Code: <span class="string">&quot;D42&quot;</span>, Price: <span class="number">100</span>&#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Read</span></span><br><span class="line">  <span class="keyword">var</span> product Product</span><br><span class="line">  db.First(&amp;product, <span class="number">1</span>) <span class="comment">// æ ¹æ®æ•´å‹ä¸»é”®æŸ¥æ‰¾</span></span><br><span class="line">  db.First(&amp;product, <span class="string">&quot;code = ?&quot;</span>, <span class="string">&quot;D42&quot;</span>) <span class="comment">// æŸ¥æ‰¾ code å­—æ®µå€¼ä¸º D42 çš„è®°å½•</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Update - å°† product çš„ price æ›´æ–°ä¸º 200</span></span><br><span class="line">  db.Model(&amp;product).Update(<span class="string">&quot;Price&quot;</span>, <span class="number">200</span>)</span><br><span class="line">  <span class="comment">// Update - æ›´æ–°å¤šä¸ªå­—æ®µ</span></span><br><span class="line">  db.Model(&amp;product).Updates(Product&#123;Price: <span class="number">200</span>, Code: <span class="string">&quot;F42&quot;</span>&#125;) <span class="comment">// ä»…æ›´æ–°éé›¶å€¼å­—æ®µ</span></span><br><span class="line">  db.Model(&amp;product).Updates(<span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;<span class="string">&quot;Price&quot;</span>: <span class="number">200</span>, <span class="string">&quot;Code&quot;</span>: <span class="string">&quot;F42&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Delete - åˆ é™¤ product</span></span><br><span class="line">  db.Delete(&amp;product, <span class="number">1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<h2 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">go get -u gorm.io/gorm</span><br><span class="line">go get -u gorm.io/driver/sqlite</span><br></pre></td></tr></table></figure>

<h2 id="CRUD"><a href="#CRUD" class="headerlink" title="CRUD"></a>CRUD</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;gorm.io/driver/mysql&quot;</span></span><br><span class="line">	<span class="string">&quot;gorm.io/gorm&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// UserInfo æ•°æ®è¡¨</span></span><br><span class="line"><span class="keyword">type</span> UserInfo <span class="keyword">struct</span> &#123;</span><br><span class="line">	ID     <span class="type">uint</span></span><br><span class="line">	Name   <span class="type">string</span></span><br><span class="line">	Gender <span class="type">string</span></span><br><span class="line">	Hobby  <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	dsn := <span class="string">&quot;root:yanjun@tcp(127.0.0.1:3306)/gorm01?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&quot;</span></span><br><span class="line">	db01, err := gorm.Open(mysql.Open(dsn), &amp;gorm.Config&#123;&#125;)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(<span class="string">&quot;è¿æ¥sqlå¤±è´¥&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//è‡ªåŠ¨è¿ç§» æŠŠç»“æ„ä½“å’Œæ•°æ®è¡¨è¿›è¡Œå¯¹åº”</span></span><br><span class="line">	err = db01.AutoMigrate(&amp;UserInfo&#123;&#125;)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//åˆ›å»ºè®°å½•</span></span><br><span class="line">	u1 := UserInfo&#123;</span><br><span class="line">		ID:     <span class="number">1</span>,</span><br><span class="line">		Name:   <span class="string">&quot;name1&quot;</span>,</span><br><span class="line">		Gender: <span class="string">&quot;gender1&quot;</span>,</span><br><span class="line">		Hobby:  <span class="string">&quot;hobby1&quot;</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	db01.Create(&amp;u1)</span><br><span class="line">	<span class="comment">//æŸ¥è¯¢</span></span><br><span class="line">	<span class="keyword">var</span> u UserInfo</span><br><span class="line">	db01.First(&amp;u, <span class="number">1</span>)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;u:%#v\n&quot;</span>, u)</span><br><span class="line">	db01.First(&amp;u, <span class="string">&quot;Name=?&quot;</span>, <span class="string">&quot;name1&quot;</span>)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;u:%#v\n&quot;</span>, u)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//æ›´æ–°</span></span><br><span class="line">	db01.Model(&amp;u).Update(<span class="string">&quot;hobby&quot;</span>, <span class="string">&quot;play&quot;</span>)</span><br><span class="line">	db01.Model(&amp;u).Updates(<span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">		<span class="string">&quot;hobby&quot;</span>:  <span class="string">&quot;hobbyNew1&quot;</span>,</span><br><span class="line">		<span class="string">&quot;gender&quot;</span>: <span class="string">&quot;genderNew1&quot;</span>,</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="comment">//åˆ é™¤</span></span><br><span class="line">	db01.Delete(&amp;u, <span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;database/sql&quot;</span></span><br><span class="line">	<span class="string">&quot;gorm.io/driver/mysql&quot;</span></span><br><span class="line">	<span class="string">&quot;gorm.io/gorm&quot;</span></span><br><span class="line">	<span class="string">&quot;gorm.io/gorm/schema&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">type Model struct &#123;</span></span><br><span class="line"><span class="comment">	ID        uint `gorm:&quot;primarykey&quot;`</span></span><br><span class="line"><span class="comment">	CreatedAt time.Time</span></span><br><span class="line"><span class="comment">	UpdatedAt time.Time</span></span><br><span class="line"><span class="comment">	DeletedAt DeletedAt `gorm:&quot;index&quot;`</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">åœ¨ä½¿ç”¨ORMå·¥å…·æ—¶ï¼Œé€šå¸¸æˆ‘ä»¬éœ€è¦åœ¨ä»£ç ä¸­å®šä¹‰æ¨¡å‹ï¼ˆModelsï¼‰</span></span><br><span class="line"><span class="comment">ä¸æ•°æ®åº“ä¸­çš„æ•°æ®è¡¨è¿›è¡Œæ˜ å°„ï¼Œ</span></span><br><span class="line"><span class="comment">åœ¨GORMä¸­æ¨¡å‹ï¼ˆModelsï¼‰é€šå¸¸æ˜¯æ­£å¸¸å®šä¹‰çš„ç»“æ„ä½“ã€</span></span><br><span class="line"><span class="comment">åŸºæœ¬çš„goç±»å‹æˆ–å®ƒä»¬çš„æŒ‡é’ˆã€‚</span></span><br><span class="line"><span class="comment">åŒæ—¶ä¹Ÿæ”¯æŒsql.ScanneråŠdriver.Valueræ¥å£ï¼ˆinterfacesï¼‰ã€‚</span></span><br><span class="line"><span class="comment">gorm.Model</span></span><br><span class="line"><span class="comment">ä¸ºäº†æ–¹ä¾¿æ¨¡å‹å®šä¹‰ï¼ŒGORMå†…ç½®äº†ä¸€ä¸ªgorm.Modelç»“æ„ä½“ã€‚</span></span><br><span class="line"><span class="comment">gorm.Modelæ˜¯ä¸€ä¸ªåŒ…å«äº†ID, CreatedAt, UpdatedAt, DeletedAtå››ä¸ªå­—æ®µçš„Golangç»“æ„ä½“ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// User é»˜è®¤ä¸»é”®ID</span></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">	gorm.Model</span><br><span class="line">	Name         <span class="type">string</span></span><br><span class="line">	Age          sql.NullInt64 <span class="comment">//é›¶å€¼</span></span><br><span class="line">	Birthday     *time.Time</span><br><span class="line">	Email        <span class="type">string</span>  <span class="string">`gorm:&quot;type:varchar(100);unique_index&quot;`</span></span><br><span class="line">	Role         <span class="type">string</span>  <span class="string">`gorm:&quot;size:255&quot;`</span>                            <span class="comment">// è®¾ç½®å­—æ®µå¤§å°ä¸º255</span></span><br><span class="line">	MemberNumber *<span class="type">string</span> <span class="string">`gorm:&quot;unique;not null;column:MemberNumber&quot;`</span> <span class="comment">// è®¾ç½®ä¼šå‘˜å·ï¼ˆmember numberï¼‰å”¯ä¸€å¹¶ä¸”ä¸ä¸ºç©º</span></span><br><span class="line">	<span class="comment">//é»˜è®¤æ‰€æœ‰å­—æ®µçš„é›¶å€¼,</span></span><br><span class="line">	<span class="comment">//æ¯”å¦‚ 0, &#x27;&#x27;, false æˆ–è€…å…¶é›¶å€¼ï¼Œ</span></span><br><span class="line">	<span class="comment">//éƒ½ä¸ä¼šä¿å­˜åˆ°æ•°æ®åº“å†…ï¼Œä½¿ç”¨æŒ‡é’ˆå¯ä»¥é¿å…è¿™ç§æƒ…å†µã€‚</span></span><br><span class="line">	Num      <span class="type">int</span>    <span class="string">`gorm:&quot;AUTO_INCREMENT&quot;`</span> <span class="comment">// è®¾ç½® num ä¸ºè‡ªå¢ç±»å‹</span></span><br><span class="line">	Address  <span class="type">string</span> <span class="string">`gorm:&quot;index:addr&quot;`</span>     <span class="comment">// ç»™addresså­—æ®µåˆ›å»ºåä¸ºaddrçš„ç´¢å¼•</span></span><br><span class="line">	IgnoreMe <span class="type">int</span>    <span class="string">`gorm:&quot;-&quot;`</span>              <span class="comment">// å¿½ç•¥æœ¬å­—æ®µ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é»˜è®¤è¡¨åuser</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// TableName ä¿®æ”¹è¡¨å</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u User)</span></span> TableName() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;myUserTable&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Animal ä½¿ç”¨`AnimalID`ä½œä¸ºä¸»é”®</span></span><br><span class="line"><span class="keyword">type</span> Animal <span class="keyword">struct</span> &#123;</span><br><span class="line">	AnimalID <span class="type">int64</span> <span class="string">`gorm:&quot;primary_key&quot;`</span></span><br><span class="line">	Name     <span class="type">string</span></span><br><span class="line">	Age      <span class="type">int64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	db02, err := gorm.Open(mysql.Open(<span class="string">&quot;root:yanjun@tcp(127.0.0.1:3306)/gorm01?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&quot;</span>), &amp;gorm.Config&#123;</span><br><span class="line">		NamingStrategy: schema.NamingStrategy&#123;</span><br><span class="line">			TablePrefix:   <span class="string">&quot;&quot;</span>,</span><br><span class="line">			SingularTable: <span class="literal">true</span>,</span><br><span class="line">			NameReplacer:  <span class="literal">nil</span>,</span><br><span class="line">			NoLowerCase:   <span class="literal">false</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(<span class="string">&quot;connect failed&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	err = db02.AutoMigrate(&amp;User&#123;&#125;)</span><br><span class="line">	err = db02.AutoMigrate(&amp;Animal&#123;&#125;)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// æ ¹æ® User çš„å­—æ®µåˆ›å»º `deleted_users` è¡¨</span></span><br><span class="line">	err = db02.Table(<span class="string">&quot;deleted_users&quot;</span>).AutoMigrate(&amp;User&#123;&#125;)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ä»å¦ä¸€å¼ è¡¨æŸ¥è¯¢æ•°æ®</span></span><br><span class="line">	<span class="keyword">var</span> deletedUsers []User</span><br><span class="line">	db02.Table(<span class="string">&quot;deleted_users&quot;</span>).Find(&amp;deletedUsers)</span><br><span class="line">	<span class="comment">// SELECT * FROM deleted_users;</span></span><br><span class="line"></span><br><span class="line">	db02.Table(<span class="string">&quot;deleted_users&quot;</span>).Where(<span class="string">&quot;name = ?&quot;</span>, <span class="string">&quot;name1&quot;</span>).Delete(&amp;User&#123;&#125;)</span><br><span class="line">	<span class="comment">// DELETE FROM deleted_users WHERE name = &#x27;name1&#x27;;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;gorm.io/driver/mysql&quot;</span></span><br><span class="line">	<span class="string">&quot;gorm.io/gorm&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	DB *gorm.DB</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Todo Model</span></span><br><span class="line"><span class="keyword">type</span> Todo <span class="keyword">struct</span> &#123;</span><br><span class="line">	ID     <span class="type">int</span>    <span class="string">`json:&quot;id&quot;`</span></span><br><span class="line">	Title  <span class="type">string</span> <span class="string">`json:&quot;title&quot;`</span></span><br><span class="line">	Status <span class="type">bool</span>   <span class="string">`json:&quot;status&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">initMySQL</span><span class="params">()</span></span> (err <span class="type">error</span>) &#123;</span><br><span class="line">	dsn := <span class="string">&quot;root:yanjun@tcp(127.0.0.1:3306)/bubble?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&quot;</span></span><br><span class="line">	DB, err = gorm.Open(mysql.Open(dsn), &amp;gorm.Config&#123;&#125;)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//è¿æ¥sql</span></span><br><span class="line">	err := initMySQL()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//å»ºç«‹å…³è”</span></span><br><span class="line">	err = DB.AutoMigrate(&amp;Todo&#123;&#125;)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	r := gin.Default()</span><br><span class="line">	<span class="comment">//é™æ€æ–‡ä»¶</span></span><br><span class="line">	r.Static(<span class="string">&quot;/static&quot;</span>, <span class="string">&quot;static&quot;</span>)</span><br><span class="line">	<span class="comment">//ginè¯»å–æ¨¡æ¿æ–‡ä»¶</span></span><br><span class="line">	r.LoadHTMLGlob(<span class="string">&quot;templates/*&quot;</span>)</span><br><span class="line">	r.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.HTML(http.StatusOK, <span class="string">&quot;index.html&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// v1</span></span><br><span class="line">	v1Group := r.Group(<span class="string">&quot;v1&quot;</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//å¾…åŠäº‹é¡¹</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//æ·»åŠ </span></span><br><span class="line">		v1Group.POST(<span class="string">&quot;/todo&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">			<span class="comment">//å‰ç«¯æäº¤åˆ°åç«¯</span></span><br><span class="line">			<span class="keyword">var</span> todo Todo</span><br><span class="line">			err = c.BindJSON(&amp;todo)</span><br><span class="line">			<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">				<span class="built_in">panic</span>(<span class="string">&quot;[error]å‰ç«¯è¿”å›å€¼åˆ°åç«¯å¤±è´¥&quot;</span>)</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//å­˜å…¥sql,è¿”å›å“åº”</span></span><br><span class="line">			<span class="keyword">if</span> err = DB.Create(&amp;todo).Error; err != <span class="literal">nil</span> &#123;</span><br><span class="line">				c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;error&quot;</span>: err.Error()&#125;)</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				c.JSON(http.StatusOK, todo)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;)</span><br><span class="line">		<span class="comment">//æŸ¥çœ‹ æ‰€æœ‰&amp;ä¸€ä¸ª</span></span><br><span class="line">		v1Group.GET(<span class="string">&quot;/todo&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">			<span class="keyword">var</span> todoList []Todo</span><br><span class="line">			<span class="keyword">if</span> err = DB.Find(&amp;todoList).Error; err != <span class="literal">nil</span> &#123;</span><br><span class="line">				c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;error&quot;</span>: err.Error()&#125;)</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				c.JSON(http.StatusOK, todoList)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;)</span><br><span class="line">		v1Group.GET(<span class="string">&quot;/todo/:id&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">		&#125;)</span><br><span class="line"></span><br><span class="line">		<span class="comment">//æ›´æ–°</span></span><br><span class="line">		v1Group.PUT(<span class="string">&quot;/todo/:id&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">			id, ok := c.Params.Get(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">			<span class="keyword">if</span> !ok &#123;</span><br><span class="line">				c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;æ— æ•ˆid&quot;</span>&#125;)</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">var</span> todo Todo</span><br><span class="line">			<span class="keyword">if</span> err = DB.Where(<span class="string">&quot;id=?&quot;</span>, id).First(&amp;todo).Error; err != <span class="literal">nil</span> &#123;</span><br><span class="line">				c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;error&quot;</span>: err.Error()&#125;)</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125;</span><br><span class="line">			err = c.BindJSON(&amp;todo)</span><br><span class="line">			<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">				<span class="built_in">panic</span>(err)</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> err = DB.Save(&amp;todo).Error; err != <span class="literal">nil</span> &#123;</span><br><span class="line">				c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;error&quot;</span>: err.Error()&#125;)</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				c.JSON(http.StatusOK, todo)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;)</span><br><span class="line">		<span class="comment">//åˆ é™¤</span></span><br><span class="line">		v1Group.DELETE(<span class="string">&quot;/todo/:id&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">			id, ok := c.Params.Get(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">			<span class="keyword">if</span> !ok &#123;</span><br><span class="line">				c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;æ— æ•ˆid&quot;</span>&#125;)</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> err = DB.Where(<span class="string">&quot;id=?&quot;</span>, id).Delete(Todo&#123;&#125;).Error; err != <span class="literal">nil</span> &#123;</span><br><span class="line">				c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;error&quot;</span>: err.Error()&#125;)</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				c.JSON(http.StatusOK, gin.H&#123;id: <span class="string">&quot;deleted&quot;</span>&#125;)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	_ = r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Database</category>
      </categories>
      <tags>
        <tag>Golang</tag>
        <tag>Gorm</tag>
      </tags>
  </entry>
  <entry>
    <title>Go-Viper</title>
    <url>/2023/09/06/Go-Viper/</url>
    <content><![CDATA[<h1 id="Viper"><a href="#Viper" class="headerlink" title="Viper"></a>Viper</h1><p>operate config settings file</p>
<p>Viper is a complete configuration solution for Go applications.<br>It is designed to work in applications and can handle all types of configuration requirements and formats.</p>
<ul>
<li>Set the default value</li>
<li>Read configuration information from configuration files in<br><code>JSON</code> the format , <code>TOML</code> , <code>YAML</code> <code>HCL</code> <code>envfile</code> and <code>Java properties</code></li>
<li>Real-time monitoring and re-reading of configuration files (optional)</li>
<li>Read from an environment path(ENV)</li>
<li>Read and monitor configuration changes from the remote configuration system (etcd or Consul).</li>
<li>Read the configuration from the command-line arguments</li>
<li>Read the configuration from buffer</li>
<li>Explicitly configure the value</li>
</ul>
<span id="more"></span>

<p>main.go</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/fsnotify/fsnotify&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/spf13/viper&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	viper.SetDefault(<span class="string">&quot;fileDir&quot;</span>, <span class="string">&quot;./&quot;</span>)</span><br><span class="line">	<span class="comment">//è¯»å–é…ç½®æ–‡ä»¶</span></span><br><span class="line">	viper.SetConfigFile(<span class="string">&quot;./config.yaml&quot;</span>)  <span class="comment">// æŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">	viper.SetConfigName(<span class="string">&quot;config&quot;</span>)         <span class="comment">// é…ç½®æ–‡ä»¶åç§°(æ— æ‰©å±•å)</span></span><br><span class="line">	viper.SetConfigType(<span class="string">&quot;yaml&quot;</span>)           <span class="comment">// å¦‚æœé…ç½®æ–‡ä»¶çš„åç§°ä¸­æ²¡æœ‰æ‰©å±•åï¼Œåˆ™éœ€è¦é…ç½®æ­¤é¡¹</span></span><br><span class="line">	viper.AddConfigPath(<span class="string">&quot;/etc/appname/&quot;</span>)  <span class="comment">// æŸ¥æ‰¾é…ç½®æ–‡ä»¶æ‰€åœ¨çš„è·¯å¾„</span></span><br><span class="line">	viper.AddConfigPath(<span class="string">&quot;$HOME/.appname&quot;</span>) <span class="comment">// å¤šæ¬¡è°ƒç”¨ä»¥æ·»åŠ å¤šä¸ªæœç´¢è·¯å¾„</span></span><br><span class="line">	viper.AddConfigPath(<span class="string">&quot;.&quot;</span>)              <span class="comment">// è¿˜å¯ä»¥åœ¨å·¥ä½œç›®å½•ä¸­æŸ¥æ‰¾é…ç½®</span></span><br><span class="line">	err := viper.ReadInConfig()           <span class="comment">// æŸ¥æ‰¾å¹¶è¯»å–é…ç½®æ–‡ä»¶</span></span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;                       <span class="comment">// å¤„ç†è¯»å–é…ç½®æ–‡ä»¶çš„é”™è¯¯</span></span><br><span class="line">		<span class="built_in">panic</span>(fmt.Errorf(<span class="string">&quot;Fatal error config file: %s \n&quot;</span>, err))</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//å®æ—¶ç›‘æ§é…ç½®æ–‡ä»¶çš„å˜åŒ–</span></span><br><span class="line">	viper.WatchConfig()</span><br><span class="line">	viper.OnConfigChange(<span class="function"><span class="keyword">func</span><span class="params">(e fsnotify.Event)</span></span> &#123;</span><br><span class="line">		<span class="comment">// é…ç½®æ–‡ä»¶å‘ç”Ÿå˜æ›´ä¹‹åä¼šè°ƒç”¨çš„å›è°ƒå‡½æ•°</span></span><br><span class="line">		fmt.Println(<span class="string">&quot;Config file changed:&quot;</span>, e.Name)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	r := gin.Default()</span><br><span class="line">	r.GET(<span class="string">&quot;version&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.String(http.StatusOK, viper.Get(<span class="string">&quot;version&quot;</span>).(<span class="type">string</span>))</span><br><span class="line">	&#125;)</span><br><span class="line">	r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>config.yaml</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">port:</span> <span class="number">8081</span></span><br><span class="line"></span><br><span class="line"><span class="attr">version:</span> <span class="string">&quot;v0.0.2&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">mysql:</span></span><br><span class="line">  <span class="string">host:&quot;127.0.0.1&quot;</span></span><br><span class="line">  <span class="string">port:13306</span></span><br><span class="line">  <span class="string">dbname:&quot;sql_demo&quot;</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Golang</category>
      </categories>
      <tags>
        <tag>Golang</tag>
      </tags>
  </entry>
  <entry>
    <title>Go-Zap</title>
    <url>/2023/09/06/Go-Zap/</url>
    <content><![CDATA[<h1 id="GO-Zap"><a href="#GO-Zap" class="headerlink" title="GO-Zap"></a>GO-Zap</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ go get -u go.uber.org/zap</span><br></pre></td></tr></table></figure>

<p>Zap provides two types of loggersâ€” <code>Sugared Logger</code> and <code>Logger</code></p>
<p>In contexts where performance is good but not critical, use <code>SugaredLogger</code><br>It is 4-10 times faster than other structured logging packages and supports structured and            printf-style logging.</p>
<p>Used <code>Logger</code> in contexts where every microsecond and every memory allocation counts.<br>Itâ€™s even <code>SugaredLogger</code> faster than and has fewer memory allocations, but it only supports strongly typed structured logging.</p>
<span id="more"></span>

<h2 id="Logger"><a href="#Logger" class="headerlink" title="Logger"></a>Logger</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;go.uber.org/zap&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> logger *zap.Logger</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	initLogger()</span><br><span class="line">	<span class="keyword">defer</span> logger.Sync()</span><br><span class="line">	SimpleHttpGet(<span class="string">&quot;https://www.bilibili.com&quot;</span>)</span><br><span class="line">	SimpleHttpGet(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">initLogger</span><span class="params">()</span></span> &#123;</span><br><span class="line">	logger, _ = zap.NewProduction()</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SimpleHttpGet</span><span class="params">(url <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">	resp, err := http.Get(url)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		logger.Error(</span><br><span class="line">			<span class="string">&quot;Error fetching url&quot;</span>,</span><br><span class="line">			zap.String(<span class="string">&quot;url&quot;</span>, url),</span><br><span class="line">			zap.Error(err),</span><br><span class="line">		)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		logger.Info(<span class="string">&quot;success...&quot;</span>,</span><br><span class="line">			zap.String(<span class="string">&quot;statusCode&quot;</span>, resp.Status),</span><br><span class="line">			zap.String(<span class="string">&quot;url&quot;</span>, url),</span><br><span class="line">		)</span><br><span class="line">		resp.Body.Close()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">&quot;level&quot;</span>:<span class="string">&quot;info&quot;</span>,<span class="string">&quot;ts&quot;</span>:1693966905.6762507,<span class="string">&quot;caller&quot;</span>:<span class="string">&quot;n11Zap/Logger.go:28&quot;</span>,<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;success...&quot;</span>,<span class="string">&quot;statusCode&quot;</span>:<span class="string">&quot;200 OK&quot;</span>,<span class="string">&quot;url&quot;</span>:<span class="string">&quot;https://www.bilibili.com&quot;</span>&#125;</span><br><span class="line">&#123;<span class="string">&quot;level&quot;</span>:<span class="string">&quot;info&quot;</span>,<span class="string">&quot;ts&quot;</span>:1693966906.1908221,<span class="string">&quot;caller&quot;</span>:<span class="string">&quot;n11Zap/Logger.go:28&quot;</span>,<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;success...&quot;</span>,<span class="string">&quot;statusCode&quot;</span>:<span class="string">&quot;200 OK&quot;</span>,<span class="string">&quot;url&quot;</span>:<span class="string">&quot;https://www.baidu.com&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<h2 id="SugaredLogger"><a href="#SugaredLogger" class="headerlink" title="SugaredLogger"></a>SugaredLogger</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;go.uber.org/zap&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sugarLogger *zap.SugaredLogger</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	initSugarLogger()</span><br><span class="line">	<span class="keyword">defer</span> sugarLogger.Sync()</span><br><span class="line">	simpleHttpGetS(<span class="string">&quot;https://zyuu.top&quot;</span>)</span><br><span class="line">	simpleHttpGetS(<span class="string">&quot;https://www.zyuu.top&quot;</span>)</span><br><span class="line">	simpleHttpGetS(<span class="string">&quot;https://www.bilibili.com&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">initSugarLogger</span><span class="params">()</span></span> &#123;</span><br><span class="line">	loggerS, _ := zap.NewProduction()</span><br><span class="line">	sugarLogger = loggerS.Sugar()</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">simpleHttpGetS</span><span class="params">(url <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">	sugarLogger.Debugf(<span class="string">&quot;Trying to hit GET request for %s&quot;</span>, url)</span><br><span class="line">	respS, err := http.Get(url)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		sugarLogger.Error(<span class="string">&quot;Error fetching URL %s : Error = %s&quot;</span>, url, err)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		sugarLogger.Info(<span class="string">&quot;Success! statusCode = %s for URL %s&quot;</span>, respS.Status, url)</span><br><span class="line">		respS.Body.Close()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">&quot;level&quot;</span>:<span class="string">&quot;info&quot;</span>,<span class="string">&quot;ts&quot;</span>:1693967379.859905,<span class="string">&quot;caller&quot;</span>:<span class="string">&quot;n11Zap/sugaredLogger.go:27&quot;</span>,<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;Success! statusCode = %s for URL %s200 OKhttps://zyuu.top&quot;</span>&#125;</span><br><span class="line">&#123;<span class="string">&quot;level&quot;</span>:<span class="string">&quot;info&quot;</span>,<span class="string">&quot;ts&quot;</span>:1693967385.2217426,<span class="string">&quot;caller&quot;</span>:<span class="string">&quot;n11Zap/sugaredLogger.go:27&quot;</span>,<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;Success! statusCode = %s for URL %s200 OKhttps://www.zyuu.top&quot;</span>&#125;</span><br><span class="line">&#123;<span class="string">&quot;level&quot;</span>:<span class="string">&quot;info&quot;</span>,<span class="string">&quot;ts&quot;</span>:1693967385.7707212,<span class="string">&quot;caller&quot;</span>:<span class="string">&quot;n11Zap/sugaredLogger.go:27&quot;</span>,<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;Success! statusCode = %s for URL %s200 OKhttps://www.bilibili.com&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Custom-loggers"><a href="#Custom-loggers" class="headerlink" title="Custom loggers"></a>Custom loggers</h2><h3 id="Output-to-file"><a href="#Output-to-file" class="headerlink" title="Output to file"></a>Output to file</h3><h4 id="file"><a href="#file" class="headerlink" title="file"></a>file</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;go.uber.org/zap&quot;</span></span><br><span class="line">	<span class="string">&quot;go.uber.org/zap/zapcore&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> loggerCustom *zap.Logger</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	initLoggerCustom()</span><br><span class="line">	<span class="keyword">defer</span> loggerCustom.Sync()</span><br><span class="line">	SimpleHttpGetCustom(<span class="string">&quot;https://www.zyuu.top&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">initLoggerCustom</span><span class="params">()</span></span> &#123;</span><br><span class="line">	writeSync := getLogWriter()</span><br><span class="line">	encoder := getEncoder()</span><br><span class="line">	core := zapcore.NewCore(encoder, writeSync, zapcore.DebugLevel)</span><br><span class="line">	loggerCustom = zap.New(core)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getLogWriter</span><span class="params">()</span></span> zapcore.WriteSyncer &#123;</span><br><span class="line">	file, _ := os.Create(<span class="string">&quot;./test.log&quot;</span>)</span><br><span class="line">	<span class="keyword">return</span> zapcore.AddSync(file)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getEncoder</span><span class="params">()</span></span> zapcore.Encoder &#123;</span><br><span class="line">	<span class="keyword">return</span> zapcore.NewJSONEncoder(zap.NewDevelopmentEncoderConfig())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SimpleHttpGetCustom</span><span class="params">(url <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">	resp, err := http.Get(url)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		loggerCustom.Error(</span><br><span class="line">			<span class="string">&quot;Error fetching url&quot;</span>,</span><br><span class="line">			zap.String(<span class="string">&quot;url&quot;</span>, url),</span><br><span class="line">			zap.Error(err),</span><br><span class="line">		)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		loggerCustom.Info(<span class="string">&quot;success...&quot;</span>,</span><br><span class="line">			zap.String(<span class="string">&quot;statusCode&quot;</span>, resp.Status),</span><br><span class="line">			zap.String(<span class="string">&quot;url&quot;</span>, url),</span><br><span class="line">		)</span><br><span class="line">		resp.Body.Close()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Output-to-mutilLocations"><a href="#Output-to-mutilLocations" class="headerlink" title="Output to mutilLocations"></a>Output to mutilLocations</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getLogWriter</span><span class="params">()</span></span> zapcore.WriteSyncer &#123;</span><br><span class="line">	file, _ := os.Create(<span class="string">&quot;./test.log&quot;</span>)</span><br><span class="line">	<span class="comment">//return zapcore.AddSync(file)</span></span><br><span class="line">	ws := io.MultiWriter(file, os.Stdout)</span><br><span class="line">	<span class="keyword">return</span> zapcore.AddSync(ws)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="OutPut-to-specific-loc"><a href="#OutPut-to-specific-loc" class="headerlink" title="OutPut to specific loc"></a>OutPut to specific loc</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;go.uber.org/zap&quot;</span></span><br><span class="line">	<span class="string">&quot;go.uber.org/zap/zapcore&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> loggerCustom *zap.Logger</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	initLoggerCustom()</span><br><span class="line">	<span class="keyword">defer</span> loggerCustom.Sync()</span><br><span class="line">	SimpleHttpGetCustom(<span class="string">&quot;https://www.bilibili.com&quot;</span>)</span><br><span class="line">	SimpleHttpGetCustom(<span class="string">&quot;https://www.zyuu2.top&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">initLoggerCustom</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//encoder</span></span><br><span class="line">	encoder := getEncoder()</span><br><span class="line">	<span class="comment">//location</span></span><br><span class="line">	core := getLogWriter(encoder)</span><br><span class="line">	loggerCustom = zap.New(core, zap.AddCaller())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getLogWriter</span><span class="params">(encoder zapcore.Encoder)</span></span> zapcore.Core &#123;</span><br><span class="line">	logF, _ := os.Create(<span class="string">&quot;./test.log&quot;</span>)</span><br><span class="line">	c1 := zapcore.NewCore(encoder, zapcore.AddSync(logF), zapcore.DebugLevel)</span><br><span class="line">	<span class="comment">// test.err.logè®°å½•ERRORçº§åˆ«çš„æ—¥å¿—</span></span><br><span class="line">	errF, _ := os.Create(<span class="string">&quot;./test.err.log&quot;</span>)</span><br><span class="line">	c2 := zapcore.NewCore(encoder, zapcore.AddSync(errF), zap.ErrorLevel)</span><br><span class="line">	<span class="comment">// ä½¿ç”¨NewTeeå°†c1å’Œc2åˆå¹¶åˆ°core</span></span><br><span class="line">	<span class="keyword">return</span> zapcore.NewTee(c1, c2)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getEncoder</span><span class="params">()</span></span> zapcore.Encoder &#123;</span><br><span class="line">	encoderConfig := zap.NewProductionEncoderConfig()</span><br><span class="line">	encoderConfig.EncodeTime = zapcore.ISO8601TimeEncoder</span><br><span class="line">	encoderConfig.EncodeLevel = zapcore.CapitalColorLevelEncoder</span><br><span class="line">	<span class="keyword">return</span> zapcore.NewConsoleEncoder(encoderConfig)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="JSON-Encoder-Log-Encoder"><a href="#JSON-Encoder-Log-Encoder" class="headerlink" title="JSON Encoder-&gt;Log Encoder"></a>JSON Encoder-&gt;Log Encoder</h3><p><strong>NewJSONEncoder-&gt;NewConsoleEncoder</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getEncoder</span><span class="params">()</span></span> zapcore.Encoder &#123;</span><br><span class="line">	<span class="keyword">return</span> zapcore.NewConsoleEncoder(zap.NewProductionEncoderConfig())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.6939687419932888e+09	error	Error fetching url	&#123;&quot;url&quot;: &quot;https://www.zyuu.top&quot;, &quot;error&quot;: &quot;Get \&quot;https://www.zyuu.top\&quot;: net/http: TLS handshake timeout&quot;&#125;</span><br><span class="line">1.693968784160138e+09	info	success...	&#123;&quot;statusCode&quot;: &quot;200 OK&quot;, &quot;url&quot;: &quot;https://www.bilibili.com&quot;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Time"><a href="#Time" class="headerlink" title="Time"></a>Time</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Change</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">initLoggerCustom</span><span class="params">()</span></span> &#123;</span><br><span class="line">	writeSync := getLogWriter()</span><br><span class="line">	encoder := getEncoder()</span><br><span class="line">	core := zapcore.NewCore(encoder, writeSync, zapcore.DebugLevel)</span><br><span class="line">    <span class="comment">//add zap.AddCaller()-&gt;è®°å½•è°ƒç”¨å‡½æ•°ä¿¡æ¯åˆ°log</span></span><br><span class="line">	loggerCustom = zap.New(core, zap.AddCaller())</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getEncoder</span><span class="params">()</span></span> zapcore.Encoder &#123;</span><br><span class="line">	encoderConfig := zap.NewProductionEncoderConfig()</span><br><span class="line">	encoderConfig.EncodeTime = zapcore.ISO8601TimeEncoder</span><br><span class="line">	encoderConfig.EncodeLevel = zapcore.CapitalColorLevelEncoder</span><br><span class="line">	<span class="keyword">return</span> zapcore.NewConsoleEncoder(encoderConfig)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="number">2023</span><span class="number">-09</span><span class="number">-06</span>T11:<span class="number">03</span>:<span class="number">44.800</span>+<span class="number">0800</span>	INFO	n11Zap/Customloggers.<span class="keyword">go</span>:<span class="number">49</span>	success...	&#123;<span class="string">&quot;statusCode&quot;</span>: <span class="string">&quot;200 OK&quot;</span>, <span class="string">&quot;url&quot;</span>: <span class="string">&quot;https://www.bilibili.com&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Golang</category>
      </categories>
      <tags>
        <tag>Golang</tag>
      </tags>
  </entry>
  <entry>
    <title>Go-file</title>
    <url>/2023/09/03/Go-file/</url>
    <content><![CDATA[<h1 id="Go-File-Standard-Library"><a href="#Go-File-Standard-Library" class="headerlink" title="Go-File Standard Library"></a>Go-File Standard Library</h1><p>Golang has Standard Library to operate file<br>include create write read and so on</p>
<span id="more"></span>

<h2 id="Open-Close"><a href="#Open-Close" class="headerlink" title="Open&#x2F;Close"></a>Open&#x2F;Close</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">file, err := os.Open(<span class="string">&quot;./main.go&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;open file failed!, err:&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">defer</span> file.Close()</span><br></pre></td></tr></table></figure>

<h2 id="Read"><a href="#Read" class="headerlink" title="Read"></a>Read</h2><p><code>func (f *File) Read(b []byte) (n int, err error)</code></p>
<p><code>func NewReader(rd io.Reader) *Reader </code></p>
<p><code>func ReadFile(name string) ([]byte, error) </code></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;bufio&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;io&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	f, err := os.Open(<span class="string">&quot;readfile.txt&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;false&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> f.Close()</span><br><span class="line">	<span class="comment">/*m1*/</span></span><br><span class="line">	<span class="keyword">var</span> tmp = <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="number">256</span>)</span><br><span class="line">	<span class="keyword">var</span> content []<span class="type">byte</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">    <span class="comment">// loop read</span></span><br><span class="line">		n, err := f.Read(tmp)</span><br><span class="line">		<span class="keyword">if</span> err == io.EOF &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;read all&quot;</span>)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;read failed&quot;</span>)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		content = <span class="built_in">append</span>(content, tmp[:n]...)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//fmt.Println(string(content))</span></span><br><span class="line">	<span class="comment">/*m2*/</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;m2&quot;</span>)</span><br><span class="line">	reader := bufio.NewReader(f)</span><br><span class="line">	<span class="keyword">for</span> &#123;	</span><br><span class="line">		line, err := reader.ReadString(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">		<span class="keyword">if</span> err == io.EOF &#123;</span><br><span class="line">			<span class="keyword">if</span> <span class="built_in">len</span>(line) != <span class="number">0</span> &#123;</span><br><span class="line">				fmt.Println(line)</span><br><span class="line">			&#125;</span><br><span class="line">			fmt.Println(<span class="string">&quot;read all&quot;</span>)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;false&quot;</span>)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println(line)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/*m3*/</span></span><br><span class="line">	readAll, err := os.ReadFile(<span class="string">&quot;./readfile.txt&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;false&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="type">string</span>(readAll))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Write"><a href="#Write" class="headerlink" title="Write"></a>Write</h2><p><code>os.OpenFile()</code></p>
<table>
<thead>
<tr>
<th>Modes</th>
<th>Meaning</th>
</tr>
</thead>
<tbody><tr>
<td><code>os.O_WRONLY</code></td>
<td>åªå†™</td>
</tr>
<tr>
<td><code>os.O_CREATE</code></td>
<td>åˆ›å»ºæ–‡ä»¶</td>
</tr>
<tr>
<td><code>os.O_RDONLY</code></td>
<td>åªè¯»</td>
</tr>
<tr>
<td><code>os.O_RDWR</code></td>
<td>è¯»å†™</td>
</tr>
<tr>
<td><code>os.O_TRUNC</code></td>
<td>æ¸…ç©º</td>
</tr>
<tr>
<td><code>os.O_APPEND</code></td>
<td>è¿½åŠ </td>
</tr>
</tbody></table>
<p><code>perm</code>ï¼šFile permissionsï¼ŒOctal numberã€‚rï¼ˆreadï¼‰04ï¼Œwï¼ˆwriteï¼‰02ï¼Œxï¼ˆexecuteï¼‰01</p>
<p><code>func OpenFile(name string, flag int, perm FileMode) (*File, error) </code></p>
<p><code>func (f *File) Write(b []byte) (n int, err error)</code><br><code>func (f *File) WriteString(s string) (n int, err error)</code></p>
<p><code>func NewWriter(w io.Writer) *Writer </code></p>
<p><code>func WriteFile(name string, data []byte, perm FileMode) error</code></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;bufio&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;strconv&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">write1</span><span class="params">()</span></span> &#123;</span><br><span class="line">	file, err := os.OpenFile(<span class="string">&quot;write.txt&quot;</span>, os.O_CREATE|os.O_APPEND, <span class="number">0666</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;open failed&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> file.Close()</span><br><span class="line">	file.Write([]<span class="type">byte</span>(<span class="string">&quot;hello world\n&quot;</span>))</span><br><span class="line">	file.WriteString(<span class="string">&quot;hello golang\n&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">write2</span><span class="params">()</span></span> &#123;</span><br><span class="line">	file, err := os.OpenFile(<span class="string">&quot;write2.txt&quot;</span>, os.O_CREATE|os.O_APPEND, <span class="number">0666</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> file.Close()</span><br><span class="line">    writer := bufio.NewWriter(file)  <span class="comment">//Write data to the cache(ç¼“å­˜åŒº)</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		writer.WriteString(<span class="string">&quot;hello golang&quot;</span> + fmt.Sprintf(strconv.Itoa(i)) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	writer.Flush() <span class="comment">//Write the contents of the cache to a file</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">write3</span><span class="params">()</span></span> &#123;</span><br><span class="line">	str := <span class="string">&quot;hello world hello golang&quot;</span></span><br><span class="line">	err := os.WriteFile(<span class="string">&quot;./write3.txt&quot;</span>, []<span class="type">byte</span>(str), <span class="number">0666</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;false&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Golang</category>
      </categories>
      <tags>
        <tag>Golang</tag>
      </tags>
  </entry>
  <entry>
    <title>GO-flag</title>
    <url>/2023/09/03/Go-flag/</url>
    <content><![CDATA[<h1 id="Golang-Flag-Standard-Library"><a href="#Golang-Flag-Standard-Library" class="headerlink" title="Golang-Flag Standard Library"></a>Golang-Flag Standard Library</h1><p>The Go language <code>flag</code> package implements the parsing of command line arguments</p>
<h2 id="Get-the-command-line-arguments"><a href="#Get-the-command-line-arguments" class="headerlink" title="Get the command line arguments"></a>Get the command line arguments</h2><span id="more"></span>

<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//os.Args-&gt;[]string</span></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(os.Args) &gt; <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> idx, arg := <span class="keyword">range</span> os.Args &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;args[%d]=%v\n&quot;</span>, idx, arg)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">go run osArgs.go 1 2</span></span><br><span class="line">args[0]=C:\Users\yu\AppData\Local\Temp\go-build3364657135\b001\exe\osArgs.exe</span><br><span class="line">args[1]=1</span><br><span class="line">args[2]=2</span><br></pre></td></tr></table></figure>

<h2 id="Define-the-command-line-flag-parameter"><a href="#Define-the-command-line-flag-parameter" class="headerlink" title="Define the command-line flag parameter"></a>Define the command-line flag parameter</h2><p>The command line parameter types supported by the flag package are ,<br><code>bool</code> <code>int</code> , <code>int64</code> <code>uint</code> <code>uint64</code> <code>float</code> <code>float64</code> <code>string</code> <code>duration</code> </p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;flag&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">/*å®šä¹‰flagå‚æ•°*/</span></span><br><span class="line">	<span class="comment">//name := flag.String(&quot;name&quot;, &quot;å¼ ä¸‰&quot;, &quot;å§“å&quot;)</span></span><br><span class="line">	<span class="comment">//age := flag.Int(&quot;age&quot;, 18, &quot;å¹´é¾„&quot;)</span></span><br><span class="line">	<span class="comment">//married := flag.Bool(&quot;married&quot;, false, &quot;å©šå¦&quot;)</span></span><br><span class="line">	<span class="comment">//delay := flag.Duration(&quot;d&quot;, 0, &quot;æ—¶é—´é—´éš”&quot;)</span></span><br><span class="line">	<span class="keyword">var</span> name <span class="type">string</span></span><br><span class="line">	<span class="keyword">var</span> age <span class="type">int</span></span><br><span class="line">	<span class="keyword">var</span> married <span class="type">bool</span></span><br><span class="line">	<span class="keyword">var</span> delay time.Duration</span><br><span class="line">	flag.StringVar(&amp;name, <span class="string">&quot;name&quot;</span>, <span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="string">&quot;å§“å&quot;</span>)</span><br><span class="line">	flag.IntVar(&amp;age, <span class="string">&quot;age&quot;</span>, <span class="number">18</span>, <span class="string">&quot;å¹´é¾„&quot;</span>)</span><br><span class="line">	flag.BoolVar(&amp;married, <span class="string">&quot;married&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;å©šå¦&quot;</span>)</span><br><span class="line">	flag.DurationVar(&amp;delay, <span class="string">&quot;d&quot;</span>, <span class="number">0</span>, <span class="string">&quot;æ—¶é—´é—´éš”&quot;</span>)</span><br><span class="line">	<span class="comment">/*è§£æ*/</span></span><br><span class="line">	flag.Parse()</span><br><span class="line">	fmt.Println(name, age, married, delay)</span><br><span class="line">	<span class="comment">//è¿”å›å‘½ä»¤è¡Œå‚æ•°åçš„å…¶ä»–å‚æ•°</span></span><br><span class="line">	fmt.Println(flag.Args())</span><br><span class="line">	<span class="comment">//è¿”å›å‘½ä»¤è¡Œå‚æ•°åçš„å…¶ä»–å‚æ•°ä¸ªæ•°</span></span><br><span class="line">	fmt.Println(flag.NArg())</span><br><span class="line">	<span class="comment">//è¿”å›ä½¿ç”¨çš„å‘½ä»¤è¡Œå‚æ•°ä¸ªæ•°</span></span><br><span class="line">	fmt.Println(flag.NFlag())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>â€‹	 	</p>
]]></content>
      <categories>
        <category>Golang</category>
      </categories>
      <tags>
        <tag>Golang</tag>
      </tags>
  </entry>
  <entry>
    <title>Go-redis</title>
    <url>/2023/09/03/Go-redis/</url>
    <content><![CDATA[<h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h1><p>Redis (<strong>Remote Dictionary Server</strong>)<br><strong>key-value</strong> non-relational (NoSQL) database based on an <strong>in-memory</strong> implementation</p>
<p>Redis provides a variety of different types of data structures,<br>many business scenarios problems can be naturally reflect to these data structures.<br>In addition, with features such as replication, persistence, and client-side sharding,<br>Redis can easily scale into(æ‰©å±•) a system that can contain hundreds of GB datas<br>and handle millions of requests per second.</p>
<p>Redis supports data structures such as<br><code>string,hash,list,set,sortedSets,bitmaps,hyperloglogs,geospatial,streams</code></p>
<span id="more"></span>

<h2 id="NoSQL"><a href="#NoSQL" class="headerlink" title="NoSQL"></a>NoSQL</h2><p>NoSQL (Not only SQL) is a collective term for a database management system that is different from traditional relational databases</p>
<p>Redis (<strong>Remote Dictionary Server</strong>)<br><strong>key-value</strong> non-relational (NoSQL) database based on an <strong>in-memory</strong> implementation</p>
<table>
<thead>
<tr>
<th></th>
<th>SQL</th>
<th>NoSQL</th>
</tr>
</thead>
<tbody><tr>
<td>dataType</td>
<td>structured</td>
<td>NotStructured</td>
</tr>
<tr>
<td>dataRelation</td>
<td>Relational</td>
<td>NotRelational</td>
</tr>
<tr>
<td>queryMethod</td>
<td>SQL</td>
<td>not-SQL</td>
</tr>
<tr>
<td>transactions</td>
<td>ACID</td>
<td>BASE</td>
</tr>
</tbody></table>
<h2 id="Commend"><a href="#Commend" class="headerlink" title="Commend"></a>Commend</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">redis-cli</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker run -it --network host --<span class="built_in">rm</span> redis redis-cli</span></span><br></pre></td></tr></table></figure>

<p>query key</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">KEYS pattern </span><br></pre></td></tr></table></figure>

<p>del key</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">DEL name</span><br></pre></td></tr></table></figure>

<p>insert</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SET</span> Key <span class="keyword">Value</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">MSET k1 v1 k2 v3 k3 v3 [key,value...]</span><br></pre></td></tr></table></figure>

<p>exist</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">EXISTS</span> key</span><br></pre></td></tr></table></figure>

<p>expirationTime</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">EXPIRE key</span><br></pre></td></tr></table></figure>

<p>see expire</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">TTL key</span><br></pre></td></tr></table></figure>

<h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><p> value:string int float</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> key</span><br><span class="line">  summary: <span class="keyword">Returns</span> the string <span class="keyword">value</span> <span class="keyword">of</span> a key.</span><br><span class="line">  </span><br><span class="line">MGET key [key ...]</span><br><span class="line">  summary: Atomically <span class="keyword">returns</span> the string <span class="keyword">values</span> <span class="keyword">of</span> <span class="keyword">one</span> <span class="keyword">or</span> more keys.</span><br><span class="line">  </span><br><span class="line"><span class="keyword">SET</span> key <span class="keyword">value</span> [NX<span class="operator">|</span>XX] [<span class="keyword">GET</span>] [EX seconds<span class="operator">|</span>PX milliseconds<span class="operator">|</span>EXAT unix<span class="operator">-</span><span class="type">time</span><span class="operator">-</span>seconds<span class="operator">|</span>PXAT unix<span class="operator">-</span><span class="type">time</span><span class="operator">-</span>			milliseconds<span class="operator">|</span>KEEPTTL]</span><br><span class="line">  summary: Sets the string <span class="keyword">value</span> <span class="keyword">of</span> a key, ignoring its type. The key <span class="keyword">is</span> created if it doesn<span class="string">&#x27;t 				exist.</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">MSET key value [key value ...]</span></span><br><span class="line"><span class="string">  summary: Atomically creates or modifies the string values of one or more keys.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">INCR key</span></span><br><span class="line"><span class="string">  summary: Increments the integer value of a key by one. Uses 0 as initial value if the key doesn&#x27;</span>t 	 	exist.  </span><br><span class="line"></span><br><span class="line">INCRBY<span class="operator">/</span>INCRBYFLOAT key increment</span><br><span class="line">  summary: Increments the <span class="type">integer</span> <span class="keyword">value</span> <span class="keyword">of</span> a key <span class="keyword">by</span> a step. Uses <span class="number">0</span> <span class="keyword">as</span> <span class="keyword">initial</span> <span class="keyword">value</span> if the key 				doesn<span class="string">&#x27;t exist. </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">SETEX key seconds value</span></span><br><span class="line"><span class="string">  summary: Sets the string value and expiration time of a key. Creates the key if it doesn&#x27;</span>t exist.</span><br><span class="line"></span><br><span class="line">SETNX key <span class="keyword">value</span></span><br><span class="line">  summary: <span class="keyword">Set</span> the string <span class="keyword">value</span> <span class="keyword">of</span> a key <span class="keyword">only</span> <span class="keyword">when</span> the key doesn<span class="string">&#x27;t exist.</span></span><br></pre></td></tr></table></figure>

<p>struct</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">projectName:serverName:type:id</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> red:user:1 <span class="string">&#x27;&#123;&quot;id&quot;:1,&quot;name&quot;:&quot;jack&quot;,&quot;age&quot;:21&#125;&#x27;</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> red:user:2 <span class="string">&#x27;&#123;&quot;id&quot;:2,&quot;name&quot;:&quot;mike&quot;,&quot;age&quot;:16&#125;&#x27;</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> red:product:1 <span class="string">&#x27;&#123;&quot;id&quot;:&quot;1&quot;,&quot;name&quot;:&quot;loop&quot;,&quot;pri&quot;,1000&#125;&#x27;</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> red:product:1 <span class="string">&#x27;&#123;&quot;id&quot;:&quot;2&quot;,&quot;name&quot;:&quot;loop2&quot;,&quot;pri&quot;,10000&#125;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; keys red*</span><br><span class="line">1) <span class="string">&quot;red:product:1&quot;</span></span><br><span class="line">2) <span class="string">&quot;red:user:2&quot;</span></span><br><span class="line">3) <span class="string">&quot;red:user:1&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; keys red:product*</span><br><span class="line">1) <span class="string">&quot;red:product:1&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; keys red:user*</span><br><span class="line">1) <span class="string">&quot;red:user:2&quot;</span></span><br><span class="line">2) <span class="string">&quot;red:user:1&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a>Hash</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">HDEL key field [field ...]</span><br><span class="line"></span><br><span class="line">HEXISTS key field</span><br><span class="line"></span><br><span class="line">HGET key field</span><br><span class="line"></span><br><span class="line">HGETALL key  </span><br><span class="line"></span><br><span class="line">HSET key field</span><br><span class="line"> </span><br><span class="line">HKEYS key</span><br><span class="line"></span><br><span class="line">HVALS key <span class="operator">/</span><span class="operator">/</span><span class="keyword">get</span> key</span><br><span class="line"></span><br><span class="line">HLEN key	<span class="operator">/</span><span class="operator">/</span><span class="keyword">get</span> <span class="keyword">value</span></span><br><span class="line"> </span><br><span class="line">HMGET key field [field ...]</span><br><span class="line"> </span><br><span class="line">HMSET key field <span class="keyword">value</span> [field <span class="keyword">value</span> ...]</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; HSET zyuu:user:1 age 111</span><br><span class="line">127.0.0.1:6379&gt; HGET zyuu:user:1 age</span><br><span class="line">&quot;111&quot;</span><br><span class="line">127.0.0.1:6379&gt;HMSET zyuu:user:2 name lilei age 20 sex man</span><br><span class="line">127.0.0.1:6379&gt; HGETALL zyuu:user:2</span><br><span class="line">1) &quot;name&quot;</span><br><span class="line">2) &quot;lilei&quot;</span><br><span class="line">3) &quot;age&quot;</span><br><span class="line">4) &quot;20&quot;</span><br><span class="line">5) &quot;sex&quot;</span><br><span class="line">6) &quot;man&quot;</span><br></pre></td></tr></table></figure>

<h3 id="List-based-on-doublie-linkedlist"><a href="#List-based-on-doublie-linkedlist" class="headerlink" title="List (based on doublie-linkedlist)"></a>List (based on doublie-linkedlist)</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">LPUSH<span class="operator">/</span>RPUSH key element [element ...]</span><br><span class="line">LPOP<span class="operator">/</span>RPOP key [count]</span><br><span class="line">LRANGE key <span class="keyword">start</span> stop</span><br></pre></td></tr></table></figure>

<h3 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h3><hr>
<h1 id="Go-redis"><a href="#Go-redis" class="headerlink" title="Go-redis"></a><a href="https://redis.io/">Go-redis</a></h1><p>Install Redis locally or use Docker</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run --name redis507 -p 6379:6379 -d redis:5.0.7</span><br><span class="line">docker run -it --network host --<span class="built_in">rm</span> redis:5.0.7 redis-cli</span><br></pre></td></tr></table></figure>

<p>Go-redis package<br><a href="https://github.com/gomodule/redigo">redigo</a> </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">go get github.com/gomodule/redigo/redis</span><br></pre></td></tr></table></figure>

<p><a href="https://github.com/redis/go-redis">go-redis</a></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">go</span> mod init github.com/my/repo</span><br><span class="line"><span class="keyword">go</span> get github.com/redis/<span class="keyword">go</span>-redis/v9</span><br></pre></td></tr></table></figure>

<p>Here we use <code>go-redis</code>package</p>
<h2 id="Connect"><a href="#Connect" class="headerlink" title="Connect"></a>Connect</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;context&quot;</span></span><br><span class="line">	<span class="string">&quot;errors&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/redis/go-redis/v9&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// $ docker run -it --network host --rm redis redis-cli</span></span><br><span class="line"><span class="keyword">var</span> rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">	Addr:     <span class="string">&quot;localhost:6379&quot;</span>,</span><br><span class="line">	Password: <span class="string">&quot;&quot;</span>, <span class="comment">// å¯†ç </span></span><br><span class="line">	DB:       <span class="number">0</span>,  <span class="comment">// æ•°æ®åº“</span></span><br><span class="line">	PoolSize: <span class="number">20</span>, <span class="comment">// è¿æ¥æ± å¤§å°</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> redisDB *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	redisDB = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">&quot;localhost:6379&quot;</span>,</span><br><span class="line">		DB:       <span class="number">3</span>,</span><br><span class="line">		Password: <span class="string">&quot;&quot;</span>,</span><br><span class="line">		PoolSize: <span class="number">20</span>,</span><br><span class="line">	&#125;)</span><br><span class="line">	ctx, cancel := context.WithTimeout(context.Background(), time.Millisecond*<span class="number">3000</span>)</span><br><span class="line">	<span class="keyword">defer</span> cancel()</span><br><span class="line">	_, err := redisDB.Ping(ctx).Result()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	DoCommend1(ctx)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">DoCommend1</span><span class="params">(ctx context.Context)</span></span> &#123;</span><br><span class="line">	<span class="comment">//æ‰§è¡Œå‘½ä»¤è·å–ç»“æœ</span></span><br><span class="line">	val, err := redisDB.Get(ctx, <span class="string">&quot;key&quot;</span>).Result()</span><br><span class="line">	fmt.Println(val, err)</span><br><span class="line">	<span class="comment">//è·å–å‘½ä»¤å¯¹è±¡</span></span><br><span class="line">	cmder := redisDB.Get(ctx, <span class="string">&quot;key&quot;</span>)</span><br><span class="line">	fmt.Println(cmder.Val())</span><br><span class="line">	fmt.Println(cmder.Err())</span><br><span class="line">	<span class="comment">//è¡Œå‘½ä»¤è·å–é”™è¯¯</span></span><br><span class="line">	err = redisDB.Set(ctx, <span class="string">&quot;key&quot;</span>, <span class="string">&quot;hello golang&quot;</span>, <span class="number">3</span>*time.Second).Err()</span><br><span class="line">	<span class="comment">// ç›´æ¥æ‰§è¡Œå‘½ä»¤è·å–å€¼</span></span><br><span class="line">	value := redisDB.Get(ctx, <span class="string">&quot;key&quot;</span>).Val()</span><br><span class="line">	fmt.Println(value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="commend"><a href="#commend" class="headerlink" title="commend"></a>commend</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// DoCommend commend</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">DoCommend</span><span class="params">()</span></span> &#123;</span><br><span class="line">	ctx, cancel := context.WithTimeout(context.Background(), <span class="number">500</span>*time.Millisecond)</span><br><span class="line">	<span class="keyword">defer</span> cancel()</span><br><span class="line">	<span class="comment">//æ‰§è¡Œå‘½ä»¤è·å–ç»“æœ</span></span><br><span class="line">	val, err := rdb.Get(ctx, <span class="string">&quot;key&quot;</span>).Result()</span><br><span class="line">	fmt.Println(val, err)</span><br><span class="line">	<span class="comment">//è·å–å‘½ä»¤å¯¹è±¡</span></span><br><span class="line">	cmder := rdb.Get(ctx, <span class="string">&quot;key&quot;</span>)</span><br><span class="line">	fmt.Println(cmder.Val())</span><br><span class="line">	fmt.Println(cmder.Err())</span><br><span class="line">	<span class="comment">//è¡Œå‘½ä»¤è·å–é”™è¯¯</span></span><br><span class="line">	err = rdb.Set(ctx, <span class="string">&quot;key&quot;</span>, <span class="string">&quot;hello golang&quot;</span>, <span class="number">3</span>*time.Second).Err()</span><br><span class="line">	<span class="comment">// ç›´æ¥æ‰§è¡Œå‘½ä»¤è·å–å€¼</span></span><br><span class="line">	value := rdb.Get(ctx, <span class="string">&quot;key&quot;</span>).Val()</span><br><span class="line">	fmt.Println(value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="anycommend"><a href="#anycommend" class="headerlink" title="anycommend"></a>anycommend</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// DoAny any commend</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">DoAny</span><span class="params">()</span></span> &#123;</span><br><span class="line">	ctx, cancel := context.WithTimeout(context.Background(), <span class="number">500</span>*time.Millisecond)</span><br><span class="line">	<span class="keyword">defer</span> cancel()</span><br><span class="line">	err := rdb.Do(ctx, <span class="string">&quot;set&quot;</span>, <span class="string">&quot;key&quot;</span>, <span class="string">&quot;hello,world&quot;</span>, <span class="string">&quot;EX&quot;</span>, <span class="number">3600</span>).Err()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	val, err := rdb.Do(ctx, <span class="string">&quot;get&quot;</span>, <span class="string">&quot;key&quot;</span>).Result()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(val)</span><br><span class="line"></span><br><span class="line">	aff, err := rdb.Do(ctx, <span class="string">&quot;EXISTS&quot;</span>, <span class="string">&quot;key&quot;</span>).Result()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;aff:&quot;</span>, aff)</span><br><span class="line"></span><br><span class="line">	aff, err = rdb.Do(ctx, <span class="string">&quot;DEL&quot;</span>, <span class="string">&quot;key&quot;</span>).Result()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;aff:&quot;</span>, aff)</span><br><span class="line"></span><br><span class="line">	aff, err = rdb.Do(ctx, <span class="string">&quot;EXISTS&quot;</span>, <span class="string">&quot;key&quot;</span>).Result()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;aff:&quot;</span>, aff)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="error"><a href="#error" class="headerlink" title="error"></a>error</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// RedisNil redis nil</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">RedisNil</span><span class="params">(key, defaultValue <span class="type">string</span>)</span></span> (<span class="type">string</span>, <span class="type">error</span>) &#123;</span><br><span class="line">	ctx, cancel := context.WithTimeout(context.Background(), <span class="number">500</span>*time.Millisecond)</span><br><span class="line">	<span class="keyword">defer</span> cancel()</span><br><span class="line">	val, err := rdb.Get(ctx, key).Result()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="comment">//not exist key</span></span><br><span class="line">		<span class="keyword">if</span> errors.Is(err, redis.Nil) &#123;</span><br><span class="line">			<span class="keyword">return</span> defaultValue, <span class="literal">nil</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span>, err</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> val, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Zset"><a href="#Zset" class="headerlink" title="Zset"></a>Zset</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ZsetRedis</span><span class="params">()</span></span> &#123;</span><br><span class="line">	zsetKey := <span class="string">&quot;language_rank&quot;</span></span><br><span class="line">	<span class="comment">//value</span></span><br><span class="line">	languages := []redis.Z&#123;</span><br><span class="line">		&#123;Score: <span class="number">90.0</span>, Member: <span class="string">&quot;Go&quot;</span>&#125;,</span><br><span class="line">		&#123;Score: <span class="number">90.1</span>, Member: <span class="string">&quot;Java&quot;</span>&#125;,</span><br><span class="line">		&#123;Score: <span class="number">90.2</span>, Member: <span class="string">&quot;C&quot;</span>&#125;,</span><br><span class="line">		&#123;Score: <span class="number">90.3</span>, Member: <span class="string">&quot;cpp&quot;</span>&#125;,</span><br><span class="line">		&#123;Score: <span class="number">90.4</span>, Member: <span class="string">&quot;C#&quot;</span>&#125;,</span><br><span class="line">		&#123;Score: <span class="number">90.5</span>, Member: <span class="string">&quot;Python&quot;</span>&#125;,</span><br><span class="line">	&#125;</span><br><span class="line">	ctx, cancer := context.WithTimeout(context.Background(), <span class="number">500</span>*time.Millisecond)</span><br><span class="line">	<span class="keyword">defer</span> cancer()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//ZADD</span></span><br><span class="line">	err := rdbZ.ZAdd(ctx, zsetKey, languages...).Err()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;add success&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//add go 0.1</span></span><br><span class="line">	newScore, err := rdbZ.ZIncrBy(ctx, zsetKey, <span class="number">0.1</span>, <span class="string">&quot;Go&quot;</span>).Result()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(newScore)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//get the max3</span></span><br><span class="line">	ret := rdbZ.ZRevRangeWithScores(ctx, zsetKey, <span class="number">0</span>, <span class="number">2</span>).Val()</span><br><span class="line">	<span class="keyword">for</span> _, v := <span class="keyword">range</span> ret &#123;</span><br><span class="line">		fmt.Println(v.Member, v.Score)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//get score limit</span></span><br><span class="line">	<span class="comment">/*op := &amp;redis.ZRangeBy&#123;</span></span><br><span class="line"><span class="comment">		Min: &quot;90&quot;,</span></span><br><span class="line"><span class="comment">		Max: &quot;90.2&quot;,</span></span><br><span class="line"><span class="comment">	&#125;*/</span></span><br><span class="line">	ret, err = rdbZ.ZRevRangeByScoreWithScores(ctx, zsetKey, &amp;redis.ZRangeBy&#123;</span><br><span class="line">		Min: <span class="string">&quot;90&quot;</span>,</span><br><span class="line">		Max: <span class="string">&quot;90.2&quot;</span>,</span><br><span class="line">	&#125;).Result()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(ret)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="KEYS"><a href="#KEYS" class="headerlink" title="KEYS *"></a>KEYS *</h2><p>prefix</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// PrefixKey Get prefix keys</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PrefixKey</span><span class="params">()</span></span> &#123;</span><br><span class="line">	ctx, cancer := context.WithTimeout(context.Background(), <span class="number">500</span>*time.Millisecond)</span><br><span class="line">	<span class="keyword">defer</span> cancer()</span><br><span class="line">	<span class="comment">//method 1</span></span><br><span class="line">	vals, _ := rdbZ.Keys(ctx, <span class="string">&quot;*&quot;</span>).Result()</span><br><span class="line">	fmt.Println(vals)</span><br><span class="line">	<span class="comment">//method 2</span></span><br><span class="line">	iter := rdbZ.Scan(ctx, <span class="number">0</span>, <span class="string">&quot;*&quot;</span>, <span class="number">0</span>).Iterator()</span><br><span class="line">	<span class="keyword">for</span> iter.Next(ctx) &#123;</span><br><span class="line">		<span class="comment">//err:=rdbZ.Del(ctx,iter.Val())</span></span><br><span class="line">		<span class="comment">//err := rdbZ.Do(ctx, &quot;DEL&quot;, iter.Val()).Err()</span></span><br><span class="line">		<span class="comment">//if err != nil &#123;</span></span><br><span class="line">		<span class="comment">//	fmt.Println(err)</span></span><br><span class="line">		<span class="comment">//	return</span></span><br><span class="line">		<span class="comment">//&#125;</span></span><br><span class="line">		fmt.Println(iter.Val())</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> err := iter.Err(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Pipeline"><a href="#Pipeline" class="headerlink" title="Pipeline"></a>Pipeline</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">to be <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Golang</category>
      </categories>
      <tags>
        <tag>Golang</tag>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title>Go-log</title>
    <url>/2023/09/03/Go-log/</url>
    <content><![CDATA[<h1 id="LOG"><a href="#LOG" class="headerlink" title="LOG"></a>LOG</h1><h2 id="GO-log-Standard-Library"><a href="#GO-log-Standard-Library" class="headerlink" title="GO-log Standard Library"></a>GO-log Standard Library</h2><p>he Go <code>log</code>  package implements a simple log service base on Standard Library.</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	log.SetFlags(log.Lshortfile | log.Ltime | log.Ldate | log.LUTC)</span><br><span class="line">	log.Println(<span class="string">&quot;æ—¥å¿—1&quot;</span>)</span><br><span class="line">	log.SetPrefix(<span class="string">&quot;[log]&quot;</span>)</span><br><span class="line">	log.Println(<span class="string">&quot;æ—¥å¿—2&quot;</span>)</span><br><span class="line">	logf, err := os.OpenFile(<span class="string">&quot;./Flog.log&quot;</span>, os.O_CREATE|os.O_APPEND, <span class="number">0644</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	log.SetOutput(logf)</span><br><span class="line">	log.Println(<span class="string">&quot;æ—¥å¿—3&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<span id="more"></span>

<h3 id="func-SetFlags-flag-int"><a href="#func-SetFlags-flag-int" class="headerlink" title="func SetFlags(flag int)"></a><code>func SetFlags(flag int)</code></h3><p>Defaultly, loggers only provide log time information,<br>but in many cases we want to get more information,<br>such as the file name and line number of the log.<br><code>log</code> The standard library gives us ways to add these choices.</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Ldate       				 // 2009/01/23</span><br><span class="line">   Ltime                        // 01:23:23</span><br><span class="line">   Lmicroseconds                // 01:23:23.123123</span><br><span class="line">   Llongfile                     // path+lineï¼š /a/b/c/d.go:23</span><br><span class="line">   Lshortfile                    // fileName+lineï¼šd.go:23ï¼ˆä¼šè¦†ç›–æ‰Llongfileï¼‰</span><br><span class="line">   LUTC                         // UTCtime</span><br><span class="line">   LstdFlags    				 // Dfaultlogger</span><br></pre></td></tr></table></figure>

<h3 id="Prefix"><a href="#Prefix" class="headerlink" title="Prefix"></a>Prefix</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Prefix</span><span class="params">()</span></span> <span class="type">string</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SetPrefix</span><span class="params">(prefix <span class="type">string</span>)</span></span></span><br></pre></td></tr></table></figure>

<h3 id="OutPutLocal"><a href="#OutPutLocal" class="headerlink" title="OutPutLocal"></a>OutPutLocal</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SetOutput</span><span class="params">(w io.Writer)</span></span></span><br></pre></td></tr></table></figure>





<h2 id="Logrus"><a href="#Logrus" class="headerlink" title="Logrus"></a><a href="https://github.com/sirupsen/logrus">Logrus</a></h2><h2 id="Uber-go-zap"><a href="#Uber-go-zap" class="headerlink" title="Uber-go zap"></a>Uber-go zap</h2>]]></content>
      <categories>
        <category>Golang</category>
      </categories>
      <tags>
        <tag>Golang</tag>
      </tags>
  </entry>
  <entry>
    <title>GoDesignPattern</title>
    <url>/2023/10/29/GoDesignPattern/</url>
    <content><![CDATA[<h1 id="Go-Design-Pattern"><a href="#Go-Design-Pattern" class="headerlink" title="Go Design Pattern"></a>Go Design Pattern</h1><hr>
<p> For Go,using design patterns like other traditional OOP languages<br>is awkward and not recommended<br>but that doesnâ€™t mean  Go doesnâ€™t need design patterns<br>and the ideas of design patterns are the same</p>
<hr>
<h2 id="Singleton"><a href="#Singleton" class="headerlink" title="Singleton"></a>Singleton</h2><p>The singleton mode has two implementations, the hungry case and the lazy case</p>
<p>The difference between the â€œlazyâ€ and â€œhungryâ€ is the difference in the time<br>it takes to create a singleton object.</p>
<h3 id="hungry"><a href="#hungry" class="headerlink" title="hungry"></a>hungry</h3><p>é¥¿æ±‰å¼å…ˆåˆ›å»º</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> singleton</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> HungrySingleton <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Hungry *HungrySingleton</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	Hungry = &amp;HungrySingleton&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GetInstance è·å–å®ä¾‹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetInstance</span><span class="params">()</span></span> *HungrySingleton &#123;</span><br><span class="line">	<span class="keyword">return</span> Hungry</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="lazy"><a href="#lazy" class="headerlink" title="lazy"></a>lazy</h3><p>ç”¨çš„æ—¶å€™åˆ›å»º,å¹¶å‘ä¸å®‰å…¨,è¦åŠ é”</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> singleton</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;sync&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Singleton <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	LazySingleton *Singleton</span><br><span class="line">	once          = &amp;sync.Once&#123;&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetLazyInstance</span><span class="params">()</span></span> *Singleton &#123;</span><br><span class="line">	<span class="keyword">if</span> LazySingleton == <span class="literal">nil</span> &#123;</span><br><span class="line">		once.Do(<span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">			LazySingleton = &amp;Singleton&#123;&#125;</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> LazySingleton</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Factor"><a href="#Factor" class="headerlink" title="Factor"></a>Factor</h2><h3 id="simple-factor"><a href="#simple-factor" class="headerlink" title="simple factor"></a>simple factor</h3><p><code>NewXXX</code>  é€šè¿‡ä¸“é—¨å®šä¹‰ä¸€ä¸ªç±»æ¥è´Ÿè´£åˆ›å»ºå…¶ä»–ç±»çš„å®ä¾‹ï¼Œè¢«åˆ›å»ºçš„å®ä¾‹é€šå¸¸éƒ½å…·æœ‰å…±åŒçš„çˆ¶ç±»<br>é‡‡ç”¨ <code>NewName</code> çš„æ–¹å¼åˆ›å»ºå¯¹è±¡&#x2F;æ¥å£ï¼Œå½“å®ƒè¿”å›çš„æ˜¯æ¥å£çš„æ—¶å€™ï¼Œå…¶å®å°±æ˜¯ç®€å•å·¥å‚æ¨¡å¼<br>éœ€è¦åŒ…å«åˆ¤æ–­é€»è¾‘ï¼Œèƒ½å¤Ÿæ ¹æ®å¤–ç•Œç»™å®šçš„ä¿¡æ¯ï¼Œå†³å®šç©¶ç«Ÿåº”è¯¥åˆ›å»ºå“ªä¸ªå…·ä½“ç±»çš„å¯¹è±¡<br>ç”¨æˆ·åœ¨ä½¿ç”¨æ—¶å¯ä»¥ç›´æ¥æ ¹æ®å·¥å‚ç±»å»åˆ›å»ºæ‰€éœ€çš„å®ä¾‹ï¼Œè€Œæ— éœ€äº†è§£è¿™äº›å¯¹è±¡æ˜¯å¦‚ä½•åˆ›å»ºä»¥åŠå¦‚ä½•ç»„ç»‡çš„<br>å½“å¯¹è±¡çš„åˆ›å»ºé€»è¾‘æ¯”è¾ƒå¤æ‚ï¼Œä¸åªæ˜¯ç®€å•çš„ new ä¸€ä¸‹å°±å¯ä»¥ï¼Œè€Œæ˜¯è¦ç»„åˆå…¶ä»–ç±»å¯¹è±¡ï¼Œ<br>åšå„ç§åˆå§‹åŒ–æ“ä½œçš„æ—¶å€™ï¼Œæ¨èä½¿ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œå°†å¤æ‚çš„åˆ›å»ºé€»è¾‘æ‹†åˆ†åˆ°å¤šä¸ªå·¥å‚ç±»ä¸­ï¼Œ<br>è®©æ¯ä¸ªå·¥å‚ç±»éƒ½ä¸è‡³äºè¿‡äºå¤æ‚<br>å¦‚sqlå¼•æ“å¯ä»¥ç”¨factoræ¨¡å¼</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> factory</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> NeedImplement <span class="keyword">interface</span> &#123;</span><br><span class="line">	Parse(data []<span class="type">byte</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> A <span class="keyword">struct</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Parse Parse</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a A)</span></span> Parse(data []<span class="type">byte</span>) &#123;</span><br><span class="line">	<span class="built_in">panic</span>(<span class="string">&quot;implement me&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> B <span class="keyword">struct</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b B)</span></span> Parse(data []<span class="type">byte</span>) &#123;</span><br><span class="line">	<span class="built_in">panic</span>(<span class="string">&quot;implement me&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewNeedImplement</span><span class="params">(t <span class="type">string</span>)</span></span> NeedImplement &#123;</span><br><span class="line">	<span class="keyword">switch</span> t &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">&quot;A&quot;</span>:</span><br><span class="line">		<span class="keyword">return</span> A&#123;&#125;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">&quot;B&quot;</span>:</span><br><span class="line">		<span class="keyword">return</span> B&#123;&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



]]></content>
      <tags>
        <tag>Golang</tag>
      </tags>
  </entry>
  <entry>
    <title>GoFAQ</title>
    <url>/2023/09/10/GoFAQ/</url>
    <content><![CDATA[<h1 id="ç¿»è¯‘éƒ¨åˆ†å®˜æ–¹FAQ"><a href="#ç¿»è¯‘éƒ¨åˆ†å®˜æ–¹FAQ" class="headerlink" title="ç¿»è¯‘éƒ¨åˆ†å®˜æ–¹FAQ"></a><a href="https://go.dev/doc/faq#Origins">ç¿»è¯‘éƒ¨åˆ†å®˜æ–¹FAQ</a></h1><p><strong>ä¸è¦é€šè¿‡å…±äº«å†…å­˜è¿›è¡Œé€šä¿¡ã€‚ç›¸åï¼Œé€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜ã€‚</strong></p>
<h2 id="èµ·æº"><a href="#èµ·æº" class="headerlink" title="èµ·æº"></a>èµ·æº</h2><p>ç”Ÿäº§è½¯ä»¶é€šå¸¸æ˜¯ç”¨C++æˆ–Javaç¼–å†™çš„ï¼ŒGitHubä¸å­˜åœ¨ï¼Œå¤§å¤šæ•°è®¡ç®—æœºè¿˜æ²¡æœ‰å¤šå¤„ç†å™¨ï¼Œé™¤äº†Visual Studioå’ŒEclipseä¹‹å¤–ï¼Œå‡ ä¹æ²¡æœ‰IDEæˆ–å…¶ä»–é«˜çº§å·¥å…·å¯ç”¨ï¼Œæ›´ä¸ç”¨è¯´åœ¨Internetä¸Šå…è´¹äº†.<br>å¤šå¤„ç†å™¨æ­£åœ¨å˜å¾—æ™®é,å¤§å¤šæ•°è¯­è¨€åœ¨é«˜æ•ˆå’Œå®‰å…¨åœ°ç¼–ç¨‹æ–¹é¢å‡ ä¹æ²¡æœ‰å¸®åŠ©</p>
<p>å¤šæ ¸CPUçš„å…´èµ·è®¤ä¸ºï¼Œä¸€ç§è¯­è¨€åº”è¯¥ä¸ºæŸç§å¹¶å‘æˆ–å¹¶è¡Œæ€§æä¾›ä¸€æµçš„æ”¯æŒã€‚ä¸ºäº†ä½¿èµ„æºç®¡ç†åœ¨å¤§å‹å¹¶å‘ç¨‹åºä¸­æ˜“äºå¤„ç†ï¼Œéœ€è¦åƒåœ¾å›æ”¶æˆ–è‡³å°‘æŸç§å®‰å…¨çš„è‡ªåŠ¨å†…å­˜ç®¡ç†ã€‚</p>
<span id="more"></span>

<p>å‰ç¥¥ç‰©å’Œæ ‡å¿—ç”±RenÃ©e Frenchè®¾è®¡</p>
<p>è¿™ç§è¯­è¨€è¢«ç§°ä¸ºGoã€‚<br>â€œgolangâ€ç»°å·çš„å‡ºç°æ˜¯å› ä¸ºè¯¥ç½‘ç«™æœ€åˆæ˜¯ golang.orgçš„.æ— è®ºå¦‚ä½•ï¼Œè¯¥è¯­è¨€çš„åç§°åªæ˜¯æ™®é€šçš„Goã€‚</p>
<p>Go é€šè¿‡å°è¯•å°†è§£é‡Šå‹åŠ¨æ€ç±»å‹è¯­è¨€çš„ç¼–ç¨‹ä¾¿åˆ©æ€§ä¸é™æ€ç±»å‹ç¼–è¯‘è¯­è¨€çš„æ•ˆç‡å’Œå®‰å…¨æ€§ç›¸ç»“åˆæ¥è§£å†³è¿™äº›é—®é¢˜ã€‚å®ƒè¿˜æ—¨åœ¨å®ç°ç°ä»£åŒ–ï¼Œæ”¯æŒç½‘ç»œå’Œå¤šæ ¸è®¡ç®—ã€‚æœ€åï¼Œä½¿ç”¨ Go çš„ç›®çš„æ˜¯ï¼šåœ¨ä¸€å°è®¡ç®—æœºä¸Šæ„å»ºä¸€ä¸ªå¤§å‹å¯æ‰§è¡Œæ–‡ä»¶æœ€å¤šéœ€è¦å‡ ç§’é’Ÿã€‚<br>ä¸ºäº†å®ç°è¿™äº›ç›®æ ‡ï¼Œéœ€è¦è§£å†³è®¸å¤šè¯­è¨€é—®é¢˜ï¼š<strong>å¯Œæœ‰è¡¨ç°åŠ›ä½†è½»é‡çº§çš„ç±»å‹ç³»ç»Ÿ;å¹¶å‘å’Œåƒåœ¾å›æ”¶;åˆšæ€§ä¾èµ–è§„èŒƒ;</strong></p>
<p>Go ä¸»è¦å±äº C ç³»åˆ—ï¼ˆåŸºæœ¬è¯­æ³•ï¼‰ï¼Œæ¥è‡ª Pascal&#x2F;Modula&#x2F;Oberon å®¶æ—ï¼ˆå£°æ˜ã€åŒ…ï¼‰çš„é‡è¦è¾“å…¥ï¼Œä»¥åŠå— Tony Hoare CSP å¯å‘çš„è¯­è¨€çš„ä¸€äº›æƒ³æ³•ï¼Œå¦‚ Newsqueak å’Œ Limboï¼ˆå¹¶å‘ï¼‰ã€‚ä½†æ˜¯ï¼Œå®ƒæ˜¯ä¸€ç§å…¨é¢çš„æ–°è¯­è¨€ã€‚åœ¨å„ä¸ªæ–¹é¢ï¼Œè¯­è¨€éƒ½æ˜¯é€šè¿‡æ€è€ƒç¨‹åºå‘˜åšä»€ä¹ˆä»¥åŠå¦‚ä½•ä½¿ç¼–ç¨‹ï¼ˆè‡³å°‘æˆ‘ä»¬æ‰€åšçš„é‚£ç§ç¼–ç¨‹ï¼‰æ›´æœ‰æ•ˆï¼Œè¿™æ„å‘³ç€æ›´å¤šçš„ä¹è¶£æ¥è®¾è®¡çš„ã€‚</p>
<h2 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h2><h3 id="Go-ç¨‹åºæ˜¯å¦ä¸-C-C-ç¨‹åºé“¾æ¥ï¼Ÿ"><a href="#Go-ç¨‹åºæ˜¯å¦ä¸-C-C-ç¨‹åºé“¾æ¥ï¼Ÿ" class="headerlink" title="Go ç¨‹åºæ˜¯å¦ä¸ C&#x2F;C++ ç¨‹åºé“¾æ¥ï¼Ÿ"></a>Go ç¨‹åºæ˜¯å¦ä¸ C&#x2F;C++ ç¨‹åºé“¾æ¥ï¼Ÿ</h3><p>åœ¨åŒä¸€åœ°å€ç©ºé—´ä¸­ä¸€èµ·ä½¿ç”¨Cå’ŒGoï¼Œä½†è¿™ä¸æ˜¯å¤©ç”Ÿçš„ï¼Œå¯èƒ½éœ€è¦ç‰¹æ®Šçš„æ¥å£è½¯ä»¶ã€‚<br>æ­¤å¤–ï¼Œå°† C ä¸ Go ä»£ç é“¾æ¥ä¼šæ”¾å¼ƒ Go æä¾›çš„å†…å­˜å®‰å…¨å’Œå †æ ˆç®¡ç†å±æ€§ã€‚æœ‰æ—¶ä½¿ç”¨ C åº“æ¥è§£å†³é—®é¢˜æ˜¯ç»å¯¹å¿…è¦çš„ï¼Œä½†è¿™æ ·åšæ€»æ˜¯ä¼šå¸¦æ¥çº¯ Go ä»£ç ä¸å­˜åœ¨çš„é£é™©å…ƒç´ ï¼Œå› æ­¤è¯·å°å¿ƒè¿™æ ·åšã€‚<br>å¦‚æœä½ ç¡®å®éœ€è¦å°† C ä¸ Go ä¸€èµ·ä½¿ç”¨ï¼Œå¦‚ä½•ç»§ç»­å–å†³äº Go ç¼–è¯‘å™¨çš„å®ç°ã€‚Go å›¢é˜Ÿæ”¯æŒä¸‰ç§ Go ç¼–è¯‘å™¨å®ç°ã€‚<br>è¿™äº›æ˜¯ <code>gc</code> é»˜è®¤ç¼–è¯‘å™¨ï¼Œå®ƒä½¿ç”¨GCCåç«¯ï¼Œä»¥åŠä¸€ä¸ªä¸å¤ªæˆç†Ÿçš„ <code>gollvm</code> ç¼–è¯‘å™¨ï¼Œ <code>gccgo</code> å®ƒä½¿ç”¨LLVMåŸºç¡€è®¾æ–½ã€‚<br><code>Gc</code> ä½¿ç”¨ä¸ C ä¸åŒçš„è°ƒç”¨çº¦å®šå’Œé“¾æ¥å™¨ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ä» C ç¨‹åºè°ƒç”¨ï¼Œåä¹‹äº¦ç„¶ã€‚è¯¥ç¨‹åº <code>cgo</code> æä¾›äº†â€œå¤–éƒ¨å‡½æ•°æ¥å£â€çš„æœºåˆ¶ï¼Œä»¥å…è®¸ä» Go ä»£ç å®‰å…¨è°ƒç”¨ C åº“ã€‚SWIG å°†æ­¤åŠŸèƒ½æ‰©å±•åˆ°C++åº“ã€‚</p>
<h2 id="è®¾è®¡"><a href="#è®¾è®¡" class="headerlink" title="è®¾è®¡"></a>è®¾è®¡</h2><h3 id="Goæœ‰runtimeå—"><a href="#Goæœ‰runtimeå—" class="headerlink" title="Goæœ‰runtimeå—"></a>Goæœ‰runtimeå—</h3><p>Go ç¡®å®æœ‰ä¸€ä¸ªå¹¿æ³›çš„åº“ï¼Œç§°ä¸ºè¿è¡Œæ—¶ï¼Œå®ƒæ˜¯æ¯ä¸ª Go ç¨‹åºçš„ä¸€éƒ¨åˆ†ã€‚è¿è¡Œæ—¶åº“å®ç°äº†åƒåœ¾å›æ”¶ã€å¹¶å‘ã€å †æ ˆç®¡ç†å’Œ Go è¯­è¨€çš„å…¶ä»–å…³é”®åŠŸèƒ½ã€‚è™½ç„¶å®ƒæ›´æ ¸å¿ƒäºè¯­è¨€ï¼Œä½† Go çš„è¿è¡Œæ—¶ç±»ä¼¼äº <code>libc</code> C åº“ã€‚</p>
<p>Go çš„è¿è¡Œæ—¶ä¸åŒ…æ‹¬è™šæ‹Ÿæœºï¼Œä¾‹å¦‚ Java è¿è¡Œæ—¶æä¾›çš„è™šæ‹Ÿæœºã€‚<br>Go ç¨‹åºè¢«æå‰ç¼–è¯‘ä¸ºæœ¬æœºæœºå™¨ä»£ç ã€‚å› æ­¤ï¼Œå°½ç®¡è¯¥æœ¯è¯­é€šå¸¸ç”¨äºæè¿°ç¨‹åºè¿è¡Œçš„è™šæ‹Ÿç¯å¢ƒï¼Œä½†åœ¨ Go ä¸­ï¼Œâ€œè¿è¡Œæ—¶â€ä¸€è¯åªæ˜¯æä¾›å…³é”®è¯­è¨€æœåŠ¡çš„åº“çš„åç§°ã€‚</p>
<h3 id="Unicode-æ ‡è¯†ç¬¦"><a href="#Unicode-æ ‡è¯†ç¬¦" class="headerlink" title="Unicode æ ‡è¯†ç¬¦"></a>Unicode æ ‡è¯†ç¬¦</h3><p>åœ¨è®¾è®¡ Go æ—¶ï¼Œç¡®ä¿å®ƒä¸ä¼šè¿‡äºä»¥ ASCII ä¸ºä¸­å¿ƒï¼Œè¿™æ„å‘³ç€å°†æ ‡è¯†ç¬¦çš„ç©ºé—´ä» 7 ä½ ASCII çš„èŒƒå›´æ‰©å±•å‡ºæ¥ã€‚<br>Go çš„è§„åˆ™ï¼ˆæ ‡è¯†ç¬¦å­—ç¬¦å¿…é¡»æ˜¯ Unicode å®šä¹‰çš„å­—æ¯æˆ–æ•°å­—ï¼‰æ˜“äºç†è§£å’Œå®ç°ï¼Œä½†æœ‰é™åˆ¶ã€‚ä¾‹å¦‚ï¼Œè®¾è®¡æ’é™¤äº†ç»„åˆå­—ç¬¦ï¼Œè¿™æ’é™¤äº†æŸäº›è¯­è¨€ï¼Œä¾‹å¦‚æ¢µæ–‡ã€‚<br>è¿™æ¡è§„åˆ™è¿˜æœ‰ä¸€ä¸ªä¸å¹¸çš„åæœã€‚ç”±äºå¯¼å‡ºçš„æ ‡è¯†ç¬¦å¿…é¡»ä»¥å¤§å†™å­—æ¯å¼€å¤´ï¼Œå› æ­¤æ ¹æ®å®šä¹‰ï¼Œä»æŸäº›è¯­è¨€ä¸­çš„å­—ç¬¦åˆ›å»ºçš„æ ‡è¯†ç¬¦ä¸èƒ½å¯¼å‡ºã€‚ç›®å‰å”¯ä¸€çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ç±»ä¼¼ <code>Xæ—¥æœ¬èª</code> çš„ä¸œè¥¿</p>
<h3 id="ä¸ºä»€ä¹ˆ-Go-æ²¡æœ‰exceptions"><a href="#ä¸ºä»€ä¹ˆ-Go-æ²¡æœ‰exceptions" class="headerlink" title="ä¸ºä»€ä¹ˆ Go æ²¡æœ‰exceptions"></a>ä¸ºä»€ä¹ˆ Go æ²¡æœ‰exceptions</h3><p>å°†å¼‚å¸¸è€¦åˆåˆ°æ§åˆ¶ç»“æ„ï¼ˆå¦‚ <code>try-catch-finally</code> æƒ¯ç”¨è¯­ä¸­ï¼‰ä¼šå¯¼è‡´å¤æ‚çš„ä»£ç ã€‚<br>å®ƒè¿˜å€¾å‘äºé¼“åŠ±ç¨‹åºå‘˜å°†å¤ªå¤šçš„æ™®é€šé”™è¯¯ï¼ˆä¾‹å¦‚æ— æ³•æ‰“å¼€æ–‡ä»¶ï¼‰æ ‡è®°ä¸ºå¼‚å¸¸ã€‚<br>Goé‡‡å–äº†ä¸åŒçš„æ–¹æ³•ã€‚å¯¹äºæ™®é€šé”™è¯¯å¤„ç†ï¼ŒGo çš„å¤šå€¼è¿”å›å¯ä»¥è½»æ¾æŠ¥å‘Šé”™è¯¯ï¼Œè€Œæ— éœ€é‡è½½è¿”å›å€¼ã€‚<br>è§„èŒƒçš„é”™è¯¯ç±»å‹ï¼ŒåŠ ä¸Š Go çš„å…¶ä»–ç‰¹æ€§ï¼Œä½¿é”™è¯¯å¤„ç†å˜å¾—æ„‰å¿«ï¼Œä½†ä¸å…¶ä»–è¯­è¨€å®Œå…¨ä¸åŒã€‚<br>Go è¿˜å…·æœ‰å‡ ä¸ªå†…ç½®å‡½æ•°ï¼Œå¯ä»¥ä»çœŸæ­£çš„å¼‚å¸¸æ¡ä»¶ä¸‹å‘å‡ºä¿¡å·å’Œæ¢å¤ã€‚æ¢å¤æœºåˆ¶ä»…ä½œä¸ºå‡½æ•°çŠ¶æ€çš„ä¸€éƒ¨åˆ†æ‰§è¡Œï¼Œè¯¥çŠ¶æ€åœ¨å‡ºé”™åè¢«æ‹†é™¤ï¼Œè¿™è¶³ä»¥å¤„ç†ç¾éš¾ï¼Œä½†ä¸éœ€è¦é¢å¤–çš„æ§åˆ¶ç»“æ„ï¼Œå¦‚æœä½¿ç”¨å¾—å½“ï¼Œå¯ä»¥äº§ç”Ÿå¹²å‡€çš„é”™è¯¯å¤„ç†ä»£ç ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆè¦åœ¨-CSP-çš„ç†å¿µä¸Šæ„å»ºå¹¶å‘æ€§"><a href="#ä¸ºä»€ä¹ˆè¦åœ¨-CSP-çš„ç†å¿µä¸Šæ„å»ºå¹¶å‘æ€§" class="headerlink" title="ä¸ºä»€ä¹ˆè¦åœ¨ CSP çš„ç†å¿µä¸Šæ„å»ºå¹¶å‘æ€§"></a>ä¸ºä»€ä¹ˆè¦åœ¨ CSP çš„ç†å¿µä¸Šæ„å»ºå¹¶å‘æ€§</h3><p>å¹¶å‘å’Œå¤šçº¿ç¨‹ç¼–ç¨‹å·²ç»å½¢æˆäº†å›°éš¾çš„å£°èª‰ã€‚è¿™éƒ¨åˆ†æ˜¯ç”±äºå¤æ‚çš„è®¾è®¡ï¼Œå¦‚pthreadsï¼Œéƒ¨åˆ†æ˜¯ç”±äºè¿‡åˆ†å¼ºè°ƒä½çº§ç»†èŠ‚ï¼Œå¦‚äº’æ–¥ä½“ã€æ¡ä»¶å˜é‡å’Œå†…å­˜éšœç¢ã€‚æ›´é«˜çº§åˆ«çš„æ¥å£ä½¿ä»£ç æ›´ç®€å•ï¼Œå³ä½¿èƒŒåä»ç„¶å­˜åœ¨äº’æ–¥ä½“ç­‰ã€‚<br>ä¸ºå¹¶å‘æä¾›é«˜çº§è¯­è¨€æ”¯æŒçš„æœ€æˆåŠŸçš„æ¨¡å‹ä¹‹ä¸€æ¥è‡ªHoareçš„é€šä¿¡é¡ºåºè¿‡ç¨‹ï¼ˆCSPï¼‰ã€‚<br>Occamå’ŒErlangæ˜¯æºäºCSPçš„ä¸¤ç§ä¼—æ‰€å‘¨çŸ¥çš„è¯­è¨€ã€‚Go çš„å¹¶å‘åŸè¯­æºè‡ªå®¶è°±çš„ä¸åŒéƒ¨åˆ†ï¼Œå…¶ä¸»è¦è´¡çŒ®æ˜¯é€šé“ä½œä¸ºç¬¬ä¸€ç±»å¯¹è±¡çš„å¼ºå¤§æ¦‚å¿µã€‚ä½¿ç”¨å‡ ç§æ—©æœŸè¯­è¨€çš„ç»éªŒè¡¨æ˜ï¼ŒCSP æ¨¡å‹éå¸¸é€‚åˆè¿‡ç¨‹è¯­è¨€æ¡†æ¶ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆæ˜¯-goroutines-è€Œä¸æ˜¯çº¿ç¨‹ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆæ˜¯-goroutines-è€Œä¸æ˜¯çº¿ç¨‹ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆæ˜¯ goroutines è€Œä¸æ˜¯çº¿ç¨‹ï¼Ÿ"></a>ä¸ºä»€ä¹ˆæ˜¯ goroutines è€Œä¸æ˜¯çº¿ç¨‹ï¼Ÿ</h3><p>Goroutines æ˜¯ä½¿å¹¶å‘æ˜“äºä½¿ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯å°†ç‹¬ç«‹æ‰§è¡Œçš„å‡½æ•°ï¼ˆåç¨‹ï¼‰å¤šè·¯å¤ç”¨åˆ°ä¸€ç»„çº¿ç¨‹ä¸Šã€‚å½“åç¨‹é˜»å¡ï¼ˆä¾‹å¦‚é€šè¿‡è°ƒç”¨é˜»å¡ç³»ç»Ÿè°ƒç”¨ï¼‰æ—¶ï¼Œè¿è¡Œæ—¶ä¼šè‡ªåŠ¨å°†åŒä¸€æ“ä½œç³»ç»Ÿçº¿ç¨‹ä¸Šçš„å…¶ä»–åç¨‹ç§»åŠ¨åˆ°ä¸åŒçš„å¯è¿è¡Œçº¿ç¨‹ï¼Œä»¥ä¾¿å®ƒä»¬ä¸ä¼šè¢«é˜»å¡ã€‚ç¨‹åºå‘˜çœ‹ä¸åˆ°è¿™äº›ï¼Œè¿™å°±æ˜¯é‡ç‚¹ã€‚ç»“æœï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºgoroutinesï¼Œå¯èƒ½éå¸¸ä¾¿å®œï¼šé™¤äº†å †æ ˆçš„å†…å­˜ï¼ˆåªæœ‰å‡ åƒå­—èŠ‚ï¼‰ä¹‹å¤–ï¼Œå®ƒä»¬å‡ ä¹æ²¡æœ‰å¼€é”€ã€‚</p>
<p>ä¸ºäº†ä½¿å †æ ˆå˜å°ï¼ŒGo çš„è¿è¡Œæ—¶ä½¿ç”¨å¯è°ƒæ•´å¤§å°çš„æœ‰ç•Œå †æ ˆã€‚ä¸€ä¸ªæ–°é“¸é€ çš„goroutineè¢«èµ‹äºˆå‡ åƒå­—èŠ‚ï¼Œè¿™å‡ ä¹æ€»æ˜¯è¶³å¤Ÿçš„ã€‚å¦‚æœä¸æ˜¯ï¼Œè¿è¡Œæ—¶ä¼šè‡ªåŠ¨å¢åŠ ï¼ˆå’Œç¼©å°ï¼‰ç”¨äºå­˜å‚¨å †æ ˆçš„å†…å­˜ï¼Œä»è€Œå…è®¸è®¸å¤š goroutines å­˜åœ¨äºé€‚é‡çš„å†…å­˜ä¸­ã€‚CPU å¼€é”€å¹³å‡æ¯ä¸ªå‡½æ•°è°ƒç”¨å¤§çº¦ä¸‰ä¸ªä¾¿å®œçš„æŒ‡ä»¤ã€‚åœ¨åŒä¸€åœ°å€ç©ºé—´ä¸­åˆ›å»ºæ•°åä¸‡ä¸ª goroutines æ˜¯åˆ‡å®å¯è¡Œçš„ã€‚å¦‚æœ goroutines åªæ˜¯çº¿ç¨‹ï¼Œç³»ç»Ÿèµ„æºå°†ä»¥æ›´å°‘çš„æ•°é‡è€—å°½ã€‚</p>
<h2 id="Type"><a href="#Type" class="headerlink" title="Type"></a>Type</h2><h3 id="Go-æ˜¯é¢å‘å¯¹è±¡çš„è¯­è¨€å—"><a href="#Go-æ˜¯é¢å‘å¯¹è±¡çš„è¯­è¨€å—" class="headerlink" title="Go æ˜¯é¢å‘å¯¹è±¡çš„è¯­è¨€å—"></a>Go æ˜¯é¢å‘å¯¹è±¡çš„è¯­è¨€å—</h3><p>æ˜¯åˆä¸æ˜¯ã€‚å°½ç®¡ Go å…·æœ‰ç±»å‹å’Œæ–¹æ³•ï¼Œå¹¶å…è®¸é¢å‘å¯¹è±¡çš„ç¼–ç¨‹é£æ ¼ï¼Œä½†æ²¡æœ‰ç±»å‹å±‚æ¬¡ç»“æ„ã€‚<br>Go ä¸­çš„â€œæ¥å£â€æ¦‚å¿µæä¾›äº†ä¸€ç§ä¸åŒçš„æ–¹æ³•ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™ç§æ–¹æ³•æ˜“äºä½¿ç”¨ï¼Œå¹¶ä¸”åœ¨æŸäº›æ–¹é¢æ›´é€šç”¨ã€‚<br>è¿˜æœ‰ä¸€äº›æ–¹æ³•å¯ä»¥åœ¨å…¶ä»–ç±»å‹ä¸­åµŒå…¥ç±»å‹ï¼Œä»¥æä¾›ä¸å­ç±»ç±»ä¼¼ä½†ä¸å®Œå…¨ç›¸åŒçš„ä¸œè¥¿ã€‚<br>æ­¤å¤–ï¼ŒGo ä¸­çš„æ–¹æ³•æ¯” C++ æˆ– Java ä¸­çš„æ–¹æ³•æ›´é€šç”¨ï¼šå®ƒä»¬å¯ä»¥ä¸ºä»»ä½•ç±»å‹çš„æ•°æ®å®šä¹‰ï¼Œç”šè‡³æ˜¯å†…ç½®ç±»å‹ï¼Œä¾‹å¦‚æ™®é€šçš„â€œæœªè£…ç®±â€æ•´æ•°ã€‚å®ƒä»¬ä¸é™äºç»“æ„ï¼ˆç±»ï¼‰ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆæ²¡æœ‰ç±»å‹ç»§æ‰¿"><a href="#ä¸ºä»€ä¹ˆæ²¡æœ‰ç±»å‹ç»§æ‰¿" class="headerlink" title="ä¸ºä»€ä¹ˆæ²¡æœ‰ç±»å‹ç»§æ‰¿"></a>ä¸ºä»€ä¹ˆæ²¡æœ‰ç±»å‹ç»§æ‰¿</h3><p>é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œè‡³å°‘åœ¨æœ€çŸ¥åçš„è¯­è¨€ä¸­ï¼Œæ¶‰åŠå¤ªå¤šå…³äºç±»å‹ä¹‹é—´å…³ç³»çš„è®¨è®ºï¼Œè¿™äº›å…³ç³»é€šå¸¸å¯ä»¥è‡ªåŠ¨æ´¾ç”Ÿã€‚Goé‡‡å–äº†ä¸åŒçš„æ–¹æ³•ã€‚</p>
<p>åœ¨ Go ä¸­ï¼Œç±»å‹è‡ªåŠ¨æ»¡è¶³æŒ‡å®šå…¶æ–¹æ³•å­é›†çš„ä»»ä½•æ¥å£ï¼Œè€Œä¸æ˜¯è¦æ±‚ç¨‹åºå‘˜æå‰å£°æ˜ä¸¤ä¸ªç±»å‹æ˜¯ç›¸å…³çš„ã€‚é™¤äº†å‡å°‘ç°¿è®°ä¹‹å¤–ï¼Œè¿™ç§æ–¹æ³•è¿˜å…·æœ‰çœŸæ­£çš„ä¼˜åŠ¿ã€‚ç±»å‹å¯ä»¥åŒæ—¶æ»¡è¶³å¤šä¸ªæ¥å£ï¼Œè€Œæ²¡æœ‰ä¼ ç»Ÿå¤šé‡ç»§æ‰¿çš„å¤æ‚æ€§ã€‚æ¥å£å¯ä»¥éå¸¸è½»é‡çº§ - å…·æœ‰ä¸€ä¸ªç”šè‡³é›¶ä¸ªæ–¹æ³•çš„æ¥å£å¯ä»¥è¡¨è¾¾ä¸€ä¸ªæœ‰ç”¨çš„æ¦‚å¿µã€‚å¦‚æœå‡ºç°æ–°æƒ³æ³•æˆ–è¿›è¡Œæµ‹è¯•ï¼Œå¯ä»¥åœ¨äº‹åæ·»åŠ æ¥å£ï¼Œè€Œæ— éœ€æ³¨é‡ŠåŸå§‹ç±»å‹ã€‚ç”±äºç±»å‹å’Œæ¥å£ä¹‹é—´æ²¡æœ‰æ˜¾å¼å…³ç³»ï¼Œå› æ­¤æ²¡æœ‰è¦ç®¡ç†æˆ–è®¨è®ºçš„ç±»å‹å±‚æ¬¡ç»“æ„ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨è¿™äº›æƒ³æ³•æ¥æ„é€ ç±»ä¼¼äºç±»å‹å®‰å…¨çš„Unixç®¡é“çš„ä¸œè¥¿ã€‚ä¾‹å¦‚ï¼Œäº†è§£å¦‚ä½• <code>fmt.Fprintf</code> å¯ç”¨æ ¼å¼åŒ–æ‰“å°åˆ°ä»»ä½•è¾“å‡ºï¼ˆè€Œä¸ä»…ä»…æ˜¯æ–‡ä»¶ï¼‰ï¼Œæˆ–è€…åŒ…å¦‚ä½• <code>bufio</code> ä¸æ–‡ä»¶ I&#x2F;O å®Œå…¨åˆ†ç¦»ï¼Œæˆ–è€… <code>image</code> åŒ…å¦‚ä½•ç”Ÿæˆå‹ç¼©çš„å›¾åƒæ–‡ä»¶ã€‚æ‰€æœ‰è¿™äº›æƒ³æ³•éƒ½æºäºè¡¨ç¤ºå•ä¸ªæ–¹æ³•ï¼ˆ <code>io.Writer</code> ï¼‰çš„å•ä¸ªæ¥å£ï¼ˆ <code>Write</code> ï¼‰ã€‚è€Œè¿™åªæ˜¯çš®æ¯›ã€‚Go çš„æ¥å£å¯¹ç¨‹åºçš„ç»“æ„æœ‰ç€æ·±è¿œçš„å½±å“ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆæˆ‘çš„é›¶é”™è¯¯å€¼ä¸ç­‰äºé›¶ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆæˆ‘çš„é›¶é”™è¯¯å€¼ä¸ç­‰äºé›¶ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆæˆ‘çš„é›¶é”™è¯¯å€¼ä¸ç­‰äºé›¶ï¼Ÿ"></a>ä¸ºä»€ä¹ˆæˆ‘çš„é›¶é”™è¯¯å€¼ä¸ç­‰äºé›¶ï¼Ÿ</h3><p>æ¥å£è¢«å®ç°ä¸ºä¸¤ä¸ªå…ƒç´ ï¼Œä¸€ä¸ªç±»å‹å’Œ <code>T</code> ä¸€ä¸ªå€¼ <code>V</code> ã€‚<br><code>V</code> æ˜¯ä¸€ä¸ªå…·ä½“çš„å€¼ï¼Œä¾‹å¦‚ <code>int</code> æˆ– <code>struct</code> æŒ‡é’ˆï¼Œè€Œä¸æ˜¯æ¥å£æœ¬èº«ï¼Œå¹¶ä¸”å…·æœ‰ ç±»å‹ <code>T</code> ã€‚<br>ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å°†å€¼ 3 å­˜å‚¨åœ¨æ¥å£ä¸­ï¼Œåˆ™ç”Ÿæˆçš„æ¥å£ <code>int</code> å€¼ç¤ºæ„æ€§åœ°å…·æœ‰ ï¼ˆ <code>T=int</code> ï¼Œ <code>V=3</code> ï¼‰ã€‚<br>è¯¥å€¼ä¹Ÿç§°ä¸ºæ¥å£çš„åŠ¨æ€å€¼ï¼Œå› ä¸ºç»™å®šçš„æ¥å£å˜é‡åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´å¯èƒ½å…·æœ‰ä¸åŒçš„å€¼ <code>V</code>  ï¼ˆå’Œç›¸åº”çš„ç±»å‹ <code>T</code> ï¼‰ã€‚</p>
<p>ä»…å½“ å’Œ éƒ½æœªè®¾ç½®æ—¶ï¼Œæ¥å£å€¼æ‰ä¸º <code>nil</code> ï¼ˆ <code>T=nil</code> ï¼Œ <code>V</code> æœªè®¾ç½®ï¼‰ï¼Œç‰¹åˆ«æ˜¯ <code>nil</code> æ¥å£å°†å§‹ç»ˆä¿å­˜ç±»å‹ <code>nil</code> ã€‚ <code>V</code> <code>T</code> å¦‚æœæˆ‘ä»¬å°†ç±»å‹çš„æŒ‡é’ˆå­˜å‚¨åœ¨æ¥å£å€¼ä¸­ï¼Œåˆ™å†…éƒ¨ç±»å‹å°†ä¸ <code>nil</code> æŒ‡é’ˆçš„å€¼ <code>*int</code> æ— å…³ï¼šï¼ˆ <code>T=*int</code> ï¼Œ <code>V=nil</code> ï¼‰ã€‚ <code>*int</code> å› æ­¤ <code>nil</code> ï¼Œå³ä½¿é‡Œé¢çš„æŒ‡é’ˆå€¼ <code>V</code> æ˜¯ <code>nil</code> ã€‚</p>
<h2 id="Value"><a href="#Value" class="headerlink" title="Value"></a>Value</h2><h3 id="ä¸ºä»€ä¹ˆ-Go-ä¸æä¾›éšå¼æ•°å­—è½¬æ¢"><a href="#ä¸ºä»€ä¹ˆ-Go-ä¸æä¾›éšå¼æ•°å­—è½¬æ¢" class="headerlink" title="ä¸ºä»€ä¹ˆ Go ä¸æä¾›éšå¼æ•°å­—è½¬æ¢"></a>ä¸ºä»€ä¹ˆ Go ä¸æä¾›éšå¼æ•°å­—è½¬æ¢</h3><p>åœ¨ C ä¸­ï¼Œåœ¨æ•°å€¼ç±»å‹ä¹‹é—´è‡ªåŠ¨è½¬æ¢çš„ä¾¿åˆ©æ€§è¢«å®ƒé€ æˆçš„æ··ä¹±æ‰€æŠµæ¶ˆã€‚<br>è¡¨è¾¾å¼ä½•æ—¶æ— ç¬¦å·ï¼Ÿä»·å€¼æœ‰å¤šå¤§ï¼Ÿå®ƒä¼šæº¢å‡ºå—ï¼Ÿç»“æœæ˜¯å¦å¯ç§»æ¤ï¼Œç‹¬ç«‹äºæ‰§è¡Œç»“æœçš„è®¡ç®—æœºï¼Ÿå®ƒè¿˜ä½¿ç¼–è¯‘å™¨å¤æ‚åŒ–;<br>â€œé€šå¸¸çš„ç®—æœ¯è½¬æ¢â€ä¸å®¹æ˜“å®ç°ï¼Œå¹¶ä¸”åœ¨æ¶æ„ä¹‹é—´ä¸ä¸€è‡´ã€‚å‡ºäºå¯ç§»æ¤æ€§çš„åŸå› ï¼Œæˆ‘ä»¬å†³å®šä»¥ä»£ç ä¸­çš„ä¸€äº›æ˜¾å¼è½¬æ¢ä¸ºä»£ä»·ï¼Œä½¿äº‹æƒ…å˜å¾—æ¸…æ™°æ˜äº†ã€‚<br>ä¸è¿‡ï¼ŒGo ä¸­å¸¸é‡çš„å®šä¹‰â€”â€”æ²¡æœ‰ç¬¦å·å’Œå¤§å°æ³¨é‡Šçš„ä»»æ„ç²¾åº¦å€¼â€”â€”å¤§å¤§æ”¹å–„äº†é—®é¢˜ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆåœ°å›¾ä¸å…è®¸åˆ‡ç‰‡ä½œä¸ºé”®ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆåœ°å›¾ä¸å…è®¸åˆ‡ç‰‡ä½œä¸ºé”®ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆåœ°å›¾ä¸å…è®¸åˆ‡ç‰‡ä½œä¸ºé”®ï¼Ÿ"></a>ä¸ºä»€ä¹ˆåœ°å›¾ä¸å…è®¸åˆ‡ç‰‡ä½œä¸ºé”®ï¼Ÿ</h3><p>mapæŸ¥æ‰¾éœ€è¦ä¸€ä¸ªç›¸ç­‰è¿ç®—ç¬¦ï¼Œåˆ‡ç‰‡ä¸ä¼šå®ç°è¯¥è¿ç®—ç¬¦ã€‚ä»–ä»¬æ²¡æœ‰å®ç°å¹³ç­‰ï¼Œå› ä¸ºå¹³ç­‰åœ¨è¿™äº›ç±»å‹ä¸Šæ²¡æœ‰å¾ˆå¥½çš„å®šä¹‰;<br>æœ‰å¤šç§æ³¨æ„äº‹é¡¹ï¼Œæ¶‰åŠæµ…æ¯”è¾ƒä¸æ·±æ¯”è¾ƒã€æŒ‡é’ˆä¸å€¼æ¯”è¾ƒã€å¦‚ä½•å¤„ç†é€’å½’ç±»å‹ç­‰ã€‚<br>æˆ‘ä»¬å¯èƒ½ä¼šé‡æ–°å®¡è§†è¿™ä¸ªé—®é¢˜â€”â€”å®ç°åˆ‡ç‰‡çš„ç›¸ç­‰æ€§ä¸ä¼šä½¿ä»»ä½•ç°æœ‰ç¨‹åºæ— æ•ˆâ€”â€”ä½†æ˜¯å¦‚æœæ²¡æœ‰æ˜ç¡®äº†è§£åˆ‡ç‰‡ç›¸ç­‰åº”è¯¥æ„å‘³ç€ä»€ä¹ˆï¼Œç°åœ¨æŠŠå®ƒæ’é™¤åœ¨å¤–å°±æ›´ç®€å•äº†ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆmapã€sliceå’Œchanæ˜¯å¼•ç”¨ï¼Œè€Œæ•°ç»„æ˜¯å€¼"><a href="#ä¸ºä»€ä¹ˆmapã€sliceå’Œchanæ˜¯å¼•ç”¨ï¼Œè€Œæ•°ç»„æ˜¯å€¼" class="headerlink" title="ä¸ºä»€ä¹ˆmapã€sliceå’Œchanæ˜¯å¼•ç”¨ï¼Œè€Œæ•°ç»„æ˜¯å€¼"></a>ä¸ºä»€ä¹ˆmapã€sliceå’Œchanæ˜¯å¼•ç”¨ï¼Œè€Œæ•°ç»„æ˜¯å€¼</h3><p>mapå’Œchanåœ¨è¯­æ³•ä¸Šæ˜¯æŒ‡é’ˆï¼Œä¸å¯èƒ½å£°æ˜æˆ–ä½¿ç”¨éæŒ‡é’ˆå®ä¾‹ã€‚<br>æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜åœ¨ä¸ºæ•°ç»„åº”è¯¥å¦‚ä½•å·¥ä½œè€Œè‹¦è‹¦æŒ£æ‰ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬å†³å®šæŒ‡é’ˆå’Œå€¼çš„ä¸¥æ ¼åˆ†ç¦»ä½¿è¯­è¨€æ›´éš¾ä½¿ç”¨ã€‚<br>æ›´æ”¹è¿™äº›ç±»å‹ä»¥å……å½“å¯¹å…³è”çš„å…±äº«æ•°æ®ç»“æ„çš„å¼•ç”¨è§£å†³äº†è¿™äº›é—®é¢˜ã€‚<br>è¿™ç§å˜åŒ–ç»™è¯­è¨€å¢åŠ äº†ä¸€äº›ä»¤äººé—æ†¾çš„å¤æ‚æ€§ï¼Œä½†å¯¹å¯ç”¨æ€§äº§ç”Ÿäº†å¾ˆå¤§çš„å½±å“ï¼šGo åœ¨å¼•å…¥æ—¶æˆä¸ºä¸€ç§æ›´é«˜æ•ˆã€æ›´èˆ’é€‚çš„è¯­è¨€ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆ-Go-æ²¡æœ‰-è¿ç®—ç¬¦ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆ-Go-æ²¡æœ‰-è¿ç®—ç¬¦ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆ Go æ²¡æœ‰ ?: è¿ç®—ç¬¦ï¼Ÿ"></a>ä¸ºä»€ä¹ˆ Go æ²¡æœ‰ <code>?:</code> è¿ç®—ç¬¦ï¼Ÿ</h3><p>Go ä¸­æ²¡æœ‰ä¸‰å…ƒæµ‹è¯•æ“ä½œ,è¯¥è¯­è¨€çš„è®¾è®¡è€…å·²ç»çœ‹åˆ°è¯¥æ“ä½œè¿‡äºé¢‘ç¹åœ°ç”¨äºåˆ›å»ºéš¾ä»¥ç†è§£çš„å¤æ‚è¡¨è¾¾å¼ã€‚ <code>if-else</code> å½¢å¼è™½ç„¶æ›´é•¿ï¼Œä½†æ— ç–‘æ›´æ¸…æ™°ã€‚ä¸€ç§è¯­è¨€åªéœ€è¦ä¸€ä¸ªæ¡ä»¶æ§åˆ¶æµæ„é€ ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆæ˜¯-å’Œ-è¯­å¥è€Œä¸æ˜¯è¡¨è¾¾å¼ï¼Ÿä¸ºä»€ä¹ˆæ˜¯åç¼€ï¼Œè€Œä¸æ˜¯å‰ç¼€ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆæ˜¯-å’Œ-è¯­å¥è€Œä¸æ˜¯è¡¨è¾¾å¼ï¼Ÿä¸ºä»€ä¹ˆæ˜¯åç¼€ï¼Œè€Œä¸æ˜¯å‰ç¼€ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆæ˜¯ ++ å’Œ -- è¯­å¥è€Œä¸æ˜¯è¡¨è¾¾å¼ï¼Ÿä¸ºä»€ä¹ˆæ˜¯åç¼€ï¼Œè€Œä¸æ˜¯å‰ç¼€ï¼Ÿ"></a>ä¸ºä»€ä¹ˆæ˜¯ <code>++</code> å’Œ <code>--</code> è¯­å¥è€Œä¸æ˜¯è¡¨è¾¾å¼ï¼Ÿä¸ºä»€ä¹ˆæ˜¯åç¼€ï¼Œè€Œä¸æ˜¯å‰ç¼€ï¼Ÿ</h3><p>å¦‚æœæ²¡æœ‰æŒ‡é’ˆç®—æ³•ï¼Œå‰ç¼€å’Œåç¼€å¢é‡è¿ç®—ç¬¦çš„ä¾¿åˆ©å€¼ä¼šä¸‹é™ã€‚é€šè¿‡å°†å®ƒä»¬ä»è¡¨è¾¾å¼å±‚æ¬¡ç»“æ„ä¸­å®Œå…¨åˆ é™¤ï¼Œè¡¨è¾¾å¼è¯­æ³•å¾—åˆ°äº†ç®€åŒ–ï¼Œå¹¶ä¸”å›´ç»•å’Œï¼ˆè€ƒè™‘ <code>f(i++)</code> å’Œ <code>p[i] = q[++i]</code> <code>--</code> ï¼‰çš„ <code>++</code> è®¡ç®—é¡ºåºçš„æ··ä¹±é—®é¢˜ä¹Ÿæ¶ˆé™¤äº†ã€‚ç®€åŒ–æ˜¯é‡è¦çš„ã€‚è‡³äºåç¼€ä¸å‰ç¼€ï¼Œä¸¤è€…éƒ½å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œä½†åç¼€ç‰ˆæœ¬æ›´ä¼ ç»Ÿ;å¯¹å‰ç¼€çš„åšæŒæºäºSTLï¼ŒSTLæ˜¯ä¸€ç§è¯­è¨€åº“ï¼Œå…·æœ‰è®½åˆºæ„å‘³çš„æ˜¯ï¼Œå…¶åç§°åŒ…å«åç¼€å¢é‡ã€‚</p>
<h2 id="æŒ‡é’ˆå’Œåˆ†é…"><a href="#æŒ‡é’ˆå’Œåˆ†é…" class="headerlink" title="æŒ‡é’ˆå’Œåˆ†é…"></a>æŒ‡é’ˆå’Œåˆ†é…</h2><h3 id="å‡½æ•°å‚æ•°ä½•æ—¶æŒ‰å€¼ä¼ é€’"><a href="#å‡½æ•°å‚æ•°ä½•æ—¶æŒ‰å€¼ä¼ é€’" class="headerlink" title="å‡½æ•°å‚æ•°ä½•æ—¶æŒ‰å€¼ä¼ é€’"></a>å‡½æ•°å‚æ•°ä½•æ—¶æŒ‰å€¼ä¼ é€’</h3><p>Go ä¸­çš„æ‰€æœ‰å†…å®¹éƒ½æ˜¯æŒ‰å€¼ä¼ é€’çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå‡½æ•°æ€»æ˜¯è·å–è¦ä¼ é€’çš„äº‹ç‰©çš„å‰¯æœ¬ï¼Œå°±å¥½åƒæœ‰ä¸€ä¸ªèµ‹å€¼è¯­å¥å°†å€¼åˆ†é…ç»™å‚æ•°ä¸€æ ·ã€‚ä¾‹å¦‚ï¼Œå°†å€¼ä¼ é€’ç»™å‡½æ•°ä¼šåˆ›å»º <code>int</code> çš„å‰¯æœ¬ï¼Œä¼ é€’æŒ‡é’ˆ <code>int</code> å€¼ä¼šåˆ›å»ºæŒ‡é’ˆçš„å‰¯æœ¬ï¼Œä½†ä¸ä¼šåˆ›å»ºæŒ‡é’ˆæŒ‡å‘çš„æ•°æ®ã€‚<br>mapå’Œsliceçš„è¡Œä¸ºç±»ä¼¼äºæŒ‡é’ˆï¼šå®ƒä»¬æ˜¯åŒ…å«æŒ‡å‘åŸºç¡€mapæˆ–åˆ‡ç‰‡æ•°æ®çš„æŒ‡é’ˆçš„æè¿°ç¬¦ã€‚å¤åˆ¶mapæˆ–å‰–åˆ‡ç‰‡å€¼ä¸ä¼šå¤åˆ¶å…¶æŒ‡å‘çš„æ•°æ®ã€‚å¤åˆ¶æ¥å£å€¼ä¼šå¤åˆ¶å­˜å‚¨åœ¨æ¥å£å€¼ä¸­çš„äº‹ç‰©ã€‚å¦‚æœæ¥å£å€¼åŒ…å«ç»“æ„ï¼Œåˆ™å¤åˆ¶æ¥å£å€¼ä¼šå¤åˆ¶ç»“æ„ã€‚å¦‚æœæ¥å£å€¼åŒ…å«æŒ‡é’ˆï¼Œåˆ™å¤åˆ¶æ¥å£å€¼ä¼šå¤åˆ¶æŒ‡é’ˆï¼Œä½†åŒæ ·ä¸ä¼šå¤åˆ¶æŒ‡é’ˆæŒ‡å‘çš„æ•°æ®ã€‚</p>
<h3 id="newå’Œmakeæœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#newå’Œmakeæœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="newå’Œmakeæœ‰ä»€ä¹ˆåŒºåˆ«"></a>newå’Œmakeæœ‰ä»€ä¹ˆåŒºåˆ«</h3><p><code>new</code> åˆ†é…å†…å­˜ï¼ŒåŒæ—¶ <code>make</code> åˆå§‹åŒ–åˆ‡ç‰‡ã€æ˜ å°„å’Œé€šé“ç±»å‹ã€‚</p>
]]></content>
      <categories>
        <category>Golang</category>
      </categories>
      <tags>
        <tag>Golang</tag>
      </tags>
  </entry>
  <entry>
    <title>GoWeb-frame</title>
    <url>/2023/09/06/GoWeb-frame/</url>
    <content><![CDATA[<h1 id="GoWeb-ProgramDevFrame"><a href="#GoWeb-ProgramDevFrame" class="headerlink" title="GoWeb ProgramDevFrame"></a>GoWeb ProgramDevFrame</h1><p><img src="/./../pic/GoWeb-frame/image-20230907095756048.png" alt="image-20230907095756048"></p>
<p>åŸºäºgo1.20<br>ä¾èµ–äº Gin viper zap lumberjack sqlx go-redis ç¬¬ä¸‰æ–¹åº“</p>
<span id="more"></span>

<h2 id="main-go"><a href="#main-go" class="headerlink" title="main.go"></a>main.go</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;GoGin/src/GoWebDevFrame/database/mysql&quot;</span></span><br><span class="line">	<span class="string">&quot;GoGin/src/GoWebDevFrame/database/redis&quot;</span></span><br><span class="line">	<span class="string">&quot;GoGin/src/GoWebDevFrame/log&quot;</span></span><br><span class="line">	<span class="string">&quot;GoGin/src/GoWebDevFrame/routes&quot;</span></span><br><span class="line">	<span class="string">&quot;GoGin/src/GoWebDevFrame/settings&quot;</span></span><br><span class="line">	<span class="string">&quot;context&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/spf13/viper&quot;</span></span><br><span class="line">	<span class="string">&quot;go.uber.org/zap&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;os/signal&quot;</span></span><br><span class="line">	<span class="string">&quot;syscall&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//setting</span></span><br><span class="line">	<span class="keyword">if</span> err := settings.Init(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;init settings failed,err: %v\n&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//log</span></span><br><span class="line">	<span class="keyword">if</span> err := logger.Init(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;init logger failed,err: %v\n&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> zap.L().Sync()</span><br><span class="line">	zap.L().Debug(<span class="string">&quot;logger init success&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//MySQL</span></span><br><span class="line">	<span class="keyword">if</span> err := mysql.Init(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;init mysql failed,err: %v\n&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> mysql.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//Redis</span></span><br><span class="line">	<span class="keyword">if</span> err := redis.Init(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;init redis failed,err: %v\n&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> redis.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//router</span></span><br><span class="line">	r := routes.SetUp()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//Start&amp;End</span></span><br><span class="line">	srv := &amp;http.Server&#123;</span><br><span class="line">		Addr:    fmt.Sprintf(<span class="string">&quot;%d&quot;</span>, viper.GetInt(<span class="string">&quot;app.port&quot;</span>)),</span><br><span class="line">		Handler: r,</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="comment">// å¼€å¯ä¸€ä¸ªgoroutineå¯åŠ¨æœåŠ¡</span></span><br><span class="line">		<span class="keyword">if</span> err := srv.ListenAndServe(); err != <span class="literal">nil</span> &amp;&amp; err != http.ErrServerClosed &#123;</span><br><span class="line">			zap.L().Fatal(<span class="string">&quot;listen: %s\n&quot;</span>, zap.Error(err))</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ç­‰å¾…ä¸­æ–­ä¿¡å·æ¥ä¼˜é›…åœ°å…³é—­æœåŠ¡å™¨ï¼Œä¸ºå…³é—­æœåŠ¡å™¨æ“ä½œè®¾ç½®ä¸€ä¸ª5ç§’çš„è¶…æ—¶</span></span><br><span class="line">	quit := <span class="built_in">make</span>(<span class="keyword">chan</span> os.Signal, <span class="number">1</span>) <span class="comment">// åˆ›å»ºä¸€ä¸ªæ¥æ”¶ä¿¡å·çš„é€šé“</span></span><br><span class="line">	<span class="comment">// kill é»˜è®¤ä¼šå‘é€ syscall.SIGTERM ä¿¡å·</span></span><br><span class="line">	<span class="comment">// kill -2 å‘é€ syscall.SIGINT ä¿¡å·ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„Ctrl+Cå°±æ˜¯è§¦å‘ç³»ç»ŸSIGINTä¿¡å·</span></span><br><span class="line">	<span class="comment">// kill -9 å‘é€ syscall.SIGKILL ä¿¡å·ï¼Œä½†æ˜¯ä¸èƒ½è¢«æ•è·ï¼Œæ‰€ä»¥ä¸éœ€è¦æ·»åŠ å®ƒ</span></span><br><span class="line">	<span class="comment">// signal.NotifyæŠŠæ”¶åˆ°çš„ syscall.SIGINTæˆ–syscall.SIGTERM ä¿¡å·è½¬å‘ç»™quit</span></span><br><span class="line">	signal.Notify(quit, syscall.SIGINT, syscall.SIGTERM) <span class="comment">// æ­¤å¤„ä¸ä¼šé˜»å¡</span></span><br><span class="line">	&lt;-quit                                               <span class="comment">// é˜»å¡åœ¨æ­¤ï¼Œå½“æ¥æ”¶åˆ°ä¸Šè¿°ä¸¤ç§ä¿¡å·æ—¶æ‰ä¼šå¾€ä¸‹æ‰§è¡Œ</span></span><br><span class="line">	zap.L().Info(<span class="string">&quot;Shutdown Server ...&quot;</span>)</span><br><span class="line">	<span class="comment">// åˆ›å»ºä¸€ä¸ª5ç§’è¶…æ—¶çš„context</span></span><br><span class="line">	ctx, cancel := context.WithTimeout(context.Background(), <span class="number">5</span>*time.Second)</span><br><span class="line">	<span class="keyword">defer</span> cancel()</span><br><span class="line">	<span class="comment">// 5ç§’å†…ä¼˜é›…å…³é—­æœåŠ¡ï¼ˆå°†æœªå¤„ç†å®Œçš„è¯·æ±‚å¤„ç†å®Œå†å…³é—­æœåŠ¡ï¼‰ï¼Œè¶…è¿‡5ç§’å°±è¶…æ—¶é€€å‡º</span></span><br><span class="line">	<span class="keyword">if</span> err := srv.Shutdown(ctx); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		zap.L().Fatal(<span class="string">&quot;Server Shutdown: &quot;</span>, zap.Error(err))</span><br><span class="line">	&#125;</span><br><span class="line">	zap.L().Info(<span class="string">&quot;Server exiting&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="config-yaml"><a href="#config-yaml" class="headerlink" title="config.yaml"></a>config.yaml</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">app:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">&quot;web_app&quot;</span></span><br><span class="line">  <span class="attr">mode:</span> <span class="string">&quot;dev&quot;</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8081</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">log:</span></span><br><span class="line">  <span class="attr">level:</span> <span class="string">&quot;debug&quot;</span></span><br><span class="line">  <span class="attr">filename:</span> <span class="string">&quot;web_app.log&quot;</span></span><br><span class="line">  <span class="attr">max_size:</span> <span class="number">200</span></span><br><span class="line">  <span class="attr">max_age:</span> <span class="number">30</span></span><br><span class="line">  <span class="attr">max_backups:</span> <span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="attr">mysql:</span></span><br><span class="line">  <span class="attr">host:</span> <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">13306</span></span><br><span class="line">  <span class="attr">user:</span> <span class="string">&quot;root&quot;</span></span><br><span class="line">  <span class="attr">password:</span> <span class="string">&quot;root1234&quot;</span></span><br><span class="line">  <span class="attr">dbname:</span> <span class="string">&quot;sql_demo&quot;</span></span><br><span class="line">  <span class="attr">max_open_conns:</span> <span class="number">200</span></span><br><span class="line">  <span class="attr">max_idle_conns:</span> <span class="number">50</span></span><br><span class="line"></span><br><span class="line"><span class="attr">redis:</span></span><br><span class="line">  <span class="attr">host:</span> <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">16379</span></span><br><span class="line">  <span class="attr">db:</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">password:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="attr">pool_size:</span> <span class="number">100</span></span><br></pre></td></tr></table></figure>



<h2 id="setting"><a href="#setting" class="headerlink" title="setting"></a>setting</h2><p>setting.go</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> settings</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/fsnotify/fsnotify&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/spf13/viper&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Init</span><span class="params">()</span></span> (err <span class="type">error</span>) &#123;</span><br><span class="line">	viper.SetConfigName(<span class="string">&quot;config&quot;</span>) <span class="comment">// é…ç½®æ–‡ä»¶åç§°(æ— æ‰©å±•å)</span></span><br><span class="line">	viper.SetConfigType(<span class="string">&quot;yaml&quot;</span>)   <span class="comment">// å¦‚æœé…ç½®æ–‡ä»¶çš„åç§°ä¸­æ²¡æœ‰æ‰©å±•åï¼Œåˆ™éœ€è¦é…ç½®æ­¤é¡¹</span></span><br><span class="line">	viper.AddConfigPath(<span class="string">&quot;.&quot;</span>)      <span class="comment">// æŸ¥æ‰¾é…ç½®æ–‡ä»¶æ‰€åœ¨çš„è·¯å¾„</span></span><br><span class="line"></span><br><span class="line">	err = viper.ReadInConfig() <span class="comment">// æŸ¥æ‰¾å¹¶è¯»å–é…ç½®æ–‡ä»¶</span></span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;viper.ReadInConfig() failed,err:%v\n&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span> <span class="comment">// å¤„ç†è¯»å–é…ç½®æ–‡ä»¶çš„é”™è¯¯</span></span><br><span class="line">	&#125;</span><br><span class="line">	viper.WatchConfig()</span><br><span class="line">	viper.OnConfigChange(<span class="function"><span class="keyword">func</span><span class="params">(in fsnotify.Event)</span></span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;é…ç½®æ–‡ä»¶ä¿®æ”¹&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="log"><a href="#log" class="headerlink" title="log"></a>log</h2><p>logger.go</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> logger</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/spf13/viper&quot;</span></span><br><span class="line">	<span class="string">&quot;net&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http/httputil&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;runtime/debug&quot;</span></span><br><span class="line">	<span class="string">&quot;strings&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/natefinch/lumberjack&quot;</span></span><br><span class="line">	<span class="string">&quot;go.uber.org/zap&quot;</span></span><br><span class="line">	<span class="string">&quot;go.uber.org/zap/zapcore&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> lg *zap.Logger</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> LogConfig <span class="keyword">struct</span> &#123;</span><br><span class="line">	Level      <span class="type">string</span> <span class="string">`json:&quot;level&quot;`</span></span><br><span class="line">	Filename   <span class="type">string</span> <span class="string">`json:&quot;filename&quot;`</span></span><br><span class="line">	MaxSize    <span class="type">int</span>    <span class="string">`json:&quot;maxsize&quot;`</span></span><br><span class="line">	MaxAge     <span class="type">int</span>    <span class="string">`json:&quot;max_age&quot;`</span></span><br><span class="line">	MaxBackups <span class="type">int</span>    <span class="string">`json:&quot;max_backups&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Init</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Init</span><span class="params">()</span></span> (err <span class="type">error</span>) &#123;</span><br><span class="line">	writeSyncer := getLogWriter(</span><br><span class="line">		viper.GetString(<span class="string">&quot;log.filename&quot;</span>),</span><br><span class="line">		viper.GetInt(<span class="string">&quot;log.max_size&quot;</span>),</span><br><span class="line">		viper.GetInt(<span class="string">&quot;log.max_backups&quot;</span>),</span><br><span class="line">		viper.GetInt(<span class="string">&quot;log.max_age&quot;</span>))</span><br><span class="line">	encoder := getEncoder()</span><br><span class="line">	<span class="keyword">var</span> l = <span class="built_in">new</span>(zapcore.Level)</span><br><span class="line">	err = l.UnmarshalText([]<span class="type">byte</span>(viper.GetString(<span class="string">&quot;log.level&quot;</span>)))</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	core := zapcore.NewCore(encoder, writeSyncer, l)</span><br><span class="line"></span><br><span class="line">	lg = zap.New(core, zap.AddCaller())</span><br><span class="line">	zap.ReplaceGlobals(lg) <span class="comment">// æ›¿æ¢zapåŒ…ä¸­å…¨å±€çš„loggerå®ä¾‹ï¼Œåç»­åœ¨å…¶ä»–åŒ…ä¸­åªéœ€ä½¿ç”¨zap.L()è°ƒç”¨å³å¯</span></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getEncoder</span><span class="params">()</span></span> zapcore.Encoder &#123;</span><br><span class="line">	encoderConfig := zap.NewProductionEncoderConfig()</span><br><span class="line">	encoderConfig.EncodeTime = zapcore.ISO8601TimeEncoder</span><br><span class="line">	encoderConfig.TimeKey = <span class="string">&quot;time&quot;</span></span><br><span class="line">	encoderConfig.EncodeLevel = zapcore.CapitalLevelEncoder</span><br><span class="line">	encoderConfig.EncodeDuration = zapcore.SecondsDurationEncoder</span><br><span class="line">	encoderConfig.EncodeCaller = zapcore.ShortCallerEncoder</span><br><span class="line">	<span class="keyword">return</span> zapcore.NewJSONEncoder(encoderConfig)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getLogWriter</span><span class="params">(filename <span class="type">string</span>, maxSize, maxBackup, maxAge <span class="type">int</span>)</span></span> zapcore.WriteSyncer &#123;</span><br><span class="line">	lumberJackLogger := &amp;lumberjack.Logger&#123;</span><br><span class="line">		Filename:   filename,</span><br><span class="line">		MaxSize:    maxSize,</span><br><span class="line">		MaxBackups: maxBackup,</span><br><span class="line">		MaxAge:     maxAge,</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> zapcore.AddSync(lumberJackLogger)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GinLogger æ¥æ”¶ginæ¡†æ¶é»˜è®¤çš„æ—¥å¿—</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GinLogger</span><span class="params">()</span></span> gin.HandlerFunc &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		start := time.Now()</span><br><span class="line">		path := c.Request.URL.Path</span><br><span class="line">		query := c.Request.URL.RawQuery</span><br><span class="line">		c.Next()</span><br><span class="line"></span><br><span class="line">		cost := time.Since(start)</span><br><span class="line">		lg.Info(path,</span><br><span class="line">			zap.Int(<span class="string">&quot;status&quot;</span>, c.Writer.Status()),</span><br><span class="line">			zap.String(<span class="string">&quot;method&quot;</span>, c.Request.Method),</span><br><span class="line">			zap.String(<span class="string">&quot;path&quot;</span>, path),</span><br><span class="line">			zap.String(<span class="string">&quot;query&quot;</span>, query),</span><br><span class="line">			zap.String(<span class="string">&quot;ip&quot;</span>, c.ClientIP()),</span><br><span class="line">			zap.String(<span class="string">&quot;user-agent&quot;</span>, c.Request.UserAgent()),</span><br><span class="line">			zap.String(<span class="string">&quot;errors&quot;</span>, c.Errors.ByType(gin.ErrorTypePrivate).String()),</span><br><span class="line">			zap.Duration(<span class="string">&quot;cost&quot;</span>, cost),</span><br><span class="line">		)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GinRecovery recoveræ‰é¡¹ç›®å¯èƒ½å‡ºç°çš„panicï¼Œå¹¶ä½¿ç”¨zapè®°å½•ç›¸å…³æ—¥å¿—</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GinRecovery</span><span class="params">(stack <span class="type">bool</span>)</span></span> gin.HandlerFunc &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">			<span class="keyword">if</span> err := <span class="built_in">recover</span>(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">				<span class="comment">// Check for a broken connection, as it is not really a</span></span><br><span class="line">				<span class="comment">// condition that warrants a panic stack trace.</span></span><br><span class="line">				<span class="keyword">var</span> brokenPipe <span class="type">bool</span></span><br><span class="line">				<span class="keyword">if</span> ne, ok := err.(*net.OpError); ok &#123;</span><br><span class="line">					<span class="keyword">if</span> se, ok := ne.Err.(*os.SyscallError); ok &#123;</span><br><span class="line">						<span class="keyword">if</span> strings.Contains(strings.ToLower(se.Error()), <span class="string">&quot;broken pipe&quot;</span>) || strings.Contains(strings.ToLower(se.Error()), <span class="string">&quot;connection reset by peer&quot;</span>) &#123;</span><br><span class="line">							brokenPipe = <span class="literal">true</span></span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				httpRequest, _ := httputil.DumpRequest(c.Request, <span class="literal">false</span>)</span><br><span class="line">				<span class="keyword">if</span> brokenPipe &#123;</span><br><span class="line">					lg.Error(c.Request.URL.Path,</span><br><span class="line">						zap.Any(<span class="string">&quot;error&quot;</span>, err),</span><br><span class="line">						zap.String(<span class="string">&quot;request&quot;</span>, <span class="type">string</span>(httpRequest)),</span><br><span class="line">					)</span><br><span class="line">					<span class="comment">// If the connection is dead, we can&#x27;t write a status to it.</span></span><br><span class="line">					c.Error(err.(<span class="type">error</span>)) <span class="comment">// nolint: errcheck</span></span><br><span class="line">					c.Abort()</span><br><span class="line">					<span class="keyword">return</span></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> stack &#123;</span><br><span class="line">					lg.Error(<span class="string">&quot;[Recovery from panic]&quot;</span>,</span><br><span class="line">						zap.Any(<span class="string">&quot;error&quot;</span>, err),</span><br><span class="line">						zap.String(<span class="string">&quot;request&quot;</span>, <span class="type">string</span>(httpRequest)),</span><br><span class="line">						zap.String(<span class="string">&quot;stack&quot;</span>, <span class="type">string</span>(debug.Stack())),</span><br><span class="line">					)</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					lg.Error(<span class="string">&quot;[Recovery from panic]&quot;</span>,</span><br><span class="line">						zap.Any(<span class="string">&quot;error&quot;</span>, err),</span><br><span class="line">						zap.String(<span class="string">&quot;request&quot;</span>, <span class="type">string</span>(httpRequest)),</span><br><span class="line">					)</span><br><span class="line">				&#125;</span><br><span class="line">				c.AbortWithStatus(http.StatusInternalServerError)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;()</span><br><span class="line">		c.Next()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="database"><a href="#database" class="headerlink" title="database"></a>database</h2><p>mysql.go</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> mysql</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	_ <span class="string">&quot;github.com/go-sql-driver/mysql&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/jmoiron/sqlx&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/spf13/viper&quot;</span></span><br><span class="line">	<span class="string">&quot;go.uber.org/zap&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> db *sqlx.DB</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Init</span><span class="params">()</span></span> (err <span class="type">error</span>) &#123;</span><br><span class="line">	dsn := fmt.Sprintf(<span class="string">&quot;%s:%s@tcp(%s:%d)/%s?charset=utf8mb4&amp;parseTime=True&quot;</span>,</span><br><span class="line">		viper.GetString(<span class="string">&quot;mysql.user&quot;</span>),</span><br><span class="line">		viper.GetString(<span class="string">&quot;mysql.password&quot;</span>),</span><br><span class="line">		viper.GetString(<span class="string">&quot;mysql.host&quot;</span>),</span><br><span class="line">		viper.GetInt(<span class="string">&quot;mysql.port&quot;</span>),</span><br><span class="line">		viper.GetString(<span class="string">&quot;mysql.dbname&quot;</span>),</span><br><span class="line">	)</span><br><span class="line">	<span class="comment">// ä¹Ÿå¯ä»¥ä½¿ç”¨MustConnectè¿æ¥ä¸æˆåŠŸå°±panic</span></span><br><span class="line">	db, err = sqlx.Connect(<span class="string">&quot;mysql&quot;</span>, dsn)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		zap.L().Error(<span class="string">&quot;connect MySQL failed, err:%v\n&quot;</span>, zap.Error(err))</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	db.SetMaxOpenConns(viper.GetInt(<span class="string">&quot;mysql.max_open_conns&quot;</span>))</span><br><span class="line">	db.SetMaxIdleConns(viper.GetInt(<span class="string">&quot;mysql.max_idle_coons&quot;</span>))</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Close</span><span class="params">()</span></span> &#123;</span><br><span class="line">	_ = db.Close()</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>redis.go</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> redis</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;context&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/redis/go-redis/v9&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/spf13/viper&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Init</span><span class="params">()</span></span> (err <span class="type">error</span>) &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     fmt.Sprintf(<span class="string">&quot;%s:%d&quot;</span>, viper.GetString(<span class="string">&quot;redis.host&quot;</span>), viper.GetInt(<span class="string">&quot;redis.port&quot;</span>)),</span><br><span class="line">		Password: viper.GetString(<span class="string">&quot;redis.password&quot;</span>), <span class="comment">// å¯†ç </span></span><br><span class="line">		DB:       viper.GetInt(<span class="string">&quot;redis.db&quot;</span>),          <span class="comment">// æ•°æ®åº“</span></span><br><span class="line">		PoolSize: viper.GetInt(<span class="string">&quot;redis.pool_size&quot;</span>),   <span class="comment">// è¿æ¥æ± å¤§å°</span></span><br><span class="line">	&#125;)</span><br><span class="line">	_, err = rdb.Ping(ctx).Result()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Close</span><span class="params">()</span></span> &#123;</span><br><span class="line">	_ = rdb.Close()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="routes"><a href="#routes" class="headerlink" title="routes"></a>routes</h2><p>routes.go</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> routes</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;GoGin/src/GoWebDevFrame/log&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SetUp</span><span class="params">()</span></span> *gin.Engine &#123;</span><br><span class="line">	r := gin.New()</span><br><span class="line">	r.Use(logger.GinLogger(), logger.GinRecovery(<span class="literal">true</span>))</span><br><span class="line">	r.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.String(http.StatusOK, <span class="string">&quot;ok&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="keyword">return</span> r</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="controllers"><a href="#controllers" class="headerlink" title="controllers"></a>controllers</h2><h2 id="logic"><a href="#logic" class="headerlink" title="logic"></a>logic</h2><h2 id="pkg"><a href="#pkg" class="headerlink" title="pkg"></a>pkg</h2><h2 id="models"><a href="#models" class="headerlink" title="models"></a>models</h2>]]></content>
      <categories>
        <category>Golang</category>
      </categories>
      <tags>
        <tag>Golang</tag>
        <tag>GoWeb</tag>
      </tags>
  </entry>
  <entry>
    <title>Graph-LC1020</title>
    <url>/2023/09/03/Graph-LC1020/</url>
    <content><![CDATA[<h1 id="Leetcode-1020-dfs-and-bfs"><a href="#Leetcode-1020-dfs-and-bfs" class="headerlink" title="Leetcode 1020-dfs and bfs"></a>Leetcode 1020-<code>dfs</code> and <code>bfs</code></h1><h2 id="1020-Number-of-Enclaves"><a href="#1020-Number-of-Enclaves" class="headerlink" title="1020. Number of Enclaves"></a><a href="https://leetcode.cn/problems/number-of-enclaves/">1020. Number of Enclaves</a></h2><p>You are given an <code>m x n</code> binary matrix <code>grid</code>, where <code>0</code> represents a sea cell and <code>1</code> represents a land cell.</p>
<p>A <strong>move</strong> consists of walking from one land cell to another adjacent (<strong>4-directionally</strong>) land cell or walking off the boundary of the <code>grid</code>.</p>
<p>Return <em>the number of land cells in</em> <code>grid</code> <em>for which we cannot walk off the boundary of the grid in any number of <strong>moves</strong></em>.</p>
<span id="more"></span>

<p><img src="/./../pic/Graph-LC1020/image-20230903161136120.png" alt="image-20230903161136120"></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Input: grid = [[0,0,0,0],[1,0,1,0],[0,1,1,0],[0,0,0,0]]</span><br><span class="line">Output: 3</span><br><span class="line">Explanation: There are three 1s that are enclosed by 0s, and one 1 that is not enclosed because its on the boundary.</span><br></pre></td></tr></table></figure>

<h2 id="Resolution"><a href="#Resolution" class="headerlink" title="Resolution"></a>Resolution</h2><p>Be similar with lc200,<br>dfs from a vertex tarverse all vertices until encounter the endCondition<br>bfs from a vertex traverse all vertices round by round </p>
<p>When encountering land around the boundary<br> change <code>1</code> to <code>0</code> is OK,then </p>
<h3 id="DFS"><a href="#DFS" class="headerlink" title="DFS"></a>DFS</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">numEnclaves</span><span class="params">(grid [][]<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	n, m := <span class="built_in">len</span>(grid), <span class="built_in">len</span>(grid[<span class="number">0</span>])</span><br><span class="line">	dir := [<span class="number">4</span>][<span class="number">2</span>]<span class="type">int</span>&#123;&#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;&#125;</span><br><span class="line">	count := <span class="number">0</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> dfs <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">int</span>)</span></span></span><br><span class="line">	dfs = <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">		grid[x][y] = <span class="number">0</span></span><br><span class="line">		count++</span><br><span class="line">		<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">4</span>; i++ &#123;</span><br><span class="line">			nX := x + dir[i][<span class="number">0</span>]</span><br><span class="line">			nY := y + dir[i][<span class="number">1</span>]</span><br><span class="line">			<span class="keyword">if</span> nX &lt; <span class="number">0</span> || nY &lt; <span class="number">0</span> || nX &gt;= n || nY &gt;= m &#123;</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> grid[nX][nY] == <span class="number">0</span> &#123;</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			&#125;</span><br><span class="line">			dfs(nX, nY)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//from left and right traverse to middle</span></span><br><span class="line">	<span class="comment">// make the land near the boundary from 1 to 0</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">if</span> grid[i][<span class="number">0</span>] == <span class="number">1</span> &#123;</span><br><span class="line">			dfs(i, <span class="number">0</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> grid[i][m<span class="number">-1</span>] == <span class="number">1</span> &#123;</span><br><span class="line">			dfs(i, m<span class="number">-1</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// from top and bottom traverse to middle</span></span><br><span class="line">	<span class="comment">// alse 1  is changed to 0</span></span><br><span class="line">	<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">		<span class="keyword">if</span> grid[<span class="number">0</span>][j] == <span class="number">1</span> &#123;</span><br><span class="line">			dfs(<span class="number">0</span>, j)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> grid[n<span class="number">-1</span>][j] == <span class="number">1</span> &#123;</span><br><span class="line">			dfs(n<span class="number">-1</span>, j)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// initalize result count 0</span></span><br><span class="line">	count = <span class="number">0</span></span><br><span class="line">	<span class="comment">//traverse all graph</span></span><br><span class="line">	<span class="comment">//compute and count the result</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">			<span class="keyword">if</span> grid[i][j] == <span class="number">1</span> &#123;</span><br><span class="line">				dfs(i, j)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> count</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br></pre></td></tr></table></figure>

<h3 id="BFS"><a href="#BFS" class="headerlink" title="BFS"></a>BFS</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">numEnclaves</span><span class="params">(grid [][]<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	n, m := <span class="built_in">len</span>(grid), <span class="built_in">len</span>(grid[<span class="number">0</span>])</span><br><span class="line">	dir := [<span class="number">4</span>][<span class="number">2</span>]<span class="type">int</span>&#123;&#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;&#125;</span><br><span class="line">	count := <span class="number">0</span></span><br><span class="line">	<span class="keyword">var</span> bfs <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">int</span>)</span></span></span><br><span class="line">	bfs = <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">		grid[x][y] = <span class="number">0</span></span><br><span class="line">		count++</span><br><span class="line">		que := list.New()</span><br><span class="line">		que.PushBack(x)</span><br><span class="line">		que.PushBack(y)</span><br><span class="line">		<span class="keyword">for</span> que.Len() != <span class="number">0</span> &#123;</span><br><span class="line">			curX := que.Remove(que.Front()).(<span class="type">int</span>)</span><br><span class="line">			curY := que.Remove(que.Front()).(<span class="type">int</span>)</span><br><span class="line">			<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">4</span>; i++ &#123;</span><br><span class="line">				nextX := curX + dir[i][<span class="number">0</span>]</span><br><span class="line">				nextY := curY + dir[i][<span class="number">1</span>]</span><br><span class="line">				<span class="keyword">if</span> nextX &lt; <span class="number">0</span> || nextY &lt; <span class="number">0</span> || nextX &gt;= n || nextY &gt;= m &#123;</span><br><span class="line">					<span class="keyword">continue</span></span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> grid[nextX][nextY] == <span class="number">1</span> &#123;</span><br><span class="line">					que.PushBack(nextX)</span><br><span class="line">					que.PushBack(nextY)</span><br><span class="line">					count++</span><br><span class="line">					grid[nextX][nextY] = <span class="number">0</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">if</span> grid[i][<span class="number">0</span>] == <span class="number">1</span> &#123;</span><br><span class="line">			bfs(i, <span class="number">0</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> grid[i][m<span class="number">-1</span>] == <span class="number">1</span> &#123;</span><br><span class="line">			bfs(i, m<span class="number">-1</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">		<span class="keyword">if</span> grid[<span class="number">0</span>][j] == <span class="number">1</span> &#123;</span><br><span class="line">			bfs(<span class="number">0</span>, j)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> grid[n<span class="number">-1</span>][j] == <span class="number">1</span> &#123;</span><br><span class="line">			bfs(n<span class="number">-1</span>, j)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	count = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">			<span class="keyword">if</span> grid[i][j] == <span class="number">1</span> &#123;</span><br><span class="line">				bfs(i, j)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> count</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Graph</tag>
        <tag>dfs</tag>
        <tag>bfs</tag>
      </tags>
  </entry>
  <entry>
    <title>Graph-LC127</title>
    <url>/2023/09/04/Graph-LC127/</url>
    <content><![CDATA[<h1 id="Word-Ladder"><a href="#Word-Ladder" class="headerlink" title="Word Ladder"></a><a href="https://leetcode.cn/problems/word-ladder/">Word Ladder</a></h1><p>A <strong>transformation sequence(åºåˆ—)</strong> from word <code>beginWord</code> to word <code>endWord</code> using a dictionary <code>wordList</code> is a sequence of words <code>beginWord -&gt; s1 -&gt; s2 -&gt; ... -&gt; sk</code> </p>
<ul>
<li>Every adjacent pair of words differs by a single letter.</li>
<li>Every <code>si</code> for <code>1 &lt;= i &lt;= k</code> is in <code>wordList</code>. Note that <code>beginWord</code> does not need to be in <code>wordList</code>.</li>
<li><code>sk == endWord</code></li>
</ul>
<p>Given two words, <code>beginWord</code> and <code>endWord</code>, and a dictionary <code>wordList</code>, return <em>the <strong>number of words</strong> in the <strong>shortest transformation sequence</strong> from</em> <code>beginWord</code> <em>to</em> <code>endWord</code><em>, or</em> <code>0</code> <em>if no such sequence exists.</em></p>
<p><strong>Example 1:</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Input: beginWord = &quot;hit&quot;, endWord = &quot;cog&quot;, wordList = [&quot;hot&quot;,&quot;dot&quot;,&quot;dog&quot;,&quot;lot&quot;,&quot;log&quot;,&quot;cog&quot;]</span><br><span class="line">Output: 5</span><br><span class="line">Explanation: One shortest transformation sequence is &quot;hit&quot; -&gt; &quot;hot&quot; -&gt; &quot;dot&quot; -&gt; &quot;dog&quot; -&gt; cog&quot;, which is 5 words long.</span><br></pre></td></tr></table></figure>

<p><img src="/./../pic/Graph-LC127/image-20230904132736425.png" alt="image-20230904132736425"></p>
<span id="more"></span>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: beginWord = &quot;hit&quot;, endWord = &quot;cog&quot;, wordList = [&quot;hot&quot;,&quot;dot&quot;,&quot;dog&quot;,&quot;lot&quot;,&quot;log&quot;]</span><br><span class="line">Output: 0</span><br><span class="line">Explanation: The endWord &quot;cog&quot; is not in wordList, therefore there is no valid transformation sequence.</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= beginWord.length &lt;= 10</code></li>
<li><code>endWord.length == beginWord.length</code></li>
<li><code>1 &lt;= wordList.length &lt;= 5000</code></li>
<li><code>wordList[i].length == beginWord.length</code></li>
<li><code>beginWord</code>, <code>endWord</code>, and <code>wordList[i]</code> consist of lowercase English letters.</li>
<li><code>beginWord != endWord</code></li>
<li>All the words in <code>wordList</code> are <strong>unique</strong>.</li>
</ul>
<h2 id="Resolution"><a href="#Resolution" class="headerlink" title="Resolution"></a>Resolution</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;container/list&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ladderLength</span><span class="params">(beginWord <span class="type">string</span>, endWord <span class="type">string</span>, wordList []<span class="type">string</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	<span class="comment">//quickly check use map not list</span></span><br><span class="line">	workset := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">bool</span>)</span><br><span class="line">	<span class="keyword">for</span> _, v := <span class="keyword">range</span> wordList &#123;</span><br><span class="line">		workset[v] = <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> !workset[endWord] &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// init a queue</span></span><br><span class="line">	que := list.New()</span><br><span class="line">	que.PushBack(beginWord)</span><br><span class="line">	<span class="comment">//init map to record the length of the path that arrives each word</span></span><br><span class="line">	<span class="comment">//add beginWord to the que and visitmap</span></span><br><span class="line">	visitmap := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int</span>)</span><br><span class="line">	visitmap[beginWord] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> que.Len() != <span class="number">0</span> &#123;</span><br><span class="line">		<span class="comment">// pick a word</span></span><br><span class="line">		<span class="comment">// and length of the path to that word named `path`</span></span><br><span class="line">		word := que.Remove(que.Front()).(<span class="type">string</span>)</span><br><span class="line">		path := visitmap[word]</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(word); i++ &#123;</span><br><span class="line">			<span class="comment">//each character in each word,</span></span><br><span class="line">			<span class="comment">//try replacing it from &#x27;a&#x27; to &#x27;z&#x27;</span></span><br><span class="line">			<span class="keyword">for</span> j := <span class="string">&#x27;a&#x27;</span>; j &lt;= <span class="string">&#x27;z&#x27;</span>; j++ &#123;</span><br><span class="line">				<span class="comment">//character is not duplication</span></span><br><span class="line">				<span class="keyword">if</span> word[i] == <span class="type">byte</span>(j) &#123;</span><br><span class="line">					<span class="keyword">continue</span></span><br><span class="line">				&#125;</span><br><span class="line">				<span class="comment">//generate a new word newWord</span></span><br><span class="line">				newWord := word[:i] + <span class="type">string</span>(j) + word[i+<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> newWord == endWord &#123;</span><br><span class="line">					<span class="keyword">return</span> path + <span class="number">1</span></span><br><span class="line">				&#125;</span><br><span class="line">				<span class="comment">// newWord is in workset &amp;&amp; not be visited</span></span><br><span class="line">				<span class="keyword">if</span> workset[newWord] &amp;&amp; visitmap[newWord] == <span class="number">0</span> &#123;</span><br><span class="line">					visitmap[newWord] = path + <span class="number">1</span></span><br><span class="line">					que.PushBack(newWord)</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Graph</tag>
        <tag>bfs</tag>
      </tags>
  </entry>
  <entry>
    <title>Graph-LC130</title>
    <url>/2023/09/03/Graph-LC130/</url>
    <content><![CDATA[<h1 id="Leetcode-200-dfs-and-bfs"><a href="#Leetcode-200-dfs-and-bfs" class="headerlink" title="Leetcode 200-dfs and bfs"></a>Leetcode 200-<code>dfs</code> and <code>bfs</code></h1><h2 id="Surrounded-Regions"><a href="#Surrounded-Regions" class="headerlink" title="Surrounded Regions"></a><a href="https://leetcode.cn/problems/surrounded-regions/">Surrounded Regions</a></h2><p>Given an <code>m x n</code> matrix <code>board</code> containing <code>&#39;X&#39;</code> and <code>&#39;O&#39;</code>, <em>capture all regions that are 4-directionally surrounded by</em> <code>&#39;X&#39;</code>.</p>
<p>A region is <strong>captured</strong> by flipping all <code>&#39;O&#39;</code>s into <code>&#39;X&#39;</code>s in that surrounded region.</p>
<p> <img src="/./../pic/Graph-LC130/image-20230903174833997.png" alt="image-20230903174833997"></p>
<span id="more"></span>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Input: board = [[&quot;X&quot;,&quot;X&quot;,&quot;X&quot;,&quot;X&quot;],[&quot;X&quot;,&quot;O&quot;,&quot;O&quot;,&quot;X&quot;],[&quot;X&quot;,&quot;X&quot;,&quot;O&quot;,&quot;X&quot;],[&quot;X&quot;,&quot;O&quot;,&quot;X&quot;,&quot;X&quot;]]</span><br><span class="line">Output: [[&quot;X&quot;,&quot;X&quot;,&quot;X&quot;,&quot;X&quot;],[&quot;X&quot;,&quot;X&quot;,&quot;X&quot;,&quot;X&quot;],[&quot;X&quot;,&quot;X&quot;,&quot;X&quot;,&quot;X&quot;],[&quot;X&quot;,&quot;O&quot;,&quot;X&quot;,&quot;X&quot;]]</span><br><span class="line">Explanation: Notice that an &#x27;O&#x27; should not be flipped if:</span><br><span class="line">- It is on the border, or</span><br><span class="line">- It is adjacent to an &#x27;O&#x27; that should not be flipped.</span><br><span class="line">The bottom &#x27;O&#x27; is on the border, so it is not flipped.</span><br><span class="line">The other three &#x27;O&#x27; form a surrounded region, so they are flipped.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Input: board = [[&quot;X&quot;]]</span><br><span class="line">Output: [[&quot;X&quot;]]</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>m == board.length</code></li>
<li><code>n == board[i].length</code></li>
<li><code>1 &lt;= m, n &lt;= 200</code></li>
<li><code>board[i][j]</code> is <code>&#39;X&#39;</code> or <code>&#39;O&#39;</code>.</li>
</ul>
<!-- more -->

<h2 id="Resolution"><a href="#Resolution" class="headerlink" title="Resolution"></a>Resolution</h2><h3 id="DFS"><a href="#DFS" class="headerlink" title="DFS"></a>DFS</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Change boundary `O` -&gt; `A`</span></span><br><span class="line"><span class="comment">Change all list `O` -&gt; `X`</span></span><br><span class="line"><span class="comment">Change all list `A` -&gt; `O`</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">solve</span><span class="params">(board [][]<span class="type">byte</span>)</span></span> &#123;</span><br><span class="line">	n, m := <span class="built_in">len</span>(board), <span class="built_in">len</span>(board[<span class="number">0</span>])</span><br><span class="line">	dir := [<span class="number">4</span>][<span class="number">2</span>]<span class="type">int</span>&#123;&#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;&#125;</span><br><span class="line">	<span class="keyword">var</span> dfs <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">int</span>)</span></span></span><br><span class="line">	dfs = <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">		board[x][y] = <span class="string">&#x27;A&#x27;</span></span><br><span class="line">		<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">4</span>; i++ &#123;</span><br><span class="line">			nextX := x + dir[i][<span class="number">0</span>]</span><br><span class="line">			nextY := y + dir[i][<span class="number">1</span>]</span><br><span class="line">			<span class="keyword">if</span> nextX &lt; <span class="number">0</span> || nextY &lt; <span class="number">0</span> || nextX &gt;= n || nextY &gt;= m &#123;</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> board[nextX][nextY] == <span class="string">&#x27;O&#x27;</span> &#123;</span><br><span class="line">				dfs(nextX, nextY)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">if</span> board[i][<span class="number">0</span>] == <span class="string">&#x27;O&#x27;</span> &#123;</span><br><span class="line">			dfs(i, <span class="number">0</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> board[i][m<span class="number">-1</span>] == <span class="string">&#x27;O&#x27;</span> &#123;</span><br><span class="line">			dfs(i, m<span class="number">-1</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">		<span class="keyword">if</span> board[<span class="number">0</span>][j] == <span class="string">&#x27;O&#x27;</span> &#123;</span><br><span class="line">			dfs(<span class="number">0</span>, j)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> board[n<span class="number">-1</span>][j] == <span class="string">&#x27;O&#x27;</span> &#123;</span><br><span class="line">			dfs(n<span class="number">-1</span>, j)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">			<span class="keyword">if</span> board[i][j] == <span class="string">&#x27;O&#x27;</span> &#123;</span><br><span class="line">				board[i][j] = <span class="string">&#x27;X&#x27;</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> board[i][j] == <span class="string">&#x27;A&#x27;</span> &#123;</span><br><span class="line">				board[i][j] = <span class="string">&#x27;O&#x27;</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="BFS"><a href="#BFS" class="headerlink" title="BFS"></a>BFS</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Change boundary `O` -&gt; `A`</span></span><br><span class="line"><span class="comment">Change all list `O` -&gt; `X`</span></span><br><span class="line"><span class="comment">Change all list `A` -&gt; `O`</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">solve</span><span class="params">(board [][]<span class="type">byte</span>)</span></span> &#123;</span><br><span class="line">	n, m := <span class="built_in">len</span>(board), <span class="built_in">len</span>(board[<span class="number">0</span>])</span><br><span class="line">	dir := [<span class="number">4</span>][<span class="number">2</span>]<span class="type">int</span>&#123;&#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;&#125;</span><br><span class="line">	<span class="keyword">var</span> bfs <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">int</span>)</span></span></span><br><span class="line">	bfs = <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">		board[x][y] = <span class="string">&#x27;A&#x27;</span></span><br><span class="line">		que := list.New()</span><br><span class="line">		que.PushBack(x)</span><br><span class="line">		que.PushBack(y)</span><br><span class="line">		<span class="keyword">for</span> que.Len() != <span class="number">0</span> &#123;</span><br><span class="line">			curX := que.Remove(que.Front()).(<span class="type">int</span>)</span><br><span class="line">			curY := que.Remove(que.Front()).(<span class="type">int</span>)</span><br><span class="line">			<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">4</span>; i++ &#123;</span><br><span class="line">				nextX := curX + dir[i][<span class="number">0</span>]</span><br><span class="line">				nextY := curY + dir[i][<span class="number">1</span>]</span><br><span class="line">				<span class="keyword">if</span> nextX &lt; <span class="number">0</span> || nextY &lt; <span class="number">0</span> || nextX &gt;= n || nextY &gt;= m &#123;</span><br><span class="line">					<span class="keyword">continue</span></span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> board[nextX][nextY] == <span class="string">&#x27;O&#x27;</span> &#123;</span><br><span class="line">					que.PushBack(nextX)</span><br><span class="line">					que.PushBack(nextY)</span><br><span class="line">					board[nextX][nextY] = <span class="string">&#x27;A&#x27;</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">if</span> board[i][<span class="number">0</span>] == <span class="string">&#x27;O&#x27;</span> &#123;</span><br><span class="line">			bfs(i, <span class="number">0</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> board[i][m<span class="number">-1</span>] == <span class="string">&#x27;O&#x27;</span> &#123;</span><br><span class="line">			bfs(i, m<span class="number">-1</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">		<span class="keyword">if</span> board[<span class="number">0</span>][j] == <span class="string">&#x27;O&#x27;</span> &#123;</span><br><span class="line">			bfs(<span class="number">0</span>, j)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> board[n<span class="number">-1</span>][j] == <span class="string">&#x27;O&#x27;</span> &#123;</span><br><span class="line">			bfs(n<span class="number">-1</span>, j)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">			<span class="keyword">if</span> board[i][j] == <span class="string">&#x27;O&#x27;</span> &#123;</span><br><span class="line">				board[i][j] = <span class="string">&#x27;X&#x27;</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> board[i][j] == <span class="string">&#x27;A&#x27;</span> &#123;</span><br><span class="line">				board[i][j] = <span class="string">&#x27;O&#x27;</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Graph</tag>
        <tag>dfs</tag>
        <tag>bfs</tag>
      </tags>
  </entry>
  <entry>
    <title>Graph-LC1971</title>
    <url>/2023/09/04/Graph-LC1971/</url>
    <content><![CDATA[<h1 id="1971Find-if-Path-Exists-in-Graph"><a href="#1971Find-if-Path-Exists-in-Graph" class="headerlink" title="1971Find if Path Exists in Graph"></a><a href="https://leetcode.cn/problems/find-if-path-exists-in-graph/">1971Find if Path Exists in Graph</a></h1><p>There is a <strong>bi-directional</strong>(åŒå‘å›¾) graph with <code>n</code> vertices, where each vertex is labeled from <code>0</code> to <code>n - 1</code> (<strong>inclusive</strong>). The edges in the graph are represented as a 2D integer array <code>edges</code>, where each <code>edges[i] = [ui, vi]</code> denotes a bi-directional edge between vertex <code>ui</code> and vertex <code>vi</code>. Every vertex pair is connected by <strong>at most one</strong> edge, and no vertex has an edge to itself.</p>
<p>You want to determine if there is a <strong>valid path</strong> that exists from vertex <code>source</code> to vertex <code>destination</code>.</p>
<p>Given <code>edges</code> and the integers <code>n</code>, <code>source</code>, and <code>destination</code>, return <code>true</code> <em>if there is a <strong>valid path</strong> from</em> <code>source</code> <em>to</em> <code>destination</code><em>, or</em> <code>false</code> <em>otherwise</em><em>.</em></p>
 <span id="more"></span>

<p><strong>Example 1:</strong></p>
<p><img src="/./../pic/Graph-LC1971/validpath-ex1.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: n = 3, edges = [[0,1],[1,2],[2,0]], source = 0, destination = 2</span><br><span class="line">Output: true</span><br><span class="line">Explanation: There are two paths from vertex 0 to vertex 2:</span><br><span class="line">- 0 â†’ 1 â†’ 2</span><br><span class="line">- 0 â†’ 2</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<p><img src="/./../pic/Graph-LC1971/validpath-ex2.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: n = 6, edges = [[0,1],[0,2],[3,5],[5,4],[4,3]], source = 0, destination = 5</span><br><span class="line">Output: false</span><br><span class="line">Explanation: There is no path from vertex 0 to vertex 5.</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= n &lt;= 2 * 105</code></li>
<li><code>0 &lt;= edges.length &lt;= 2 * 105</code></li>
<li><code>edges[i].length == 2</code></li>
<li><code>0 &lt;= ui, vi &lt;= n - 1</code></li>
<li><code>ui != vi</code></li>
<li><code>0 &lt;= source, destination &lt;= n - 1</code></li>
<li>There are no duplicate edges.</li>
<li>There are no self edges.</li>
</ul>
<h2 id="Resolution"><a href="#Resolution" class="headerlink" title="Resolution"></a>Resolution</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">validPath</span><span class="params">(n <span class="type">int</span>, edges [][]<span class="type">int</span>, source <span class="type">int</span>, destination <span class="type">int</span>)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> sol DSU</span><br><span class="line">	sol.Init(n)</span><br><span class="line">	<span class="keyword">for</span> _, edge := <span class="keyword">range</span> edges &#123;</span><br><span class="line">		sol.Union(edge[<span class="number">1</span>], edge[<span class="number">0</span>])</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> sol.IsSame(source, destination)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> DSU <span class="keyword">struct</span> &#123;</span><br><span class="line">	Father []<span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d *DSU)</span></span> Init(n <span class="type">int</span>) &#123;</span><br><span class="line">	d.Father = <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		d.Father[i] = i</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d *DSU)</span></span> Union(i, j <span class="type">int</span>) &#123;</span><br><span class="line">	iFather := d.Find(i)</span><br><span class="line">	jFather := d.Find(j)</span><br><span class="line">	<span class="comment">//i&#x27;s father-&gt;j&#x27;s father</span></span><br><span class="line">	<span class="keyword">if</span> iFather == jFather &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	d.Father[iFather] = jFather</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d *DSU)</span></span> Find(i <span class="type">int</span>) <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> i == d.Father[i] &#123;</span><br><span class="line">		<span class="keyword">return</span> i</span><br><span class="line">	&#125;</span><br><span class="line">	d.Father[i] = d.Find(d.Father[i])</span><br><span class="line">	<span class="keyword">return</span> d.Father[i]</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d *DSU)</span></span> IsSame(i, j <span class="type">int</span>) <span class="type">bool</span> &#123;</span><br><span class="line">	iFather := d.Find(i)</span><br><span class="line">	jFather := d.Find(j)</span><br><span class="line">	<span class="keyword">return</span> iFather == jFather</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>DSU</tag>
        <tag>Graph</tag>
      </tags>
  </entry>
  <entry>
    <title>Graph-LC200</title>
    <url>/2023/09/02/Graph-LC200/</url>
    <content><![CDATA[<h1 id="Leetcode-200-dfs-and-bfs"><a href="#Leetcode-200-dfs-and-bfs" class="headerlink" title="Leetcode 200-dfs and bfs"></a>Leetcode 200-<code>dfs</code> and <code>bfs</code></h1><h2 id="Number-of-Islands"><a href="#Number-of-Islands" class="headerlink" title="Number of Islands"></a><a href="https://leetcode.cn/problems/number-of-islands/">Number of Islands</a></h2><p>Given an <code>m x n</code> 2D binary <code>grid</code> which represents a map of <code>1</code> (land) and <code>0</code> (water), return <em>the number of islands</em>.</p>
<p>An <strong>island</strong> is surrounded by water and is formed by connecting adjacent(é‚»è¿‘çš„) lands horizontally(æ°´å¹³) or vertically(å‚ç›´). You may assume all four edges of the grid are all surrounded by water.</p>
 <span id="more"></span>

<p><strong>Example 1:</strong></p>
<figure class="highlight latex"><table><tr><td class="code"><pre><span class="line">Input: grid = [</span><br><span class="line">  [&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;0&quot;],</span><br><span class="line">  [&quot;1&quot;,&quot;1&quot;,&quot;0&quot;,&quot;1&quot;,&quot;0&quot;],</span><br><span class="line">  [&quot;1&quot;,&quot;1&quot;,&quot;0&quot;,&quot;0&quot;,&quot;0&quot;],</span><br><span class="line">  [&quot;0&quot;,&quot;0&quot;,&quot;0&quot;,&quot;0&quot;,&quot;0&quot;]</span><br><span class="line">]</span><br><span class="line">Output: 1</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight latex"><table><tr><td class="code"><pre><span class="line">Input: grid = [</span><br><span class="line">  [&quot;1&quot;,&quot;1&quot;,&quot;0&quot;,&quot;0&quot;,&quot;0&quot;],</span><br><span class="line">  [&quot;1&quot;,&quot;1&quot;,&quot;0&quot;,&quot;0&quot;,&quot;0&quot;],</span><br><span class="line">  [&quot;0&quot;,&quot;0&quot;,&quot;1&quot;,&quot;0&quot;,&quot;0&quot;],</span><br><span class="line">  [&quot;0&quot;,&quot;0&quot;,&quot;0&quot;,&quot;1&quot;,&quot;1&quot;]</span><br><span class="line">]</span><br><span class="line">Output: 3 </span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>m == grid.length</code></li>
<li><code>n == grid[i].length</code></li>
<li><code>1 &lt;= m, n &lt;= 300</code></li>
<li><code>grid[i][j]</code> is <code>&#39;0&#39;</code> or <code>&#39;1&#39;</code>.</li>
</ul>
<h2 id="resolution"><a href="#resolution" class="headerlink" title="resolution"></a>resolution</h2><h3 id="DFS"><a href="#DFS" class="headerlink" title="DFS"></a>DFS</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="comment">// 200  2023-09-02 20:21:35</span></span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">numIslands</span><span class="params">(grid [][]<span class="type">byte</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	n, m := <span class="built_in">len</span>(grid), <span class="built_in">len</span>(grid[<span class="number">0</span>])</span><br><span class="line">	visited := <span class="built_in">make</span>([][]<span class="type">bool</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="keyword">range</span> visited &#123;</span><br><span class="line">		visited[i] = <span class="built_in">make</span>([]<span class="type">bool</span>, m)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// four directions</span></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">		&#123;0, 1&#125;  to right: col+1</span></span><br><span class="line"><span class="comment">		&#123;1, 0&#125; 	to down: row+1</span></span><br><span class="line"><span class="comment">		&#123;-1, 0&#125;	to up: row-1</span></span><br><span class="line"><span class="comment">		&#123;0, -1&#125; to left: col-1</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="keyword">var</span> dir = [<span class="number">4</span>][<span class="number">2</span>]<span class="type">int</span>&#123;&#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//dfs function</span></span><br><span class="line">	<span class="keyword">var</span> dfs <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">int</span>)</span></span></span><br><span class="line">	dfs = <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">		<span class="comment">// has been visited or the point is ocean</span></span><br><span class="line">		<span class="keyword">if</span> visited[x][y]==<span class="literal">true</span> || grid[x][y] == <span class="string">&#x27;0&#x27;</span> &#123;</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// has been visited</span></span><br><span class="line">		visited[x][y] = <span class="literal">true</span></span><br><span class="line">		<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">4</span>; i++ &#123;</span><br><span class="line">			<span class="comment">//right down up left</span></span><br><span class="line">			nextX := x + dir[i][<span class="number">0</span>]</span><br><span class="line">			nextY := y + dir[i][<span class="number">1</span>]</span><br><span class="line">			<span class="keyword">if</span> nextX &lt; <span class="number">0</span> || nextX &gt;= n || nextY &lt; <span class="number">0</span> || nextY &gt;= m &#123;</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			&#125;</span><br><span class="line">			dfs(nextX, nextY)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	ret := <span class="number">0</span></span><br><span class="line">	<span class="comment">// traverse the grip</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">			<span class="comment">//this point is not visited and is land</span></span><br><span class="line">			<span class="keyword">if</span> visited[i][j]==<span class="literal">false</span> &amp;&amp; grid[i][j] == <span class="string">&#x27;1&#x27;</span> &#123;</span><br><span class="line">				ret++</span><br><span class="line">				<span class="comment">//from this point tarvers all linked land</span></span><br><span class="line">				dfs(i, j)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br></pre></td></tr></table></figure>

<h3 id="BFS"><a href="#BFS" class="headerlink" title="BFS"></a>BFS</h3><p>ues queue</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;container/list&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 200  2023-09-02 20:21:35</span></span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">numIslands</span><span class="params">(grid [][]<span class="type">byte</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	n, m := <span class="built_in">len</span>(grid), <span class="built_in">len</span>(grid[<span class="number">0</span>])</span><br><span class="line">	visited := <span class="built_in">make</span>([][]<span class="type">bool</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="keyword">range</span> visited &#123;</span><br><span class="line">		visited[i] = <span class="built_in">make</span>([]<span class="type">bool</span>, m)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">var</span> dir = [<span class="number">4</span>][<span class="number">2</span>]<span class="type">int</span>&#123;&#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> bfs <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">int</span>)</span></span></span><br><span class="line">	bfs = <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">		que := list.New()</span><br><span class="line">		que.PushBack([<span class="number">2</span>]<span class="type">int</span>&#123;x, y&#125;)</span><br><span class="line">		visited[x][y] = <span class="literal">true</span></span><br><span class="line">		<span class="keyword">for</span> que.Len() != <span class="number">0</span> &#123;</span><br><span class="line">			cur := que.Remove(que.Front()).([<span class="number">2</span>]<span class="type">int</span>)</span><br><span class="line">			curx, cury := cur[<span class="number">0</span>], cur[<span class="number">1</span>]</span><br><span class="line">			<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">4</span>; i++ &#123;</span><br><span class="line">				nextX := curx + dir[i][<span class="number">0</span>]</span><br><span class="line">				nextY := cury + dir[i][<span class="number">1</span>]</span><br><span class="line">				<span class="keyword">if</span> nextX &lt; <span class="number">0</span> || nextX &gt;= n || nextY &lt; <span class="number">0</span> || nextY &gt;= m &#123;</span><br><span class="line">					<span class="keyword">continue</span></span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> visited[nextX][nextY] == <span class="literal">false</span> &amp;&amp; grid[nextX][nextY] == <span class="string">&#x27;1&#x27;</span> &#123;</span><br><span class="line">					que.PushBack([<span class="number">2</span>]<span class="type">int</span>&#123;nextX, nextY&#125;)</span><br><span class="line">					visited[nextX][nextY] = <span class="literal">true</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	ret := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">			<span class="keyword">if</span> visited[i][j] == <span class="literal">false</span> &amp;&amp; grid[i][j] == <span class="string">&#x27;1&#x27;</span> &#123;</span><br><span class="line">				ret++</span><br><span class="line">				bfs(i, j)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Graph</tag>
        <tag>dfs</tag>
        <tag>bfs</tag>
      </tags>
  </entry>
  <entry>
    <title>Graph-LC417</title>
    <url>/2023/09/03/Graph-LC417/</url>
    <content><![CDATA[<h1 id="Leetcode-417-dfs"><a href="#Leetcode-417-dfs" class="headerlink" title="Leetcode 417-dfs"></a>Leetcode 417-<code>dfs</code></h1><h2 id="Pacific-Atlantic-Water-Flow"><a href="#Pacific-Atlantic-Water-Flow" class="headerlink" title="Pacific Atlantic Water Flow"></a><a href="https://leetcode.cn/problems/pacific-atlantic-water-flow/">Pacific Atlantic Water Flow</a></h2><p><em>Becase of method of DFS and BFS are Similar,</em><br><em>therefore using dfs to solve this problem</em></p>
<p>There is an <code>m x n</code> rectangular(çŸ©å½¢) island<br>that borders both the <strong>Pacific Ocean</strong>(å¤ªå¹³æ´‹) and <strong>Atlantic Ocean</strong>(å¤§è¥¿æ´‹).<br>The <strong>Pacific Ocean</strong> touches the islandâ€™s left and top edges,<br>and the <strong>Atlantic Ocean</strong> touches the islandâ€™s right and bottom edges.</p>
<p>The island is partitioned into a grid of square cells.<br>You are given an <code>m x n</code> integer matrix <code>heights</code><br>where <code>heights[r][c]</code> represents the <strong>height above sea level</strong> of<br>the cell at coordinate(åæ ‡) <code>(r, c)</code>.</p>
<p>The island receives a lot of rain,<br>and the rain water can flow to neighboring cells directly north, south, east, and west<br>if the neighboring cellâ€™s height is <strong>less than or equal to</strong> the current cellâ€™s height.<br>Water can flow from any cell adjacent to an ocean into the ocean.</p>
<p>Return <em>a <strong>2D list</strong> of grid coordinates</em> <code>result</code><br><em>where</em> <code>result[i] = [ri, ci]</code> denotes that<br><em>rain water can flow from cell</em> <code>(ri, ci)</code> <em>to <strong>both</strong> the Pacific and Atlantic oceans</em>. </p>
<span id="more"></span>



<p><img src="/./../pic/Graph-LC417/image-20230903183542427.png" alt="image-20230903183542427"></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Input: heights = [[1,2,2,3,5],[3,2,3,4,4],[2,4,5,3,1],[6,7,1,4,5],[5,1,1,2,4]]</span><br><span class="line">Output: [[0,4],[1,3],[1,4],[2,2],[3,0],[3,1],[4,0]]</span><br><span class="line">Explanation: The following cells can flow to the Pacific and Atlantic oceans, as shown below:</span><br><span class="line">[0,4]: [0,4] -&gt; Pacific Ocean </span><br><span class="line">       [0,4] -&gt; Atlantic Ocean</span><br><span class="line">[1,3]: [1,3] -&gt; [0,3] -&gt; Pacific Ocean </span><br><span class="line">       [1,3] -&gt; [1,4] -&gt; Atlantic Ocean</span><br><span class="line">[1,4]: [1,4] -&gt; [1,3] -&gt; [0,3] -&gt; Pacific Ocean </span><br><span class="line">       [1,4] -&gt; Atlantic Ocean</span><br><span class="line">[2,2]: [2,2] -&gt; [1,2] -&gt; [0,2] -&gt; Pacific Ocean </span><br><span class="line">       [2,2] -&gt; [2,3] -&gt; [2,4] -&gt; Atlantic Ocean</span><br><span class="line">[3,0]: [3,0] -&gt; Pacific Ocean </span><br><span class="line">       [3,0] -&gt; [4,0] -&gt; Atlantic Ocean</span><br><span class="line">[3,1]: [3,1] -&gt; [3,0] -&gt; Pacific Ocean </span><br><span class="line">       [3,1] -&gt; [4,1] -&gt; Atlantic Ocean</span><br><span class="line">[4,0]: [4,0] -&gt; Pacific Ocean </span><br><span class="line">       [4,0] -&gt; Atlantic Ocean</span><br><span class="line">Note that there are other possible paths for these cells to flow to the Pacific and Atlantic oceans.</span><br></pre></td></tr></table></figure>

<h2 id="Resolution"><a href="#Resolution" class="headerlink" title="Resolution"></a>Resolution</h2><p>è¿™é“é¢˜è‹±è¯­çœ‹çš„æˆ‘å¤´ç–¼,æˆ‘å¤§æ¦‚æè¿°ä¸€ä¸‹<br>æµå‘å¤ªå¹³æ´‹åªèƒ½å‘å·¦å‘ä¸Š<br>æµå‘å¤§è¥¿æ´‹åªèƒ½å‘å³å‘ä¸‹<br>ä»å¤ªå¹³æ´‹è¾¹ä¸Šçš„èŠ‚ç‚¹ é€†æµè€Œä¸Šï¼Œå°†éå†è¿‡çš„èŠ‚ç‚¹éƒ½æ ‡è®°ä¸Šã€‚<br>ä»å¤§è¥¿æ´‹çš„è¾¹ä¸ŠèŠ‚ç‚¹ é€†æµè€Œé•¿ï¼Œå°†éå†è¿‡çš„èŠ‚ç‚¹ä¹Ÿæ ‡è®°ä¸Šã€‚<br>ç„¶åä¸¤æ–¹éƒ½æ ‡è®°è¿‡çš„èŠ‚ç‚¹å°±æ˜¯æ—¢å¯ä»¥æµå¤ªå¹³æ´‹ä¹Ÿå¯ä»¥æµå¤§è¥¿æ´‹çš„èŠ‚ç‚¹ã€‚<br>resultæ˜¯ä¸€ä¸ªåŒ…å«å¯è¡Œç‚¹çš„äºŒç»´æ•°ç»„</p>
<p>ç”±äºdfså’Œbfsåªæ˜¯å¤„ç†æ–¹å¼ä¸ä¸€æ ·,å…¶ä»–çš„æ€»ä½“ä»£ç å¤§åŒå°å¼‚<br>æ‰€ä»¥åªå†™dfs</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">pacificAtlantic</span><span class="params">(heights [][]<span class="type">int</span>)</span></span> [][]<span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> ret [][]<span class="type">int</span></span><br><span class="line">	<span class="keyword">var</span> dir = [<span class="number">4</span>][<span class="number">2</span>]<span class="type">int</span>&#123;&#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;&#125;</span><br><span class="line">	n, m := <span class="built_in">len</span>(heights), <span class="built_in">len</span>(heights[<span class="number">0</span>])</span><br><span class="line">	pacific, atlantic := <span class="built_in">make</span>([][]<span class="type">bool</span>, n), <span class="built_in">make</span>([][]<span class="type">bool</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="keyword">range</span> pacific &#123;</span><br><span class="line">		pacific[i], atlantic[i] = <span class="built_in">make</span>([]<span class="type">bool</span>, m), <span class="built_in">make</span>([]<span class="type">bool</span>, m)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> dfs <span class="function"><span class="keyword">func</span><span class="params">(visited [][]<span class="type">bool</span>, x, y <span class="type">int</span>)</span></span></span><br><span class="line">	dfs = <span class="function"><span class="keyword">func</span><span class="params">(visited [][]<span class="type">bool</span>, x, y <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">		<span class="keyword">if</span> visited[x][y] &#123;</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		visited[x][y] = <span class="literal">true</span></span><br><span class="line">		<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">4</span>; i++ &#123;</span><br><span class="line">			nextX := x + dir[i][<span class="number">0</span>]</span><br><span class="line">			nextY := y + dir[i][<span class="number">1</span>]</span><br><span class="line">			<span class="keyword">if</span> nextX &lt; <span class="number">0</span> || nextY &lt; <span class="number">0</span> || nextX &gt;= n || nextY &gt;= m &#123;</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> heights[nextX][nextY] &gt;= heights[x][y] &#123;</span><br><span class="line">				dfs(visited, nextX, nextY)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">		ç”¨äºéå†çŸ©é˜µçš„è¡Œ(ä»ä¸Šåˆ°ä¸‹)</span></span><br><span class="line"><span class="comment">		è°ƒç”¨ dfs å‡½æ•°æ ‡è®°ä»å½“å‰è¡Œçš„ç¬¬ä¸€åˆ—å‡ºå‘å¯ä»¥æµå‘å¤ªå¹³æ´‹çš„å•å…ƒæ ¼ï¼Œå³(i, 0)è¿™ä¸ªå•å…ƒæ ¼</span></span><br><span class="line"><span class="comment">		è°ƒç”¨ dfs å‡½æ•°æ ‡è®°ä»å½“å‰è¡Œçš„æœ€åä¸€åˆ—å‡ºå‘å¯ä»¥æµå‘å¤§è¥¿æ´‹çš„å•å…ƒæ ¼ï¼Œå³(i, m-1)è¿™ä¸ªå•å…ƒæ ¼</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		dfs(pacific, i, <span class="number">0</span>)</span><br><span class="line">		dfs(atlantic, i, m<span class="number">-1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">		ç”¨äºéå†çŸ©é˜µçš„åˆ—(ä»å·¦åˆ°å³)</span></span><br><span class="line"><span class="comment">		è°ƒç”¨ dfs å‡½æ•°æ ‡è®°ä»å½“å‰åˆ—çš„ç¬¬ä¸€è¡Œå‡ºå‘å¯ä»¥æµå‘å¤ªå¹³æ´‹çš„å•å…ƒæ ¼ï¼Œå³ (0, j) è¿™ä¸ªå•å…ƒæ ¼ã€‚</span></span><br><span class="line"><span class="comment">		è°ƒç”¨ dfs å‡½æ•°æ ‡è®°ä»å½“å‰åˆ—çš„æœ€åä¸€è¡Œä¸€è¡Œå‡ºå‘å¯ä»¥æµå‘å¤ªå¹³æ´‹çš„å•å…ƒæ ¼ï¼Œå³ (n-1, j) è¿™ä¸ªå•å…ƒæ ¼ã€‚</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">		dfs(pacific, <span class="number">0</span>, j)</span><br><span class="line">		dfs(atlantic, n<span class="number">-1</span>, j)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">			<span class="keyword">if</span> pacific[i][j] &amp;&amp; atlantic[i][j] &#123;</span><br><span class="line">				ret = <span class="built_in">append</span>(ret, []<span class="type">int</span>&#123;i, j&#125;)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Graph</tag>
        <tag>dfs</tag>
      </tags>
  </entry>
  <entry>
    <title>Graph-LC463</title>
    <url>/2023/09/04/Graph-LC463/</url>
    <content><![CDATA[<h1 id="463Island-Perimeter"><a href="#463Island-Perimeter" class="headerlink" title="463Island Perimeter"></a><a href="https://leetcode.cn/problems/island-perimeter/">463Island Perimeter</a></h1><p>You are given <code>row x col</code> <code>grid</code> representing a map where <code>grid[i][j] = 1</code> represents land and <code>grid[i][j] = 0</code> represents water.</p>
<p>Grid cells are connected <strong>horizontally&#x2F;vertically</strong> (not diagonally). The <code>grid</code> is completely surrounded by water, and there is exactly one island (i.e., one or more connected land cells).</p>
<p>The island doesnâ€™t have â€œlakesâ€, meaning the water inside isnâ€™t connected to the water around the island. One cell is a square with side length 1. The grid is rectangular, width and height donâ€™t exceed 100. Determine the perimeter of the island.</p>
<span id="more"></span> 

<p><strong>Example 1:</strong></p>
<p><img src="/./../pic/Graph-LC463/island.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: grid = [[0,1,0,0],[1,1,1,0],[0,1,0,0],[1,1,0,0]]</span><br><span class="line">Output: 16</span><br><span class="line">Explanation: The perimeter is the 16 yellow stripes in the image above.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: grid = [[1]]</span><br><span class="line">Output: 4</span><br></pre></td></tr></table></figure>

<p><strong>Example 3:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: grid = [[1,0]]</span><br><span class="line">Output: 4</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>row == grid.length</code></li>
<li><code>col == grid[i].length</code></li>
<li><code>1 &lt;= row, col &lt;= 100</code></li>
<li><code>grid[i][j]</code> is <code>0</code> or <code>1</code>.</li>
<li>There is exactly one island in <code>grid</code>.</li>
</ul>
<h2 id="Resolution"><a href="#Resolution" class="headerlink" title="Resolution"></a>Resolution</h2><h3 id="When-contacting-boundary-and-water-result"><a href="#When-contacting-boundary-and-water-result" class="headerlink" title="When contacting boundary and water , result++"></a>When contacting boundary and water , result++</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">islandPerimeter</span><span class="params">(grid [][]<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	dir := [<span class="number">4</span>][<span class="number">2</span>]<span class="type">int</span>&#123;&#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;&#125;</span><br><span class="line">	n, m := <span class="built_in">len</span>(grid), <span class="built_in">len</span>(grid[<span class="number">0</span>])</span><br><span class="line">	ret := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">			<span class="keyword">if</span> grid[i][j] == <span class="number">1</span> &#123;</span><br><span class="line">				<span class="keyword">for</span> k := <span class="number">0</span>; k &lt; <span class="number">4</span>; k++ &#123;</span><br><span class="line">					nx := i + dir[k][<span class="number">0</span>]</span><br><span class="line">					ny := j + dir[k][<span class="number">1</span>]</span><br><span class="line">					<span class="keyword">if</span> nx &lt; <span class="number">0</span> || ny &lt; <span class="number">0</span> || nx &gt;= n || ny &gt;= m || grid[nx][ny] == <span class="number">0</span> &#123;</span><br><span class="line">						ret++</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ANS-AllGripNums-4-adjacentGrip-2"><a href="#ANS-AllGripNums-4-adjacentGrip-2" class="headerlink" title="ANS&#x3D;AllGripNums * 4 - adjacentGrip * 2"></a>ANS&#x3D;AllGripNums * 4 - adjacentGrip * 2</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">islandPerimeter</span><span class="params">(grid [][]<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	sum, adjacent := <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">	n, m := <span class="built_in">len</span>(grid), <span class="built_in">len</span>(grid[<span class="number">0</span>])</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">			<span class="keyword">if</span> grid[i][j] == <span class="number">1</span> &#123;</span><br><span class="line">				sum++</span><br><span class="line">				<span class="keyword">if</span> i<span class="number">-1</span> &gt;= <span class="number">0</span> &amp;&amp; grid[i<span class="number">-1</span>][j] == <span class="number">1</span> &#123;</span><br><span class="line">					adjacent++</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> j<span class="number">-1</span> &gt;= <span class="number">0</span> &amp;&amp; grid[i][j<span class="number">-1</span>] == <span class="number">1</span> &#123;</span><br><span class="line">					adjacent++</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> sum*<span class="number">4</span> - adjacent*<span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Graph</tag>
      </tags>
  </entry>
  <entry>
    <title>Graph-LC685(can&#39;t solve)</title>
    <url>/2023/09/04/Graph-LC685/</url>
    <content><![CDATA[<h1 id="685Redundant-Connection-II"><a href="#685Redundant-Connection-II" class="headerlink" title="685Redundant Connection II"></a><a href="https://leetcode.cn/problems/redundant-connection-ii/">685Redundant Connection II</a></h1><p><strong>I am stupid  canâ€™t do solve this</strong><br><strong>canâ€™t even distinguish out the difference with 684</strong></p>
<p>In this problem, a rooted tree is a <strong>directed</strong> graph such that, there is exactly one node (the root) for which all other nodes are descendants of this node, plus every node has exactly one parent, except for the root node which has no parents.</p>
<p>The given input is a directed graph that started as a rooted tree with <code>n</code> nodes (with distinct values from <code>1</code> to <code>n</code>), with one additional directed edge added. The added edge has two different vertices chosen from <code>1</code> to <code>n</code>, and was not an edge that already existed.</p>
<p>The resulting graph is given as a 2D-array of <code>edges</code>. Each element of <code>edges</code> is a pair <code>[ui, vi]</code> that represents a <strong>directed</strong> edge connecting nodes <code>ui</code> and <code>vi</code>, where <code>ui</code> is a parent of child <code>vi</code>.</p>
<p>Return <em>an edge that can be removed so that the resulting graph is a rooted tree of</em> <code>n</code> <em>nodes</em>. If there are multiple answers, return the answer that occurs last in the given 2D-array.</p>
 <span id="more"></span>

<p><strong>Example 1:</strong></p>
<p><img src="/./../pic/Graph-LC685/graph1.jpg" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: edges = [[1,2],[1,3],[2,3]]</span><br><span class="line">Output: [2,3]</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<p><img src="/./../pic/Graph-LC685/graph2.jpg" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: edges = [[1,2],[2,3],[3,4],[4,1],[1,5]]</span><br><span class="line">Output: [4,1]</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>n == edges.length</code></li>
<li><code>3 &lt;= n &lt;= 1000</code></li>
<li><code>edges[i].length == 2</code></li>
<li><code>1 &lt;= ui, vi &lt;= n</code></li>
<li><code>ui != vi</code></li>
</ul>
<h2 id="Resolution"><a href="#Resolution" class="headerlink" title="Resolution"></a>Resolution</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">I am stupid</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>DSU</tag>
        <tag>Graph</tag>
      </tags>
  </entry>
  <entry>
    <title>Graph-LC684</title>
    <url>/2023/09/04/Graph-LC684/</url>
    <content><![CDATA[<h1 id="Redundant-Connection"><a href="#Redundant-Connection" class="headerlink" title="Redundant Connection"></a><a href="https://leetcode.cn/problems/redundant-connection/">Redundant Connection</a></h1><p>In this problem, a tree is an <strong>undirected graph</strong> that is connected and has no cycles.</p>
<p>You are given a graph that started as a tree with <code>n</code> nodes labeled from <code>1</code> to <code>n</code>, with one additional edge added. The added edge has two <strong>different</strong> vertices chosen from <code>1</code> to <code>n</code>, and was not an edge that already existed. The graph is represented as an array <code>edges</code> of length <code>n</code> where <code>edges[i] = [ai, bi]</code> indicates that there is an edge between nodes <code>ai</code> and <code>bi</code> in the graph.</p>
<p>Return <em>an edge that can be removed so that the resulting graph is a tree of</em> <code>n</code> <em>nodes</em>. If there are multiple answers, return the answer that occurs last in the input.</p>
<span id="more"></span>



<p><strong>Example 1:</strong></p>
<p><img src="/./../pic/Graph-LC684/reduntant1-1-graph.jpg" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: edges = [[1,2],[1,3],[2,3]]</span><br><span class="line">Output: [2,3]</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<p><img src="/./../pic/Graph-LC684/reduntant1-2-graph.jpg" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: edges = [[1,2],[2,3],[3,4],[1,4],[1,5]]</span><br><span class="line">Output: [1,4]</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>n == edges.length</code></li>
<li><code>3 &lt;= n &lt;= 1000</code></li>
<li><code>edges[i].length == 2</code></li>
<li><code>1 &lt;= ai &lt; bi &lt;= edges.length</code></li>
<li><code>ai != bi</code></li>
<li>There are no repeated edges.</li>
<li>The given graph is connected.</li>
</ul>
<h2 id="Resolution"><a href="#Resolution" class="headerlink" title="Resolution"></a>Resolution</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">findRedundantConnection</span><span class="params">(edges [][]<span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> d DSU</span><br><span class="line">	d.Init(<span class="number">1005</span>)</span><br><span class="line">	<span class="keyword">for</span> _, edge := <span class="keyword">range</span> edges &#123;</span><br><span class="line">		<span class="keyword">if</span> d.IsSame(edge[<span class="number">0</span>], edge[<span class="number">1</span>]) &#123;</span><br><span class="line">			<span class="keyword">return</span> edge</span><br><span class="line">		&#125;</span><br><span class="line">		d.Union(edge[<span class="number">1</span>], edge[<span class="number">0</span>])</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> []<span class="type">int</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> DSU <span class="keyword">struct</span> &#123;</span><br><span class="line">	Father []<span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d *DSU)</span></span> Init(n <span class="type">int</span>) &#123;</span><br><span class="line">	d.Father = <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		d.Father[i] = i</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d *DSU)</span></span> Union(i, j <span class="type">int</span>) &#123;</span><br><span class="line">	iFather := d.Find(i)</span><br><span class="line">	jFather := d.Find(j)</span><br><span class="line">	<span class="keyword">if</span> iFather == jFather &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	d.Father[iFather] = jFather</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d *DSU)</span></span> Find(i <span class="type">int</span>) <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> i == d.Father[i] &#123;</span><br><span class="line">		<span class="keyword">return</span> i</span><br><span class="line">	&#125;</span><br><span class="line">	d.Father[i] = d.Find(d.Father[i])</span><br><span class="line">	<span class="keyword">return</span> d.Father[i]</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d *DSU)</span></span> IsSame(i, j <span class="type">int</span>) <span class="type">bool</span> &#123;</span><br><span class="line">	iFather := d.Find(i)</span><br><span class="line">	jFather := d.Find(j)</span><br><span class="line">	<span class="keyword">return</span> iFather == jFather</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>DSU</tag>
        <tag>Graph</tag>
      </tags>
  </entry>
  <entry>
    <title>Graph-LC695</title>
    <url>/2023/09/03/Graph-LC695/</url>
    <content><![CDATA[<h1 id="Leetcode-695-dfs-and-bfs"><a href="#Leetcode-695-dfs-and-bfs" class="headerlink" title="Leetcode 695-dfs and bfs"></a>Leetcode 695-<code>dfs</code> and <code>bfs</code></h1><h2 id="Max-Area-of-Island"><a href="#Max-Area-of-Island" class="headerlink" title="Max Area of Island"></a><a href="https://leetcode.cn/problems/max-area-of-island/">Max Area of Island</a></h2><p>You are given an <code>m x n</code> binary matrix <code>grid</code>. An island is a group of <code>1</code>â€˜s (representing land) connected <strong>4-directionally</strong> (horizontal or vertical.) You may assume all four edges of the grid are surrounded by water.</p>
<p>The <strong>area</strong> of an island is the number of cells with a value <code>1</code> in the island.</p>
<p>Return <em>the maximum <strong>area</strong> of an island in</em> <code>grid</code>. If there is no island, return <code>0</code>.</p>
 <span id="more"></span>

<p><img src="/./../pic/Graph-LC695/image-20230903105407377.png" alt="image-20230903105407377"></p>
<figure class="highlight latex"><table><tr><td class="code"><pre><span class="line">nput: grid = [[0,0,1,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,0,0,1,1,1,0,0,0],[0,1,1,0,1,0,0,0,0,0,0,0,0],[0,1,0,0,1,1,0,0,1,0,1,0,0],[0,1,0,0,1,1,0,0,1,1,1,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,0],[0,0,0,0,0,0,0,1,1,1,0,0,0],[0,0,0,0,0,0,0,1,1,0,0,0,0]]</span><br><span class="line">Output: 6</span><br><span class="line">Explanation: The answer is not 11, because the island must be connected 4-directionally.</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>m == grid.length</code></li>
<li><code>n == grid[i].length</code></li>
<li><code>1 &lt;= m, n &lt;= 50</code></li>
<li><code>grid[i][j]</code> is either <code>0</code> or <code>1</code>.</li>
</ul>
<h2 id="Resolution"><a href="#Resolution" class="headerlink" title="Resolution"></a>Resolution</h2><h3 id="dfs"><a href="#dfs" class="headerlink" title="dfs"></a>dfs</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">maxAreaOfIsland</span><span class="params">(grid [][]<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	n, m := <span class="built_in">len</span>(grid), <span class="built_in">len</span>(grid[<span class="number">0</span>])</span><br><span class="line">	visited := <span class="built_in">make</span>([][]<span class="type">bool</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="keyword">range</span> grid &#123;</span><br><span class="line">		visited[i] = <span class="built_in">make</span>([]<span class="type">bool</span>, m)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// four directions</span></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">		&#123;0, 1&#125;  to right: col+1</span></span><br><span class="line"><span class="comment">		&#123;1, 0&#125; 	to down: row+1</span></span><br><span class="line"><span class="comment">		&#123;-1, 0&#125;	to up: row-1ã€‚</span></span><br><span class="line"><span class="comment">		&#123;0, -1&#125; to left: col-1</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="keyword">var</span> dir = [<span class="number">4</span>][<span class="number">2</span>]<span class="type">int</span>&#123;&#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;&#125;</span><br><span class="line">	count, ret := <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">	<span class="comment">//dfs func</span></span><br><span class="line">	<span class="keyword">var</span> dfs <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">int</span>)</span></span></span><br><span class="line">	dfs = <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">		<span class="comment">//visited or ocean</span></span><br><span class="line">		<span class="keyword">if</span> visited[x][y] == <span class="literal">true</span> || grid[x][y] == <span class="number">0</span> &#123;</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		visited[x][y] = <span class="literal">true</span></span><br><span class="line">		count++</span><br><span class="line">		<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">4</span>; i++ &#123;</span><br><span class="line">			nextX := x + dir[i][<span class="number">0</span>]</span><br><span class="line">			nextY := y + dir[i][<span class="number">1</span>]</span><br><span class="line">			<span class="keyword">if</span> nextX &lt; <span class="number">0</span> || nextX &gt;= n || nextY &lt; <span class="number">0</span> || nextY &gt;= m &#123;</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			&#125;</span><br><span class="line">			dfs(nextX, nextY)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">			<span class="keyword">if</span> visited[i][j] == <span class="literal">false</span> &amp;&amp; grid[i][j] == <span class="number">1</span> &#123;</span><br><span class="line">				count = <span class="number">0</span></span><br><span class="line">				dfs(i, j)</span><br><span class="line">				ret = max(ret, count)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">max</span><span class="params">(a, b <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;<span class="keyword">if</span> a &gt; b &#123;<span class="keyword">return</span> a&#125;;<span class="keyword">return</span> b&#125;</span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br></pre></td></tr></table></figure>

<h3 id="bfs"><a href="#bfs" class="headerlink" title="bfs"></a>bfs</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">maxAreaOfIsland</span><span class="params">(grid [][]<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	n, m := <span class="built_in">len</span>(grid), <span class="built_in">len</span>(grid[<span class="number">0</span>])</span><br><span class="line">	visited := <span class="built_in">make</span>([][]<span class="type">bool</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="keyword">range</span> grid &#123;</span><br><span class="line">		visited[i] = <span class="built_in">make</span>([]<span class="type">bool</span>, m)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">var</span> dir = [<span class="number">4</span>][<span class="number">2</span>]<span class="type">int</span>&#123;&#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;&#125;</span><br><span class="line">	count, ret := <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> bfs <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">int</span>)</span></span></span><br><span class="line">	bfs = <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">		que := list.New()</span><br><span class="line">		<span class="comment">//que.PushBack([2]int&#123;x, y&#125;)</span></span><br><span class="line">		que.PushBack(x)</span><br><span class="line">		que.PushBack(y)</span><br><span class="line">		visited[x][y] = <span class="literal">true</span></span><br><span class="line">		count++</span><br><span class="line">		<span class="keyword">for</span> que.Len() != <span class="number">0</span> &#123;</span><br><span class="line">            <span class="comment">//cur := que.Remove(que.Front()).([2]int)</span></span><br><span class="line">			<span class="comment">//curx, cury := cur[0], cur[1]</span></span><br><span class="line">			curx := que.Remove(que.Front()).(<span class="type">int</span>)</span><br><span class="line">			cury := que.Remove(que.Front()).(<span class="type">int</span>)</span><br><span class="line">			<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">4</span>; i++ &#123;</span><br><span class="line">				nextX := curx + dir[i][<span class="number">0</span>]</span><br><span class="line">				nextY := cury + dir[i][<span class="number">1</span>]</span><br><span class="line">				<span class="keyword">if</span> nextX &lt; <span class="number">0</span> || nextX &gt;= n || nextY &lt; <span class="number">0</span> || nextY &gt;= m &#123;</span><br><span class="line">					<span class="keyword">continue</span></span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> visited[nextX][nextY] == <span class="literal">false</span> &amp;&amp; grid[nextX][nextY] == <span class="number">1</span> &#123;</span><br><span class="line">					count++</span><br><span class="line">                    <span class="comment">//que.PushBack([2]int&#123;nextX, nextY&#125;)</span></span><br><span class="line">					que.PushBack(nextX)</span><br><span class="line">					que.PushBack(nextY)</span><br><span class="line">					visited[nextX][nextY] = <span class="literal">true</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">			<span class="keyword">if</span> visited[i][j] == <span class="literal">false</span> &amp;&amp; grid[i][j] == <span class="number">1</span> &#123;</span><br><span class="line">				count = <span class="number">0</span></span><br><span class="line">				bfs(i, j)</span><br><span class="line">				ret = max(ret, count)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">max</span><span class="params">(a, b <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> a &gt; b &#123;</span><br><span class="line">		<span class="keyword">return</span> a</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Graph</tag>
        <tag>dfs</tag>
        <tag>bfs</tag>
      </tags>
  </entry>
  <entry>
    <title>Graph-LC827</title>
    <url>/2023/09/04/Graph-LC827/</url>
    <content><![CDATA[<h1 id="Making-A-Large-Island"><a href="#Making-A-Large-Island" class="headerlink" title="Making A Large Island"></a><a href="https://leetcode.cn/problems/making-a-large-island/">Making A Large Island</a></h1><p>You are given an <code>n x n</code> binary matrix <code>grid</code>. You are allowed to change <strong>at most one</strong> <code>0</code> to be <code>1</code>.</p>
<p>Return <em>the size of the largest <strong>island</strong> in</em> <code>grid</code> <em>after applying this operation</em>.</p>
<p>An <strong>island</strong> is a 4-directionally connected group of <code>1</code>s.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Input: grid = [[1,0],[0,1]]</span><br><span class="line">Output: 3</span><br><span class="line">Explanation: Change one 0 to 1 and connect two 1s, then we get an island with area = 3.</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<p><strong>Example 2:</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Input: grid = [[1,1],[1,0]]</span><br><span class="line">Output: 4</span><br><span class="line">Explanation: Change the 0 to 1 and make the island bigger, only one island with area = 4.</span><br></pre></td></tr></table></figure>

<p><strong>Example 3:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: grid = [[1,1],[1,1]]</span><br><span class="line">Output: 4</span><br><span class="line">Explanation: Can&#x27;t change any 0 to 1, only one island with area = 4.</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>n == grid.length</code></li>
<li><code>n == grid[i].length</code></li>
<li><code>1 &lt;= n &lt;= 500</code></li>
<li><code>grid[i][j]</code> is either <code>0</code> or <code>1</code>.</li>
</ul>
<h2 id="Resolution"><a href="#Resolution" class="headerlink" title="Resolution"></a>Resolution</h2><p>Traverse each square, and record it by numbering.<br>use hashmap records, key is the island number, value is the island area </p>
<p>After traversing, traverse the square of 0 (want to turn 0 into 1),<br>count surrounding islands of 1 (which from 0 to 1),<br>add its near areas together,<br>after traversing all 0,<br>get the maximum area after selecting a 0 into 1</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">largestIsland</span><span class="params">(grid [][]<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	n, m := <span class="built_in">len</span>(grid), <span class="built_in">len</span>(grid[<span class="number">0</span>])</span><br><span class="line">	dir := [<span class="number">4</span>][<span class="number">2</span>]<span class="type">int</span>&#123;&#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;&#125;</span><br><span class="line">	visited := <span class="built_in">make</span>([][]<span class="type">bool</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="keyword">range</span> visited &#123;</span><br><span class="line">		visited[i] = <span class="built_in">make</span>([]<span class="type">bool</span>, m)</span><br><span class="line">	&#125;</span><br><span class="line">	count := <span class="number">0</span></span><br><span class="line">	ret := <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//traverse all,mark and count the areas</span></span><br><span class="line">	<span class="keyword">var</span> dfs <span class="function"><span class="keyword">func</span><span class="params">(x, y, mark <span class="type">int</span>)</span></span></span><br><span class="line">	dfs = <span class="function"><span class="keyword">func</span><span class="params">(x, y, mark <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">		<span class="keyword">if</span> visited[x][y] == <span class="literal">true</span> || grid[x][y] == <span class="number">0</span> &#123;</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		visited[x][y] = <span class="literal">true</span></span><br><span class="line">        <span class="comment">//mark each individual grid</span></span><br><span class="line">		grid[x][y] = mark</span><br><span class="line">        <span class="comment">//count areas</span></span><br><span class="line">		count++</span><br><span class="line">		<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">4</span>; i++ &#123;</span><br><span class="line">			nx := x + dir[i][<span class="number">0</span>]</span><br><span class="line">			ny := y + dir[i][<span class="number">1</span>]</span><br><span class="line">			<span class="keyword">if</span> nx &lt; <span class="number">0</span> || ny &lt; <span class="number">0</span> || nx &gt;= n || ny &gt;= m &#123;</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			&#125;</span><br><span class="line">			dfs(nx, ny, mark)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">//key is the island number, value is the island area </span></span><br><span class="line">	gridNum := <span class="keyword">map</span>[<span class="type">int</span>]<span class="type">int</span>&#123;&#125;</span><br><span class="line">	mark := <span class="number">2</span></span><br><span class="line">	isAllgrid := <span class="literal">true</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">            <span class="comment">//the grid has ocean</span></span><br><span class="line">			<span class="keyword">if</span> grid[i][j] == <span class="number">0</span> &#123;</span><br><span class="line">				isAllgrid = <span class="literal">false</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> visited[i][j] == <span class="literal">false</span> &amp;&amp; grid[i][j] == <span class="number">1</span> &#123;</span><br><span class="line">				count = <span class="number">0</span></span><br><span class="line">				dfs(i, j, mark)</span><br><span class="line">				gridNum[mark] = count</span><br><span class="line">				mark++</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> isAllgrid &#123;</span><br><span class="line">		<span class="keyword">return</span> m * n</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//Traverse each 0 square, </span></span><br><span class="line">    <span class="comment">//count the area of its near grid, and finally take a maximum value.</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//mark the visited grip</span></span><br><span class="line">	visitedGrid := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">int</span>]<span class="type">bool</span>)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">			nums := <span class="number">1</span></span><br><span class="line">            <span class="comment">//make it empty</span></span><br><span class="line">			visitedGrid = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">int</span>]<span class="type">bool</span>)</span><br><span class="line">			<span class="keyword">if</span> grid[i][j] == <span class="number">0</span> &#123;</span><br><span class="line">				<span class="keyword">for</span> k := <span class="number">0</span>; k &lt; <span class="number">4</span>; k++ &#123;</span><br><span class="line">					nx := i + dir[k][<span class="number">0</span>]</span><br><span class="line">					ny := j + dir[k][<span class="number">1</span>]</span><br><span class="line">					<span class="keyword">if</span> nx &lt; <span class="number">0</span> || ny &lt; <span class="number">0</span> || nx &gt;= n || ny &gt;= m &#123;</span><br><span class="line">						<span class="keyword">continue</span></span><br><span class="line">					&#125;</span><br><span class="line">                    <span class="comment">//has marked</span></span><br><span class="line">					<span class="keyword">if</span> visitedGrid[grid[nx][ny]] &#123;</span><br><span class="line">						<span class="keyword">continue</span></span><br><span class="line">					&#125;</span><br><span class="line">					nums += gridNum[grid[nx][ny]]</span><br><span class="line">					visitedGrid[grid[nx][ny]] = <span class="literal">true</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> nums &gt; ret &#123;</span><br><span class="line">				ret = nums</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Graph</tag>
        <tag>dfs</tag>
      </tags>
  </entry>
  <entry>
    <title>Graph-LC841</title>
    <url>/2023/09/04/Graph-LC841/</url>
    <content><![CDATA[<h1 id="841Keys-and-Rooms"><a href="#841Keys-and-Rooms" class="headerlink" title="841Keys and Rooms"></a><a href="https://leetcode.cn/problems/keys-and-rooms/">841Keys and Rooms</a></h1><p>There are <code>n</code> rooms labeled from <code>0</code> to <code>n - 1</code> and all the rooms are locked except for room <code>0</code>. Your goal is to visit all the rooms. However, you cannot enter a locked room without having its key.</p>
<p>When you visit a room, you may find a set of <strong>distinct keys</strong> in it. Each key has a number on it, denoting which room it unlocks, and you can take all of them with you to unlock the other rooms.</p>
<p>Given an array <code>rooms</code> where <code>rooms[i]</code> is the set of keys that you can obtain if you visited room <code>i</code>, return <code>true</code> <em>if you can visit <strong>all</strong> the rooms, or</em> <code>false</code> <em>otherwise</em>.</p>
 <span id="more"></span>

<p><strong>Example 1:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: rooms = [[1],[2],[3],[]]</span><br><span class="line">Output: true</span><br><span class="line">Explanation: </span><br><span class="line">We visit room 0 and pick up key 1.</span><br><span class="line">We then visit room 1 and pick up key 2.</span><br><span class="line">We then visit room 2 and pick up key 3.</span><br><span class="line">We then visit room 3.</span><br><span class="line">Since we were able to visit every room, we return true.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: rooms = [[1,3],[3,0,1],[2],[0]]</span><br><span class="line">Output: false</span><br><span class="line">Explanation: We can not enter room number 2 since the only key that unlocks it is in that room.</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>n == rooms.length</code></li>
<li><code>2 &lt;= n &lt;= 1000</code></li>
<li><code>0 &lt;= rooms[i].length &lt;= 1000</code></li>
<li><code>1 &lt;= sum(rooms[i].length) &lt;= 3000</code></li>
<li><code>0 &lt;= rooms[i][j] &lt; n</code></li>
<li>All the values of <code>rooms[i]</code> are <strong>unique</strong>.</li>
</ul>
<h2 id="resolution"><a href="#resolution" class="headerlink" title="resolution"></a>resolution</h2><h3 id="dfs"><a href="#dfs" class="headerlink" title="dfs"></a>dfs</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">canVisitAllRoomsDFS</span><span class="params">(rooms [][]<span class="type">int</span>)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">	visited := <span class="built_in">make</span>([]<span class="type">bool</span>, <span class="built_in">len</span>(rooms))</span><br><span class="line">	<span class="keyword">var</span> dfs <span class="function"><span class="keyword">func</span><span class="params">(key <span class="type">int</span>)</span></span></span><br><span class="line">	dfs = <span class="function"><span class="keyword">func</span><span class="params">(key <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">		<span class="keyword">if</span> visited[key] &#123;</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		visited[key] = <span class="literal">true</span></span><br><span class="line">		keys := rooms[key]</span><br><span class="line">		<span class="keyword">for</span> _, key := <span class="keyword">range</span> keys &#123;</span><br><span class="line">			dfs(key)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	dfs(<span class="number">0</span>)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="keyword">range</span> rooms &#123;</span><br><span class="line">		<span class="keyword">if</span> !visited[i] &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="bfs"><a href="#bfs" class="headerlink" title="bfs"></a>bfs</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">canVisitAllRooms</span><span class="params">(rooms [][]<span class="type">int</span>)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">	visited := <span class="built_in">make</span>([]<span class="type">bool</span>, <span class="built_in">len</span>(rooms))</span><br><span class="line">	<span class="keyword">var</span> bfs <span class="function"><span class="keyword">func</span><span class="params">([][]<span class="type">int</span>)</span></span> <span class="type">bool</span></span><br><span class="line">	bfs = <span class="function"><span class="keyword">func</span><span class="params">(rooms [][]<span class="type">int</span>)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">		visited[<span class="number">0</span>] = <span class="literal">true</span></span><br><span class="line">		que := list.New()</span><br><span class="line">		que.PushBack(<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">for</span> que.Len() != <span class="number">0</span> &#123;</span><br><span class="line">			key := que.Remove(que.Front()).(<span class="type">int</span>)</span><br><span class="line">			keys := rooms[key]</span><br><span class="line">			<span class="keyword">for</span> _, key := <span class="keyword">range</span> keys &#123;</span><br><span class="line">				<span class="keyword">if</span> !visited[key] &#123;</span><br><span class="line">					que.PushBack(key)</span><br><span class="line">					visited[key] = <span class="literal">true</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> i := <span class="keyword">range</span> rooms &#123;</span><br><span class="line">			<span class="keyword">if</span> !visited[i] &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> bfs(rooms)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Graph</tag>
        <tag>dfs</tag>
        <tag>bfs</tag>
      </tags>
  </entry>
  <entry>
    <title>Graph-bfs</title>
    <url>/2023/09/02/Graph-bfs/</url>
    <content><![CDATA[<h1 id="BreadthFirstSearch"><a href="#BreadthFirstSearch" class="headerlink" title="BreadthFirstSearch"></a>BreadthFirstSearch</h1><h2 id="Quote-and-translate-from-Code-Caprice"><a href="#Quote-and-translate-from-Code-Caprice" class="headerlink" title="Quote and translate from  Code Caprice"></a>Quote and translate from  <em><strong><a href="https://programmercarl.com/">Code Caprice</a></strong></em></h2><p>BFS is always used to solve the shortest path problem between two vertices.<br>BFS starts from the starting vertex, the starting vertexis the center of the circle of search,<br>once the end point is encountered, the record of the previous node is the shortest road.</p>
<span id="more"></span>

<h2 id="The-process-of-BFS"><a href="#The-process-of-BFS" class="headerlink" title="The process of BFS"></a>The process of BFS</h2><p>BFS is a round-by-circle search process<br>using a square map,each direction of search is <code>up/down/right/left</code><br>then a start location is given,so BFS can take a step to the four directions</p>
<p><img src="/./../pic/Graph-bfs/image-20230902144715129.png" alt="image-20230902144715129"></p>
<p>Now set an <code>end</code> location,the process of <code>BFS</code> is following<br>From the start vertex,search circle by circle and inside out<br>the first step is the vertex holding <code>1</code><br>the second step is the vertex holding <code>2</code><br>when stepNum is <code>4</code>,has found the <code>end</code></p>
<p><img src="/./../pic/Graph-bfs/image-20230902144812331.png" alt="image-20230902144812331"></p>
<p>The way BFS traverses round by circle,<br>so once it encounters the <code>end</code> point, it must be the shortest path.<br>And the map can also have obstacles, as shown in the image:</p>
<p><img src="/./../pic/Graph-bfs/image-20230902150649652.png" alt="image-20230902150649652"></p>
<p>In the <code>5th</code> step, the <code>6th</code> step only dyed the key nodes<br>and the other directions did not dye<br>only needs to pay attention to the logic of dyeing in key places<br>As we can see from the pic, if obstacles are added,<br>the <code>6th</code> step to reach the end </p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><p>Based on LinkedList</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">bfs</span><span class="params">(grid [][]<span class="type">byte</span>, visited [][]<span class="type">bool</span>, x <span class="type">int</span>, y <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">    <span class="comment">// grid --&gt;map</span></span><br><span class="line">    <span class="comment">// vistied --&gt; value has been traverse</span></span><br><span class="line">    <span class="comment">// x,y --&gt; the start SearchNode&#x27;s index </span></span><br><span class="line">    <span class="comment">// Representing four directions (up left down right)</span></span><br><span class="line">	dir := [<span class="number">4</span>][<span class="number">2</span>]<span class="type">int</span>&#123;&#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">	queue := <span class="built_in">make</span>([][<span class="number">2</span>]<span class="type">int</span>, <span class="number">0</span>)          <span class="comment">// Define a queue</span></span><br><span class="line">	queue = <span class="built_in">append</span>(queue, [<span class="number">2</span>]<span class="type">int</span>&#123;x, y&#125;) <span class="comment">// Add the starting node to the queue</span></span><br><span class="line">	visited[x][y] = <span class="literal">true</span>                <span class="comment">// Mark the starting visitednode</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Start traversing elements in the queue</span></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">len</span>(queue) &gt; <span class="number">0</span> &#123; </span><br><span class="line">		cur := queue[<span class="number">0</span>]</span><br><span class="line">		queue = queue[<span class="number">1</span>:]            <span class="comment">// get an element from the queue</span></span><br><span class="line">		curx, cury := cur[<span class="number">0</span>], cur[<span class="number">1</span>] <span class="comment">// Current node coordinates</span></span><br><span class="line">		</span><br><span class="line">        <span class="comment">// Start traversing in four directions - left, right, up, and down</span></span><br><span class="line">		<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">4</span>; i++ &#123; </span><br><span class="line">            <span class="comment">// Get coordinates of the adjacent nodes</span></span><br><span class="line">			nextx := curx + dir[i][<span class="number">0</span>]</span><br><span class="line">			nexty := cury + dir[i][<span class="number">1</span>] </span><br><span class="line">            </span><br><span class="line">            <span class="comment">// Skip if the coordinate indexs are out of bounds</span></span><br><span class="line">			<span class="keyword">if</span> nextx &lt; <span class="number">0</span> || nextx &gt;= <span class="built_in">len</span>(grid) || nexty &lt; <span class="number">0</span> || nexty &gt;= <span class="built_in">len</span>(grid[<span class="number">0</span>]) &#123;</span><br><span class="line">				<span class="keyword">continue</span> </span><br><span class="line">			&#125;</span><br><span class="line">            </span><br><span class="line">			<span class="comment">// If the node hasn&#x27;t been visited</span></span><br><span class="line">			<span class="keyword">if</span> !visited[nextx][nexty] &#123; </span><br><span class="line">                <span class="comment">// Add the node to the queue for the next round of traversal</span></span><br><span class="line">				queue = <span class="built_in">append</span>(queue, [<span class="number">2</span>]<span class="type">int</span>&#123;nextx, nexty&#125;) </span><br><span class="line">                <span class="comment">// Mark it as visited immediately to avoid duplicates</span></span><br><span class="line">				visited[nextx][nexty] = <span class="literal">true</span>                </span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Graph</tag>
        <tag>bfs</tag>
      </tags>
  </entry>
  <entry>
    <title>Graph-dfs</title>
    <url>/2023/09/02/Graph-dfs/</url>
    <content><![CDATA[<h1 id="DepthFirstSearch"><a href="#DepthFirstSearch" class="headerlink" title="DepthFirstSearch"></a>DepthFirstSearch</h1><h2 id="Quote-and-translate-from-Code-Caprice"><a href="#Quote-and-translate-from-Code-Caprice" class="headerlink" title="Quote and translate from  Code Caprice"></a>Quote and translate from  <em><strong><a href="https://programmercarl.com/">Code Caprice</a></strong></em></h2><p><strong>A</strong> undirected graph that we want to search all pths form <code>vertex1</code> to <code>vertex6</code></p>
<p><img src="/./../pic/Graph-dfs/image01.png" alt="image-20230902105209987"></p>
<span id="more"></span>

<p><strong>T</strong>hen the first path of DFS search looks like this:<br>Assuming that the first time you extend the default direction, you find <code>vertex6</code></p>
<p><img src="/./../pic/Graph-dfs/image-20230902105329872.png" alt="image-20230902105329872"></p>
<p><strong>A</strong>t this time, we found <code>vertex6</code>, then we should search for other directions<br>so <code>Path2</code> reversed, changed direction, took <code>path3</code><br>and then also found the end <code>vertex6</code>. Then reversing <code>path2</code> and<br> changing it to <code>path3</code> is  the process of backtracking in DFS </p>
<p><img src="/./../pic/Graph-dfs/image-20230902105518919.png" alt="image-20230902105518919"></p>
<p><strong>F</strong>ind a path from <code>vertex1</code> to <code>vertex</code>6,<br>and then to the direction, and then turned back,<br> <code>path4</code> was withdrawn (the process of backtracking) and changed to <code>path5</code>.</p>
<p><img src="/./../pic/Graph-dfs/image-20230902110148371.png" alt="image-20230902110148371"></p>
<p><strong>F</strong>ind a path from <code>vertex1</code> to <code>vertex6</code>,<br>and then to the direction, at this time turned back,<br><code>path6</code> was undone (the process of backtracking),<br>changed to <code>path7</code>, <code>path8</code> and <code>path7</code>, <code>path9</code>,<br>and found that there was a dead end, all of which came to the node they walked.</p>
<p><img src="/./../pic/Graph-dfs/image-20230902110506611.png" alt="image-20230902110506611"></p>
<p><strong>T</strong>hen the path connected by <code>vertex2</code> and the path linked by <code>vertex3</code> have passed,<br>and the undo path can only be reversed upwards to choose to cancel the original choice of <code>vertex4</code>,<br>that is, cancel <code>path5</code> and change it to <code>path10</code></p>
<p><img src="/./../pic/Graph-dfs/image-20230902110709419.png" alt="image-20230902110709419"></p>
]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Graph</tag>
        <tag>dfs</tag>
      </tags>
  </entry>
  <entry>
    <title>GraphIntroduce</title>
    <url>/2023/09/01/Graph01/</url>
    <content><![CDATA[<h1 id="Graph"><a href="#Graph" class="headerlink" title="Graph"></a>Graph</h1><p>Start learning of Graph.<br>Mainly refer to the following booksã€ŠHello Algorithmã€‹ã€Šä»£ç éšæƒ³å½•ã€‹</p>
<span id="more"></span>

<h2 id="Introduce"><a href="#Introduce" class="headerlink" title="Introduce"></a>Introduce</h2><p><strong>Graph</strong><br>consists of an infinite non-empty set of vertices and a set of edges between vertices</p>
<p><img src="/./../pic/Graph/graph01.png" alt="graph01"></p>
<figure class="highlight mathematica"><table><tr><td class="code"><pre><span class="line"><span class="variable">V</span><span class="operator">=</span><span class="punctuation">&#123;</span><span class="number">1</span><span class="operator">,</span><span class="number">2</span><span class="operator">,</span><span class="number">3</span><span class="operator">,</span><span class="number">4</span><span class="operator">,</span><span class="number">5</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="built_in">E</span><span class="operator">=</span><span class="punctuation">&#123;</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">,</span><span class="number">2</span><span class="punctuation">)</span><span class="operator">,</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">,</span><span class="number">3</span><span class="punctuation">)</span><span class="operator">,</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">,</span><span class="number">5</span><span class="punctuation">)</span><span class="operator">,</span><span class="punctuation">(</span><span class="number">2</span><span class="operator">,</span><span class="number">3</span><span class="punctuation">)</span><span class="operator">,</span><span class="punctuation">(</span><span class="number">2</span><span class="operator">,</span><span class="number">4</span><span class="punctuation">)</span><span class="operator">,</span><span class="punctuation">(</span><span class="number">2</span><span class="operator">,</span><span class="number">5</span><span class="punctuation">)</span><span class="operator">,</span><span class="punctuation">(</span><span class="number">4</span><span class="operator">,</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="variable">G</span><span class="operator">=</span><span class="punctuation">&#123;</span><span class="variable">V</span><span class="operator">,</span><span class="built_in">E</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>Commonï¼š<strong>G(V,E)</strong></p>
<p><strong>G represents a graph</strong><br><strong>V is the set of vertices in figure G</strong><br><strong>E is the set of edges in Figure G</strong></p>
<p>In the data elements in the graph, we call them Vertex, the set of vertices is infinite and not empty. In a graph, there may be a relationship between any two vertices, the logical relationship between the vertices is represented by edges, and the edge set can be empty.</p>
<p>Graphs are divided into <strong>undirected graphs</strong> and <strong>directed graphs</strong> according to the direction of the edges.</p>
<ul>
<li>an undirected graph consists of vertices and edges,</li>
<li>A directed graph consists of vertices and arcs(å¼§). The arc is divided into an arc tail and an arc head, and the end with an arrow is the arc head.<img src="/./../pic/Graph/graph02.png" alt="graph02"></li>
</ul>
<p>According to whether the vertices are connected or not, it is divided into<br><strong>connected graph</strong> and  <strong>non-connected graph</strong> </p>
<ul>
<li><p>For connected graphs, from one vertex, you can reach any of the other vertices.</p>
</li>
<li><p>For non-connected graphs, at least one vertex is unreachable from a vertex.</p>
</li>
<li><p><img src="/./../pic/Graph/graph03.png" alt="image-20230901180215803"></p>
</li>
</ul>
<p>According to the weight, it is divided into <strong>power graph</strong> and  <strong>nopwer graph</strong></p>
<p><img src="/./../pic/Graph/graph04.png" alt="image-20230901180544716"></p>
<p>å›¾æ•°æ®ç»“æ„åŒ…å«ä»¥ä¸‹å¸¸ç”¨æœ¯è¯­ã€‚</p>
<ul>
<li><p>adjacencyï¼šin two vertices connectã€‚</p>
</li>
<li><p>pathï¼šthe path from VertexA to VertexB   </p>
</li>
<li><p>degreeï¼šThe number of edges owned by a vertex</p>
</li>
</ul>
<h2 id="Representation-of-the-figure"><a href="#Representation-of-the-figure" class="headerlink" title="Representation of the figure"></a>Representation of the figure</h2><p>Common representations of graphs include <strong>adjacency matrices</strong> and <strong>adjacency list</strong></p>
<h3 id="Adjacency-matrices"><a href="#Adjacency-matrices" class="headerlink" title="Adjacency matrices"></a>Adjacency matrices</h3><p>A graph holds vertices <code>n</code>ï¼Œadjacency matrices use <code>n*n</code> matrices implement graphï¼ŒEach row (column) represents a vertex,using element <code>1</code> or <code>0</code> denote wether vertices holding a path</p>
<p>adjacency matrices <code>M</code>ã€<code>vertices:V</code> ï¼Œmatrices element <code>M[i,j]=1</code> denote  vertex<code>V[i] </code> to vertex <code>V[j]</code> has a path<br>,so <code>M[i,j]=0</code>means there is no path in two vertices.</p>
<p><img src="/./../pic/Graph/graph05.png" alt="image-20230901181201339"></p>
<p>adjacency matrices has the following characteristics</p>
<ul>
<li>Vertices cannot be connected to themselves, so adjacency matrix main diagonal elements have no meaning.</li>
<li>For undirected graphs, the edges in both directions are the same power, where the adjacency matrix is symmetric with respect to the principal diagonal.<br>Replacing the elements of the adjacency matrix with weights from 1 and 0 represents a weight graph.</li>
</ul>
<h3 id="Adjacency-list"><a href="#Adjacency-list" class="headerlink" title="Adjacency list"></a>Adjacency list</h3><p> adjacency list use <code>n</code> linklist to implement graphï¼Œwhose node is used to implement vertex.<br>the <code>ith</code>linklisr is reflect the vertex <code>i</code> </p>
<p><img src="/./../pic/Graph/graph06.png" alt="image-20230901181618572"></p>
<p>The adjacency table only stores the edges that actually exist, and the total number of edges is usually much smaller than  â€˜ <code>O(n^2) </code>, so it is more space-efficient. However, in the adjacency table, it is necessary to traverse the linked list to find edges, so it is not as time-efficient as the adjacency matrix.</p>
<p>The adjacency table structure is very similar to the â€œchained addressâ€ in the hash table,<br> so we can also take a similar approach to optimize efficiency.<br>For example, when the linked list is long, the linked list can be converted into an <strong>AVL tree</strong> or a red-black tree,<br>thereby optimizing the time efficiency from <code>O(n) </code>to <code>O(logN)</code><br> It is also possible to convert a linked list to a hash table, thereby reducing the time complexity to <code>O(1)</code></p>
]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Graph</tag>
      </tags>
  </entry>
  <entry>
    <title>Graph-The basic operation of Graph</title>
    <url>/2023/09/01/Graph02/</url>
    <content><![CDATA[<h1 id="The-basic-operation-of-Graph"><a href="#The-basic-operation-of-Graph" class="headerlink" title="The basic operation of Graph"></a>The basic operation of Graph</h1><p>This Blog   use <strong>adjacency matrices</strong> and <strong>adjacency list</strong> to implement <strong>Graph</strong> in <code>Golang</code></p>
<span id="more"></span>

<h2 id="Adjacency-matrices"><a href="#Adjacency-matrices" class="headerlink" title="Adjacency matrices"></a><strong>Adjacency matrices</strong></h2><p>vertices <code>n</code>  non-direction Graph</p>
<ul>
<li><strong>Add&#x2F;Remove Edges</strong>ï¼šindirectly  revise dege in <strong>adjacency matrices</strong> ï¼Œ<code>O(1)</code> time-complexity</li>
<li><strong>Add Vertex</strong>ï¼šAdd a row and column at the end of the adjacency matrix and fill in all <code>0</code>, using the <code>O(n)</code> time-complexity.</li>
<li><strong>Remove Vertex</strong>ï¼šDelete a row and a column in the adjacency matrix. When the worst-case scenario is reached when the first row and column are removed, <code>(n-1)^2</code> elements need to be â€œmoved up leftâ€ to use the <code>O(n^2)</code>time.</li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// adjacency matrices implement Non-direcionGraph</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// graphArray</span></span><br><span class="line"><span class="keyword">type</span> graphArray <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">//verticesList</span></span><br><span class="line">	vertices []<span class="type">int</span></span><br><span class="line">	<span class="comment">//matrices</span></span><br><span class="line">	adjMat [][]<span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// newGraphArray Function of construction</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newGraphArray</span><span class="params">(vertices []<span class="type">int</span>, edges [][]<span class="type">int</span>)</span></span> *graphArray &#123;</span><br><span class="line">	<span class="comment">// construct matrices</span></span><br><span class="line">	n := <span class="built_in">len</span>(vertices)</span><br><span class="line">	adjMat := <span class="built_in">make</span>([][]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="keyword">range</span> adjMat &#123;</span><br><span class="line">		adjMat[i] = <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// initialize the graph</span></span><br><span class="line">	g := &amp;graphArray&#123;</span><br><span class="line">		vertices: vertices,</span><br><span class="line">		adjMat:   adjMat,</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// add edges</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="keyword">range</span> edges &#123;</span><br><span class="line">		g.addEdge(edges[i][<span class="number">0</span>], edges[i][<span class="number">1</span>])</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> g</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// size Nums of vertices</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graphArray)</span></span> size() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">len</span>(g.vertices)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// addVertex Add a vertex</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graphArray)</span></span> addVertex(val <span class="type">int</span>) &#123;</span><br><span class="line">	n := g.size()</span><br><span class="line">	<span class="comment">//append the new val to vertices list</span></span><br><span class="line">	g.vertices = <span class="built_in">append</span>(g.vertices, val)</span><br><span class="line">	<span class="comment">//add a new row</span></span><br><span class="line">	newRow := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	g.adjMat = <span class="built_in">append</span>(g.adjMat, newRow)</span><br><span class="line">	<span class="comment">//add a new col</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="keyword">range</span> g.adjMat &#123;</span><br><span class="line">		g.adjMat[i] = <span class="built_in">append</span>(g.adjMat[i], <span class="number">0</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// removeVertex Remove a vertex following its idx</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graphArray)</span></span> removeVertex(idx <span class="type">int</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> idx &gt;= g.size() &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;index not exist,remove failed&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// remove vertex</span></span><br><span class="line">	g.vertices = <span class="built_in">append</span>(g.vertices[:idx], g.vertices[idx+<span class="number">1</span>:]...)</span><br><span class="line">	<span class="comment">// remove row</span></span><br><span class="line">	g.adjMat = <span class="built_in">append</span>(g.adjMat[:idx], g.adjMat[idx+<span class="number">1</span>:]...)</span><br><span class="line">	<span class="comment">// remove col</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="keyword">range</span> g.adjMat &#123;</span><br><span class="line">		g.adjMat[i] = <span class="built_in">append</span>(g.adjMat[i][:idx], g.adjMat[i][idx+<span class="number">1</span>:]...)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// addEdge Add a new edge</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graphArray)</span></span> addEdge(i, j <span class="type">int</span>) &#123;</span><br><span class="line">    <span class="comment">// idx is not right: i==j</span></span><br><span class="line">	<span class="keyword">if</span> i &lt; <span class="number">0</span> || j &lt; <span class="number">0</span> || i &gt;= g.size() || j &gt;= g.size() || i == j &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;The index is out of bounds or two edges is coincident&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	g.adjMat[i][j] = <span class="number">1</span></span><br><span class="line">	g.adjMat[j][i] = <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// removeEdge Remove a edge</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graphArray)</span></span> removeEdge(i, j <span class="type">int</span>) &#123;</span><br><span class="line">	<span class="comment">// idx is not right: i==j</span></span><br><span class="line">	<span class="keyword">if</span> i &lt; <span class="number">0</span> || j &lt; <span class="number">0</span> || i &gt;= g.size() || j &gt;= g.size() || i == j &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;The index is out of bounds or two edges is coincident&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	g.adjMat[i][j] = <span class="number">0</span></span><br><span class="line">	g.adjMat[j][i] = <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// print </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graphArray)</span></span> <span class="built_in">print</span>() &#123;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;\té¡¶ç‚¹åˆ—è¡¨%v\n&quot;</span>, g.vertices)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;\tçŸ©é˜µ\n&quot;</span>)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="keyword">range</span> g.adjMat &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;\t\t%v\n&quot;</span>, g.adjMat[i])</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// construct vertices list and edges</span></span><br><span class="line">	vertices := []<span class="type">int</span>&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">	edges := [][]<span class="type">int</span>&#123;</span><br><span class="line">		&#123;<span class="number">0</span>, <span class="number">1</span>&#125;,</span><br><span class="line">		&#123;<span class="number">0</span>, <span class="number">2</span>&#125;,</span><br><span class="line">		&#123;<span class="number">1</span>, <span class="number">2</span>&#125;,</span><br><span class="line">		&#123;<span class="number">2</span>, <span class="number">3</span>&#125;,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// construct graph</span></span><br><span class="line">	g := newGraphArray(vertices, edges)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// print init edge</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;åˆå§‹å›¾ï¼š&quot;</span>)</span><br><span class="line">	g.<span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// add new vertex and edge</span></span><br><span class="line">	g.addVertex(<span class="number">4</span>)</span><br><span class="line">	g.addEdge(<span class="number">4</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// print the new graph</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;\næ›´æ–°åçš„å›¾ï¼š&quot;</span>)</span><br><span class="line">	g.<span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// remove vertex and edge</span></span><br><span class="line">	g.removeVertex(<span class="number">2</span>)</span><br><span class="line">	<span class="comment">//g.removeEdge(0, 1)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// print </span></span><br><span class="line">	fmt.Println(<span class="string">&quot;\næœ€ç»ˆå›¾ï¼š&quot;</span>)</span><br><span class="line">	g.<span class="built_in">print</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">go run main.go</span></span><br><span class="line"></span><br><span class="line">åˆå§‹å›¾ï¼š</span><br><span class="line">        é¡¶ç‚¹åˆ—è¡¨[0 1 2 3]</span><br><span class="line">        çŸ©é˜µ</span><br><span class="line">                [0 1 1 0]</span><br><span class="line">                [1 0 1 0]</span><br><span class="line">                [1 1 0 1]</span><br><span class="line">                [0 0 1 0]</span><br><span class="line"></span><br><span class="line">æ›´æ–°åçš„å›¾ï¼š</span><br><span class="line">        é¡¶ç‚¹åˆ—è¡¨[0 1 2 3 4]</span><br><span class="line">        çŸ©é˜µ</span><br><span class="line">                [0 1 1 0 0]</span><br><span class="line">                [1 0 1 0 1]</span><br><span class="line">                [1 1 0 1 0]</span><br><span class="line">                [0 0 1 0 0]</span><br><span class="line">                [0 1 0 0 0]</span><br><span class="line"></span><br><span class="line">æœ€ç»ˆå›¾ï¼š</span><br><span class="line">        é¡¶ç‚¹åˆ—è¡¨[0 1 3 4]</span><br><span class="line">        çŸ©é˜µ</span><br><span class="line">                [0 1 0 0]</span><br><span class="line">                [1 0 0 1]</span><br><span class="line">                [0 0 0 0]</span><br><span class="line">                [0 1 0 0]</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="Adjacency-list"><a href="#Adjacency-list" class="headerlink" title="Adjacency list"></a>Adjacency list</h2><p>non-direction verticesNums are <code>n</code>ã€edgeNums are <code>m</code> </p>
<ul>
<li><strong>Add edge</strong>ï¼šadd an edge to the end of the linked list of vertices,Because non-direction graph,<br>needing to add edges in both directions at the same time.</li>
<li><strong>Remove edge</strong>ï¼šFind and delete the specified edge in the vertex  linked list<br> In an non-direction graph, you need to delete edges in both directions at the same time.</li>
<li><strong>Add vertex</strong>ï¼šAdd a linked list to the adjacency list and add the new vertex as the linked list head node,</li>
<li><strong>Remove vertex</strong>ï¼šTraverse the entire adjacency list, remove all edges containing the specified vertices</li>
<li><strong>Initialize</strong>ï¼šCreate <code>m </code>vertices and <code>2m </code>edges  in the adjacency list</li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;strconv&quot;</span></span><br><span class="line">	<span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Vertex <span class="keyword">struct</span> &#123;</span><br><span class="line">	Val <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// graphAdjList Based on adjacency list implement non-direction graph</span></span><br><span class="line"><span class="keyword">type</span> graphAdjList <span class="keyword">struct</span> &#123;</span><br><span class="line">    <span class="comment">// AdjList:key:Vertexï¼Œvalueï¼šAll adjacency vertices for that vertex</span></span><br><span class="line">    <span class="comment">//map key:Vertex value:[]Vertex</span></span><br><span class="line">	adjList <span class="keyword">map</span>[Vertex][]Vertex</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// newGraphAdjList Construct</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newGraphAdjList</span><span class="params">(edges [][]Vertex)</span></span> *graphAdjList &#123;</span><br><span class="line">	g := &amp;graphAdjList&#123;</span><br><span class="line">		adjList: <span class="built_in">make</span>(<span class="keyword">map</span>[Vertex][]Vertex),</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// add all vertices and edges</span></span><br><span class="line">	<span class="keyword">for</span> _, edge := <span class="keyword">range</span> edges &#123;</span><br><span class="line">		g.addVertex(edge[<span class="number">0</span>])</span><br><span class="line">		g.addVertex(edge[<span class="number">1</span>])</span><br><span class="line">		g.addEdge(edge[<span class="number">0</span>], edge[<span class="number">1</span>])</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> g</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// size Get the nums of vertices</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graphAdjList)</span></span> size() <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">len</span>(g.adjList)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// addEdge Add a new edge</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graphAdjList)</span></span> addEdge(vet1 Vertex, vet2 Vertex) &#123;</span><br><span class="line">	_, ok1 := g.adjList[vet1]</span><br><span class="line">	_, ok2 := g.adjList[vet2]</span><br><span class="line">	<span class="keyword">if</span> !ok1 || !ok2 || vet1 == vet2 &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;adding false&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// add a edge vet1 - vet2</span></span><br><span class="line">	g.adjList[vet1] = <span class="built_in">append</span>(g.adjList[vet1], vet2)</span><br><span class="line">	g.adjList[vet2] = <span class="built_in">append</span>(g.adjList[vet2], vet1)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// removeEdge Remove edge</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graphAdjList)</span></span> removeEdge(vet1 Vertex, vet2 Vertex) &#123;</span><br><span class="line">	_, ok1 := g.adjList[vet1]</span><br><span class="line">	_, ok2 := g.adjList[vet2]</span><br><span class="line">	<span class="keyword">if</span> !ok1 || !ok2 || vet1 == vet2 &#123;</span><br><span class="line">		<span class="built_in">panic</span>(<span class="string">&quot;error&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// remove vet1 - vet2</span></span><br><span class="line">	g.adjList[vet1] = DeleteSliceElms(g.adjList[vet1], vet2)</span><br><span class="line">	g.adjList[vet2] = DeleteSliceElms(g.adjList[vet2], vet1)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// addVertex Add a new vertex</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graphAdjList)</span></span> addVertex(vet Vertex) &#123;</span><br><span class="line">	_, ok := g.adjList[vet]</span><br><span class="line">	<span class="keyword">if</span> ok &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// add a new linked list to the adjacency list</span></span><br><span class="line">	g.adjList[vet] = <span class="built_in">make</span>([]Vertex, <span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// removeVertex Remove vertex</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graphAdjList)</span></span> removeVertex(vet Vertex) &#123;</span><br><span class="line">	_, ok := g.adjList[vet]</span><br><span class="line">	<span class="keyword">if</span> !ok &#123;</span><br><span class="line">		<span class="built_in">panic</span>(<span class="string">&quot;error&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">// delete the vertex(vet) corresponding list in adjList</span></span><br><span class="line">	<span class="built_in">delete</span>(g.adjList, vet)</span><br><span class="line">	<span class="comment">// traverse other vertices corresponding edgesï¼Œremove the edges contained in vets</span></span><br><span class="line">	<span class="keyword">for</span> v, list := <span class="keyword">range</span> g.adjList &#123;</span><br><span class="line">		g.adjList[v] = DeleteSliceElms(list, vet)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// print </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *graphAdjList)</span></span> <span class="built_in">print</span>() &#123;</span><br><span class="line">	<span class="keyword">var</span> builder strings.Builder</span><br><span class="line">	fmt.Printf(<span class="string">&quot;é‚»æ¥è¡¨ = \n&quot;</span>)</span><br><span class="line">	<span class="keyword">for</span> k, v := <span class="keyword">range</span> g.adjList &#123;</span><br><span class="line">		builder.WriteString(<span class="string">&quot;\t\t&quot;</span> + strconv.Itoa(k.Val) + <span class="string">&quot;: &quot;</span>)</span><br><span class="line">		<span class="keyword">for</span> _, vet := <span class="keyword">range</span> v &#123;</span><br><span class="line">			builder.WriteString(strconv.Itoa(vet.Val) + <span class="string">&quot; &quot;</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println(builder.String())</span><br><span class="line">		builder.Reset()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DeleteSliceElms Delete a specific slice element</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">DeleteSliceElms</span><span class="params">(slice []Vertex, val Vertex)</span></span> []Vertex &#123;</span><br><span class="line">	<span class="keyword">var</span> result []Vertex</span><br><span class="line">	<span class="keyword">for</span> _, v := <span class="keyword">range</span> slice &#123;</span><br><span class="line">		<span class="keyword">if</span> v != val &#123;</span><br><span class="line">			result = <span class="built_in">append</span>(result, v)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	vet1 := Vertex&#123;<span class="number">1</span>&#125;</span><br><span class="line">	vet2 := Vertex&#123;<span class="number">2</span>&#125;</span><br><span class="line">	vet3 := Vertex&#123;<span class="number">3</span>&#125;</span><br><span class="line">	vet4 := Vertex&#123;<span class="number">4</span>&#125;</span><br><span class="line">	vet5 := Vertex&#123;<span class="number">5</span>&#125;</span><br><span class="line"></span><br><span class="line">	edges := [][]Vertex&#123;</span><br><span class="line">		&#123;vet1, vet2&#125;,</span><br><span class="line">		&#123;vet2, vet3&#125;,</span><br><span class="line">		&#123;vet3, vet4&#125;,</span><br><span class="line">		&#123;vet4, vet1&#125;,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	g := newGraphAdjList(edges)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;åˆå§‹å›¾ï¼š&quot;</span>)</span><br><span class="line">	g.<span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">	g.addVertex(vet5)</span><br><span class="line">	g.addEdge(vet1, vet5)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;\næ›´æ–°åçš„å›¾ï¼š&quot;</span>)</span><br><span class="line">	g.<span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">	g.removeVertex(vet2)</span><br><span class="line">	g.removeEdge(vet1, vet3)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;\næœ€ç»ˆå›¾ï¼š&quot;</span>)</span><br><span class="line">	g.<span class="built_in">print</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">åˆå§‹å›¾ï¼š</span><br><span class="line">é‚»æ¥è¡¨ =</span><br><span class="line">          1: 2 4</span><br><span class="line">          2: 1 3</span><br><span class="line">          3: 2 4</span><br><span class="line">          4: 3 1</span><br><span class="line"></span><br><span class="line">æ›´æ–°åçš„å›¾ï¼š</span><br><span class="line">é‚»æ¥è¡¨ =</span><br><span class="line">           1: 2 4 5</span><br><span class="line">           2: 1 3</span><br><span class="line">           3: 2 4</span><br><span class="line">           4: 3 1</span><br><span class="line">           5: 1</span><br><span class="line"></span><br><span class="line">æœ€ç»ˆå›¾ï¼š</span><br><span class="line">é‚»æ¥è¡¨ =</span><br><span class="line">           1: 4 5</span><br><span class="line">           3: 4</span><br><span class="line">           4: 3 1</span><br><span class="line">           5: 1</span><br></pre></td></tr></table></figure>

<p><img src="/./../pic/Graph02/Graph01.png" alt="image-20230901235239699"></p>
]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Graph</tag>
      </tags>
  </entry>
  <entry>
    <title>Graph-Search</title>
    <url>/2023/09/02/Graph03-Traverse/</url>
    <content><![CDATA[<h1 id="Search-Graph"><a href="#Search-Graph" class="headerlink" title="Search  Graph"></a>Search  Graph</h1><p>To traverse a graph ,we always hold <code>DepthFirstSearch(dfs)</code>and <code>BreadthFirstSearch(bfs)</code></p>
<p><code>dfs</code>: Search in one direction, until can not search, and then change direction<br>        the process of changing direction involves backtracking</p>
<p><code>bfs</code>: Traverse all  vertices connected by this vertex,<br>         and when you go to the next vertex then traverse all the vertices connected to the vertex,<br>         and the search direction is more like a breadth, a search process in all directions.</p>
]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Graph</tag>
        <tag>dfs</tag>
        <tag>bfs</tag>
      </tags>
  </entry>
  <entry>
    <title>GraphDfs-LC797</title>
    <url>/2023/09/02/GraphDfs-LC797/</url>
    <content><![CDATA[<h1 id="Leetcode-797"><a href="#Leetcode-797" class="headerlink" title="Leetcode-797"></a>Leetcode-797</h1><p>Given a directed acyclic graph (DAG) of <strong>n</strong> nodes labeled from <strong>0</strong> to <strong>n - 1</strong>,<br>find all possible paths from node <strong>0</strong> to node <strong>n - 1</strong> and return them in <strong>any order</strong>.<br>The graph is given as follows: <code>graph[i]</code> is a list of all nodes you can visit from node <code>i</code><br>(i.e., there is a directed edge from node <code>i</code> to node <code>graph[i][j]</code>).</p>
<span id="more"></span>

<p><strong>Example 1</strong></p>
<p><img src="/./../pic/GraphDfs-LC797/image-20230902111802810.png" alt="image-20230902111802810"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: graph = [[1,2],[3],[3],[]]</span><br><span class="line">Output: [[0,1,3],[0,2,3]]</span><br><span class="line">Explanation: There are two paths: 0 -&gt; 1 -&gt; 3 and 0 -&gt; 2 -&gt; 3.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2</strong></p>
<p><img src="/./../pic/GraphDfs-LC797/image-20230902112111869.png" alt="image-20230902112111869"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: graph = [[4,3,1],[3,2,4],[3],[4],[]]</span><br><span class="line">Output: [[0,4],[0,3,4],[0,1,3,4],[0,1,2,3,4],[0,1,4]]</span><br></pre></td></tr></table></figure>



<p><strong>Constraints:</strong></p>
<ul>
<li><code>n == graph.length</code></li>
<li><code>2 &lt;= n &lt;= 15</code></li>
<li><code>0 &lt;= graph[i][j] &lt; n</code></li>
<li><code>graph[i][j] != i</code> (i.e., there will be no self-loops).</li>
<li>All the elements of <code>graph[i]</code> are <strong>unique</strong>.</li>
<li>The input graph is <strong>guaranteed</strong> to be a <strong>DAG</strong>.</li>
</ul>
<p><strong>Resolution</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="comment">// 797  2023-09-02 11:15:28</span></span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">allPathsSourceTarget</span><span class="params">(graph [][]<span class="type">int</span>)</span></span> [][]<span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> ret [][]<span class="type">int</span></span><br><span class="line">	<span class="keyword">var</span> path []<span class="type">int</span></span><br><span class="line">	<span class="keyword">var</span> dfs <span class="function"><span class="keyword">func</span><span class="params">(<span class="type">int</span>)</span></span></span><br><span class="line">	dfs = <span class="function"><span class="keyword">func</span><span class="params">(x <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">		<span class="keyword">if</span> x == <span class="built_in">len</span>(graph)<span class="number">-1</span> &#123;</span><br><span class="line">			<span class="comment">// get a path</span></span><br><span class="line">			tmp := <span class="built_in">make</span>([]<span class="type">int</span>, <span class="built_in">len</span>(path))</span><br><span class="line">			<span class="built_in">copy</span>(tmp, path)</span><br><span class="line">			ret = <span class="built_in">append</span>(ret, tmp)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//find the nodeX link all nodes</span></span><br><span class="line">		<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(graph[x]); i++ &#123;</span><br><span class="line">			<span class="comment">// add to path</span></span><br><span class="line">			path = <span class="built_in">append</span>(path, graph[x][i])</span><br><span class="line">			dfs(graph[x][i])</span><br><span class="line">			<span class="comment">// traverse</span></span><br><span class="line">			path = path[:<span class="built_in">len</span>(path)<span class="number">-1</span>]</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	path = <span class="built_in">append</span>(path, <span class="number">0</span>)</span><br><span class="line">	dfs(<span class="number">0</span>)</span><br><span class="line">	<span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Graph</tag>
        <tag>dfs</tag>
      </tags>
  </entry>
  <entry>
    <title>LC9.9</title>
    <url>/2023/09/09/LC9-9/</url>
    <content><![CDATA[<p>There are a total of <code>numCourses</code> courses you have to take, labeled from <code>0</code> to <code>numCourses - 1</code>. You are given an array <code>prerequisites</code> where <code>prerequisites[i] = [ai, bi]</code> indicates that you <strong>must</strong> take course <code>bi</code> first if you want to take course <code>ai</code>.</p>
<ul>
<li>For example, the pair <code>[0, 1]</code>, indicates that to take course <code>0</code> you have to first take course <code>1</code>.</li>
</ul>
<p>Return <code>true</code> if you can finish all courses. Otherwise, return <code>false</code>.</p>
 <span id="more"></span>

<p><strong>Example 1:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: numCourses = 2, prerequisites = [[1,0]]</span><br><span class="line">Output: true</span><br><span class="line">Explanation: There are a total of 2 courses to take. </span><br><span class="line">To take course 1 you should have finished course 0. So it is possible.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: numCourses = 2, prerequisites = [[1,0],[0,1]]</span><br><span class="line">Output: false</span><br><span class="line">Explanation: There are a total of 2 courses to take. </span><br><span class="line">To take course 1 you should have finished course 0, and to take course 0 you should also have finished course 1. So it is impossible.</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;container/list&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 207  2023-09-09 00:53:15</span></span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">canFinish</span><span class="params">(numCourses <span class="type">int</span>, prerequisites [][]<span class="type">int</span>)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">	inDegree := <span class="built_in">make</span>([]<span class="type">int</span>, numCourses)</span><br><span class="line">	graph := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">int</span>]*list.List)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(prerequisites); i++ &#123;</span><br><span class="line">		inDegree[prerequisites[i][<span class="number">0</span>]]++                    <span class="comment">//åˆå§‹å…¥åº¦å€¼</span></span><br><span class="line">		<span class="keyword">if</span> _, exist := graph[prerequisites[i][<span class="number">1</span>]]; exist &#123; <span class="comment">//å½“å‰è¯¾å­˜åœ¨äºè¡¨</span></span><br><span class="line">			graph[prerequisites[i][<span class="number">1</span>]].PushBack(prerequisites[i][<span class="number">0</span>]) <span class="comment">//æ·»åŠ å®ƒçš„ä¾èµ–è¯¾</span></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			graph[prerequisites[i][<span class="number">1</span>]] = list.New()</span><br><span class="line">			graph[prerequisites[i][<span class="number">1</span>]].PushBack(prerequisites[i][<span class="number">0</span>])</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	que := list.New()</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; numCourses; i++ &#123;</span><br><span class="line">		<span class="keyword">if</span> inDegree[i] == <span class="number">0</span> &#123;</span><br><span class="line">			que.PushBack(i)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	count := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> que.Len() &gt; <span class="number">0</span> &#123;</span><br><span class="line">		selected := que.Remove(que.Front()).(<span class="type">int</span>)</span><br><span class="line">		count++</span><br><span class="line">		toEnqueue := graph[selected] <span class="comment">// è·å–è¿™é—¨è¯¾å¯¹åº”çš„åç»­è¯¾</span></span><br><span class="line">		<span class="keyword">if</span> toEnqueue != <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">for</span> e := toEnqueue.Front(); e != <span class="literal">nil</span>; e = e.Next() &#123;</span><br><span class="line">				course := e.Value.(<span class="type">int</span>)</span><br><span class="line">				inDegree[course]--         <span class="comment">// ä¾èµ–å®ƒçš„åç»­è¯¾çš„å…¥åº¦-1</span></span><br><span class="line">				<span class="keyword">if</span> inDegree[course] == <span class="number">0</span> &#123; <span class="comment">// å¦‚æœå› æ­¤å‡ä¸º0ï¼Œå…¥åˆ—</span></span><br><span class="line">					que.PushBack(course)</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> count == numCourses</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Graph</tag>
        <tag>Bfs</tag>
      </tags>
  </entry>
  <entry>
    <title>Plan9_18</title>
    <url>/2023/09/18/Plan9-18/</url>
    <content><![CDATA[<h1 id="0x12"><a href="#0x12" class="headerlink" title="0x12"></a>0x12</h1><p>1.CET-6 words 30 min per day<br>2.geeWeb geeORM replicate<br>3.OS</p>
]]></content>
      <categories>
        <category>Planning</category>
      </categories>
      <tags>
        <tag>Planning</tag>
      </tags>
  </entry>
  <entry>
    <title>WebCrawler_BaiduTranslation</title>
    <url>/2023/09/16/WebCrawler-BaiduTranslation/</url>
    <content><![CDATA[<h1 id="WebCrawler-based-on-BaiduTranslation-interface"><a href="#WebCrawler-based-on-BaiduTranslation-interface" class="headerlink" title="WebCrawler based on BaiduTranslation interface"></a>WebCrawler based on BaiduTranslation interface</h1><ul>
<li><p>input letter you want to translate</p>
</li>
<li><p>post your letter to baidu translate interface</p>
</li>
<li><p>input <code>exit</code> to finish it</p>
</li>
<li><p>if there is no result,shell will output â€œæ²¡æœ‰æŸ¥è¯¢åˆ°ç»“æœâ€</p>
</li>
<li><p>based on Goï¼Œusing standard library<code>net/http</code>and<code>encoding/json</code>package operate HTTP post andJSON parse</p>
</li>
</ul>
<p>Codes are as follows</p>
<span id="more"></span>

<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;bytes&quot;</span></span><br><span class="line">	<span class="string">&quot;encoding/json&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> TranslationResult <span class="keyword">struct</span> &#123;</span><br><span class="line">	K <span class="type">string</span> <span class="string">`json:&quot;k&quot;`</span></span><br><span class="line">	V <span class="type">string</span> <span class="string">`json:&quot;v&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// ç¡®å®šè¦è®¿é—®çš„URL</span></span><br><span class="line">	url := <span class="string">&quot;https://fanyi.baidu.com/sug&quot;</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;é€€å‡ºè¾“å…¥ exit&quot;</span>)</span><br><span class="line">		<span class="comment">// è·å–ç”¨æˆ·è¾“å…¥çš„ç¿»è¯‘å†…å®¹</span></span><br><span class="line">		fmt.Print(<span class="string">&quot;è¯·è¾“å…¥è¦ç¿»è¯‘çš„å†…å®¹ï¼š&quot;</span>)</span><br><span class="line">		<span class="keyword">var</span> word <span class="type">string</span></span><br><span class="line">		_, err := fmt.Scan(&amp;word)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;è¾“å…¥é”™è¯¯:&quot;</span>, err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> word == <span class="string">&quot;exit&quot;</span> &#123;</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// åˆ›å»ºè¯·æ±‚æ•°æ®</span></span><br><span class="line">		data := <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;<span class="string">&quot;kw&quot;</span>: word&#125;</span><br><span class="line">		jsonData, err := json.Marshal(data)</span><br><span class="line">		<span class="comment">//fmt.Println(&quot;----------------------------------------&quot;, string(jsonData))</span></span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;JSONç¼–ç é”™è¯¯:&quot;</span>, err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// åˆ›å»ºHTTPè¯·æ±‚</span></span><br><span class="line">		req, err := http.NewRequest(<span class="string">&quot;POST&quot;</span>, url, bytes.NewBuffer(jsonData))</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;åˆ›å»ºHTTPè¯·æ±‚é”™è¯¯:&quot;</span>, err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// è®¾ç½®è¯·æ±‚å¤´</span></span><br><span class="line">		req.Header.Set(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json;charset=UTF-8&quot;</span>)</span><br><span class="line">		req.Header.Set(<span class="string">&quot;Content-Length&quot;</span>, fmt.Sprintf(<span class="string">&quot;%d&quot;</span>, <span class="built_in">len</span>(jsonData)))</span><br><span class="line">		req.Header.Set(<span class="string">&quot;X-Requested-With&quot;</span>, <span class="string">&quot;XMLHttpRequest&quot;</span>)</span><br><span class="line"></span><br><span class="line">		<span class="comment">// å‘é€HTTPè¯·æ±‚</span></span><br><span class="line">		client := &amp;http.Client&#123;&#125;</span><br><span class="line">		res, err := client.Do(req)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;å‘é€HTTPè¯·æ±‚é”™è¯¯:&quot;</span>, err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">defer</span> res.Body.Close()</span><br><span class="line"></span><br><span class="line">		<span class="comment">//actualURL := req.URL.String()</span></span><br><span class="line">		<span class="comment">//fmt.Println(&quot;å®é™…è¯·æ±‚çš„URL:&quot;, actualURL)</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// è§£æå“åº”</span></span><br><span class="line">		<span class="comment">// è§£æå“åº”</span></span><br><span class="line">		<span class="keyword">var</span> response <span class="keyword">struct</span> &#123;</span><br><span class="line">			Data []TranslationResult <span class="string">`json:&quot;data&quot;`</span></span><br><span class="line">		&#125;</span><br><span class="line">		err = json.NewDecoder(res.Body).Decode(&amp;response)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;è§£æå“åº”é”™è¯¯:&quot;</span>, err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(response.Data) == <span class="number">0</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;æ²¡æœ‰æŸ¥è¯¢åˆ°ç»“æœ&quot;</span>)</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// æ‰“å°ç»“æœ</span></span><br><span class="line">		filePath := <span class="string">&quot;./doc.log&quot;</span></span><br><span class="line">		file, err := os.OpenFile(filePath, os.O_APPEND|os.O_CREATE|os.O_WRONLY, <span class="number">0644</span>)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;æ‰“å¼€æ–‡ä»¶æ—¶å‡ºé”™:&quot;</span>, err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">defer</span> file.Close()</span><br><span class="line"></span><br><span class="line">		<span class="comment">// éå†æŸ¥è¯¢ç»“æœå¹¶åŒæ—¶å†™å…¥æ–‡ä»¶å’Œæ‰“å°</span></span><br><span class="line">		<span class="keyword">for</span> k, result := <span class="keyword">range</span> response.Data &#123;</span><br><span class="line">			line := fmt.Sprintf(<span class="string">&quot;%d---%s\n%s\n&quot;</span>, k+<span class="number">1</span>, result.K, result.V)</span><br><span class="line">			fmt.Print(line)</span><br><span class="line">			_, err = file.WriteString(line)</span><br><span class="line">			<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">				fmt.Println(<span class="string">&quot;å†™å…¥æ–‡ä»¶æ—¶å‡ºé”™:&quot;</span>, err)</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>WebCrawler</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQL01</title>
    <url>/2023/09/01/MySQL01/</url>
    <content><![CDATA[<h1 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h1><p><strong>SQL (Structured Query Language:ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€) æ˜¯ç”¨äºç®¡ç†å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆRDBMSï¼‰ã€‚ SQL çš„èŒƒå›´åŒ…æ‹¬æ•°æ®æ’å…¥ã€æŸ¥è¯¢ã€æ›´æ–°å’Œåˆ é™¤ï¼Œæ•°æ®åº“æ¨¡å¼åˆ›å»ºå’Œä¿®æ”¹ï¼Œä»¥åŠæ•°æ®è®¿é—®æ§åˆ¶ã€‚</strong></p>
<span id="more"></span>



<h2 id="SQL-åˆ†ç±»"><a href="#SQL-åˆ†ç±»" class="headerlink" title="SQL åˆ†ç±»"></a>SQL åˆ†ç±»</h2><p>SQLè¯­è¨€åœ¨åŠŸèƒ½ä¸Šä¸»è¦åˆ†ä¸ºå¦‚ä¸‹3å¤§ç±»ï¼š<br><strong>DDLï¼ˆData Definition Languagesã€æ•°æ®å®šä¹‰è¯­è¨€ï¼‰</strong>ï¼Œè¿™äº›è¯­å¥å®šä¹‰äº†ä¸åŒçš„æ•°æ®åº“ã€è¡¨ã€è§†å›¾ã€ç´¢<br>å¼•ç­‰æ•°æ®åº“å¯¹è±¡ï¼Œè¿˜å¯ä»¥ç”¨æ¥åˆ›å»ºã€åˆ é™¤ã€ä¿®æ”¹æ•°æ®åº“å’Œæ•°æ®è¡¨çš„ç»“æ„ã€‚<br>ä¸»è¦çš„è¯­å¥å…³é”®å­—åŒ…æ‹¬CREATE ã€DROP ã€ALTER ç­‰ã€‚<br><strong>DMLï¼ˆData Manipulation Languageã€æ•°æ®æ“ä½œè¯­è¨€ï¼‰</strong>ï¼Œç”¨äºæ·»åŠ ã€åˆ é™¤ã€æ›´æ–°å’ŒæŸ¥è¯¢æ•°æ®åº“è®°<br>å½•ï¼Œå¹¶æ£€æŸ¥æ•°æ®å®Œæ•´æ€§ã€‚<br>ä¸»è¦çš„è¯­å¥å…³é”®å­—åŒ…æ‹¬INSERT ã€DELETE ã€UPDATE ã€SELECT ç­‰ã€‚<br>SELECTæ˜¯SQLè¯­è¨€çš„åŸºç¡€ï¼Œæœ€ä¸ºé‡è¦ã€‚<br><strong>DCLï¼ˆData Control Languageã€æ•°æ®æ§åˆ¶è¯­è¨€ï¼‰</strong>ï¼Œç”¨äºå®šä¹‰æ•°æ®åº“ã€è¡¨ã€å­—æ®µã€ç”¨æˆ·çš„è®¿é—®æƒé™å’Œ<br>å®‰å…¨çº§åˆ«ã€‚<br>ä¸»è¦çš„è¯­å¥å…³é”®å­—åŒ…æ‹¬GRANT ã€REVOKE ã€COMMIT ã€ROLLBACK ã€SAVEPOINT ç­‰ã€‚<br>å› ä¸ºæŸ¥è¯¢è¯­å¥ä½¿ç”¨çš„éå¸¸çš„é¢‘ç¹ï¼Œæ‰€ä»¥å¾ˆå¤šäººæŠŠæŸ¥è¯¢è¯­å¥å•æ‹å‡ºæ¥ä¸€ç±»ï¼šDQLï¼ˆæ•°æ®æŸ¥è¯¢è¯­è¨€ï¼‰ã€‚<br>è¿˜æœ‰å•ç‹¬å°†COMMIT ã€ROLLBACK å–å‡ºæ¥ç§°ä¸ºTCL ï¼ˆTransaction Control Languageï¼Œäº‹åŠ¡æ§åˆ¶è¯­<br>è¨€ï¼‰ã€‚</p>
<h2 id="åŸºæœ¬è§„åˆ™"><a href="#åŸºæœ¬è§„åˆ™" class="headerlink" title="åŸºæœ¬è§„åˆ™"></a>åŸºæœ¬è§„åˆ™</h2><ul>
<li>SQL å¯ä»¥å†™åœ¨ä¸€è¡Œæˆ–è€…å¤šè¡Œã€‚ä¸ºäº†æé«˜å¯è¯»æ€§ï¼Œå„å­å¥åˆ†è¡Œå†™ï¼Œå¿…è¦æ—¶ä½¿ç”¨ç¼©è¿›</li>
<li>æ¯æ¡å‘½ä»¤ä»¥ ; æˆ– \g æˆ– \G ç»“æŸ</li>
<li>å…³é”®å­—ä¸èƒ½è¢«ç¼©å†™ä¹Ÿä¸èƒ½åˆ†è¡Œ</li>
<li>å…³äºæ ‡ç‚¹ç¬¦å·</li>
<li>å¿…é¡»ä¿è¯æ‰€æœ‰çš„()ã€å•å¼•å·ã€åŒå¼•å·æ˜¯æˆå¯¹ç»“æŸçš„</li>
<li>å¿…é¡»ä½¿ç”¨è‹±æ–‡çŠ¶æ€ä¸‹çš„åŠè§’è¾“å…¥æ–¹å¼</li>
<li>å­—ç¬¦ä¸²å‹å’Œæ—¥æœŸæ—¶é—´ç±»å‹çš„æ•°æ®å¯ä»¥ä½¿ç”¨å•å¼•å·ï¼ˆâ€™ â€˜ï¼‰è¡¨ç¤º</li>
<li>åˆ—çš„åˆ«åï¼Œå°½é‡ä½¿ç”¨åŒå¼•å·ï¼ˆâ€ â€œï¼‰ï¼Œè€Œä¸”ä¸å»ºè®®çœç•¥as</li>
<li>MySQL åœ¨ Windows ç¯å¢ƒä¸‹æ˜¯å¤§å°å†™ä¸æ•æ„Ÿçš„</li>
<li>MySQL åœ¨ Linux ç¯å¢ƒä¸‹æ˜¯å¤§å°å†™æ•æ„Ÿçš„</li>
<li>æ•°æ®åº“åã€è¡¨åã€è¡¨çš„åˆ«åã€å˜é‡åæ˜¯ä¸¥æ ¼åŒºåˆ†å¤§å°å†™çš„</li>
<li>å…³é”®å­—ã€å‡½æ•°åã€åˆ—å(æˆ–å­—æ®µå)ã€åˆ—çš„åˆ«å(å­—æ®µçš„åˆ«å) æ˜¯å¿½ç•¥å¤§å°å†™çš„ã€‚</li>
<li><strong>æ¨èé‡‡ç”¨ç»Ÿä¸€çš„ä¹¦å†™è§„èŒƒï¼š</strong></li>
<li><strong>æ•°æ®åº“åã€è¡¨åã€è¡¨åˆ«åã€å­—æ®µåã€å­—æ®µåˆ«åç­‰éƒ½å°å†™</strong></li>
<li><strong>SQL å…³é”®å­—ã€å‡½æ•°åã€ç»‘å®šå˜é‡ç­‰éƒ½å¤§å†™</strong></li>
</ul>
<h2 id="æ•°æ®åº“"><a href="#æ•°æ®åº“" class="headerlink" title="æ•°æ®åº“"></a>æ•°æ®åº“</h2><h3 id="åˆ›å»º"><a href="#åˆ›å»º" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] name [CHAHRCTER <span class="keyword">SET</span> utf8] [<span class="keyword">COLLATE</span> utf8_bin];</span><br></pre></td></tr></table></figure>

<p>CHAHRCTERå­—ç¬¦é›†<br>COLLATEæ ¡å¯¹è§„åˆ™	utf8_binåŒºåˆ†å¤§å°å†™ ï¼Œé»˜è®¤utf8_general_ciä¸åŒºåˆ†å¤§å°å†™</p>
<h3 id="æŸ¥çœ‹åˆ é™¤æ•°æ®åº“"><a href="#æŸ¥çœ‹åˆ é™¤æ•°æ®åº“" class="headerlink" title="æŸ¥çœ‹åˆ é™¤æ•°æ®åº“"></a>æŸ¥çœ‹åˆ é™¤æ•°æ®åº“</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> DATABASE [IF <span class="keyword">EXISTS</span>] name;</span><br><span class="line"><span class="keyword">SHOW</span> DATABASES ;</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> DATABASE hello;#æ˜¾ç¤ºæ•°æ®åº“åˆ›å»ºè¯­å¥</span><br></pre></td></tr></table></figure>



<h3 id="å¤‡ä»½å’Œæ¢å¤æ•°æ®åº“"><a href="#å¤‡ä»½å’Œæ¢å¤æ•°æ®åº“" class="headerlink" title="å¤‡ä»½å’Œæ¢å¤æ•°æ®åº“"></a>å¤‡ä»½å’Œæ¢å¤æ•°æ®åº“</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mysqlump -u ç”¨æˆ·å -p -B æ•°æ®åº“1 æ•°æ®åº“2 æ•°æ®åº“3 &gt;d:\\æ–‡ä»¶å.sql #docå‘½ä»¤</span><br><span class="line">mysqlump -u ç”¨æˆ·å -p æ•°æ®åº“1 è¡¨1 è¡¨2 è¡¨3 &gt;d:\\æ–‡ä»¶å.sql #docå‘½ä»¤</span><br><span class="line">Source æ–‡ä»¶å.sql #mysqlå‘½ä»¤</span><br></pre></td></tr></table></figure>



<h2 id="åˆ›å»ºè¡¨"><a href="#åˆ›å»ºè¡¨" class="headerlink" title="åˆ›å»ºè¡¨"></a>åˆ›å»ºè¡¨</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table_name</span><br><span class="line">(</span><br><span class="line">	field datatype,</span><br><span class="line">    field datatype,</span><br><span class="line">    field datatype,</span><br><span class="line">)<span class="type">character</span> <span class="keyword">set</span>å­—ç¬¦é›† <span class="keyword">collate</span> æ ¡å¯¹è§„åˆ™ engineå¼•æ“ </span><br></pre></td></tr></table></figure>



<h3 id="è¡¨ç±»å‹å’Œå­˜å‚¨å¼•æ“"><a href="#è¡¨ç±»å‹å’Œå­˜å‚¨å¼•æ“" class="headerlink" title="è¡¨ç±»å‹å’Œå­˜å‚¨å¼•æ“"></a>è¡¨ç±»å‹å’Œå­˜å‚¨å¼•æ“</h3><p>MySQLçš„è¡¨çš„ç±»å‹ç”±å­˜å‚¨å¼•æ“å†³å®šï¼Œä¸»è¦åŒ…æ‹¬MyLSAMã€innoDBã€Memoryç­‰<br>MySQLæ•°æ®åº“ä¸»è¦æ”¯æŒå…­ç§ç±»å‹ï¼Œåˆ†åˆ«æ—¶CSVã€MEMORYã€ARCHIVEã€MGR_MYISAMã€MYISAMã€innoDBã€‚</p>
<p>è¿™å…­ç§åˆåˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯äº‹åŠ¡å®‰å…¨å‹(transaction-safe)å¦‚ [innoDB]ï¼Œ<br>å…¶ä½™éƒ½å±äºç¬¬äºŒç±»ï¼Œéäº‹åŠ¡å®‰å…¨å‹(non-transaction-safe) [MYISAMå’ŒMEMORY]</p>
<p>mysql&gt; show engines;</p>
<table>
<thead>
<tr>
<th>Engine</th>
<th>Comment</th>
<th>Transactions</th>
<th>XA(è·¨æ•°æ®åº“äº‹åŠ¡)</th>
<th>Savepoints</th>
</tr>
</thead>
<tbody><tr>
<td>InnoDB</td>
<td>æ”¯æŒäº‹åŠ¡ï¼Œè¡Œçº§é”å®šï¼Œå¤–é”®</td>
<td>YES</td>
<td>YES</td>
<td>YES</td>
</tr>
<tr>
<td>MyISAM</td>
<td>MyISAMå­˜å‚¨å¼•æ“</td>
<td>NO</td>
<td>NO</td>
<td>NO</td>
</tr>
<tr>
<td>MRG_MYISAM</td>
<td>ç›¸åŒçš„ MyISAM è¡¨çš„é›†åˆ</td>
<td>NO</td>
<td>NO</td>
<td>NO</td>
</tr>
<tr>
<td>MEMORY</td>
<td>åŸºäºå“ˆå¸Œï¼Œå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¯¹ä¸´æ—¶è¡¨å¾ˆæœ‰ç”¨</td>
<td>NO</td>
<td>NO</td>
<td>NO</td>
</tr>
<tr>
<td>CSV</td>
<td>CSV å­˜å‚¨å¼•æ“</td>
<td>NO</td>
<td>NO</td>
<td>NO</td>
</tr>
<tr>
<td>ARCHIVE</td>
<td>Archiveå­˜æ¡£ç±»å‹å­˜å‚¨å¼•æ“</td>
<td>NO</td>
<td>NO</td>
<td>NO</td>
</tr>
<tr>
<td>PERFORMANCE_SCHEMA</td>
<td>æ€§èƒ½æ¶æ„</td>
<td>NO</td>
<td>NO</td>
<td>NO</td>
</tr>
<tr>
<td>BLACKHOLE</td>
<td>dev&#x2F;null å­˜å‚¨å¼•æ“ï¼ˆæ‚¨å†™å…¥çš„ä»»ä½•å†…å®¹éƒ½ä¼šæ¶ˆå¤±ï¼‰</td>
<td>NO</td>
<td>NO</td>
<td>NO</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th><strong>åŠŸèƒ½</strong></th>
<th><strong>MyISAM</strong></th>
<th><strong>MEMORY</strong></th>
<th><strong>innoDB</strong></th>
<th><strong>ARCHIVE</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>å­˜å‚¨é™åˆ¶</strong></td>
<td>256BT</td>
<td>RAM</td>
<td>64BT</td>
<td></td>
</tr>
<tr>
<td><strong>äº‹åŠ¡</strong></td>
<td></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td><strong>å…¨æ–‡ç´¢å¼•</strong></td>
<td>Yes</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Bæ ‘ç´¢å¼•</strong></td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td><strong>å“ˆå¸Œç´¢å¼•</strong></td>
<td>Yes</td>
<td>Yes</td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>é›†ç¾¤ç´¢å¼•</strong></td>
<td></td>
<td>Yes</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td><strong>æ•°æ®ç´¢å¼•</strong></td>
<td></td>
<td>Yes</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td><strong>æ•°æ®å‹ç¼©</strong></td>
<td>Yes</td>
<td></td>
<td></td>
<td>Yes</td>
</tr>
<tr>
<td><strong>ç©ºé—´ä½¿ç”¨ç‡</strong></td>
<td>ä½</td>
<td>N&#x2F;A</td>
<td>é«˜</td>
<td>éå¸¸ä½</td>
</tr>
<tr>
<td><strong>å¤–é”®</strong></td>
<td></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
</tbody></table>
<p>1.MyISAMä¸æ”¯æŒäº‹åŠ¡ã€ä¹Ÿä¸æ”¯æŒå¤–é”®ï¼Œä½†å…¶è®¿åŒé€Ÿåº¦å¿«ï¼Œå¯¹äº‹åŠ¡å®Œæ•´æ€§æ²¡æœ‰è¦æ±‚</p>
<p>2.InnoDBå­˜å‚¨å¼•æ“æä¾›äº†å…·æœ‰æäº¤ã€å›æ»šå’Œå´©æºƒæ¢å¤èƒ½åŠ›çš„äº‹åŠ¡å®‰å…¨ã€‚ä½†æ˜¯æ¯”èµ·MyISAMå­˜å‚¨å¼•æ“ï¼ŒInnoDBå†™çš„å¤„ç†æ•ˆç‡å·®ä¸€äº›å¹¶ç›´ä¼šå ç”¨æ›´å¤šçš„ç£ç›˜ç©ºé—´ä»¥ä¿ç•™æ•°æ®å’Œç´¢å¼•ã€‚</p>
<p>3.MEMORYå­˜å‚¨å¼•æ“ä½¿ç”¨å­˜åœ¨å†…å­˜ä¸­çš„å†…å®¹æ¥åˆ›å»ºè¡¨ã€‚æ¯ä¸ªMEMORYè¡¨åªå®é™…å¯¹åº”ä¸€ä¸ªç£ç›˜æ–‡ä»¶ã€‚MEMORYç±»å‹çš„è¡¨è®¿é—®éå¸¸å¾—å¿«ï¼Œå› ä¸ºå®ƒçš„æ•°æ®æ˜¯æ”¾åœ¨å†…å­˜ä¸­çš„å¹¶é»˜è®¤ä½¿ç”¨HASHç´¢å¼•ã€‚ä½†æ˜¯ä¸€æ—¦æœåŠ¡å…³é—­ï¼Œè¡¨ä¸­çš„æ•°æ®å°±ä¼šä¸¢å¤±æ‰ï¼Œè¡¨çš„ç»“æ„è¿˜åœ¨ã€‚</p>
<p><strong>ä¿®æ”¹å­˜å‚¨å¼•æ“</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> è¡¨å engine<span class="operator">=</span>xxxx;</span><br></pre></td></tr></table></figure>



<h3 id="MySQLå¸¸ç”¨æ•°æ®ç±»å‹"><a href="#MySQLå¸¸ç”¨æ•°æ®ç±»å‹" class="headerlink" title="MySQLå¸¸ç”¨æ•°æ®ç±»å‹"></a>MySQLå¸¸ç”¨æ•°æ®ç±»å‹</h3><h4 id="æ•´å‹"><a href="#æ•´å‹" class="headerlink" title="æ•´å‹"></a>æ•´å‹</h4><table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>å å­—èŠ‚æ•°</th>
<th>æœ€å¤§å®½åº¦</th>
<th>æ— ç¬¦å·çš„æ•°å€¼èŒƒå›´</th>
<th>æœ‰ç¬¦å·çš„æ•°å€¼èŒƒå›´</th>
</tr>
</thead>
<tbody><tr>
<td>bit(m)</td>
<td>bit(m) m1åˆ°64</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>int[unsigned]</td>
<td>4</td>
<td>int(11)</td>
<td>0 åˆ° 2^32 â€“ 1</td>
<td>-2^31 åˆ° 2^31 â€“ 1</td>
</tr>
<tr>
<td>tinyint[unsigned]</td>
<td>1</td>
<td>tinyint(4)</td>
<td>0 åˆ° 2^8 â€“ 1</td>
<td>- 2^7 åˆ° 2^7 â€“ 1</td>
</tr>
<tr>
<td>smallint[unsigned]</td>
<td>2</td>
<td>smallint(6)</td>
<td>0 åˆ° 2^16 â€“ 1</td>
<td>- 2^15 åˆ° 2^15 â€“ 1</td>
</tr>
<tr>
<td>mediumint[unsigned]</td>
<td>3</td>
<td>mediumint(9)</td>
<td>0 åˆ° 2^24 â€“ 1</td>
<td>- 2^23 åˆ° 2^23 â€“ 1</td>
</tr>
<tr>
<td>bigint[unsigned]</td>
<td>8</td>
<td>bigint(20)</td>
<td>0åˆ° 2^64 â€“ 1</td>
<td>- 2^63 åˆ° 2^63 â€“ 1</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `BIT`(num BIT(<span class="number">8</span>));</span><br><span class="line"><span class="comment">-- m=8 è¡¨ç¤ºä¸€ä¸ªå­—èŠ‚0-255 --</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `BIT` <span class="keyword">VALUES</span> (<span class="number">123</span>); #<span class="number">01111011</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `BIT` <span class="keyword">VALUES</span> (<span class="number">255</span>); #<span class="number">11111111</span></span><br></pre></td></tr></table></figure>



<h4 id="æµ®ç‚¹å‹"><a href="#æµ®ç‚¹å‹" class="headerlink" title="æµ®ç‚¹å‹"></a>æµ®ç‚¹å‹</h4><table>
<thead>
<tr>
<th>ç±»å‹</th>
<th align="left">æ‰€å å­—èŠ‚æ•°</th>
<th>å¤‡æ³¨</th>
</tr>
</thead>
<tbody><tr>
<td>float(m,d)</td>
<td align="left">4</td>
<td>å•ç²¾åº¦ï¼Œm ä¸ºæ€»ä¸ªæ•°ï¼Œ d å°æ•°ç‚¹åè¾¹ä½æ•° ï¼Œé»˜è®¤æ˜¯float(10,2)</td>
</tr>
<tr>
<td>double(m,d)</td>
<td align="left">8</td>
<td>åŒç²¾åº¦ï¼Œm ä¸ºæ€»ä¸ªæ•°ï¼Œdä¸ºå°æ•°ç‚¹åè¾¹ä½æ•°ï¼Œé»˜è®¤æ˜¯double(16,4)</td>
</tr>
<tr>
<td>decimal(m,d)</td>
<td align="left">må­—èŠ‚ï¼ˆmysql3.23ä¹‹å‰ç‰ˆæœ¬ï¼‰ï¼Œm+2å­—èŠ‚ï¼ˆmysql 3.23ä»¥åç‰ˆæœ¬ ï¼‰</td>
<td>å‚¨å­˜ä¸ºå­—ç¬¦ä¸²çš„æµ®ç‚¹æ•° må¤§å°ä¸º1-256ï¼Œdçš„å¤§å°ä¸º0-30ï¼Œé»˜è®¤æ˜¯decimal(18,9)</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `<span class="type">DECIMAL</span>`(</span><br><span class="line">    num1 <span class="type">float</span>,</span><br><span class="line">    num2 <span class="keyword">double</span>,</span><br><span class="line">    num3 <span class="type">decimal</span>(<span class="number">30</span>,<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `<span class="type">DECIMAL</span>` <span class="keyword">VALUES</span> (<span class="number">88.12345678912345</span>,<span class="number">88.12345678912345</span>,<span class="number">88.12345678912345</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> `<span class="type">DECIMAL</span>`;</span><br><span class="line"><span class="number">88.1235</span>,<span class="number">88.12345678912345</span>,<span class="number">88.12345678912345000000</span></span><br></pre></td></tr></table></figure>



<h4 id="å­—ç¬¦ä¸²ç±»å‹"><a href="#å­—ç¬¦ä¸²ç±»å‹" class="headerlink" title="å­—ç¬¦ä¸²ç±»å‹"></a>å­—ç¬¦ä¸²ç±»å‹</h4><table>
<thead>
<tr>
<th align="left">ç±»å‹</th>
<th align="left">å­—èŠ‚èŒƒå›´å¤§å°</th>
<th align="center">å¤‡æ³¨</th>
</tr>
</thead>
<tbody><tr>
<td align="left">varchar</td>
<td align="left">0-65535å­—èŠ‚,ä½¿ç”¨ä¸­æ ¹æ®ç¼–ç å®é™…æƒ…å†µå¡«å†™ï¼Œå¦‚utf8ä¸º65532&#x2F;3å­—ç¬¦ï¼Œgbkä¸º65532&#x2F;2å­—ç¬¦</td>
<td align="center">å¯å˜é•¿åº¦å­—ç¬¦ä¸²ï¼ˆå¿…é¡»æŒ‡å®šé•¿åº¦ï¼‰ [0-2^16-1]</td>
</tr>
<tr>
<td align="left">char</td>
<td align="left">0-255å­—èŠ‚</td>
<td align="center">å›ºå®šé•¿åº¦å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="left">tinytext</td>
<td align="left">0-255å­—èŠ‚</td>
<td align="center">çŸ­æ–‡æœ¬å­—ç¬¦ä¸²ï¼ˆä¸èƒ½æŒ‡å®šé•¿åº¦ï¼‰</td>
</tr>
<tr>
<td align="left">text</td>
<td align="left">0-65535å­—èŠ‚</td>
<td align="center">é•¿æ–‡æœ¬æ•°æ®</td>
</tr>
<tr>
<td align="left">longtext</td>
<td align="left">0-4294967295å­—èŠ‚</td>
<td align="center">æå¤§æ–‡æœ¬æ•°æ® [0-2^24-1]</td>
</tr>
<tr>
<td align="left">tinyblob</td>
<td align="left">0-255å­—èŠ‚</td>
<td align="center">äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼ˆå­˜å‚¨å›¾ç‰‡ï¼Œè§†é¢‘ç­‰ï¼‰ï¼ˆä¸èƒ½æŒ‡å®šé•¿åº¦ï¼‰</td>
</tr>
<tr>
<td align="left">blob</td>
<td align="left">0-65535å­—èŠ‚</td>
<td align="center">äºŒè¿›åˆ¶å½¢å¼çš„é•¿æ–‡æœ¬ [0-2^16-1]</td>
</tr>
<tr>
<td align="left">longblob</td>
<td align="left">0-4294967295å­—èŠ‚</td>
<td align="center">äºŒè¿›åˆ¶å½¢å¼çš„æå¤§æ–‡æœ¬æ•°æ®</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="type">CHAR</span>(<span class="number">4</span>) #è¿™ä¸ª<span class="number">4</span>è¡¨ç¤ºå­—ç¬¦æ•°(æœ€å¤§<span class="number">255</span>)ï¼Œä¸æ˜¯å­—èŠ‚æ•°ï¼Œä¸­è‹±æ–‡éƒ½æ”¾<span class="number">4</span>ä¸ªï¼ŒæŒ‰å­—ç¬¦è®¡ç®—</span><br><span class="line"><span class="type">VARCHAR</span>(<span class="number">4</span>) #è¿™ä¸ª<span class="number">4</span>è¡¨ç¤ºå­—ç¬¦æ•°ï¼Œä¸­è‹±æ–‡éƒ½ä»¥å®šä¹‰å¥½çš„è¡¨çš„ç¼–ç æ¥å­˜æ”¾æ•°æ®,ä¸€ä¸ªå­—ç¬¦æ‰€å çš„å­—èŠ‚æ•°å–å†³äºç¼–ç </span><br></pre></td></tr></table></figure>



<h4 id="æ—¥æœŸå’Œæ—¶é—´ç±»å‹"><a href="#æ—¥æœŸå’Œæ—¶é—´ç±»å‹" class="headerlink" title="æ—¥æœŸå’Œæ—¶é—´ç±»å‹"></a>æ—¥æœŸå’Œæ—¶é—´ç±»å‹</h4><table>
<thead>
<tr>
<th><strong>ç±»å‹</strong></th>
<th><strong>æ‰€å å­—èŠ‚æ•°</strong></th>
<th><strong>å­˜å‚¨æ ¼å¼</strong></th>
<th><strong>æ”¯æŒçš„èŒƒå›´</strong></th>
</tr>
</thead>
<tbody><tr>
<td>date</td>
<td>3</td>
<td>YYYY-MM-DD</td>
<td>â€˜1000-01-01â€™ åˆ° â€˜9999-12-31â€™</td>
</tr>
<tr>
<td>time</td>
<td>3</td>
<td>HH:MM:SS</td>
<td>â€˜-838:59:59â€™ åˆ° â€˜838:59:59â€™</td>
</tr>
<tr>
<td>datetime</td>
<td>8</td>
<td>YYYY-MM-DD HH:MM:SS</td>
<td>â€˜1000-01-01 00:00:00â€™ åˆ° â€˜9999-12-31 23:59:59â€™</td>
</tr>
<tr>
<td>timestamp</td>
<td>4</td>
<td>è‡ªåŠ¨å­˜å‚¨è®°å½•ä¿®æ”¹çš„æ—¶é—´ï¼Œè®¾ç½®å€¼æ—¶åªå…è®¸è®¾ç½®æ•°å­—ç±»å‹çš„å€¼</td>
<td>æ—¶é—´æˆ³ï¼Œä»1970-01-01 00:00:00åˆ°å½“å‰çš„æ—¶é—´å·®å€¼ã€‚</td>
</tr>
<tr>
<td>year</td>
<td>1</td>
<td>YYYY</td>
<td>1901 åˆ° 2155</td>
</tr>
</tbody></table>
<h4 id="å¤åˆç±»å‹"><a href="#å¤åˆç±»å‹" class="headerlink" title="å¤åˆç±»å‹"></a>å¤åˆç±»å‹</h4><table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>è¯´æ˜</th>
<th>ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>set</td>
<td>é›†åˆç±»å‹</td>
<td>set(â€˜num1â€™,â€˜num2â€™,â€˜num3â€™)</td>
</tr>
<tr>
<td>enum</td>
<td>æšä¸¾ç±»å‹</td>
<td>enum(â€˜num1â€™,â€˜num2â€™,â€˜num3â€™)</td>
</tr>
</tbody></table>
<h2 id="ä¿®æ”¹è¡¨"><a href="#ä¿®æ”¹è¡¨" class="headerlink" title="ä¿®æ”¹è¡¨"></a>ä¿®æ”¹è¡¨</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `emp`(</span><br><span class="line">    `id` <span class="type">INT</span>,</span><br><span class="line">    `name` <span class="type">VARCHAR</span>(<span class="number">32</span>),</span><br><span class="line">    `sex`   <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">    `birthday` <span class="type">DATE</span>,</span><br><span class="line">    `entry_date` DATETIME,</span><br><span class="line">    `job`    <span class="type">VARCHAR</span>(<span class="number">32</span>),</span><br><span class="line">    `salary` <span class="keyword">DOUBLE</span>,</span><br><span class="line">    `resume`    TEXT</span><br><span class="line">)CHARSET utf8 <span class="keyword">COLLATE</span> utf8_bin ENGINE INNODB;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `emp` <span class="keyword">VALUES</span></span><br><span class="line">                      (<span class="number">100</span>,<span class="string">&#x27;name1&#x27;</span>,<span class="string">&#x27;ç”·&#x27;</span>,</span><br><span class="line">                       <span class="string">&#x27;2000-11-11&#x27;</span>,<span class="string">&#x27;2010-11-10 11:11:11&#x27;</span>,</span><br><span class="line">                       <span class="string">&#x27;job1&#x27;</span>,<span class="number">3000</span>,<span class="string">&#x27;resume1&#x27;</span>);</span><br></pre></td></tr></table></figure>



<h3 id="æ·»åŠ åˆ—"><a href="#æ·»åŠ åˆ—" class="headerlink" title="æ·»åŠ åˆ—"></a>æ·»åŠ åˆ—</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tablename <span class="keyword">ADD</span> (<span class="keyword">column</span> databyte [<span class="keyword">DEFAULT</span> expr]);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp <span class="keyword">ADD</span> `image` <span class="type">VARCHAR</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> AFTER resume;</span><br></pre></td></tr></table></figure>

<h3 id="æŸ¥çœ‹è¡¨ç»“æ„"><a href="#æŸ¥çœ‹è¡¨ç»“æ„" class="headerlink" title="æŸ¥çœ‹è¡¨ç»“æ„"></a>æŸ¥çœ‹è¡¨ç»“æ„</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DESC</span> TableName;</span><br><span class="line"><span class="keyword">DESC</span> emp;</span><br></pre></td></tr></table></figure>



<h3 id="ä¿®æ”¹åˆ—"><a href="#ä¿®æ”¹åˆ—" class="headerlink" title="ä¿®æ”¹åˆ—"></a>ä¿®æ”¹åˆ—</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName MODIFY (<span class="keyword">column</span> databyte [<span class="keyword">DEFAULT</span> expr]);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp MODIFY job <span class="type">VARCHAR</span>(<span class="number">60</span>)  <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h4 id="ä¿®æ”¹åˆ—å"><a href="#ä¿®æ”¹åˆ—å" class="headerlink" title="ä¿®æ”¹åˆ—å"></a>ä¿®æ”¹åˆ—å</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName CHANGE `OldName` <span class="keyword">TO</span> `NewName` <span class="type">VARCHAR</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span>; </span><br></pre></td></tr></table></figure>

<h4 id="åˆ é™¤åˆ—"><a href="#åˆ é™¤åˆ—" class="headerlink" title="åˆ é™¤åˆ—"></a>åˆ é™¤åˆ—</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName <span class="keyword">DROP</span> (<span class="keyword">column</span> databyte);</span><br></pre></td></tr></table></figure>

<h4 id="ä¿®æ”¹è¡¨å"><a href="#ä¿®æ”¹è¡¨å" class="headerlink" title="ä¿®æ”¹è¡¨å"></a>ä¿®æ”¹è¡¨å</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">RENAME <span class="keyword">TABLE</span> emp <span class="keyword">TO</span> employee;</span><br></pre></td></tr></table></figure>

<h4 id="ä¿®æ”¹è¡¨çš„å­—ç¬¦é›†"><a href="#ä¿®æ”¹è¡¨çš„å­—ç¬¦é›†" class="headerlink" title="ä¿®æ”¹è¡¨çš„å­—ç¬¦é›†"></a>ä¿®æ”¹è¡¨çš„å­—ç¬¦é›†</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> employee <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8;</span><br></pre></td></tr></table></figure>



<h2 id="CRUD"><a href="#CRUD" class="headerlink" title="CRUD"></a>CRUD</h2><p><em><strong>create read update delete</strong></em></p>
<p>æ•°æ®åº“çš„CRUDè¯­å¥</p>
<h3 id="Insert-æ·»åŠ æ•°æ®"><a href="#Insert-æ·»åŠ æ•°æ®" class="headerlink" title="Insert æ·»åŠ æ•°æ®"></a>Insert æ·»åŠ æ•°æ®</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TableName (column1,column2,column3) <span class="keyword">VALUES</span> (value1,value2,value3);</span><br><span class="line">#colä¸valæ˜¯å¯¹åº”çš„</span><br></pre></td></tr></table></figure>

<ul>
<li><p>æ’å…¥çš„æ•°æ®åº”ä¸å­—æ®µçš„ç±»å‹æ•°æ®ç›¸åŒ</p>
</li>
<li><p>æ•°æ®çš„é•¿åº¦åº”è¯¥åœ¨åˆ—çš„è§„å®šèŒƒå›´å†…</p>
</li>
<li><p>VALUESä¸­åˆ—å‡ºçš„æ•°æ®ä½ç½®å¿…é¡»ä¸è¢«åŠ å…¥çš„åˆ—çš„æ’åˆ—ä½ç½®ç›¸åº”</p>
</li>
<li><p>å­—ç¬¦å’Œæ—¥æœŸå‹æ•°æ®åº”è¯¥åŒ…å«åœ¨å•å¼•å·ä¸­</p>
</li>
<li><p>åˆ—å¯ä»¥æ’å…¥ç©ºå€¼[å‰ææ˜¯è¯¥å­—æ®µå…è®¸ä¸ºç©º] insert into table value(null)</p>
</li>
<li><p>æ·»åŠ å¤šæ¡è®°å½•</p>
<p><code>INSERT INTO TableName (column1,column2,column3)</code> </p>
<p>â€‹							<code>VALUES (value1,value2,value3)ï¼Œ</code></p>
<p>â€‹											<code>(value1,value2,value3);</code></p>
</li>
<li><p>é»˜è®¤å€¼çš„ä½¿ç”¨ï¼Œå½“ä¸ç»™æŸä¸ªå­—æ®µå€¼æ—¶ï¼Œå¦‚æœæœ‰é»˜è®¤å€¼å°±ä¼šæ·»åŠ ï¼Œå¦åˆ™æŠ¥é”™</p>
<p>å¦‚æœæŸä¸ªåˆ—æ²¡æœ‰æŒ‡å®š not nullï¼Œé‚£ä¹ˆæ·»åŠ æ•°æ®æ—¶ï¼Œæ²¡æœ‰ç»™å®šå€¼ï¼Œå°±ä¼šé»˜è®¤ç»™null</p>
<p>å¦‚æœå¸Œæœ›æŒ‡å®šæŸä¸ªåˆ—çš„é»˜è®¤å€¼ï¼Œå¯ä»¥åœ¨åˆ›å»ºè¡¨çš„æ—¶å€™æŒ‡å®š</p>
</li>
</ul>
<h4 id="è‡ªå¢é•¿"><a href="#è‡ªå¢é•¿" class="headerlink" title="è‡ªå¢é•¿"></a>è‡ªå¢é•¿</h4><p>è¡¨ä¸­å­˜åœ¨idåˆ—ï¼Œå¸Œæœ›æ·»åŠ æ•°æ®æ—¶ï¼Œè¯¥åˆ—ä»1å¼€å§‹è‡ªåŠ¨å¢é•¿</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">å­—æ®µå <span class="type">INT</span> <span class="keyword">primary</span> key auto_increment</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tableName auto_increment<span class="operator">=</span><span class="number">100</span> #ä¿®æ”¹è‡ªå¢é•¿å¼€å§‹å€¼</span><br></pre></td></tr></table></figure>

<p><strong>æ·»åŠ æ–¹å¼</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> xxx (å­—æ®µ<span class="number">1</span>ï¼Œå­—æ®µ<span class="number">2.</span>..) <span class="keyword">VALUES</span> (<span class="keyword">null</span>,<span class="string">&#x27;å€¼&#x27;</span>...);#å¸Œæœ›è‡ªå¢é•¿ï¼Œå­—æ®µ<span class="number">1</span>ç›´æ¥å¡«<span class="keyword">null</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> xxx ((å­—æ®µ<span class="number">1</span>ï¼Œå­—æ®µ<span class="number">2</span>ï¼Œå­—æ®µ<span class="number">3.</span>..) <span class="keyword">VALUES</span> (<span class="string">&#x27;å€¼2&#x27;</span>,<span class="string">&#x27;å€¼3&#x27;</span>...);#ç›´æ¥ä¸å†™autoæ‰€åœ¨çš„åˆ—</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> xxx <span class="keyword">VALUES</span> (<span class="keyword">null</span>,<span class="string">&#x27;å€¼1&#x27;</span>...);</span><br></pre></td></tr></table></figure>

<p><strong>è‹¥æŒ‡å®šåˆ™ä»æŒ‡å®šçš„å€¼å¢é•¿</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> xxx (å­—æ®µ<span class="number">1</span>ï¼Œå­—æ®µ<span class="number">2.</span>..) <span class="keyword">VALUES</span> (<span class="number">666</span>,<span class="keyword">null</span>,<span class="string">&#x27;å€¼&#x27;</span>...);#ä»<span class="number">666</span>å¼€å§‹å¢é•¿</span><br></pre></td></tr></table></figure>



<h3 id="Update-æ›´æ–°æ•°æ®"><a href="#Update-æ›´æ–°æ•°æ®" class="headerlink" title="Update æ›´æ–°æ•°æ®"></a>Update æ›´æ–°æ•°æ®</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> TableName </span><br><span class="line">	<span class="keyword">SET</span> col1<span class="operator">=</span>expr1,col2<span class="operator">=</span>expr2 [<span class="keyword">WHERE</span> expr];</span><br></pre></td></tr></table></figure>

<ul>
<li>UPDATEå¯ä»¥ç”¨æ–°å€¼è·Ÿæ–°åŸæœ‰åˆ—è¡¨ä¸­çš„å‰²è£‚</li>
<li>SETè¯­å¥æŒ‡ç¤ºè¦ä¿®æ”¹å“ªäº›åˆ—å’Œè¦èµ‹äºˆé‚£äº›å€¼</li>
<li>WHEREå­å¥æŒ‡å®šæ›´æ–°å“ªäº›è¡Œï¼Œæ²¡æœ‰WHEREå…¨æ›´æ–°</li>
<li>å¦‚æœè¦æ›´æ–°å¤šä¸ªå­—æ®µ é€šè¿‡ <code>set å­—æ®µ1=å€¼1,å­—æ®µ2=å€¼2</code>&#x3D;</li>
</ul>
<h3 id="Delete-åˆ é™¤æ•°æ®"><a href="#Delete-åˆ é™¤æ•°æ®" class="headerlink" title="Delete åˆ é™¤æ•°æ®"></a>Delete åˆ é™¤æ•°æ®</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">DEALETE <span class="keyword">FROM</span> TableName [<span class="keyword">WHERE</span> expr;];</span><br></pre></td></tr></table></figure>

<ul>
<li>ä¸ä½¿ç”¨WHEREå­å¥ï¼Œå°†åˆ é™¤è¡¨ä¸­æ‰€æœ‰çš„æ•°æ®</li>
<li>DELETE ä¸èƒ½åˆ é™¤æŸä¸€åˆ—çš„å€¼(å¯ä½¿ç”¨updateè®¾ä¸ºnullæˆ–è€…â€™ â€˜)</li>
<li>DELETE è¯­å¥ä»…åˆ é™¤è®°å½•ï¼Œä¸åˆ é™¤è¡¨æœ¬èº«ï¼Œå¦‚æœè¦åˆ é™¤è¡¨ï¼Œä½¿ç”¨<code>drop table</code>è¯­å¥</li>
</ul>
<h3 id="Select-æŸ¥æ‰¾æ•°æ®"><a href="#Select-æŸ¥æ‰¾æ•°æ®" class="headerlink" title="Select æŸ¥æ‰¾æ•°æ®"></a>Select æŸ¥æ‰¾æ•°æ®</h3><h4 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">DISTINCT</span>] <span class="operator">*</span><span class="operator">|</span> &#123;col1,col2,col3...&#125; <span class="keyword">FROM</span> tablename;</span><br></pre></td></tr></table></figure>

<ul>
<li>SELECTæŒ‡å®šæŸ¥è¯¢å“ªäº›åˆ—çš„æ•°æ®</li>
<li>colæŒ‡å®šåˆ—å</li>
<li>ä»£è¡¨æŸ¥è¯¢æ‰€æœ‰åˆ—</li>
<li>FROMæŒ‡å®šæŸ¥è¯¢å“ªå¼ è¡¨</li>
<li>DISTINCTå¯é€‰ï¼ŒæŒ‡æ˜¾ç¤ºç»“æœæ—¶ï¼Œæ˜¯å¦å»æ‰é‡å¤æ•°æ®ï¼Œæ¯ä¸ªå­—æ®µéƒ½ç›¸åŒæ‰ä¼šå»é‡</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">TABLE</span> student</span><br><span class="line">(</span><br><span class="line">    id      <span class="type">int</span>         <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>,</span><br><span class="line">    `name`   <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    chinese <span class="type">FLOAT</span>       <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span>,</span><br><span class="line">    english <span class="type">FLOAT</span>       <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span>,</span><br><span class="line">    math    <span class="type">FLOAT</span>       <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student (id, `name`, chinese, english, math)</span><br><span class="line">	  <span class="keyword">VALUES</span>(<span class="number">1</span>, <span class="string">&#x27;NAME1&#x27;</span>, <span class="number">89</span>, <span class="number">78</span>, <span class="number">90</span>),</span><br><span class="line">       		(<span class="number">2</span>, <span class="string">&#x27;NAME2&#x27;</span>, <span class="number">67</span>, <span class="number">98</span>, <span class="number">56</span>),</span><br><span class="line">      	 	(<span class="number">3</span>, <span class="string">&#x27;NAME3&#x27;</span>, <span class="number">87</span>, <span class="number">78</span>, <span class="number">77</span>),		</span><br><span class="line">      	 	(<span class="number">4</span>, <span class="string">&#x27;NAME4&#x27;</span>, <span class="number">88</span>, <span class="number">98</span>, <span class="number">90</span>),</span><br><span class="line">       		(<span class="number">5</span>, <span class="string">&#x27;NAME5&#x27;</span>, <span class="number">82</span>, <span class="number">84</span>, <span class="number">67</span>),</span><br><span class="line">       		(<span class="number">6</span>, <span class="string">&#x27;NAME6&#x27;</span>, <span class="number">55</span>, <span class="number">85</span>, <span class="number">45</span>),</span><br><span class="line">       		(<span class="number">7</span>, <span class="string">&#x27;NAME7&#x27;</span>, <span class="number">75</span>, <span class="number">65</span>, <span class="number">30</span>),</span><br><span class="line">       		(<span class="number">8</span>, <span class="string">&#x27;NAME8&#x27;</span>, <span class="number">45</span>, <span class="number">65</span>, <span class="number">99</span>);  </span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> student;</span><br></pre></td></tr></table></figure>

<hr>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `name`,english <span class="keyword">FROM</span> student;</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> english <span class="keyword">FROM</span> student;</span><br></pre></td></tr></table></figure>

<h4 id="ä½¿ç”¨è¡¨è¾¾å¼å¯¹æŸ¥è¯¢çš„åˆ—è¿ç®—ä¸åˆ«å"><a href="#ä½¿ç”¨è¡¨è¾¾å¼å¯¹æŸ¥è¯¢çš„åˆ—è¿ç®—ä¸åˆ«å" class="headerlink" title="ä½¿ç”¨è¡¨è¾¾å¼å¯¹æŸ¥è¯¢çš„åˆ—è¿ç®—ä¸åˆ«å"></a>ä½¿ç”¨è¡¨è¾¾å¼å¯¹æŸ¥è¯¢çš„åˆ—è¿ç®—ä¸åˆ«å</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span><span class="operator">|</span>&#123;<span class="keyword">column</span><span class="operator">|</span>expression , column2<span class="operator">|</span>expression,...&#125; <span class="keyword">FROM</span> TableName;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> columnName <span class="keyword">AS</span> åˆ«å <span class="keyword">FROM</span> TableName;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `name`,(chinese<span class="operator">+</span>math<span class="operator">+</span>english) <span class="keyword">AS</span> <span class="string">&#x27;SUM&#x27;</span> <span class="keyword">FROM</span> student;</span><br></pre></td></tr></table></figure>

<h4 id="WHEREå­å¥å¸¸ç”¨è¿ç®—ç¬¦"><a href="#WHEREå­å¥å¸¸ç”¨è¿ç®—ç¬¦" class="headerlink" title="WHEREå­å¥å¸¸ç”¨è¿ç®—ç¬¦"></a>WHEREå­å¥å¸¸ç”¨è¿ç®—ç¬¦</h4><table>
<thead>
<tr>
<th align="center"><strong>æ¯”è¾ƒè¿ç®—ç¬¦</strong></th>
<th align="left"><strong>æè¿°</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">&#x3D;     !&#x3D;     &gt;     &lt;    &gt;&#x3D;   &lt;&#x3D;</td>
<td align="left">ç­‰äº,ä¸ç­‰äº,å¤§äº,å°äº,å¤§äºç­‰äº,å°äºç­‰äº</td>
</tr>
<tr>
<td align="center">BETWEEN  â€¦ANDâ€¦</td>
<td align="left">åœ¨æŸä¸ªèŒƒå›´å†…,å·¦å³é—­åŒºé—´</td>
</tr>
<tr>
<td align="center">LIKE  NOT LIKE</td>
<td align="left">æ¨¡ç³Šæœç´¢æŸç§æ¨¡å¼</td>
</tr>
<tr>
<td align="center">IN</td>
<td align="left">æŒ‡å®šé’ˆå¯¹æŸä¸ªåˆ—çš„å¤šä¸ªå¯èƒ½å€¼</td>
</tr>
<tr>
<td align="center">IS NULL</td>
<td align="left">åˆ¤æ–­æ˜¯å¦ä¸ºç©º</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center"><strong>é€»è¾‘è¿ç®—ç¬¦</strong></th>
<th align="left"><strong>æè¿°</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">AND</td>
<td align="left">å¤šä¸ªæ¡ä»¶åŒæ—¶æˆç«‹</td>
</tr>
<tr>
<td align="center">OR</td>
<td align="left">å¤šä¸ªæ¡ä»¶ä»»ä¸€æˆç«‹</td>
</tr>
<tr>
<td align="center">NOT</td>
<td align="left">ä¸æˆç«‹</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> `name`<span class="operator">=</span><span class="string">&#x27;name1&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> english <span class="operator">&gt;</span> <span class="number">90</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> english <span class="keyword">BETWEEN</span> <span class="number">80</span> <span class="keyword">AND</span> <span class="number">90</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> english <span class="keyword">IN</span> ( <span class="number">89</span>,<span class="number">90</span>,<span class="number">91</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> student <span class="keyword">WHERE</span> </span><br><span class="line">				(english<span class="operator">+</span>math<span class="operator">+</span>chinese)<span class="operator">&gt;</span><span class="number">200</span> </span><br><span class="line">				<span class="keyword">AND</span> math <span class="operator">&lt;</span> chinese </span><br><span class="line">				<span class="keyword">AND</span> `name` <span class="keyword">LIKE</span> <span class="string">&#x27;éŸ©%&#x27;</span>;</span><br><span class="line">#æŸ¥è¯¢æ€»åˆ†å¤§äº<span class="number">200</span>ï¼Œæ•°å­¦å°äºè¯­æ–‡ï¼Œå§“&quot;éŸ©&quot;çš„å­¦ç”Ÿ</span><br></pre></td></tr></table></figure>



<h4 id="ORDER-BYå­å¥æ’åºæŸ¥è¯¢ç»“æœ"><a href="#ORDER-BYå­å¥æ’åºæŸ¥è¯¢ç»“æœ" class="headerlink" title="ORDER BYå­å¥æ’åºæŸ¥è¯¢ç»“æœ"></a>ORDER BYå­å¥æ’åºæŸ¥è¯¢ç»“æœ</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column1,column2,column3...FROM <span class="keyword">table</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">column</span> <span class="keyword">asc</span><span class="operator">|</span><span class="keyword">desc</span>,...</span><br></pre></td></tr></table></figure>

<ul>
<li>ORDER BYæŒ‡å®šæ’åºçš„åˆ—ï¼Œæ’åºçš„åˆ—æ—¢å¯ä»¥æ˜¯è¡¨çš„åˆ—åä¹Ÿå¯ä»¥æ˜¯selectè¯­å¥åæŒ‡å®šçš„åˆ«å</li>
<li>ASCå‡åº[é»˜è®¤]ï¼ŒDESCé™åº</li>
<li>ORDER BYè¯­å¥ç¡¬ä½äºSELECTè¯­å¥çš„ç»“å°¾</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `name`,(chinese <span class="operator">+</span> math <span class="operator">+</span> english) <span class="keyword">AS</span> total <span class="keyword">FROM</span> student <span class="keyword">ORDER</span> <span class="keyword">BY</span> total <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> `name` <span class="keyword">LIKE</span> <span class="string">&#x27;æ%&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> math <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>





<h3 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h3><h4 id="COUNTç»Ÿè®¡å‡½æ•°"><a href="#COUNTç»Ÿè®¡å‡½æ•°" class="headerlink" title="COUNTç»Ÿè®¡å‡½æ•°"></a>COUNTç»Ÿè®¡å‡½æ•°</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)<span class="operator">|</span><span class="built_in">COUNT</span>(åˆ—å) <span class="keyword">FROM</span> TableName [<span class="keyword">WHERE</span> expr];</span><br></pre></td></tr></table></figure>

<ul>
<li>COUNT(*)è¿”å›æ»¡è¶³æ¡ä»¶çš„è®°å½•çš„è¡Œæ•°</li>
<li>COUNT(åˆ—å)æ˜¯ç»Ÿè®¡æ»¡è¶³æ¡ä»¶çš„æŸåˆ—æœ‰å¤šå°‘ä¸ªï¼Œä½†æ˜¯ä¼šæ’é™¤ä¸ºç©ºçš„æƒ…å†µ</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `COUNT` (`name` <span class="type">VARCHAR</span>(<span class="number">20</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> COUNT <span class="keyword">VALUES</span> (<span class="string">&#x27;TOM&#x27;</span>),(<span class="string">&#x27;JACK&#x27;</span>),(<span class="string">&#x27;MARY&#x27;</span>),(<span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> `COUNT`;   <span class="comment">/*4*/</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(`name`) <span class="keyword">FROM</span> `COUNT`;  <span class="comment">/*3*/</span></span><br></pre></td></tr></table></figure>



<h4 id="SUMå‡½æ•°"><a href="#SUMå‡½æ•°" class="headerlink" title="SUMå‡½æ•°"></a>SUMå‡½æ•°</h4><p>SUMå‡½æ•°è¿”å›å¤åˆWHEREæ¡ä»¶è¡Œçš„å’Œï¼Œä»…å¯¹æ•°å€¼èµ·ä½œç”¨ï¼Œå¯¹å¤šåˆ—æ±‚å’Œâ€œï¼Œâ€ä¸èƒ½å°‘ï¼Œå¦åˆ™ä¼šæŠ¥é”™</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(åˆ—å) &#123;,<span class="built_in">SUM</span>(åˆ—å)...&#125; <span class="keyword">FROM</span> TableName [<span class="keyword">WHERE</span> expr];</span><br></pre></td></tr></table></figure>



<h4 id="AVGå‡½æ•°"><a href="#AVGå‡½æ•°" class="headerlink" title="AVGå‡½æ•°"></a>AVGå‡½æ•°</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(åˆ—å) &#123;,<span class="built_in">AVG</span>(åˆ—å)...&#125; <span class="keyword">FROM</span> TableName [<span class="keyword">WHERE</span> expr];</span><br></pre></td></tr></table></figure>



<h4 id="MAX-MINå‡½æ•°"><a href="#MAX-MINå‡½æ•°" class="headerlink" title="MAX&#x2F;MINå‡½æ•°"></a>MAX&#x2F;MINå‡½æ•°</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(åˆ—å) <span class="keyword">FROM</span> TableName [<span class="keyword">WHERE</span> expr];</span><br></pre></td></tr></table></figure>



<h4 id="GROUP-BY-å¯¹-å­å¥é˜Ÿåˆ—è¿›è¡Œåˆ†ç»„"><a href="#GROUP-BY-å¯¹-å­å¥é˜Ÿåˆ—è¿›è¡Œåˆ†ç»„" class="headerlink" title="GROUP BY å¯¹ å­å¥é˜Ÿåˆ—è¿›è¡Œåˆ†ç»„"></a>GROUP BY å¯¹ å­å¥é˜Ÿåˆ—è¿›è¡Œåˆ†ç»„</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col1ï¼Œcol2...FROM <span class="keyword">table</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> col;</span><br></pre></td></tr></table></figure>

<p>åªè¦æœ‰èšåˆå‡½æ•° sum()ï¼Œcount()ï¼Œmax()ï¼Œavg() ç­‰å‡½æ•°å°±éœ€è¦ç”¨åˆ° group by , å¦åˆ™å°±ä¼šæŠ¥ä¸Šé¢çš„é”™è¯¯.<br>group by id (id æ˜¯ä¸»é”®) çš„æ—¶å€™, select ä»€ä¹ˆéƒ½æ²¡æœ‰é—®é¢˜, åŒ…æ‹¬æœ‰èšåˆå‡½æ•°.<br>group by role (éä¸»é”®) çš„æ—¶å€™, select åªèƒ½æ˜¯èšåˆå‡½æ•°å’Œ role ( group by çš„å­—æ®µ) , å¦åˆ™æŠ¥é”™</p>
<p><strong>ä½¿ç”¨HAVINGå­å¥å¯¹åˆ†ç»„ä»¥åçš„ç»“æœè¿‡æ»¤</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col1ï¼Œcol2...FROM <span class="keyword">table</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> col <span class="keyword">HAVING</span> ...;</span><br></pre></td></tr></table></figure>



<h5 id="example"><a href="#example" class="headerlink" title="example"></a>example</h5><p> <strong>éƒ¨å‘˜è¡¨</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#éƒ¨å‘˜è¡¨</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> dept</span><br><span class="line">(</span><br><span class="line">    deptno MEDIUMINT   <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">    dname  <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    loc    <span class="type">VARCHAR</span>(<span class="number">13</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dept</span><br><span class="line">    <span class="keyword">VALUES</span> (<span class="number">10</span>, <span class="string">&#x27;ACCOUNTING&#x27;</span>, <span class="string">&#x27;NEW YORK&#x27;</span>),</span><br><span class="line">           (<span class="number">20</span>, <span class="string">&#x27;RESEARCH&#x27;</span>, <span class="string">&#x27;DALLAS&#x27;</span>),</span><br><span class="line">           (<span class="number">30</span>, <span class="string">&#x27;SALES&#x27;</span>, <span class="string">&#x27;CHICAGO&#x27;</span>),</span><br><span class="line">           (<span class="number">40</span>, <span class="string">&#x27;OPERATIONS&#x27;</span>, <span class="string">&#x27;BOSHTON&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> dept;</span><br></pre></td></tr></table></figure>



<p><strong>é›‡å‘˜è¡¨</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#é›‡å‘˜è¡¨</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp</span><br><span class="line">(</span><br><span class="line">    empno    MEDIUMINT UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,  #ç¼–å·</span><br><span class="line">    ename    <span class="type">VARCHAR</span>(<span class="number">20</span>)        <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span>, #åå­—</span><br><span class="line">    job      <span class="type">VARCHAR</span>(<span class="number">9</span>)         <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span>, #å·¥ä½œ</span><br><span class="line">    mgr      MEDIUMINT UNSIGNED,				    #ä¸Šçº§ç¼–å·</span><br><span class="line">    hiredate <span class="type">DATE</span>               <span class="keyword">NOT</span> <span class="keyword">NULL</span>, 		     #å…¥èŒæ—¶é—´</span><br><span class="line">    sal      <span class="type">DECIMAL</span>(<span class="number">7</span>, <span class="number">2</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span>,			#è–ªæ°´</span><br><span class="line">    comm     <span class="type">DECIMAL</span>(<span class="number">7</span>, <span class="number">2</span>),						   #çº¢åˆ©</span><br><span class="line">    deptno   MEDIUMINT UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>   #éƒ¨é—¨ç¼–å·</span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp</span><br><span class="line">        <span class="keyword">VALUES</span>(<span class="number">7369</span>,<span class="string">&#x27;SMITH&#x27;</span>,<span class="string">&#x27;CLERK&#x27;</span>,<span class="number">7902</span>,<span class="string">&#x27;1990-12-17&#x27;</span>,<span class="number">800.00</span>,<span class="keyword">NULL</span>,<span class="number">20</span>),</span><br><span class="line">              (<span class="number">7499</span>,<span class="string">&#x27;ALLEN&#x27;</span>,<span class="string">&#x27;SALESMAN&#x27;</span>,<span class="number">7698</span>,<span class="string">&#x27;1991-2-20&#x27;</span>,<span class="number">1600.00</span>,<span class="number">300.00</span>,<span class="number">30</span>),</span><br><span class="line">              (<span class="number">7521</span>,<span class="string">&#x27;WARD&#x27;</span>,<span class="string">&#x27;SALESMAN&#x27;</span>,<span class="number">7698</span>,<span class="string">&#x27;1991-2-22&#x27;</span>,<span class="number">1250.00</span>,<span class="number">500.00</span>,<span class="number">30</span>),</span><br><span class="line">              (<span class="number">7566</span>,<span class="string">&#x27;JONES&#x27;</span>,<span class="string">&#x27;MANAGER&#x27;</span>,<span class="number">7839</span>,<span class="string">&#x27;1991-4-2&#x27;</span>,<span class="number">2975.00</span>,<span class="keyword">NULL</span>,<span class="number">20</span>),</span><br><span class="line">              (<span class="number">7654</span>,<span class="string">&#x27;MARTIN&#x27;</span>,<span class="string">&#x27;SALESMAN&#x27;</span>,<span class="number">7698</span>,<span class="string">&#x27;1991-9-28&#x27;</span>,<span class="number">1250.00</span>,<span class="number">1400.00</span>,<span class="number">30</span>),</span><br><span class="line">              (<span class="number">7698</span>,<span class="string">&#x27;BLAKE&#x27;</span>,<span class="string">&#x27;MANAGER&#x27;</span>,<span class="number">7839</span>,<span class="string">&#x27;1991-5-1&#x27;</span>,<span class="number">2850.00</span>,<span class="keyword">NULL</span>,<span class="number">30</span>),</span><br><span class="line">              (<span class="number">7782</span>,<span class="string">&#x27;CLARK&#x27;</span>,<span class="string">&#x27;MANAGER&#x27;</span>,<span class="number">7839</span>,<span class="string">&#x27;1991-6-9&#x27;</span>,<span class="number">2450.00</span>,<span class="keyword">NULL</span>,<span class="number">10</span>),</span><br><span class="line">              (<span class="number">7788</span>,<span class="string">&#x27;SCOTT&#x27;</span>,<span class="string">&#x27;ANALYST&#x27;</span>,<span class="number">7566</span>,<span class="string">&#x27;1991-4-19&#x27;</span>,<span class="number">3000.00</span>,<span class="keyword">NULL</span>,<span class="number">20</span>),</span><br><span class="line">              (<span class="number">7839</span>,<span class="string">&#x27;KING&#x27;</span>,<span class="string">&#x27;PRESIDENT&#x27;</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;1991-11-17&#x27;</span>,<span class="number">5000.00</span>,<span class="keyword">NULL</span>,<span class="number">10</span>),</span><br><span class="line">              (<span class="number">7844</span>,<span class="string">&#x27;TURNER&#x27;</span>,<span class="string">&#x27;SALESMAN&#x27;</span>,<span class="number">7698</span>,<span class="string">&#x27;1991-9-8&#x27;</span>,<span class="number">1500.00</span>,<span class="keyword">NULL</span>,<span class="number">30</span>),</span><br><span class="line">              (<span class="number">7900</span>,<span class="string">&#x27;JAMES&#x27;</span>,<span class="string">&#x27;CLERK&#x27;</span>,<span class="number">7698</span>,<span class="string">&#x27;1991-12-3&#x27;</span>,<span class="number">950.00</span>,<span class="keyword">NULL</span>,<span class="number">30</span>),</span><br><span class="line">              (<span class="number">7902</span>,<span class="string">&#x27;FORD&#x27;</span>,<span class="string">&#x27;ANALYST&#x27;</span>,<span class="number">7566</span>,<span class="string">&#x27;1991-12-3&#x27;</span>,<span class="number">3000.00</span>,<span class="keyword">NULL</span>,<span class="number">20</span>),</span><br><span class="line">              (<span class="number">7934</span>,<span class="string">&#x27;MILLER&#x27;</span>,<span class="string">&#x27;CLERK&#x27;</span>,<span class="number">7782</span>,<span class="string">&#x27;1991-1-23&#x27;</span>,<span class="number">1300.00</span>,<span class="keyword">NULL</span>,<span class="number">10</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#æ˜¾ç¤ºæ¯ä¸ªéƒ¨é—¨çš„å¹³å‡å·¥èµ„å’Œæœ€é«˜å·¥èµ„</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(sal),<span class="built_in">MAX</span>(sal),deptno <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno;</span><br><span class="line">#æ˜¾ç¤ºæ¯ä¸ªéƒ¨é—¨æ¯ç§å²—ä½çš„å¹³å‡å·¥èµ„å’Œæœ€ä½å·¥èµ„</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(sal),<span class="built_in">MIN</span>(sal),deptno,job <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno,job;</span><br><span class="line">#æ˜¾ç¤ºå¹³å‡å·¥èµ„ä½äº<span class="number">2000</span>çš„éƒ¨é—¨å·å’Œä»–çš„å¹³å‡å·¥èµ„</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(sal),deptno <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno <span class="keyword">HAVING</span>  <span class="built_in">AVG</span>(sal) <span class="operator">&lt;</span><span class="number">2000</span> ;</span><br><span class="line">#ä½¿ç”¨åˆ«å</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(sal) <span class="keyword">AS</span> &quot;avgsal&quot;,deptno <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno <span class="keyword">HAVING</span>  avgsal <span class="operator">&lt;</span><span class="number">2000</span> ;</span><br></pre></td></tr></table></figure>



<p><strong>å·¥èµ„çº§åˆ«è¡¨</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#å·¥èµ„çº§åˆ«è¡¨</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> salgrade(</span><br><span class="line">    grade MEDIUMINT UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">    losal <span class="type">DECIMAL</span>(<span class="number">17</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    hisal <span class="type">DECIMAL</span>(<span class="number">17</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> salgrade </span><br><span class="line">	<span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="number">700</span>,<span class="number">1200</span>),</span><br><span class="line">    	  (<span class="number">2</span>,<span class="number">1201</span>,<span class="number">1400</span>),</span><br><span class="line">    	  (<span class="number">3</span>,<span class="number">1401</span>,<span class="number">2000</span>),</span><br><span class="line">    	  (<span class="number">4</span>,<span class="number">2001</span>,<span class="number">3000</span>),</span><br><span class="line">    	  (<span class="number">5</span>,<span class="number">3001</span>,<span class="number">9999</span>);</span><br></pre></td></tr></table></figure>



<h4 id="å­—ç¬¦ä¸²ç›¸å…³å‡½æ•°"><a href="#å­—ç¬¦ä¸²ç›¸å…³å‡½æ•°" class="headerlink" title="å­—ç¬¦ä¸²ç›¸å…³å‡½æ•°"></a>å­—ç¬¦ä¸²ç›¸å…³å‡½æ•°</h4><table>
<thead>
<tr>
<th align="left">CHARSET(str)</th>
<th align="left">è¿”å›å­—ä¸²å­—ç¬¦é›†</th>
</tr>
</thead>
<tbody><tr>
<td align="left">CONCAT(string [,â€¦])</td>
<td align="left">é“¾æ¥å­—ä¸²</td>
</tr>
<tr>
<td align="left">UCASE(string) &#x2F; LCASE(string)</td>
<td align="left">è½¬åŒ–æˆå¤§å†™&#x2F;å°å†™</td>
</tr>
<tr>
<td align="left">LENGTH(string)</td>
<td align="left">é•¿åº¦</td>
</tr>
<tr>
<td align="left">REPLACE(str , search_str , replace_str)</td>
<td align="left">strä¸­ç”¨replace_stræ›¿æ¢search_str</td>
</tr>
<tr>
<td align="left">SUBSTRING(str , position , [length])</td>
<td align="left">strçš„positionå¼€å§‹[ç´¢å¼•ä»1å¼€å§‹],å–lengthä¸ªå­—ç¬¦</td>
</tr>
<tr>
<td align="left">INSTR(str,substring)</td>
<td align="left">è¿”å›substringåœ¨strä¸­å‡ºç°çš„ä½ç½®ï¼Œæ²¡æœ‰è¿”å›0</td>
</tr>
<tr>
<td align="left">STRCMP(str1,str2)</td>
<td align="left">é€å­—ç¬¦æ¯”è¾ƒä¸¤å­—ä¸²çš„å¤§å°ï¼Œç›¸ç­‰ä¸º0ï¼Œä¸ç›¸ç­‰-1</td>
</tr>
<tr>
<td align="left">LTRIM(str) &#x2F; RTRIM(str)</td>
<td align="left">å»æ‰å‰ç«¯æˆ–è€…åç«¯ç©ºæ ¼</td>
</tr>
<tr>
<td align="left">LEFT(str,length) &#x2F; RIGHT(str,length)</td>
<td align="left">ä»å·¦è¾¹&#x2F;å³è¾¹å–lengthä¸ªå­—ä¸²</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> CHARSET(ename) <span class="keyword">FROM</span> emp; #utf8mb4</span><br><span class="line"><span class="keyword">SELECT</span> CONCAT(ename,<span class="string">&#x27; job is &#x27;</span> ,job) <span class="keyword">FROM</span> emp; #SMITH job <span class="keyword">is</span> CLERK</span><br><span class="line"><span class="keyword">SELECT</span> LCASE(CONCAT(ename,<span class="string">&#x27; job is &#x27;</span> ,job)) <span class="keyword">FROM</span> emp; #smith job <span class="keyword">is</span> clerk</span><br><span class="line"><span class="keyword">SELECT</span> ename, LENGTH(ename) <span class="keyword">FROM</span> emp; #SMITH <span class="number">5</span></span><br><span class="line"><span class="keyword">SELECT</span> REPLACE(<span class="string">&#x27;HELLO,GOLANG&#x27;</span>,<span class="string">&#x27;GOLANG&#x27;</span>,<span class="string">&#x27;WORLD&#x27;</span>) <span class="keyword">FROM</span> dual; #HELLO,WORLD</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUBSTRING</span>(<span class="string">&#x27;hello world&#x27;</span>,<span class="number">7</span>); #world</span><br><span class="line"><span class="keyword">SELECT</span> INSTR(<span class="string">&#x27;HELLO WORLD&#x27;</span>,<span class="string">&#x27;WORLD&#x27;</span>) <span class="keyword">FROM</span> dual; #<span class="number">7</span></span><br><span class="line"><span class="keyword">SELECT</span> STRCMP(<span class="string">&#x27;HELLO WORLD&#x27;</span>,<span class="string">&#x27;HELLO,GOLANG&#x27;</span>) <span class="keyword">FROM</span> dual; #<span class="number">-1</span></span><br><span class="line"><span class="keyword">SELECT</span> LTRIM(<span class="string">&#x27;    hello&#x27;</span>) <span class="keyword">FROM</span> dual; #hello </span><br></pre></td></tr></table></figure>



<h4 id="æ•°å­¦ç›¸å…³å‡½æ•°"><a href="#æ•°å­¦ç›¸å…³å‡½æ•°" class="headerlink" title="æ•°å­¦ç›¸å…³å‡½æ•°"></a>æ•°å­¦ç›¸å…³å‡½æ•°</h4><table>
<thead>
<tr>
<th align="left">ABS()</th>
<th align="left">ç»å¯¹å€¼</th>
</tr>
</thead>
<tbody><tr>
<td align="left">BIN()</td>
<td align="left">è½¬åŒ–äºŒè¿›åˆ¶</td>
</tr>
<tr>
<td align="left">HEX()</td>
<td align="left">è½¬åŒ–åå…­è¿›åˆ¶</td>
</tr>
<tr>
<td align="left">CONV(num,oldBase,newBase)</td>
<td align="left">è½¬åŒ–è¿›åˆ¶</td>
</tr>
<tr>
<td align="left">CEILING()</td>
<td align="left">å‘ä¸Šå–æ•´</td>
</tr>
<tr>
<td align="left">FLOOR()</td>
<td align="left">å‘ä¸‹å–æ•´</td>
</tr>
<tr>
<td align="left">FORMAT(num,å°æ•°ä½æ•°)</td>
<td align="left">ä¿ç•™å°æ•°ä½æ•°,è¶…å‡ºä½å››èˆäº”å…¥</td>
</tr>
<tr>
<td align="left">LEAST(num1,num2,num3)</td>
<td align="left">æ±‚æœ€å°å€¼</td>
</tr>
<tr>
<td align="left">MOD(numerator,denominator)</td>
<td align="left">æ±‚ä½™</td>
</tr>
<tr>
<td align="left">RAND([seed])</td>
<td align="left">éšæœºæ•°ï¼ŒèŒƒå›´æ˜¯[0 , 1.0]</td>
</tr>
</tbody></table>
<h4 id="æ—¶é—´å‡½æ•°"><a href="#æ—¶é—´å‡½æ•°" class="headerlink" title="æ—¶é—´å‡½æ•°"></a>æ—¶é—´å‡½æ•°</h4><table>
<thead>
<tr>
<th>CURRENT_DATE()</th>
<th>å½“å‰æ—¥æœŸ</th>
</tr>
</thead>
<tbody><tr>
<td>CURRENT_TIME**()**</td>
<td>å½“å‰æ—¶é—´</td>
</tr>
<tr>
<td>DATE(datetime)</td>
<td>è¿”å›datetimeçš„æ—¥æœŸéƒ¨åˆ†</td>
</tr>
<tr>
<td>DATE_ADD(date,INTERVAL d_value d_type)</td>
<td>dateåŸºç¡€ä¸ŠåŠ ä¸Šæ—¥æœŸæˆ–æ—¶é—´</td>
</tr>
<tr>
<td>DATE_SUB(date,INTERVAL d_value d_type)</td>
<td>dateåŸºç¡€ä¸Šå‡å»æ—¥æœŸæˆ–æ—¶é—´</td>
</tr>
<tr>
<td>DATEDIFF(date1,date2)</td>
<td>æ—¶é—´å·®</td>
</tr>
<tr>
<td>NOW()</td>
<td>å½“å‰æ—¶é—´</td>
</tr>
<tr>
<td>YEAR | MONTH | DAY| DATE(datetime)</td>
<td>å¹´æœˆæ—¥</td>
</tr>
<tr>
<td>UNIX_TIMESTAMP()ï¼›</td>
<td>è¿”å›1970-1-1åˆ°ç°åœ¨çš„ç§’æ•°</td>
</tr>
<tr>
<td>FROM_UNIXTIME()</td>
<td>å¯ä»¥æŠŠunix_timestampè½¬åŒ–æˆæŒ‡å®šæ ¼å¼æ—¥æœŸ</td>
</tr>
</tbody></table>
<ul>
<li>DATE_ADDåé¢å¯ä»¥æ˜¯yearï¼Œminuteï¼Œsecondï¼Œday</li>
<li>DATEDIFF(date1,date2)å¾—åˆ°çš„æ˜¯å¤©æ•°ï¼Œæ˜¯date1-date2çš„å¤©æ•°ï¼Œå¯ä»¥å–è´Ÿæ•°</li>
<li>DATEï¼ŒDATE_ADDï¼ŒDATE_SUBï¼ŒDATEDIFFçš„æ—¥æœŸç±»å‹å¯ä»¥æ˜¯dateã€‚datetimeï¼Œtimestamp</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">CURRENT_DATE</span>,<span class="built_in">CURRENT_TIME</span>,<span class="built_in">CURRENT_TIMESTAMP</span>,<span class="built_in">CURRENT_USER</span> <span class="keyword">FROM</span> dual;</span><br><span class="line">#   <span class="number">2023</span><span class="number">-07</span><span class="number">-28</span>       <span class="number">18</span>:<span class="number">49</span>:<span class="number">02</span>  <span class="number">2023</span><span class="number">-07</span><span class="number">-28</span> <span class="number">18</span>:<span class="number">49</span>:<span class="number">02</span> root<span class="variable">@localhost</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> mes(</span><br><span class="line">    id <span class="type">INT</span>,</span><br><span class="line">    content <span class="type">VARCHAR</span>(<span class="number">30</span>),</span><br><span class="line">    send_time DATETIME</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> mes <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;åŒ—äº¬æ–°é—»&#x27;</span>,<span class="built_in">CURRENT_TIMESTAMP</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> mes <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;ä¸Šæµ·æ–°é—»&#x27;</span>,<span class="string">&#x27;2020-11-11&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> mes <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">&#x27;å¤©æ´¥æ–°é—»&#x27;</span>,NOW());</span><br><span class="line"></span><br><span class="line">#åªæ˜¾ç¤ºæ—¥æœŸä¸æ˜¾ç¤ºæ—¶é—´</span><br><span class="line"><span class="keyword">select</span> id,content,<span class="type">DATE</span>(send_time) <span class="keyword">from</span> mes;</span><br><span class="line">#æŸ¥è¯¢<span class="number">10</span>minå†…å‘å¸ƒçš„æ–°é—»</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span><span class="keyword">from</span> mes <span class="keyword">where</span> DATE_ADD (send_time , <span class="type">INTERVAL</span> <span class="number">10</span> <span class="keyword">MINUTE</span>) <span class="operator">&gt;=</span> NOW() <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span><span class="keyword">from</span> mes <span class="keyword">where</span> DATE_SUB (NOW() , <span class="type">INTERVAL</span> <span class="number">10</span> <span class="keyword">MINUTE</span>) <span class="operator">&lt;=</span> send_time <span class="keyword">from</span> dual;</span><br><span class="line">#<span class="number">2011</span><span class="number">-11</span><span class="number">-11</span>ä¸<span class="number">1990</span><span class="number">-1</span><span class="number">-1</span>ç›¸å·®å¤šå°‘å¤©</span><br><span class="line"><span class="keyword">select</span> datediff(<span class="string">&#x27;2011-11-11&#x27;</span>,<span class="string">&#x27;1990-1-1&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line">#æ ¼å¼åŒ–</span><br><span class="line"><span class="keyword">select</span> from_unixtime(unix_timestamp(),<span class="string">&#x27;%Y-%m-%d %H:%i:%s&#x27;</span>); #<span class="number">2023</span><span class="number">-07</span><span class="number">-28</span> <span class="number">19</span>:<span class="number">25</span>:<span class="number">35</span></span><br></pre></td></tr></table></figure>



<h4 id="åŠ å¯†å‡½æ•°"><a href="#åŠ å¯†å‡½æ•°" class="headerlink" title="åŠ å¯†å‡½æ•°"></a>åŠ å¯†å‡½æ•°</h4><table>
<thead>
<tr>
<th><strong>USER()</strong></th>
<th><strong>æŸ¥è¯¢ç”¨æˆ·</strong></th>
</tr>
</thead>
<tbody><tr>
<td>DATABASE()</td>
<td>æ•°æ®åº“åç§°</td>
</tr>
<tr>
<td>MD5(str)</td>
<td>ä»å­—ç¬¦ä¸²ç®—å‡ºä¸€ä¸ªMD5 32çš„å­—ç¬¦ä¸²ï¼Œ(ç”¨æˆ·å¯†ç )åŠ å¯†</td>
</tr>
<tr>
<td>PASSWORD(str)  [SQL8.0å·²ç§»é™¤]<br />SHA1(str)</td>
<td>ä»åŸæ–‡å¯†ç strè®¡ç®—å¹¶è¿”å›å¯†ç å­—ç¬¦ä¸²ï¼Œå¸¸ç”¨äºå¯¹MySQLæ•°æ®åº“çš„ç”¨æˆ·å¯†ç åŠ å¯†</td>
</tr>
<tr>
<td><code> select*from mysql.user \G</code></td>
<td>ä»åŸæ–‡å¯†ç strè®¡ç®—å¹¶è¿”å›å¯†ç å­—ç¬¦ä¸²</td>
</tr>
</tbody></table>
<h4 id="æµç¨‹æ§åˆ¶å‡½æ•°"><a href="#æµç¨‹æ§åˆ¶å‡½æ•°" class="headerlink" title="æµç¨‹æ§åˆ¶å‡½æ•°"></a>æµç¨‹æ§åˆ¶å‡½æ•°</h4><table>
<thead>
<tr>
<th>IF (expr1ï¼Œexpr2ï¼Œexpr3)</th>
<th>expr1ä¸ºtrueè¿”å›expr2.å¦åˆ™è¿”å›expr3</th>
</tr>
</thead>
<tbody><tr>
<td>IFNULL(expr1,expr2)</td>
<td>expr1éƒ¨ä½ç©ºnullè¿”expr1ï¼Œå¦åˆ™è¿”å›expr2</td>
</tr>
<tr>
<td>select case WHEN expr1 THEN expr2  WHEN expr3 THEN expr4 ELSE expr5ï¼›</td>
<td>ç±»ä¼¼äºå…¶ä»–è¯­è¨€switchå‡½æ•°</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢empè¡¨commï¼Œå¦‚æœä¸ºnullï¼Œæ˜¾ç¤º0.0</span></span><br><span class="line"><span class="comment">-- åˆ¤æ–­è¦ç”¨ is [not] null</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,IF(comm <span class="keyword">IS</span> <span class="keyword">NULL</span>,<span class="number">0.0</span>,comm) <span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure>





<h3 id="æŸ¥è¯¢è¡¥å……"><a href="#æŸ¥è¯¢è¡¥å……" class="headerlink" title="æŸ¥è¯¢è¡¥å……"></a>æŸ¥è¯¢è¡¥å……</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">WHERE</span></span><br><span class="line"><span class="comment">-- æŸ¥æ‰¾1992.1.1åå…¥èŒçš„å‘˜å·¥</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> subdate(hiredate,<span class="string">&#x27;1992-1-1&#x27;</span>)<span class="operator">&gt;</span><span class="number">0</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> hiredate<span class="operator">&lt;=</span><span class="string">&#x27;1992-01-01&#x27;</span>;</span><br><span class="line"><span class="comment">-- mysqlä¸­æ—¥æœŸç±»å‹å†™å¯ä»¥ç›´æ¥æ¯”è¾ƒ</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">LIKE</span> </span><br><span class="line">â€‹	<span class="operator">%</span> :è¡¨ç¤º<span class="number">0</span>åˆ°å¤šä¸ªå­—ç¬¦</span><br><span class="line">â€‹	_ :è¡¨ç¤ºå•ä¸ªå­—ç¬¦</span><br><span class="line"><span class="comment">-- æ˜¾ç¤ºé¦–å­—æ¯Sçš„å‘˜å·¥å§“åå’Œå·¥èµ„</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> ename <span class="keyword">LIKE</span> <span class="string">&#x27;S%&#x27;</span>;</span><br><span class="line"><span class="comment">-- æ˜¾ç¤ºç¬¬ä¸‰ä¸ªå­—ç¬¦ä¸ºå¤§å†™Oçš„æ‰€æœ‰å‘˜å·¥é¡¹ç›®å’Œå·¥èµ„</span></span><br><span class="line"><span class="keyword">SELECT</span> ename <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> ename <span class="keyword">LIKE</span> <span class="string">&#x27;__O%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">IS</span></span><br><span class="line"><span class="comment">-- æ˜¾ç¤ºæ²¡æœ‰ä¸Šçº§çš„é›‡å‘˜æƒ…å†µ</span></span><br><span class="line"><span class="keyword">SELECT</span> ename <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> mgr <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- order by</span></span><br><span class="line"><span class="comment">-- æŒ‰ç…§å·¥èµ„çš„ä»ä½åˆ°é«˜æ˜¾ç¤ºé›‡å‘˜ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> sal <span class="keyword">ASC</span> ;</span><br><span class="line"><span class="comment">-- å¯¹éƒ¨é—¨å·å‡åºä¸”å·¥èµ„é™åºæ’åºï¼Œæ˜¾ç¤ºé›‡å‘˜ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> deptno <span class="keyword">ASC</span> ,sal <span class="keyword">DESC</span> ;</span><br></pre></td></tr></table></figure>



<h4 id="åˆ†é¡µæŸ¥è¯¢"><a href="#åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="åˆ†é¡µæŸ¥è¯¢"></a><strong>åˆ†é¡µæŸ¥è¯¢</strong></h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ...limit <span class="keyword">start</span> , <span class="keyword">rows</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> empno  LIMIT æ¯é¡µæ˜¾ç¤ºçš„è®°å½•æ•°<span class="operator">*</span>(ç¬¬å‡ é¡µ<span class="number">-1</span>),æ¯é¡µè®°å½•æ•°;</span><br><span class="line"><span class="comment">-- è¡¨ç¤ºä»start+1è¡Œå¼€å§‹å–ï¼Œå–å‡ºrowsè¡Œï¼Œstartä»0å¼€å§‹ç®—</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- æŒ‰é›‡å‘˜idå‡åºå–å‡ºï¼Œæ¯é¡µ3æ¡è®°å½•ï¼Œåˆ†åˆ«æ˜¾ç¤ºç¬¬ä¸€é¡µï¼Œç¬¬äºŒé¡µï¼Œç¬¬ä¸‰é¡µ</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> empno LIMIT <span class="number">0</span>,<span class="number">3</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> empno LIMIT <span class="number">1</span>,<span class="number">3</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> empno LIMIT <span class="number">2</span>,<span class="number">3</span>;</span><br><span class="line"><span class="comment">-- æŒ‰é›‡å‘˜idé™åºå–å‡ºï¼Œæ¯é¡µ5æ¡è®°å½•ï¼Œæ˜¾ç¤ºç¬¬ä¸‰é¡µï¼Œç¬¬äº”é¡µå¯¹åº”çš„sqlè¯­å¥</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> empno <span class="keyword">DESC</span> LIMIT <span class="number">20</span>,<span class="number">5</span>;</span><br></pre></td></tr></table></figure>



<h4 id="å¢å¼ºgroup-byçš„ä½¿ç”¨"><a href="#å¢å¼ºgroup-byçš„ä½¿ç”¨" class="headerlink" title="å¢å¼ºgroup byçš„ä½¿ç”¨"></a><strong>å¢å¼ºgroup byçš„ä½¿ç”¨</strong></h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- æ˜¾ç¤ºæ¯ç§å²—ä½çš„é›‡å‘˜æ€»æ•°ï¼Œå¹³å‡å·¥èµ„</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>),<span class="built_in">avg</span>(sal),job <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> job;</span><br><span class="line"><span class="comment">-- æ˜¾ç¤ºé›‡å‘˜æ€»æ•°ï¼Œä»¥åŠè·å¾—è¡¥åŠ©çš„é›‡å‘˜æ•°</span></span><br><span class="line">    <span class="comment">-- count()ä¸­ä¸ºnullçš„äººé»˜è®¤ä¸ä¼šç»Ÿè®¡è¿›å»</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>),<span class="built_in">count</span>(comm) <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- ç»Ÿè®¡æ²¡æœ‰è·å¾—è¡¥åŠ©çš„é›‡å‘˜</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>),<span class="built_in">count</span>(if(comm <span class="keyword">is</span> <span class="keyword">null</span>,<span class="literal">true</span>,<span class="keyword">null</span>)) <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- æ˜¾ç¤ºç®¡ç†è€…çš„æ€»äººæ•°</span></span><br><span class="line"><span class="keyword">select</span>  <span class="built_in">count</span>(<span class="keyword">distinct</span> mgr) <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- æ˜¾ç¤ºé›‡å‘˜å·¥èµ„çš„æœ€å¤§å·®é¢</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(sal)<span class="operator">-</span><span class="built_in">min</span>(sal) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>



<h4 id="å¤šå­å¥æŸ¥è¯¢"><a href="#å¤šå­å¥æŸ¥è¯¢" class="headerlink" title="å¤šå­å¥æŸ¥è¯¢"></a><strong>å¤šå­å¥æŸ¥è¯¢</strong></h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col1,col2... <span class="keyword">FROM</span> <span class="keyword">table</span> </span><br><span class="line">    	<span class="keyword">GROUP</span> <span class="keyword">BY</span> col</span><br><span class="line">    	<span class="keyword">HAVING</span> <span class="keyword">condition</span></span><br><span class="line">    	<span class="keyword">ORDER</span> <span class="keyword">BY</span> col</span><br><span class="line">    	LIMIT <span class="keyword">start</span>,<span class="keyword">rows</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- ç»Ÿè®¡å„ä¸ªéƒ¨é—¨[group by]çš„å¹³å‡å·¥èµ„[avg]ï¼Œ</span></span><br><span class="line"><span class="comment">-- å¹¶ä¸”å¤§äº1000çš„[having],</span></span><br><span class="line"><span class="comment">-- å¹¶ä¸”æŒ‰ç…§å¹³å‡å·¥èµ„ä»ä½åˆ°é«˜æ’åº[order by]ï¼Œ</span></span><br><span class="line"><span class="comment">-- å–å‡ºå‰ä¸¤è¡Œæ•°æ®[Limit]</span></span><br><span class="line"><span class="keyword">SELECT</span> deptno ,<span class="built_in">AVG</span>(sal) <span class="keyword">AS</span> avg_sal <span class="keyword">FROM</span> emp</span><br><span class="line">                                   <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno</span><br><span class="line">                                   <span class="keyword">HAVING</span> avg_sal<span class="operator">&gt;</span><span class="number">1000</span></span><br><span class="line">                                   <span class="keyword">ORDER</span> <span class="keyword">BY</span> avg_sal <span class="keyword">DESC</span></span><br><span class="line">                                   LIMIT <span class="number">0</span>,<span class="number">2</span>;</span><br></pre></td></tr></table></figure>







<h2 id="å¤šè¡¨æŸ¥è¯¢"><a href="#å¤šè¡¨æŸ¥è¯¢" class="headerlink" title="å¤šè¡¨æŸ¥è¯¢"></a>å¤šè¡¨æŸ¥è¯¢</h2><p> <strong>éƒ¨å‘˜è¡¨</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#éƒ¨å‘˜è¡¨</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> dept</span><br><span class="line">(</span><br><span class="line">    deptno MEDIUMINT   <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">    dname  <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    loc    <span class="type">VARCHAR</span>(<span class="number">13</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dept</span><br><span class="line">    <span class="keyword">VALUES</span> (<span class="number">10</span>, <span class="string">&#x27;ACCOUNTING&#x27;</span>, <span class="string">&#x27;NEW YORK&#x27;</span>),</span><br><span class="line">           (<span class="number">20</span>, <span class="string">&#x27;RESEARCH&#x27;</span>, <span class="string">&#x27;DALLAS&#x27;</span>),</span><br><span class="line">           (<span class="number">30</span>, <span class="string">&#x27;SALES&#x27;</span>, <span class="string">&#x27;CHICAGO&#x27;</span>),</span><br><span class="line">           (<span class="number">40</span>, <span class="string">&#x27;OPERATIONS&#x27;</span>, <span class="string">&#x27;BOSHTON&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> dept;</span><br></pre></td></tr></table></figure>



<p><strong>é›‡å‘˜è¡¨</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#é›‡å‘˜è¡¨</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp</span><br><span class="line">(</span><br><span class="line">    empno    MEDIUMINT UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,  #ç¼–å·</span><br><span class="line">    ename    <span class="type">VARCHAR</span>(<span class="number">20</span>)        <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span>, #åå­—</span><br><span class="line">    job      <span class="type">VARCHAR</span>(<span class="number">9</span>)         <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span>, #å·¥ä½œ</span><br><span class="line">    mgr      MEDIUMINT UNSIGNED,				    #ä¸Šçº§ç¼–å·</span><br><span class="line">    hiredate <span class="type">DATE</span>               <span class="keyword">NOT</span> <span class="keyword">NULL</span>, 		     #å…¥èŒæ—¶é—´</span><br><span class="line">    sal      <span class="type">DECIMAL</span>(<span class="number">7</span>, <span class="number">2</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span>,			#è–ªæ°´</span><br><span class="line">    comm     <span class="type">DECIMAL</span>(<span class="number">7</span>, <span class="number">2</span>),						   #çº¢åˆ©</span><br><span class="line">    deptno   MEDIUMINT UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>   #éƒ¨é—¨ç¼–å·</span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp</span><br><span class="line">        <span class="keyword">VALUES</span>(<span class="number">7369</span>,<span class="string">&#x27;SMITH&#x27;</span>,<span class="string">&#x27;CLERK&#x27;</span>,<span class="number">7902</span>,<span class="string">&#x27;1990-12-17&#x27;</span>,<span class="number">800.00</span>,<span class="keyword">NULL</span>,<span class="number">20</span>),</span><br><span class="line">              (<span class="number">7499</span>,<span class="string">&#x27;ALLEN&#x27;</span>,<span class="string">&#x27;SALESMAN&#x27;</span>,<span class="number">7698</span>,<span class="string">&#x27;1991-2-20&#x27;</span>,<span class="number">1600.00</span>,<span class="number">300.00</span>,<span class="number">30</span>),</span><br><span class="line">              (<span class="number">7521</span>,<span class="string">&#x27;WARD&#x27;</span>,<span class="string">&#x27;SALESMAN&#x27;</span>,<span class="number">7698</span>,<span class="string">&#x27;1991-2-22&#x27;</span>,<span class="number">1250.00</span>,<span class="number">500.00</span>,<span class="number">30</span>),</span><br><span class="line">              (<span class="number">7566</span>,<span class="string">&#x27;JONES&#x27;</span>,<span class="string">&#x27;MANAGER&#x27;</span>,<span class="number">7839</span>,<span class="string">&#x27;1991-4-2&#x27;</span>,<span class="number">2975.00</span>,<span class="keyword">NULL</span>,<span class="number">20</span>),</span><br><span class="line">              (<span class="number">7654</span>,<span class="string">&#x27;MARTIN&#x27;</span>,<span class="string">&#x27;SALESMAN&#x27;</span>,<span class="number">7698</span>,<span class="string">&#x27;1991-9-28&#x27;</span>,<span class="number">1250.00</span>,<span class="number">1400.00</span>,<span class="number">30</span>),</span><br><span class="line">              (<span class="number">7698</span>,<span class="string">&#x27;BLAKE&#x27;</span>,<span class="string">&#x27;MANAGER&#x27;</span>,<span class="number">7839</span>,<span class="string">&#x27;1991-5-1&#x27;</span>,<span class="number">2850.00</span>,<span class="keyword">NULL</span>,<span class="number">30</span>),</span><br><span class="line">              (<span class="number">7782</span>,<span class="string">&#x27;CLARK&#x27;</span>,<span class="string">&#x27;MANAGER&#x27;</span>,<span class="number">7839</span>,<span class="string">&#x27;1991-6-9&#x27;</span>,<span class="number">2450.00</span>,<span class="keyword">NULL</span>,<span class="number">10</span>),</span><br><span class="line">              (<span class="number">7788</span>,<span class="string">&#x27;SCOTT&#x27;</span>,<span class="string">&#x27;ANALYST&#x27;</span>,<span class="number">7566</span>,<span class="string">&#x27;1991-4-19&#x27;</span>,<span class="number">3000.00</span>,<span class="keyword">NULL</span>,<span class="number">20</span>),</span><br><span class="line">              (<span class="number">7839</span>,<span class="string">&#x27;KING&#x27;</span>,<span class="string">&#x27;PRESIDENT&#x27;</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;1991-11-17&#x27;</span>,<span class="number">5000.00</span>,<span class="keyword">NULL</span>,<span class="number">10</span>),</span><br><span class="line">              (<span class="number">7844</span>,<span class="string">&#x27;TURNER&#x27;</span>,<span class="string">&#x27;SALESMAN&#x27;</span>,<span class="number">7698</span>,<span class="string">&#x27;1991-9-8&#x27;</span>,<span class="number">1500.00</span>,<span class="keyword">NULL</span>,<span class="number">30</span>),</span><br><span class="line">              (<span class="number">7900</span>,<span class="string">&#x27;JAMES&#x27;</span>,<span class="string">&#x27;CLERK&#x27;</span>,<span class="number">7698</span>,<span class="string">&#x27;1991-12-3&#x27;</span>,<span class="number">950.00</span>,<span class="keyword">NULL</span>,<span class="number">30</span>),</span><br><span class="line">              (<span class="number">7902</span>,<span class="string">&#x27;FORD&#x27;</span>,<span class="string">&#x27;ANALYST&#x27;</span>,<span class="number">7566</span>,<span class="string">&#x27;1991-12-3&#x27;</span>,<span class="number">3000.00</span>,<span class="keyword">NULL</span>,<span class="number">20</span>),</span><br><span class="line">              (<span class="number">7934</span>,<span class="string">&#x27;MILLER&#x27;</span>,<span class="string">&#x27;CLERK&#x27;</span>,<span class="number">7782</span>,<span class="string">&#x27;1991-1-23&#x27;</span>,<span class="number">1300.00</span>,<span class="keyword">NULL</span>,<span class="number">10</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong><img src="/./C:/Users/yu/Desktop/markdown/MySQL/MySQL%E7%AC%94%E8%AE%B0/GROUPBY_emp.png"></strong></p>
<p><strong>å·¥èµ„çº§åˆ«è¡¨</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#å·¥èµ„çº§åˆ«è¡¨</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> salgrade(</span><br><span class="line">    grade MEDIUMINT UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">    losal <span class="type">DECIMAL</span>(<span class="number">17</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    hisal <span class="type">DECIMAL</span>(<span class="number">17</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> salgrade </span><br><span class="line">	<span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="number">700</span>,<span class="number">1200</span>),</span><br><span class="line">    	  (<span class="number">2</span>,<span class="number">1201</span>,<span class="number">1400</span>),</span><br><span class="line">    	  (<span class="number">3</span>,<span class="number">1401</span>,<span class="number">2000</span>),</span><br><span class="line">    	  (<span class="number">4</span>,<span class="number">2001</span>,<span class="number">3000</span>),</span><br><span class="line">    	  (<span class="number">5</span>,<span class="number">3001</span>,<span class="number">9999</span>);</span><br></pre></td></tr></table></figure>



<h3 id="ç¬›å¡å°”ç§¯"><a href="#ç¬›å¡å°”ç§¯" class="headerlink" title="ç¬›å¡å°”ç§¯"></a>ç¬›å¡å°”ç§¯</h3><p><strong>ç¬›å¡å°”ç§¯:ä¸¤ä¸ªè¡¨é»˜è®¤æŸ¥è¯¢ï¼Œç¬¬ä¸€å¼ è¡¨æ¯ä¸€è¡Œè®°å½•ä¸ç¬¬äºŒå¼ æ¯ä¸€è¡Œè®°å½•ç»„åˆ</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> emp,dept; #<span class="number">13</span><span class="operator">*</span><span class="number">4</span><span class="operator">=</span><span class="number">52</span>é»˜è®¤æŸ¥è¯¢å‡º<span class="number">52</span>æ¡è®°å½•ï¼Œå³ç¬›å¡å°”ç§¯</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#æ˜¾ç¤ºé›‡å‘˜å,é›‡å‘˜å·¥èµ„ä»¥åŠæ‰€åœ¨çš„éƒ¨é—¨åå­—</span><br><span class="line">    <span class="comment">/*é›‡å‘˜å é›‡å‘˜å·¥èµ„æ¥è‡ªemp éƒ¨é—¨åæ¥è‡ªdeptè¡¨*/</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,sal,dname <span class="keyword">FROM</span> emp,dept <span class="keyword">where</span> emp.deptno<span class="operator">=</span>dept.deptno;</span><br><span class="line">#æ˜¾ç¤ºéƒ¨é—¨å·ä¸º<span class="number">10</span>çš„éƒ¨é—¨å,å‘˜å·¥å,å·¥èµ„</span><br><span class="line"><span class="keyword">SELECT</span> dname,ename,sal,emp.deptno <span class="keyword">FROM</span> emp,dept <span class="keyword">WHERE</span> emp.deptno<span class="operator">=</span>dept.deptno <span class="keyword">AND</span> 														 dept.deptno <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">#æ˜¾ç¤ºå„ä¸ªå‘˜å·¥çš„å§“å,å·¥èµ„,å·¥èµ„çº§åˆ«</span><br><span class="line"><span class="keyword">SELECT</span> ename,sal,grade <span class="keyword">FROM</span> emp,salgrade <span class="keyword">WHERE</span> sal <span class="keyword">BETWEEN</span> losal <span class="keyword">AND</span> hisal;</span><br><span class="line"><span class="comment">-- æ˜¾ç¤ºé›‡å‘˜åï¼Œé›‡å‘˜å·¥èµ„ï¼Œé›‡å‘˜æ‰€åœ¨çš„éƒ¨é—¨åï¼Œå¹¶æŒ‰éƒ¨é—¨é™åºæ’åº</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,sal,dname,emp.deptno </span><br><span class="line">				<span class="keyword">FROM</span> emp,dept </span><br><span class="line">                  <span class="keyword">WHERE</span> emp.deptno<span class="operator">=</span>dept.deptno  </span><br><span class="line">                  <span class="keyword">ORDER</span> <span class="keyword">BY</span>  dept.deptno <span class="keyword">DESC</span> ;</span><br></pre></td></tr></table></figure>



<h3 id="è‡ªè¿æ¥"><a href="#è‡ªè¿æ¥" class="headerlink" title="è‡ªè¿æ¥"></a>è‡ªè¿æ¥</h3><p>è‡ªè¿æ¥æŒ‡åœ¨åŒä¸€å¼ è¡¨çš„è¿æ¥æŸ¥è¯¢</p>
<p>å°†åŒä¸€ç§è¡¨çœ‹ä½œä¸¤å¼ è¡¨</p>
<p><em>ç»™è¡¨èµ·åˆ«å</em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- æ˜¾ç¤ºå‘˜å·¥å’Œä¸Šçº§åå­—</span></span><br><span class="line"><span class="keyword">SELECT</span> worker.ename , boss.ename </span><br><span class="line">		<span class="keyword">FROM</span> emp <span class="keyword">AS</span> worker , emp <span class="keyword">AS</span> boss </span><br><span class="line">		<span class="keyword">WHERE</span> worker.mgr <span class="operator">=</span> boss.empno;</span><br></pre></td></tr></table></figure>



<h3 id="å¤šè¡Œå­æŸ¥è¯¢"><a href="#å¤šè¡Œå­æŸ¥è¯¢" class="headerlink" title="å¤šè¡Œå­æŸ¥è¯¢"></a>å¤šè¡Œå­æŸ¥è¯¢</h3><ul>
<li>å­æŸ¥è¯¢æ˜¯æŒ‡åµŒå…¥åœ¨å…¶ä»– <code>sql</code> è¯­å¥ä¸­çš„ <code>select</code> è¯­å¥ï¼Œä¹Ÿå«åµŒå¥—æŸ¥è¯¢</li>
<li>å•è¡Œå­æŸ¥è¯¢æ˜¯æŒ‡è¿”å›ä¸€è¡Œæ•°æ®çš„æŸ¥è¯¢è¯­å¥</li>
<li>å¤šè¡Œå­æŸ¥è¯¢æ˜¯è¿”å›å¤šè¡Œæ•°æ®çš„å­æŸ¥è¯¢ï¼Œä½¿ç”¨å…³é”®å­— <code>IN</code></li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢ä¸SMITHåŒä¸€éƒ¨é—¨çš„å‘˜å·¥</span></span><br><span class="line"><span class="keyword">SELECT</span> deptno <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> ename <span class="operator">=</span> <span class="string">&#x27;SMITH&#x27;</span>; #å…ˆæ‰¾åˆ°SMITHçš„éƒ¨é—¨å·</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno <span class="keyword">IN</span> (<span class="keyword">SELECT</span> deptno <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> ename <span class="operator">=</span> <span class="string">&#x27;SMITH&#x27;</span>); #åµŒå¥—</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢ å’Œéƒ¨é—¨10çš„å·¥ä½œç›¸åŒçš„é›‡å‘˜çš„åå­—ï¼Œå²—ä½ï¼Œå·¥èµ„ï¼Œéƒ¨é—¨å·ï¼Œä½†æ˜¯ä¸åŒ…å«10å·éƒ¨é—¨è‡ªå·±çš„é›‡å‘˜</span></span><br><span class="line"># <span class="number">1.</span>åå·éƒ¨é—¨æœ‰å“ªäº›å·¥ä½œ</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> job <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno<span class="operator">=</span><span class="number">10</span>;</span><br><span class="line"># <span class="number">2.</span>æŠŠä¸Šé¢æŸ¥è¯¢çš„ç»“æœå½“ä½œå­æŸ¥è¯¢</span><br><span class="line"><span class="keyword">SELECT</span> ename,job,sal,deptno </span><br><span class="line">		<span class="keyword">FROM</span> emp</span><br><span class="line">		<span class="keyword">WHERE</span> job <span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> job <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno<span class="operator">=</span><span class="number">10</span>) 							<span class="keyword">AND</span> deptno <span class="operator">!=</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<h4 id="å­æŸ¥è¯¢ä¸´æ—¶è¡¨"><a href="#å­æŸ¥è¯¢ä¸´æ—¶è¡¨" class="headerlink" title="å­æŸ¥è¯¢ä¸´æ—¶è¡¨"></a>å­æŸ¥è¯¢ä¸´æ—¶è¡¨</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢ecshopä¸­å„ç±»åˆ«ä¸­ä»·æ ¼æœ€é«˜çš„å•†å“</span></span><br><span class="line">#å•†å“è¡¨</span><br><span class="line"><span class="keyword">SELECT</span> goods_id,cat_id,goods_name,shop_price <span class="keyword">FROM</span> ecs_goods; #ä¸´æ—¶è¡¨</span><br><span class="line">#å¾—åˆ°å„ä¸ªç±»åˆ«ä¸­ï¼Œä»·æ ¼æœ€é«˜çš„å•†å“ max <span class="operator">+</span> <span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line"><span class="keyword">SELECT</span> cat_id,<span class="built_in">MAX</span>(shop_price) <span class="keyword">FROM</span> ecs_goods <span class="keyword">GROUP</span> <span class="keyword">BY</span> cat_id;</span><br><span class="line"># ç»“æœ</span><br><span class="line"><span class="keyword">SELECT</span> goods_id,temp.cat_id,goods_name,shop_price </span><br><span class="line">	   	 <span class="keyword">FROM</span> ecs_goods,(</span><br><span class="line">    			<span class="keyword">SELECT</span> cat_id,<span class="built_in">MAX</span>(shop_price) <span class="keyword">AS</span> max_price</span><br><span class="line">   			 	<span class="keyword">FROM</span> ecs_goods </span><br><span class="line">    			<span class="keyword">GROUP</span> <span class="keyword">BY</span> cat_id</span><br><span class="line">         )  <span class="keyword">AS</span> temp</span><br><span class="line">		 <span class="keyword">WHERE</span> 	temp.cat_id <span class="operator">=</span> ecs_goods.cat_id <span class="keyword">AND</span> temp.max_price <span class="operator">=</span> ecs_goods.shop_price;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨çš„ä¿¡æ¯(éƒ¨é—¨å ç¼–å· åœ°å€ äººå‘˜æ•°é‡)</span></span><br><span class="line"><span class="keyword">select</span> dname,dept.deptno,loc,temp.num</span><br><span class="line">    <span class="keyword">from</span> dept,(<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> num,deptno <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno) <span class="keyword">as</span> temp</span><br><span class="line">    <span class="keyword">where</span> temp.deptno<span class="operator">=</span>dept.deptno;</span><br><span class="line"><span class="comment">-- å¦ä¸€ç§å†™æ³•</span></span><br><span class="line"><span class="keyword">select</span> temp.<span class="operator">*</span>,dname,loc</span><br><span class="line">    <span class="keyword">from</span> dept,(<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> num,deptno <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno) <span class="keyword">as</span> temp</span><br><span class="line">    <span class="keyword">where</span> temp.deptno<span class="operator">=</span>dept.deptno;</span><br><span class="line"><span class="comment">-- æ˜¾ç¤ºåˆ— è¡¨å.* å¯ä»¥å…¨æ˜¾ç¤ºå‡ºæ¥,å‰ææ˜¯åˆ—ååœ¨å¤šè¡¨æŸ¥è¯¢ä¸­ä¸é‡å¤   </span></span><br></pre></td></tr></table></figure>



<h4 id="ALL-å’Œ-ANY"><a href="#ALL-å’Œ-ANY" class="headerlink" title="ALL å’Œ ANY"></a>ALL å’Œ ANY</h4><p><strong>ALL</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- æ˜¾ç¤ºå·¥èµ„æ¯”éƒ¨é—¨30çš„æ‰€æœ‰å‘˜å·¥çš„å·¥èµ„é«˜çš„å‘˜å·¥çš„å§“åï¼Œå·¥èµ„ï¼Œéƒ¨é—¨å·</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,sal,deptno <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal<span class="operator">&gt;</span><span class="keyword">ALL</span>(<span class="keyword">SELECT</span> sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno<span class="operator">=</span><span class="number">30</span>);</span><br><span class="line"><span class="keyword">SELECT</span> ename,sal,deptno <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal<span class="operator">&gt;</span>(<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(sal) <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno<span class="operator">=</span><span class="number">30</span>);</span><br><span class="line"># <span class="keyword">WHERE</span> åé¢ä¸èƒ½ç›´æ¥è·Ÿèšåˆå‡½æ•°MAX </span><br></pre></td></tr></table></figure>

<p><strong>ANY</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- æ˜¾ç¤ºå·¥èµ„æ¯”éƒ¨é—¨30çš„å…¶ä¸­ä¸€ä¸ªå‘˜å·¥çš„å·¥èµ„é«˜çš„å‘˜å·¥å§“åï¼Œå·¥èµ„ï¼Œéƒ¨é—¨å·</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,sal,deptno <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal<span class="operator">&gt;</span><span class="keyword">ANY</span>(<span class="keyword">SELECT</span> sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno<span class="operator">=</span><span class="number">30</span>);</span><br><span class="line"><span class="keyword">SELECT</span> ename,sal,deptno <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal<span class="operator">&gt;</span>(<span class="keyword">SELECT</span> <span class="built_in">MIN</span>(sal) <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno<span class="operator">=</span><span class="number">30</span>);</span><br></pre></td></tr></table></figure>



<h3 id="å¤šåˆ—å­æŸ¥è¯¢"><a href="#å¤šåˆ—å­æŸ¥è¯¢" class="headerlink" title="å¤šåˆ—å­æŸ¥è¯¢"></a>å¤šåˆ—å­æŸ¥è¯¢</h3><p>å¤šåˆ—å­æŸ¥è¯¢æŒ‡æŸ¥è¯¢è¿”å›å¤šä¸ªåˆ—æ•°æ®çš„å­æŸ¥è¯¢è¯­å¥</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">(å­—æ®µ<span class="number">1</span>,å­—æ®µ<span class="number">2.</span>..)<span class="operator">=</span>(<span class="keyword">SELECT</span> å­—æ®µ<span class="number">1</span>,å­—æ®µ<span class="number">2.</span>.. <span class="keyword">FROM</span> ...);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢ä¸SMITHéƒ¨é—¨å’Œå²—ä½å®Œå…¨ç›¸åŒçš„æ‰€æœ‰é›‡å‘˜ï¼Œä¸åŒ…å«SMITHæœ¬äºº</span></span><br><span class="line"># å¾—åˆ°SMITHçš„éƒ¨é—¨å’Œå²—ä½</span><br><span class="line"><span class="keyword">SELECT</span> deptno,job <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> ename <span class="operator">=</span><span class="string">&#x27;SMITH&#x27;</span>;</span><br><span class="line">#æŠŠä¸Šé¢çš„æŸ¥è¯¢å½“ä½œå­æŸ¥è¯¢ï¼Œå¹¶ä¸”ä½¿ç”¨å¤šåˆ—å­æŸ¥è¯¢</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp</span><br><span class="line">    <span class="keyword">WHERE</span> (deptno, job) <span class="operator">=</span> (<span class="keyword">SELECT</span> deptno, job <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> ename <span class="operator">=</span> <span class="string">&#x27;SMITH&#x27;</span>)</span><br><span class="line">    <span class="keyword">AND</span> ename <span class="operator">!=</span> <span class="string">&#x27;SMITH&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h3 id="è¡¨å¤åˆ¶å’Œå»é‡"><a href="#è¡¨å¤åˆ¶å’Œå»é‡" class="headerlink" title="è¡¨å¤åˆ¶å’Œå»é‡"></a>è¡¨å¤åˆ¶å’Œå»é‡</h3><h4 id="å¤åˆ¶"><a href="#å¤åˆ¶" class="headerlink" title="å¤åˆ¶"></a>å¤åˆ¶</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- è¡¨çš„å¤åˆ¶</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> my_tab01</span><br><span class="line">(</span><br><span class="line">    id     <span class="type">INT</span>,</span><br><span class="line">    `name` <span class="type">VARCHAR</span>(<span class="number">32</span>),</span><br><span class="line">    sal    <span class="keyword">DOUBLE</span>,</span><br><span class="line">    job    <span class="type">VARCHAR</span>(<span class="number">32</span>),</span><br><span class="line">    deptno <span class="type">INT</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> my_tab01;</span><br><span class="line"><span class="comment">-- è‡ªæˆ‘å¤åˆ¶</span></span><br><span class="line"><span class="comment">-- 1.å…ˆæŠŠempçš„è¡¨è®°å½•å¤åˆ¶åˆ° my_tab01</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> my_tab01 (id, name, sal, job, deptno)</span><br><span class="line">        <span class="keyword">SELECT</span> empno, ename, sal, job, deptno <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="comment">-- 2.è‡ªæˆ‘å¤åˆ¶(è¡Œæ•°æ¯å¤åˆ¶ä¸€æ¬¡*2)</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> my_tab01 <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> my_tab01;</span><br></pre></td></tr></table></figure>

<h4 id="å»é‡"><a href="#å»é‡" class="headerlink" title="å»é‡"></a>å»é‡</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºä¸å¾…å»é‡è¡¨ä¸€æ ·ç»“æ„çš„ä¸´æ—¶è¡¨</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> my_tmp <span class="keyword">LIKE</span> my_tab01;</span><br><span class="line"><span class="comment">-- distinct å¤åˆ¶åˆ°ä¸´æ—¶è¡¨</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> my_tmp <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="operator">*</span> <span class="keyword">FROM</span> my_tab01;</span><br><span class="line"><span class="comment">-- æ¸…é™¤è®°å½•</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> my_tab01;</span><br><span class="line"><span class="comment">-- é‡æ–°æ‹·è´</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> my_tab01 <span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> my_tmp;</span><br><span class="line"><span class="comment">-- é‡Šæ”¾å†…å­˜</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> my_tmp;</span><br></pre></td></tr></table></figure>



<h3 id="åˆå¹¶æŸ¥è¯¢"><a href="#åˆå¹¶æŸ¥è¯¢" class="headerlink" title="åˆå¹¶æŸ¥è¯¢"></a>åˆå¹¶æŸ¥è¯¢</h3><p>å®é™…åº”ç”¨ä¸­ï¼Œä¸ºäº†åˆå¹¶å¤šä¸ªselectè¯­å¥ï¼Œå¯ä»¥ä½¿ç”¨é›†åˆæ“ä½œç¬¦å·<code>union</code> <code>union all</code></p>
<p><code>union all</code>æ“ä½œç¬¦ç”¨äºå–å¾—ä¸¤ä¸ªç»“æœé›†çš„å¹¶é›†ï¼Œä½¿ç”¨è¯¥æ“ä½œç¬¦æ—¶ä¸ä¼šå–æ¶ˆé‡å¤è¡Œ</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ename,sal,job <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal<span class="operator">&gt;</span><span class="number">2500</span>;</span><br><span class="line"><span class="keyword">SELECT</span> ename,sal,job <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> job<span class="operator">=</span><span class="string">&#x27;MANAGER&#x27;</span>;</span><br><span class="line"><span class="comment">-- union all å°†ä¸¤ä¸ªç»“æœåˆå¹¶ä¸ä¼šå»é‡</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,sal,job <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal<span class="operator">&gt;</span><span class="number">2500</span></span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,sal,job <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> job<span class="operator">=</span><span class="string">&#x27;MANAGER&#x27;</span>;</span><br><span class="line"><span class="comment">-- union ä¼šå»é‡</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,sal,job <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal<span class="operator">&gt;</span><span class="number">2500</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,sal,job <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> job<span class="operator">=</span><span class="string">&#x27;MANAGER&#x27;</span>;</span><br><span class="line"><span class="comment">-- or ä¼šå»é‡</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,sal,job <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal<span class="operator">&gt;</span><span class="number">2500</span> <span class="keyword">OR</span>  job<span class="operator">=</span><span class="string">&#x27;MANAGER&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h3 id="å¤–è¿æ¥"><a href="#å¤–è¿æ¥" class="headerlink" title="å¤–è¿æ¥"></a>å¤–è¿æ¥</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- åˆ—å‡ºéƒ¨é—¨åç§°å’Œè¿™äº›éƒ¨é—¨å‘˜å·¥åç§°å’Œå·¥ä½œï¼ŒåŒæ—¶æ˜¾ç¤ºå‡ºé‚£äº›æ²¡æœ‰å‘˜å·¥çš„éƒ¨é—¨</span></span><br><span class="line"><span class="keyword">SELECT</span> dname,ename,job</span><br><span class="line">    <span class="keyword">FROM</span> emp,dept</span><br><span class="line">    <span class="keyword">WHERE</span> emp.deptno<span class="operator">=</span>dept.deptno <span class="keyword">ORDER</span> <span class="keyword">BY</span> dname;</span><br><span class="line">#éƒ¨é—¨æœ‰å››ä¸ªéƒ¨é—¨ ä¸Šé¢<span class="keyword">sql</span>è¯­å¥æŒ‡æŒ¥æ˜¾ç¤ºå‡ºæœ‰å‘˜å·¥çš„éƒ¨é—¨ï¼Œæ‰€ä»¥æœ€ç»ˆæ˜¾ç¤ºå‡ºä¸‰ä¸ªéƒ¨é—¨ï¼Œæ— æ³•æ˜¾ç¤ºæ²¡æœ‰å‘˜å·¥çš„éƒ¨é—¨</span><br><span class="line">#è¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦å¤–è¿æ¥</span><br></pre></td></tr></table></figure>

<p>å¤–è¿æ¥</p>
<ul>
<li><p>å·¦å¤–è¿æ¥ å·¦ä¾§çš„è¡¨å®Œå…¨æ˜¾ç¤ºå°±æ˜¯å·¦å¤–è¿æ¥</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">FROM</span> table1 <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> table2 <span class="keyword">ON</span> <span class="keyword">condition</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å³å¤–è¿æ¥ å³ä¾§çš„è¡¨å®Œå…¨æ˜¾ç¤ºå°±æ˜¯å·¦å¤–è¿æ¥</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">FROM</span> table1 <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> table2 <span class="keyword">ON</span> <span class="keyword">condition</span></span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- stu è¡¨</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> stu</span><br><span class="line">(</span><br><span class="line">    id <span class="type">INT</span>,</span><br><span class="line">    `name` <span class="type">VARCHAR</span>(<span class="number">32</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> stu <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="string">&#x27;jack&#x27;</span>),(<span class="number">2</span>,<span class="string">&#x27;tom&#x27;</span>),(<span class="number">3</span>,<span class="string">&#x27;kitty&#x27;</span>),(<span class="number">4</span>,<span class="string">&#x27;nono&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">stuè¡¨</span><br><span class="line">			1 	jack</span><br><span class="line">			2 	tom</span><br><span class="line">			3 	kitty</span><br><span class="line">			4 	nono</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- exam è¡¨</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> exam</span><br><span class="line">(</span><br><span class="line">    id <span class="type">INT</span>,</span><br><span class="line">    grade <span class="type">INT</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> exam <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="number">56</span>),(<span class="number">2</span>,<span class="number">76</span>),(<span class="number">11</span>,<span class="number">8</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">examè¡¨</span><br><span class="line">			1	56</span><br><span class="line">			2	76</span><br><span class="line">			11	8</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- ä½¿ç”¨å·¦å¤–è¿æ¥</span></span><br><span class="line"><span class="comment">-- æ˜¾ç¤ºæ‰€æœ‰äººçš„æˆç»© å¦‚æœæ²¡æœ‰æˆç»©ä¹Ÿè¦æ˜¾ç¤ºäººçš„å§“åå’Œidï¼Œæˆç»©æ˜¾ç¤ºä¸ºç©º</span></span><br><span class="line"><span class="keyword">SELECT</span> name,stu.id,grade</span><br><span class="line">    <span class="keyword">FROM</span> stu,exam</span><br><span class="line">    <span class="keyword">WHERE</span> stu.id<span class="operator">=</span>exam.id;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">jack	1	56</span></span><br><span class="line"><span class="comment">tom		2	76</span></span><br><span class="line"><span class="comment">*/</span>    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#æ”¹æˆå·¦å¤–è¿æ¥</span><br><span class="line"><span class="keyword">SELECT</span> name,stu.id,grade</span><br><span class="line">    <span class="keyword">FROM</span> stu <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> exam</span><br><span class="line">    <span class="keyword">ON</span> stu.id<span class="operator">=</span>exam.id;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">jack	1	56</span></span><br><span class="line"><span class="comment">tom		2	76</span></span><br><span class="line"><span class="comment">kitty	3	NULL</span></span><br><span class="line"><span class="comment">nono	4	NULL</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- ä½¿ç”¨å³å¤–è¿æ¥</span></span><br><span class="line"><span class="comment">-- æ˜¾ç¤ºæ‰€æœ‰æˆç»©ï¼Œå¦‚æœæ²¡æœ‰åå­—åŒ¹é…æ˜¾ç¤ºç©º</span></span><br><span class="line"><span class="keyword">SELECT</span> name,stu.id,grade</span><br><span class="line">    <span class="keyword">FROM</span> stu <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> exam</span><br><span class="line">    <span class="keyword">ON</span> stu.id<span class="operator">=</span>exam.id;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">jack	1		56</span></span><br><span class="line"><span class="comment">tom		2		76</span></span><br><span class="line"><span class="comment">NULL	NULL 	 8</span></span><br><span class="line"><span class="comment">*/</span>    </span><br></pre></td></tr></table></figure>

<p><strong>EXAMPLE</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--åˆ—å‡ºéƒ¨é—¨åç§°å’Œè¿™äº›éƒ¨é—¨çš„å‘˜å·¥ä¿¡æ¯ï¼ŒåŒæ—¶åˆ—å‡ºé‚£äº›æ²¡æœ‰å‘˜å·¥çš„éƒ¨é—¨</span></span><br><span class="line">#å·¦å¤–è¿æ¥</span><br><span class="line"><span class="keyword">SELECT</span> dname,ename,job</span><br><span class="line">    <span class="keyword">FROM</span> dept <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> emp</span><br><span class="line">    <span class="keyword">ON</span> emp.deptno<span class="operator">=</span>dept.deptno;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">dname		ename	job</span></span><br><span class="line"><span class="comment">ACCOUNTING	MILLER	CLERK</span></span><br><span class="line"><span class="comment">ACCOUNTING	KING	PRESIDENT</span></span><br><span class="line"><span class="comment">ACCOUNTING	CLARK	MANAGER</span></span><br><span class="line"><span class="comment">RESEARCH	FORD	ANALYST</span></span><br><span class="line"><span class="comment">RESEARCH	SCOTT	ANALYST</span></span><br><span class="line"><span class="comment">RESEARCH	JONES	MANAGER</span></span><br><span class="line"><span class="comment">RESEARCH	SMITH	CLERK</span></span><br><span class="line"><span class="comment">SALES		JAMES	CLERK</span></span><br><span class="line"><span class="comment">SALES		TURNER	SALESMAN</span></span><br><span class="line"><span class="comment">SALES		BLAKE	MANAGER</span></span><br><span class="line"><span class="comment">SALES		MARTIN	SALESMAN</span></span><br><span class="line"><span class="comment">SALES		WARD	SALESMAN</span></span><br><span class="line"><span class="comment">SALES		ALLEN	SALESMAN</span></span><br><span class="line"><span class="comment">OPERATIONS	NULL	NULL</span></span><br><span class="line"><span class="comment">*/</span>    </span><br><span class="line">#å³å¤–è¿æ¥</span><br><span class="line"><span class="keyword">SELECT</span> ename,job,dname</span><br><span class="line">    <span class="keyword">FROM</span> emp <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> dept</span><br><span class="line">    <span class="keyword">ON</span> emp.deptno<span class="operator">=</span>dept.deptno;</span><br></pre></td></tr></table></figure>





<h2 id="MySQLçº¦æŸ"><a href="#MySQLçº¦æŸ" class="headerlink" title="MySQLçº¦æŸ"></a>MySQLçº¦æŸ</h2><p>çº¦æŸç”¨äºæ•°æ®åº“æ»¡è¶³ç‰¹å®šçš„å•†ä¸šè§„åˆ™</p>
<p>mysqlä¸­çº¦æŸåŒ…æ‹¬ï¼š<code>not nullã€uniqueã€primary keyã€foreign keyã€check</code>äº”ç§</p>
<h3 id="ä¸»é”®-primary-key"><a href="#ä¸»é”®-primary-key" class="headerlink" title="ä¸»é”® [primary key]"></a>ä¸»é”® [primary key]</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">å­—æ®µå å­—æ®µç±»å‹ <span class="keyword">primary</span> key</span><br></pre></td></tr></table></figure>

<p>ç”¨äºå”¯ä¸€çš„è¡¨ç¤ºè¡¨è¡Œçš„æ•°æ®ï¼Œå½“å®šä¹‰ä¸»é”®çº¦æŸåï¼Œè¯¥åˆ—ä¸èƒ½é‡å¤</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> primaryT</span><br><span class="line">(</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY ,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">32</span>),</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">32</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- ä¸»é”®åˆ—å€¼ä¸å¯ä»¥é‡å¤</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> primaryT <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="string">&#x27;jack&#x27;</span>,<span class="string">&#x27;jack@gmail.com&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> primaryT <span class="keyword">VALUES</span> (<span class="number">2</span>,<span class="string">&#x27;tom&#x27;</span>,<span class="string">&#x27;tom@gmail.com&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> primaryT <span class="keyword">VALUES</span> (<span class="number">2</span>,<span class="string">&#x27;false&#x27;</span>,<span class="string">&#x27;false@gmail.com&#x27;</span>);#é‡å¤</span><br><span class="line"></span><br><span class="line"># [<span class="literal">false</span>] Duplicate entry <span class="string">&#x27;2&#x27;</span> <span class="keyword">for</span> key <span class="string">&#x27;primaryt.PRIMARY&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>primary keyä¸èƒ½é‡å¤ä¸èƒ½ä¸ºnull</p>
</li>
<li><p>ä¸€å¼ è¡¨æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ï¼Œä½†å¯ä»¥æ˜¯å¤åˆä¸»é”®</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> primaryComplexKey</span><br><span class="line">(</span><br><span class="line">    id <span class="type">INT</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">32</span>),</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">32</span>),</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (id,`name`)</span><br><span class="line">);</span><br><span class="line">#åªæœ‰ id å’Œ name åŒæ—¶é‡å¤æ‰æ— æ³•æ·»åŠ æ•°æ®</span><br><span class="line"># id å’Œ name æœ‰ä¸€ä¸ªä¸ä¸€æ ·ï¼Œè¯¥åˆ—ä¸ç®—é‡å¤</span><br></pre></td></tr></table></figure>

<ul>
<li>é€æ¸çš„æŒ‡å®šæ–¹å¼æœ‰ä¸¤ç§</li>
</ul>
<p>â€‹	1.å­—æ®µå ç±»å‹ primary key</p>
<p>â€‹	2.è¡¨çš„æœ€åå†™ primary key(åˆ—å)</p>
<ul>
<li><em>ä½¿ç”¨<code>desc</code>è¡¨åï¼Œå¯ä»¥æŸ¥çœ‹åˆ°primary keyçš„æƒ…å†µ</em></li>
</ul>
<h3 id="éç©º-not-null"><a href="#éç©º-not-null" class="headerlink" title="éç©º [not null]"></a>éç©º [not null]</h3><p>æ’å…¥æ•°æ®æ—¶å¿…é¡»æä¾›æ•°æ®</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">å­—æ®µå å­—æ®µç±»å‹ <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br></pre></td></tr></table></figure>



<h3 id="å”¯ä¸€-unique"><a href="#å”¯ä¸€-unique" class="headerlink" title="å”¯ä¸€  [unique]"></a>å”¯ä¸€  [unique]</h3><p>å®šä¹‰å”¯ä¸€çº¦æŸåï¼Œè¯¥åˆ—å€¼ä¸èƒ½é‡å¤</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">å­—æ®µå å­—æ®µç±»å‹ <span class="keyword">UNIQUE</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å¦‚æœæ²¡æœ‰æŒ‡å®šnot null é‚£ä¹ˆuniqueå­—æ®µå¯ä»¥æœ‰å¤šä¸ªnull</li>
<li>ä¸€å¼ è¡¨å¯ä»¥æœ‰å¤šä¸ªuniqueå­—æ®µ</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> UniqueTable</span><br><span class="line">(</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">UNIQUE</span> , <span class="comment">-- è¡¨ç¤ºidåˆ—æ˜¯ä¸å¯ä»¥é‡å¤</span></span><br><span class="line">    `name` <span class="type">VARCHAR</span>(<span class="number">32</span>), <span class="comment">-- è¡¨ç¤ºnameåˆ—æ˜¯ä¸å¯ä»¥é‡å¤</span></span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">32</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> UniqueTable <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="string">&#x27;jack&#x27;</span>,<span class="string">&#x27;jack@gmail.com&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> UniqueTable <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="string">&#x27;tom&#x27;</span>,<span class="string">&#x27;tom@gmail.com&#x27;</span>);</span><br><span class="line"></span><br><span class="line">#[<span class="literal">false</span>] Duplicate entry <span class="string">&#x27;1&#x27;</span> <span class="keyword">for</span> key <span class="string">&#x27;uniquetable.id&#x27;</span></span><br></pre></td></tr></table></figure>



<p><strong>ä¸»é”®çº¦æŸï¼ˆprimary keyï¼‰</strong></p>
<ol>
<li>primary keyç”¨äºå”¯ä¸€åœ°æ ‡è¯†è¡¨ä¸­çš„æ¯ä¸€æ¡è®°å½•ï¼Œå¯ä»¥å®šä¹‰ä¸€åˆ—æˆ–å¤šåˆ—ä¸ºprimary key</li>
<li>æ˜¯ä¸å¯èƒ½ï¼ˆæˆ–å¾ˆéš¾ï¼‰æ›´æ–°</li>
<li>primary keyåˆ—ä¸Šæ²¡æœ‰ä»»ä½•ä¸¤è¡Œå…·æœ‰ç›¸åŒå€¼ï¼ˆå³é‡å¤å€¼ï¼‰ï¼Œä¸å…è®¸ç©ºï¼ˆNULLï¼‰</li>
<li>primary keyå¯ä½œå¤–å¥ï¼Œuniqueç´¢å¼•ä¸å¯</li>
</ol>
<p><strong>å”¯ä¸€æ€§çº¦æŸï¼ˆuniqueï¼‰</strong></p>
<ol>
<li>uniqueçº¦æŸç”¨æ¥é™åˆ¶ä¸å—ä¸»é”®çº¦æŸçš„åˆ—ä¸Šçš„æ•°æ®çš„å”¯ä¸€æ€§ï¼Œç”¨äºä½œä¸ºè®¿é—®æŸè¡Œçš„å¯é€‰æ‰‹æ®µï¼Œä¸€ä¸ªè¡¨ä¸Šå¯ä»¥æ”¾ç½®å¤šä¸ªuniqueçº¦æŸï¼</li>
<li>åªè¦uniqueå°±å¯ä»¥æ›´æ–°ï¼</li>
<li>å³è¡¨ä¸­ä»»æ„ä¸¤è¡Œåœ¨ æŒ‡å®šåˆ—ä¸Šéƒ½ä¸å…è®¸æœ‰ç›¸åŒçš„å€¼ï¼Œå…è®¸ç©ºï¼ˆNULLï¼‰</li>
<li>ä¸€ä¸ªè¡¨ä¸Šå¯ä»¥æ”¾ç½®å¤šä¸ªunique</li>
</ol>
<h3 id="å¤–é”®-foreign-key"><a href="#å¤–é”®-foreign-key" class="headerlink" title="å¤–é”®  [foreign key]"></a>å¤–é”®  [foreign key]</h3><p>ç”¨äºå®šä¹‰ä¸»è¡¨å’Œä»è¡¨å…³ç³»ï¼šå¤–é”®çº¦æŸè¦å®šä¹‰åœ¨ä»è¡¨ä¸Šï¼Œä¸»è¡¨å¿…é¡»å…·æœ‰primary keyæˆ–è€…uniqueï¼Œå½“å®šä¹‰å¤–é”®çº¦æŸåï¼Œè¦æ±‚å¤–é”®åˆ—æ•°æ®å¿…é¡»åœ¨ä¸»è¡¨çš„ä¸»é”®åˆ—å­˜åœ¨æˆ–è€…ä¸ºnull</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">FOREIGN</span> KEY(æœ¬è¡¨å­—æ®µå) <span class="keyword">REFERENCES</span> ä¸»è¡¨å (ä¸»é”®åæˆ–<span class="keyword">unique</span>å­—æ®µå)</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- ä¸»è¡¨ class</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> class</span><br><span class="line">(</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY ,</span><br><span class="line">    `name`  <span class="type">VARCHAR</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- ä»è¡¨ student</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student</span><br><span class="line">(</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">primary</span> key,<span class="comment">-- å­¦ç”Ÿç¼–å·</span></span><br><span class="line">    `name` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">default</span> <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    class_id <span class="type">int</span>,<span class="comment">-- ç­çº§ç¼–å·</span></span><br><span class="line">    # å¤–é”®å…³ç³»</span><br><span class="line">    <span class="keyword">foreign</span> key (class_id) <span class="keyword">references</span> class(id)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- æµ‹è¯•æ•°æ®</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> class <span class="keyword">values</span>(<span class="number">100</span>,<span class="string">&#x27;java&#x27;</span>),(<span class="number">200</span>,<span class="string">&#x27;web&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;tom&#x27;</span>,<span class="number">100</span>);#æˆåŠŸ</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;jack&#x27;</span>,<span class="number">200</span>);#æˆåŠŸ</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">&#x27;false&#x27;</span>,<span class="number">300</span>);#å¤±è´¥</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">&#x27;false&#x27;</span>,<span class="keyword">null</span>);#æˆåŠŸ</span><br></pre></td></tr></table></figure>

<ul>
<li><p>å¤–é”®æŒ‡å‘è¡¨çš„å­—æ®µï¼Œå¿…é¡»æ˜¯primary keyæˆ–è€…unique</p>
</li>
<li><p>è¡¨çš„ç±»å‹å¿…é¡»æ˜¯innodbæ‰æ”¯æŒå¤–é”®</p>
</li>
<li><p>å¤–é”®ä¸­åˆ—çš„æ•°æ®ç±»å‹å¿…é¡»å’Œä¸»è¡¨ä¸»é”®ä¸­å¯¹åº”åˆ—çš„æ•°æ®ç±»å‹ç›¸åŒï¼Œé•¿åº¦å¯ä¸åŒ</p>
</li>
<li><p>å¤–é”®å­—æ®µçš„å€¼å¿…é¡»åœ¨ä¸»é”®å­—æ®µä¸­å‡ºç°è¿‡ï¼Œæˆ–è€…ä¸ºnull</p>
</li>
<li><p>ä¸€æ—¦å»ºç«‹ä¸»å¤–é”®å…³ç³»ï¼Œæ•°æ®ä¸èƒ½éšæ„åˆ é™¤</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> class <span class="keyword">where</span> id<span class="operator">=</span><span class="number">100</span>;#<span class="literal">false</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="çº¦æŸé”®-check"><a href="#çº¦æŸé”®-check" class="headerlink" title="çº¦æŸé”® [check]"></a>çº¦æŸé”® [check]</h3><p>ç”¨äºå¼ºåˆ¶è¡Œæ•°æ®å¿…é¡»æ»¡è¶³çš„æ¡ä»¶ï¼Œå‡å®šsalåˆ—å®šä¹‰äº†checkçº¦æŸå¹¶è¦æ±‚salåˆ—å€¼åœ¨1000~2000ä¹‹é—´ï¼Œå¦‚æœä¸åœ¨å°±ä¼šæŠ¥é”™</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> checkTab</span><br><span class="line">(</span><br><span class="line">    id     <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    `name` <span class="type">VARCHAR</span>(<span class="number">32</span>),</span><br><span class="line">    sex    <span class="type">VARCHAR</span>(<span class="number">6</span>) <span class="keyword">CHECK</span> ( sex <span class="keyword">IN</span> (<span class="string">&#x27;man&#x27;</span>, <span class="string">&#x27;women&#x27;</span>)),</span><br><span class="line">    sal    <span class="keyword">DOUBLE</span> <span class="keyword">CHECK</span> ( sal <span class="operator">&gt;</span> <span class="number">1000</span> <span class="keyword">AND</span> sal <span class="operator">&lt;</span> <span class="number">2000</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> checkTab <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="string">&#x27;false&#x27;</span>,<span class="string">&#x27;man&#x27;</span>,<span class="number">1133223</span>);#<span class="literal">false</span></span><br></pre></td></tr></table></figure>





<h2 id="MySQLç´¢å¼•"><a href="#MySQLç´¢å¼•" class="headerlink" title="MySQLç´¢å¼•"></a>MySQLç´¢å¼•</h2><p>ç´¢å¼•ï¼ˆIndexï¼‰æ˜¯å¸®åŠ©MySQLé«˜æ•ˆè·å–æ•°æ®çš„æ•°æ®ç»“æ„ï¼Œé€šä¿—æ¥è®²ç´¢å¼•å°±å¥½æ¯”ä¹¦æœ¬çš„ç›®å½•ï¼ŒåŠ å¿«æ•°æ®åº“çš„æŸ¥è¯¢é€Ÿåº¦ã€‚ï¼ˆMySQLå®˜æ–¹å¯¹ç´¢å¼•çš„å®šä¹‰ï¼‰æé«˜æŸ¥è¯¢æ•ˆç‡</p>
<p><strong>ç´¢å¼•çš„ä¼˜ç‚¹</strong></p>
<p>æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œæ¶ˆé™¤æ•°æ®åˆ†ç»„ã€æ’åºï¼Œé¿å…å›è¡¨æŸ¥è¯¢ï¼ˆç´¢å¼•è¦†ç›–ï¼‰ï¼Œä¼˜åŒ–èšåˆæŸ¥è¯¢ï¼Œ ç”¨äºå¤šè¡¨JOINå…³è”æŸ¥è¯¢ï¼Œ åˆ©ç”¨å”¯ä¸€æ€§çº¦æŸï¼Œä¿è¯æ•°æ®å”¯ä¸€æ€§ï¼Œ InnoDBè¡Œé”å®ç°ã€‚</p>
<p><strong>ç´¢å¼•çš„ç¼ºç‚¹</strong></p>
<p>å¢åŠ I&#x2F;Oæˆæœ¬ï¼Œ å¢åŠ ç£ç›˜ç©ºé—´ï¼Œä¸åˆé€‚çš„ç´¢å¼•æˆ–ç´¢å¼•è¿‡å¤šï¼Œä¼šé™ä½å¢åˆ æ”¹çš„æ•ˆç‡(DML)</p>
<p><strong>ä¸»é”®ç´¢å¼• [primary key] ä¸»é”®å°±æ˜¯ä¸€ä¸ªç´¢å¼•</strong></p>
<p> <strong>å”¯ä¸€ç´¢å¼• [unique] å”¯ä¸€é”®ä¹Ÿæ˜¯ä¸€ç§ç´¢å¼•</strong></p>
<p> <strong>æ™®é€šç´¢å¼• [index]</strong></p>
<p> <strong>å…¨æ–‡ç´¢å¼• [fulltext] å®é™…å¼€å‘ä¸­ä½¿ç”¨å…¨æ–‡æœç´¢Solr å’Œ ElasticSearch(ES)</strong></p>
<h3 id="åˆ›å»ºç´¢å¼•"><a href="#åˆ›å»ºç´¢å¼•" class="headerlink" title="åˆ›å»ºç´¢å¼•"></a>åˆ›å»ºç´¢å¼•</h3><p><strong>unique</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># å”¯ä¸€ç´¢å¼•</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">unique</span> index id_index <span class="keyword">on</span> tableName(id);</span><br></pre></td></tr></table></figure>

<p><strong>index</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># æ™®é€šç´¢å¼•</span><br><span class="line"><span class="keyword">create</span>  index id_index <span class="keyword">on</span> tableName(id);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tableName <span class="keyword">add</span> index id_index(id)ï¼›</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæŸåˆ—çš„å€¼æ˜¯ä¸é‡å¤çš„å°±ä¼˜å…ˆè€ƒè™‘unqiueç´¢å¼•ï¼Œå¦åˆ™ä½¿ç”¨indexæ™®é€šç´¢å¼•</p>
<p><strong>primary key</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># ä¸»é”®ç´¢å¼• å»ºè¡¨æ—¶å»ºç´¢å¼•</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> `primaryKeyIndex`</span><br><span class="line">(</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">primary</span> key ,</span><br><span class="line">    `name` <span class="type">varchar</span>(<span class="number">32</span>)</span><br><span class="line">);</span><br><span class="line"># alert</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tableName <span class="keyword">add</span> <span class="keyword">primary</span> key  id_index(id)ï¼›</span><br></pre></td></tr></table></figure>



<h3 id="åˆ é™¤ç´¢å¼•"><a href="#åˆ é™¤ç´¢å¼•" class="headerlink" title="åˆ é™¤ç´¢å¼•"></a>åˆ é™¤ç´¢å¼•</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> index id_index <span class="keyword">on</span> tableName;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> index  <span class="keyword">PRIMARY</span> <span class="keyword">on</span> tableName;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> TableName <span class="keyword">drop</span> <span class="keyword">PRIMARY</span> KEY;</span><br></pre></td></tr></table></figure>



<h3 id="ä¿®æ”¹ç´¢å¼•"><a href="#ä¿®æ”¹ç´¢å¼•" class="headerlink" title="ä¿®æ”¹ç´¢å¼•"></a>ä¿®æ”¹ç´¢å¼•</h3><p>å…ˆåˆ é™¤é‡æ·»åŠ æ–°ç´¢å¼•</p>
<h3 id="æŸ¥è¯¢ç´¢å¼•"><a href="#æŸ¥è¯¢ç´¢å¼•" class="headerlink" title="æŸ¥è¯¢ç´¢å¼•"></a>æŸ¥è¯¢ç´¢å¼•</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- å‰ä¸‰ç§ç´¢å¼•æ–¹å¼å‡ ä¹ä¸€æ ·</span></span><br><span class="line"><span class="keyword">show</span> index <span class="keyword">from</span> tableName;</span><br><span class="line"><span class="keyword">show</span> indexes <span class="keyword">from</span> tableName; </span><br><span class="line"><span class="keyword">show</span> keys <span class="keyword">from</span> tableName; </span><br><span class="line"><span class="comment">-- ç¬¬å››ç§æ˜¾ç¤ºè¾ƒç®€ç•¥</span></span><br><span class="line"><span class="keyword">desc</span> tableName;</span><br></pre></td></tr></table></figure>



<h2 id="MySQLäº‹åŠ¡"><a href="#MySQLäº‹åŠ¡" class="headerlink" title="MySQLäº‹åŠ¡"></a>MySQLäº‹åŠ¡</h2><h3 id="MySQLäº‹åŠ¡ACID"><a href="#MySQLäº‹åŠ¡ACID" class="headerlink" title="MySQLäº‹åŠ¡ACID"></a>MySQLäº‹åŠ¡ACID</h3><p>åŸå­æ€§(Atomicity) åŸå­æ€§æ˜¯æŒ‡äº‹åŠ¡æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å•ä½ï¼Œäº‹åŠ¡ä¸­çš„æ“ä½œè¦ä¹ˆå‘ç”Ÿï¼Œè¦ä¹ˆä¸å‘ç”Ÿ</p>
<p>ä¸€è‡´æ€§(Consistency) äº‹åŠ¡å¿…é¡»ä½¿æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€æ¢åˆ°å¦å¤–ä¸€ä¸ªä¸€è‡´æ€§çš„çŠ¶æ€</p>
<p>éš”ç¦»æ€§(Lsolation) äº‹åŠ¡çš„éš”ç¦»æ€§æ˜¯æŒ‡å¤šä¸ªç”¨æˆ·å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œæ•°æ®åº“ä¸ºæ¯ä¸€ä¸ªç”¨æˆ·å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œä¸èƒ½è¢«å…¶ä»–äº‹åŠ¡çš„æ“ä½œæ•°æ®å¹²æ‰°ï¼Œå¤šä¸ªå¹¶å‘äº‹åŠ¡é—´è¦ç›¸äº’éš”ç¦»</p>
<p>æŒä¹…æ€§(Durability) æŒä¹…æ€§æ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦è¢«æäº¤ï¼Œå®ƒå¯¹æ•°æ®åº“çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§ï¼Œæ¥ä¸‹æ¥å³ä½¿æ•°æ®åº“å‘ç”Ÿæ•…éšœä¹Ÿä¸åº”è¯¥å¯¹å…¶æœ‰ä»»ä½•å½±å“</p>
<h3 id="äº‹åŠ¡æ“ä½œ"><a href="#äº‹åŠ¡æ“ä½œ" class="headerlink" title="äº‹åŠ¡æ“ä½œ"></a>äº‹åŠ¡æ“ä½œ</h3><p>äº‹åŠ¡ç”¨äºä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œå®ƒç”±ä¸€ç»„dmlè¯­å¥ç»„æˆï¼Œæ”¹ç»„çš„dml(update insert delete)è¦ä¹ˆå…¨æˆåŠŸï¼Œè¦ä¹ˆå…¨å¤±è´¥</p>
<p>äº‹åŠ¡åŠ é”ï¼Œç”¨æˆ·æ‰§è¡Œäº‹åŠ¡å¤„ç†è¯­å¥(dml)ï¼Œmysqlä¼šåŠ é”ï¼Œé˜²æ­¢å…¶ä»–ç”¨æˆ·ä¿®æ”¹è¡¨çš„æ•°æ®</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">start</span> transaction <span class="comment">-- å¼€å¯äº‹åŠ¡</span></span><br><span class="line"><span class="keyword">savepoint</span> ä¿å­˜ç‚¹å <span class="comment">-- è®¾ç½®ä¿å­˜ç‚¹</span></span><br><span class="line"><span class="keyword">rollback</span> <span class="keyword">to</span> ä¿å­˜ç‚¹å <span class="comment">-- å›é€€äº‹åŠ¡</span></span><br><span class="line"><span class="keyword">rollback</span> <span class="comment">-- å›é€€å…¨éƒ¨äº‹åŠ¡</span></span><br><span class="line"><span class="keyword">commit</span> <span class="comment">-- æäº¤äº‹åŠ¡ï¼Œæ‰€æœ‰çš„æ“ä½œç”Ÿæ•ˆï¼Œä¸èƒ½å›é€€</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> `transaction`</span><br><span class="line">(</span><br><span class="line">    id <span class="type">INT</span>,</span><br><span class="line">    `name` <span class="type">VARCHAR</span>(<span class="number">32</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¼€å¯äº‹åŠ¡</span></span><br><span class="line"><span class="keyword">start</span> transaction ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¿å­˜ç‚¹a</span></span><br><span class="line"><span class="keyword">savepoint</span> a;</span><br><span class="line"><span class="comment">-- dml</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `transaction` <span class="keyword">values</span>(<span class="number">100</span>,<span class="string">&#x27;nameA&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¿å­˜ç‚¹b</span></span><br><span class="line"><span class="keyword">savepoint</span> b;</span><br><span class="line"><span class="comment">-- dml</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `transaction` <span class="keyword">values</span>(<span class="number">100</span>,<span class="string">&#x27;nameB&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å›é€€</span></span><br><span class="line"><span class="keyword">rollback</span> <span class="keyword">to</span> b;</span><br><span class="line"><span class="keyword">rollback</span> <span class="keyword">to</span> a;</span><br><span class="line">#ç›´æ¥å›é€€åˆ°aç‚¹åæ— æ³•å†è¿”å›bç‚¹ï¼Œå›é€€åˆ°aç‚¹ä¼šåˆ é™¤ä¸­é—´æ‰€æœ‰çš„<span class="keyword">savepoint</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æäº¤</span></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line">#æäº¤äº‹åŠ¡ï¼Œæ— æ³•è¿”å›äº‹åŠ¡åŒºé—´å†…æ‰€æœ‰<span class="keyword">savePoint</span></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„äº‹é¡¹</p>
<ul>
<li>ä¸å¼€å¯äº‹åŠ¡é»˜è®¤æƒ…å†µdmlè‡ªåŠ¨æäº¤ä¸èƒ½å›æ»š</li>
<li>å¼€å¯ä¸€ä¸ªäº‹åŠ¡æ²¡æœ‰savepointä¹Ÿå¯ä»¥ç›´æ¥ç”¨rollbackå›æ»šåˆ°äº‹åŠ¡å¼€å§‹ç‚¹</li>
<li>mysqläº‹åŠ¡è®°ä½éœ€è¦innodbçš„å­˜å‚¨å¼•æ“</li>
<li>å¼€å¯ä¸€ä¸ªäº‹åŠ¡ start transactionæˆ–è€…set autocommit&#x3D;offï¼›</li>
</ul>
<h2 id="MySQLéš”ç¦»"><a href="#MySQLéš”ç¦»" class="headerlink" title="MySQLéš”ç¦»"></a><strong>MySQLéš”ç¦»</strong></h2><p><strong>å¤šä¸ªè¿æ¥å¼€å¯å„è‡ªäº‹åŠ¡æ“ä½œæ•°æ®åº“ä¸­çš„æ•°æ®æ—¶ï¼Œæ•°æ®åº“ç³»ç»Ÿè¦è´Ÿè´£éš”ç¦»æ“ä½œï¼Œä»¥ä¿è¯å„ä¸ªè¿æ¥åœ¨è·å–æ•°æ®æ—¶çš„å‡†ç¡®æ€§ï¼Œå¦‚æœä¸éš”ç¦»ä¼šå¼•å‘<em>è„è¯»ï¼Œä¸å¯é‡å¤è¯»ï¼Œå¹»è¯»</em></strong></p>
<p>**è„è¯»(<em>dirty read</em>)**ï¼šå½“ä¸€ä¸ªäº‹åŠ¡è¯»å–å¦ä¸€ä¸ªäº‹åŠ¡å°šæœªæäº¤çš„ä¿®æ”¹æ—¶ï¼Œäº§ç”Ÿè„è¯»</p>
<p>**ä¸å¯é‡å¤è¯»(<em>nonrepeatable rea</em>d)**: åŒä¸€æŸ¥è¯¢å†åŒä¸€äº‹ç‰©ç§å¤šæ¬¡è¿›è¡Œï¼Œç”±äºå…¶ä»–æäº¤çš„äº‹åŠ¡æ‰€ä½œçš„ä¿®æ”¹æˆ–åˆ é™¤ï¼Œæ¯æ¬¡è¿”å›ä¸åŒçš„ç»“æœé›†ï¼Œæ­¤æ—¶å‘ç”Ÿä¸å¯é‡å¤è¯»</p>
<p><strong>å¹»è¯»(<em>phantom read</em>)</strong>: åŒä¸€æŸ¥è¯¢åœ¨åŒä¸€äº‹äº‹åŠ¡ä¸­å¤šæ¬¡è¿›è¡Œï¼Œç”±äºå…¶ä»–æäº¤çš„äº‹åŠ¡æ‰€åšçš„æ’å…¥æ“ä½œï¼Œæ¯æ¬¡è¿”å›ä¸åŒçš„ç»“æœé›†ï¼Œæ­¤æ—¶å‘ç”Ÿå¹»è¯»</p>
<h3 id="æŸ¥çœ‹éš”ç¦»çº§åˆ«"><a href="#æŸ¥çœ‹éš”ç¦»çº§åˆ«" class="headerlink" title="æŸ¥çœ‹éš”ç¦»çº§åˆ«"></a>æŸ¥çœ‹éš”ç¦»çº§åˆ«</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#æŸ¥çœ‹ å½“å‰ä¼šè¯ éš”ç¦»çº§åˆ«</span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@transaction_isolation</span></span><br><span class="line">#æŸ¥çœ‹ å½“å‰ç³»ç»Ÿ éš”ç¦»çº§åˆ«</span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@global</span>.transaction_isolation;</span><br></pre></td></tr></table></figure>

<h3 id="ä¿®æ”¹éš”ç¦»çº§åˆ«"><a href="#ä¿®æ”¹éš”ç¦»çº§åˆ«" class="headerlink" title="ä¿®æ”¹éš”ç¦»çº§åˆ«"></a>ä¿®æ”¹éš”ç¦»çº§åˆ«</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#ä¿®æ”¹ å½“å‰ä¼šè¯ éš”ç¦»çº§åˆ«</span><br><span class="line"><span class="keyword">set</span> session transaction isolation level read committed;</span><br><span class="line">#ä¿®æ”¹ å½“å‰ç³»ç»Ÿ éš”ç¦»çº§åˆ«</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> session transaction isolation level read committed;</span><br></pre></td></tr></table></figure>

<p>mysqlé»˜è®¤äº‹åŠ¡çš„éš”ç¦»çº§åˆ«æ˜¯repeatable readè¶³ä»¥æ»¡è¶³å¤§éƒ¨åˆ†é¡¹ç›®éœ€æ±‚</p>
<h3 id="äº‹åŠ¡éš”ç¦»çº§åˆ«"><a href="#äº‹åŠ¡éš”ç¦»çº§åˆ«" class="headerlink" title="äº‹åŠ¡éš”ç¦»çº§åˆ«"></a>äº‹åŠ¡éš”ç¦»çº§åˆ«</h3><p>MySQLéš”ç¦»çº§åˆ«å®šä¹‰äº†äº‹åŠ¡ä¸äº‹åŠ¡é—´çš„éš”ç¦»ç¨‹åº¦</p>
<table>
<thead>
<tr>
<th><strong>MySQLéš”ç¦»çº§åˆ«</strong></th>
<th><strong>è„è¯»</strong></th>
<th><strong>ä¸å¯é‡å¤è¯»</strong></th>
<th><strong>å¹»è¯»</strong></th>
<th><strong>åŠ é”è¯»</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>è¯»æœªæäº¤(Read uncommitted)</strong></td>
<td>âˆš</td>
<td>âˆš</td>
<td>âˆš</td>
<td>ä¸åŠ é”</td>
</tr>
<tr>
<td><strong>è¯»å·²æäº¤(Read committed)</strong></td>
<td>Ã—</td>
<td>âˆš</td>
<td>âˆš</td>
<td>ä¸åŠ é”</td>
</tr>
<tr>
<td><strong>å¯é‡å¤è¯»(Repeatable read)</strong></td>
<td>Ã—</td>
<td>Ã—</td>
<td>Ã—</td>
<td>ä¸åŠ é”</td>
</tr>
<tr>
<td><strong>å¯ä¸²è¡ŒåŒ–(Serializable)</strong></td>
<td>Ã—</td>
<td>Ã—</td>
<td>Ã—</td>
<td>åŠ é”</td>
</tr>
</tbody></table>
<ul>
<li>âˆš å¯èƒ½å‡ºç°</li>
<li>Ã— ä¸ä¼šå‡ºç°</li>
</ul>
<p><strong>å¼€å¯ä¸¤ä¸ªmysqlçš„æ§åˆ¶å°</strong></p>
<p><strong>æŸ¥è¯¢å½“å‰éš”ç¦»çº§åˆ«</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> @<span class="variable">@transaction_isolation</span></span><br></pre></td></tr></table></figure>

<p>æ§åˆ¶å°1</p>
<p>+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“+<br>| @@transaction_isolation   |<br>+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“+<br>| REPEATABLE-READ         |<br>+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+</p>
<p>æ§åˆ¶å°2</p>
<p>+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“+<br>| @@transaction_isolation   |<br>+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“+<br>| REPEATABLE-READ         |<br>+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+</p>
<h3 id="è¯»æœªæäº¤-Read-uncommitted"><a href="#è¯»æœªæäº¤-Read-uncommitted" class="headerlink" title="è¯»æœªæäº¤ Read uncommitted"></a>è¯»æœªæäº¤ Read uncommitted</h3><p><em>ä¼šå‡ºç°è„è¯» å¹»è¯» ä¸å¯é‡å¤è¯»</em></p>
<p>æŠŠå…¶ä¸­ä¸€ä¸ªæ§åˆ¶å°éš”ç¦»çº§åˆ«è®¾ç½®æˆ<strong>Read uncommitted</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">set</span> session transaction isolation level read uncommitted ;</span><br></pre></td></tr></table></figure>

<p> <strong>read uncommitted</strong>æ§åˆ¶å°</p>
<p>+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“+<br>| @@transaction_isolation   |<br>+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“+<br>| READ-UNCOMMITTED    |<br>+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+</p>
<p> <strong>repeatable read</strong>æ§åˆ¶å°</p>
<p>+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“+<br>| @@transaction_isolation   |<br>+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“+<br>| REPEATABLE-READ         |<br>+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+</p>
<p><strong>ä¸¤æ§åˆ¶å°å‡å¯åŠ¨äº‹åŠ¡</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">start</span> transaction;</span><br></pre></td></tr></table></figure>



<p><em><strong>åˆ›å»ºè¡¨</strong></em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> `account`</span><br><span class="line">(</span><br><span class="line">    id <span class="type">INT</span>,</span><br><span class="line">    `name` <span class="type">VARCHAR</span>(<span class="number">32</span>),</span><br><span class="line">    money <span class="type">INT</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>





<p>repeatable readæ§åˆ¶å° <em>æ·»åŠ æ•°æ®</em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> account <span class="keyword">values</span> (<span class="number">100</span>,<span class="string">&#x27;tom&#x27;</span>,<span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<p>æœªæäº¤ä½†æ§åˆ¶å° <strong>read uncommitted</strong> (éš”ç¦»çº§åˆ«è¯»æœªæäº¤)æ˜¾ç¤ºå‡ºæ¥äº†</p>
<p>+â€”â€”+â€”â€”+â€”â€”â€”â€“+<br>| id   | name | money  |<br>+â€”â€”+â€”â€”+â€”â€”â€”â€“+<br>|  100 | tom  |  1000   |<br>+â€”â€”+â€”â€”+â€”â€”â€”â€“+</p>
<p>å‘ç”Ÿäº†<em>è„è¯»</em>ï¼Œä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°äº†å¦ä¸€ä¸ªäº‹åŠ¡æœªæäº¤çš„ä¿®æ”¹</p>
<p><strong>repeatable read</strong> <em>æ·»åŠ æ•°æ®ä¿®æ”¹æ•°æ®åæäº¤</em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money<span class="operator">=</span><span class="number">800</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">100</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> account <span class="keyword">values</span> (<span class="number">200</span>,<span class="string">&#x27;jack&#x27;</span>,<span class="number">2000</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure>

<p><strong>read uncommittedæŸ¥è¯¢çœ‹åˆ°äº†ç»“æœ</strong></p>
<p>+â€”â€”+â€”â€”+â€”â€”â€”â€“+<br>| id   | name | money  |<br>+â€”â€”+â€”â€”+â€”â€”â€”â€“+<br>|  100 | tom  |   800    |<br>|  200 | jack |  2000    |<br>+â€”â€”+â€”â€”+â€”â€”â€”â€“+</p>
<p>ä¿®æ”¹å’Œæ·»åŠ æäº¤åæ§åˆ¶å°1çœ‹åˆ°äº†ï¼Œå‘ç”Ÿäº†<em>ä¸å¯é‡å¤è¯»å’Œå¹»è¯»</em>ï¼Œéš”ç¦»çº§åˆ«é«˜äº†å¦‚Repeatable readå’ŒSerializableä¸ä¼šå‘ç”Ÿä¸å¯é‡å¤è¯»å’Œå¹»è¯»ï¼Œå…¶ä»–äº‹åŠ¡çš„commitä¸ä¼šå½±å“åˆ°æœ¬äº‹åŠ¡</p>
<h3 id="è¯»å·²æäº¤-read-uncommitted"><a href="#è¯»å·²æäº¤-read-uncommitted" class="headerlink" title="è¯»å·²æäº¤ read uncommitted"></a>è¯»å·²æäº¤ read uncommitted</h3><p>ä¸ä¼šå‡ºç°è„è¯»ï¼Œä¼šå¹»è¯» ä¸å¯é‡å¤è¯»</p>
<p><strong>å¯åŠ¨äº‹åŠ¡</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">start</span> transaction;</span><br></pre></td></tr></table></figure>



<p> <strong>read committed</strong>  <em>æ§åˆ¶å°è®¾ç½®éš”ç¦»çº§åˆ«</em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">set</span> session transaction isolation level read committed;</span><br></pre></td></tr></table></figure>



<p><strong>repeatable read</strong>æ§åˆ¶å°<em>æ·»åŠ æ•°æ®</em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> account <span class="keyword">values</span> (<span class="number">300</span>,<span class="string">&#x27;scott&#x27;</span>,<span class="number">8000</span>);</span><br></pre></td></tr></table></figure>



<p> <strong>read committed</strong> <em>æŸ¥è¯¢æ§åˆ¶å°</em></p>
<p>å‘ç°æ— æ³•çœ‹è§è®°å½• è¯´æ˜æ²¡æœ‰å‘ç”Ÿè„è¯»</p>
<p><code>mysql&gt; select *from account;</code><br><code>Empty set (0.00 sec)</code></p>
<p> <strong>repeatable read</strong>  <em>æ§åˆ¶å°ä¿®æ”¹æ•°æ®</em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money<span class="operator">=</span><span class="number">7000</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">300</span>;</span><br></pre></td></tr></table></figure>

<p>read committedæ§åˆ¶å°ä¹Ÿèƒ½æŸ¥è¯¢åˆ°ï¼Œè¯´æ˜read committedçº§åˆ«ä¼šå‘ç”Ÿ<em>ä¸å¯é‡å¤è¯»å’Œå¹»è¯»</em></p>
<h3 id="å¯é‡å¤è¯»-repeatable-read"><a href="#å¯é‡å¤è¯»-repeatable-read" class="headerlink" title="å¯é‡å¤è¯» repeatable read"></a>å¯é‡å¤è¯» repeatable read</h3><p>ä¸ä¼šå‡ºç°è„è¯» å¹»è¯» ä¸å¯é‡å¤è¯»</p>
<p> <strong>read committed</strong> æ§åˆ¶å°<em>æ·»åŠ æ•°æ®æœªæäº¤</em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> account <span class="keyword">values</span> (<span class="number">100</span>,<span class="string">&#x27;first&#x27;</span>,<span class="number">9000</span>);</span><br></pre></td></tr></table></figure>



<p><strong>repeatable read</strong> æ§åˆ¶å°æ— æ³•æŸ¥è¯¢åˆ°ï¼Œæ²¡æœ‰å‡ºç°è„è¯»</p>
<p><code>mysql&gt; select *from account;</code><br><code>Empty set (0.00 sec)</code></p>
<p><strong>read committed</strong>  <em>æ§åˆ¶å°æ·»åŠ æˆ–ä¿®æ”¹æ•°æ®å¹¶æäº¤</em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> account <span class="keyword">values</span> (<span class="number">200</span>,<span class="string">&#x27;second&#x27;</span>,<span class="number">9000</span>);</span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money<span class="operator">=</span><span class="number">8000</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">200</span>;</span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure>



<p>repeatable read æ§åˆ¶å°æ— æ³•æŸ¥è¯¢åˆ°ï¼Œæ²¡æœ‰å‡ºç°ä¸å¯é‡å¤è¯»å’Œå¹»è¯»</p>
<p><strong><code>mysql&gt; select *from account;</code></strong><br><strong><code>Empty set (0.00 sec)</code></strong></p>
<h3 id="å¯ä¸²è¡Œè¯»-serializable"><a href="#å¯ä¸²è¡Œè¯»-serializable" class="headerlink" title="å¯ä¸²è¡Œè¯» serializable"></a>å¯ä¸²è¡Œè¯» serializable</h3><p>ä¸ä¼šå‡ºç°è„è¯» å¹»è¯» ä¸å¯é‡å¤è¯» åŒæ—¶ä¼šåŠ é”</p>
<p>ä¸€ä¸ªäº‹åŠ¡æ“ä½œæ—¶å¦ä¸€ä¸ªäº‹åŠ¡æ— æ³•æ“ä½œï¼Œä¼šå¡ä½</p>
<p><strong>å¼€å¯äº‹åŠ¡</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">start</span> transaction;</span><br></pre></td></tr></table></figure>



<p><strong>read committed</strong> æ§åˆ¶å°<em>æ·»åŠ æ•°æ®</em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> account <span class="keyword">values</span> (<span class="number">100</span>,<span class="string">&#x27;first&#x27;</span>,<span class="number">9000</span>);</span><br></pre></td></tr></table></figure>

<p>Serializableæ§åˆ¶å°ä¼šå¡ä½ï¼Œå› ä¸ºå…¶ä»–äº‹åŠ¡åœ¨ä½¿ç”¨ï¼Œå­˜åœ¨lockæ— æ³•æ“ä½œè¡¨</p>
<p>read committed <em>æäº¤</em> <code>commitï¼›</code></p>
<p><strong>Serializable</strong>æ§åˆ¶å°æ‰æ˜¾ç¤ºç»“æœï¼Œå› ä¸ºunlockäº†</p>
<h2 id="MySQLè§†å›¾"><a href="#MySQLè§†å›¾" class="headerlink" title="MySQLè§†å›¾"></a>MySQLè§†å›¾</h2><p>è§†å›¾viewæ˜¯ä¸€ä¸ª<strong>è™šæ‹Ÿè¡¨</strong>ï¼Œå…¶å†…å®¹ç”±æŸ¥è¯¢æ¥å®šä¹‰ï¼ŒåŒçœŸçœŸå®è¡¨ä¸€æ ·ï¼Œè§†å›¾åŒ…å«åˆ—ï¼Œå…¶æ•°æ®å¯¹åº”çœŸå®è¡¨&#x2F;åŸºè¡¨</p>
<p>æ˜¯ä¸€ç§æ˜ å°„å…³ç³»ï¼Œæé«˜äº†æ•°æ®åº“ä¸€å®šçš„å®‰å…¨æ€§</p>
<p>ä»<strong>ä¸€ä¸ªæˆ–å‡ ä¸ªåŸºæœ¬è¡¨ï¼ˆæˆ–è§†å›¾ï¼‰å¯¼å‡ºçš„è¡¨</strong>ã€‚å®ƒä¸åŸºæœ¬è¡¨ä¸åŒï¼Œæ˜¯ä¸€ä¸ªè™šè¡¨ã€‚æ•°æ®åº“ä¸­åªå­˜æ”¾è§†å›¾çš„å®šä¹‰ï¼Œè€Œä¸å­˜æ”¾è§†å›¾å¯¹åº”çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®ä»å­˜æ”¾åœ¨åŸæ¥çš„åŸºæœ¬è¡¨ä¸­ã€‚</p>
<p>æ‰€ä»¥<strong>ä¸€æ—¦åŸºæœ¬è¡¨ä¸­çš„æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œä»è§†å›¾ä¸­æŸ¥è¯¢å‡ºçš„æ•°æ®ä¹Ÿå°±éšä¹‹æ”¹å˜äº†</strong>ã€‚ä»è¿™ä¸ªæ„ä¹‰ä¸Šè®²ï¼Œ<strong>è§†å›¾å°±åƒä¸€ä¸ªçª—å£</strong>ï¼Œé€è¿‡å®ƒå¯ä»¥çœ‹åˆ°æ•°æ®åº“ä¸­è‡ªå·±æ„Ÿå…´è¶£çš„æ•°æ®åŠå…¶å˜åŒ–ã€‚</p>
<p>è§†å›¾ä¸€ç»å®šä¹‰ï¼Œå°±å¯ä»¥å’ŒåŸºæœ¬è¡¨ä¸€æ ·è¢«æŸ¥è¯¢ã€åˆ é™¤ã€‚ä¹Ÿå¯ä»¥åœ¨ä¸€ä¸ªè§†å›¾ä¹‹ä¸Šå†å®šä¹‰æ–°çš„è§†å›¾ï¼Œä½†å¯¹è§†å›¾çš„æ›´æ–°ï¼ˆå¢ã€åˆ ã€æ”¹ï¼‰æ“ä½œåˆ™æœ‰ä¸€å®šçš„é™åˆ¶ã€‚</p>
<h3 id="è§†å›¾çš„åŸºæœ¬ä½¿ç”¨"><a href="#è§†å›¾çš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="è§†å›¾çš„åŸºæœ¬ä½¿ç”¨"></a>è§†å›¾çš„åŸºæœ¬ä½¿ç”¨</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#åˆ›å»º</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> ViewTable <span class="keyword">AS</span> <span class="keyword">SELECT</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> emp_view01 <span class="keyword">AS</span> <span class="keyword">SELECT</span> empno,ename,job,deptno <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">select</span>  <span class="operator">*</span> <span class="keyword">from</span> emp_view01;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#æ›´æ–°è§†å›¾</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">VIEW</span> ViewTable <span class="keyword">AS</span> <span class="keyword">SELECT</span></span><br><span class="line"><span class="keyword">update</span> myview <span class="keyword">set</span> comm<span class="operator">=</span><span class="number">200</span> <span class="keyword">where</span> empno<span class="operator">=</span><span class="number">7369</span>;</span><br><span class="line"></span><br><span class="line">#æ˜¾ç¤ºåˆ›å»ºè§†å›¾çš„æŒ‡ä»¤</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> ViewTable</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">view</span> emp_view01;</span><br><span class="line"></span><br><span class="line">#åˆ é™¤è§†å›¾</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> ViewTable1,ViewTable2</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> emp_view01;</span><br></pre></td></tr></table></figure>

<p><strong>è§†å›¾ç»†èŠ‚è®¨è®º</strong></p>
<ul>
<li><p>åˆ›å»ºè§†å›¾åï¼Œåˆ°æ•°æ®åº“å»çœ‹ï¼Œå¯¹åº”è§†å›¾åªæœ‰ä¸€ä¸ªè§†å›¾ç»“æ„æ–‡ä»¶ï¼ˆå½¢å¼ï¼šè§†å›¾å.frmï¼‰</p>
</li>
<li><p>è§†å›¾çš„æ•°æ®å˜åŒ–ä¼šå½±å“åˆ°åŸºè¡¨ï¼ŒåŸºè¡¨çš„æ•°æ®å˜åŒ–ä¹Ÿä¼šå½±å“åˆ°è§†å›¾ [insert update delete]</p>
<p>â€”-é’ˆå¯¹å‰é¢çš„é›‡å‘˜ç®¡ç†ç³»ç»Ÿâ€”-<br>mysql&gt; <code>create view myview as select empno,ename,job,comm from emp;</code><br>mysql&gt; <code>select * from myview;</code><br>mysql&gt;<code>update myview set comm=200 where empno=7369;</code><strong>ä¿®æ”¹è§†å›¾,å¯¹åŸºè¡¨éƒ½æœ‰å˜åŒ–</strong><br>mysql&gt;<code>update emp set comm=100 where empno=7369;</code><strong>ä¿®æ”¹åŸºè¡¨ï¼Œå¯¹è§†é¢‘ä¹Ÿæœ‰å˜åŒ–</strong></p>
</li>
</ul>
<h3 id="è§†å›¾çš„æœ€ä½³å®è·µ"><a href="#è§†å›¾çš„æœ€ä½³å®è·µ" class="headerlink" title="è§†å›¾çš„æœ€ä½³å®è·µ"></a>è§†å›¾çš„æœ€ä½³å®è·µ</h3><ul>
<li><strong>å®‰å…¨</strong>  ä¸€äº›æ•°æ®è¡¨æœ‰ç€é‡è¦çš„ä¿¡æ¯ï¼Œæœ‰äº›å­—æ®µæ˜¯ä¿å¯†çš„ï¼Œä¸èƒ½è®©ç”¨æˆ·ç›´æ¥çœ‹åˆ°ï¼Œè¿™æ—¶å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªè§†å›¾ï¼Œåœ¨è¿™å¼ è§†å›¾ä¸­åªä¿ç•™ä¸€éƒ¨åˆ†å­¦æ®µã€‚è¿™æ ·ï¼Œç”¨æˆ·å°±å¯ä»¥æŸ¥è¯¢è‡ªå·±éœ€è¦çš„å­—æ®µï¼Œä¸èƒ½æŸ¥çœ‹ä¿å¯†çš„å­—æ®µã€‚</li>
<li><strong>æ€§èƒ½</strong>  å…³ç³»æ•°æ®åº“çš„æ•°æ®å¸¸å¸¸ä¼šåˆ†è¡¨å­˜å‚¨ï¼Œä½¿ç”¨å¤–é”®å»ºç«‹è¿™äº›è¡¨çš„ä¹‹é—´å…³ç³»ã€‚è¿™æ—¶æ•°æ®åº“æŸ¥è¯¢é€šå¸¸ä¼šç”¨åˆ°è¿æ¥ï¼ˆJOINï¼‰ã€‚è¿™æ ·åšä¸ä½†éº»çƒ¦ï¼Œæ•ˆç‡ç›¸å¯¹ä¹Ÿæ¯”è¾ƒä½ã€‚å¦‚æœå»ºç«‹ä¸€ä¸ªè§†å›¾ï¼Œå°†ç›¸å…³çš„è¡¨å’Œå­—æ®µç»„åˆåœ¨ä¸€èµ·ï¼Œå°±å¯ä»¥é¿å…ä½¿ç”¨JOINæŸ¥è¯¢æ•°æ®ã€‚</li>
<li><strong>çµæ´»</strong>  å¦‚æœç³»ç»Ÿä¸­æœ‰ä¸€å¼ æ—§çš„è¡¨ï¼Œè¿™å¼ è¡¨ç”±äºè®¾è®¡çš„é—®é¢˜ï¼Œå³å°†è¢«åºŸå¼ƒã€‚ç„¶è€Œï¼Œå¾ˆå¤šåº”ç”¨éƒ½æ˜¯åŸºäºè¿™å¼ è¡¨ï¼Œä¸æ˜“ä¿®æ”¹ã€‚è¿™æ—¶å°±å¯ä»¥å»ºç«‹ä¸€å¼ è§†å›¾ï¼Œè§†å›¾ä¸­çš„æ•°æ®ç›´æ¥æ˜ å°„åˆ°æ–°å»ºçš„è¡¨ã€‚è¿™æ ·ï¼Œå°±å¯ä»¥å°‘åšå¾ˆå¤šæ”¹åŠ¨ï¼Œä¹Ÿè¾¾åˆ°äº†å‡çº§æ•°æ®è¡¨çš„è‡ªçš„</li>
</ul>
<h2 id="MySQLç®¡ç†"><a href="#MySQLç®¡ç†" class="headerlink" title="MySQLç®¡ç†"></a>MySQLç®¡ç†</h2><h3 id="MySQLçš„ç”¨æˆ·ç®¡ç†"><a href="#MySQLçš„ç”¨æˆ·ç®¡ç†" class="headerlink" title="MySQLçš„ç”¨æˆ·ç®¡ç†"></a>MySQLçš„ç”¨æˆ·ç®¡ç†</h3><p>mysqlçš„ç”¨æˆ·å­˜å‚¨åœ¨æ•°æ®åº“mysqlä¸­çš„userè¡¨</p>
<p>ä¸åŒæ•°æ®åº“ç”¨æˆ·ï¼Œç™»å½•åˆ°DBMSåï¼Œæ ¹æ®æƒé™çš„ä¸åŒï¼Œæ“ä½œçš„åº“å’Œæ•°æ®å¯¹è±¡(è¡¨ï¼Œè§†å›¾ï¼Œè§¦å‘å™¨)ä¸ç›¸åŒ</p>
<p>å­—æ®µè¯´æ˜</p>
<ul>
<li><strong>host</strong>    å…è®¸ç™»å½•çš„ä½ç½®ï¼Œ<strong>localhost</strong>è¡¨ç¤ºè¯¥ç”¨æˆ·åªå…è®¸æœ¬æœºç™»å½•ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šipï¼Œå¦‚192.168.1.100</li>
<li>**user **   ç”¨æˆ·å</li>
<li><strong>authentication_string</strong>    å¯†ç ï¼Œæ˜¯é€šè¿‡mysqlçš„password()å‡½æ•°åŠ å¯†ä¹‹åçš„å¯†ç ,å­˜æ”¾åœ¨userè¡¨ä¸­ä¹Ÿæ˜¯åŠ å¯†åçš„å¯†ç </li>
</ul>
<p><strong>åˆ›å»ºç”¨æˆ·</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;ç™»é™†ä½ç½®&#x27;</span> INDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ é™¤ç”¨æˆ·</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;ç™»é™†ä½ç½®&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>åœ¨åˆ›å»ºç”¨æˆ·çš„æ—¶å€™ï¼Œå¦‚æœä¸æŒ‡å®šHostï¼Œåˆ™ä¸º%ï¼Œ%è¡¨ç¤ºè¡¨ç¤ºæ‰€æœ‰IPéƒ½æœ‰è¿æ¥æƒé™ <code>create user xxx;</code></li>
<li>ä½ ä¹Ÿå¯ä»¥è¿™æ ·æŒ‡å®š <code>create userxxx@&#39;192.168.1.%&#39;</code>è¡¨ç¤ºxxxç”¨æˆ·åœ¨192.168.1.*çš„ipå¯ä»¥ç™»å½•mysg</li>
<li>åœ¨åˆ é™¤ç”¨æˆ·çš„æ—¶å€™ï¼Œå¦‚æœ host ä¸æ˜¯ %,éœ€è¦æ˜ç¡®æŒ‡å®š<code>&#39;ç”¨æˆ·&#39;@&#39;hostå€¼&#39;</code></li>
</ul>
<p><strong>ç™»å½•</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mysql [-h ä¸»æœºå -P] ç«¯å£å· -u username -ppassword</span><br></pre></td></tr></table></figure>

<ul>
<li>-p åç›´æ¥è¾“å…¥å¯†ç ï¼Œåˆ™ä¸å¯ä»¥åŠ ç©ºæ ¼ï¼Œå¹¶ä¸”åœ¨è¿™é‡Œè¾“å…¥å¯†ç ï¼Œå¯†ç ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œå»ºè®®-påæŒ‰å›è½¦ï¼Œå‘½ä»¤è¡Œçª—å£å°±ä¼šè‡ªåŠ¨è·³åˆ°ä¸‹ä¸€è¡Œï¼šEnter password:</li>
<li>å¦‚æœç™»å½•çš„æ˜¯è¿œç«¯æœåŠ¡å™¨çš„æ•°æ®åº“ï¼Œåˆ™å¾—è¾“å…¥ mysql -hä¸»æœºå -Pç«¯å£å· -uç”¨æˆ·å -på¯†ç </li>
<li>æ³¨æ„ï¼Œ-Pç«¯å£å·ï¼Œä¸­çš„Pæ˜¯å¤§å†™çš„ï¼Œè¦è·Ÿå¯†ç å‰é¢çš„pï¼ˆå°å†™ï¼‰åŒºåˆ†å¼€</li>
</ul>
<p><strong>ä¿®æ”¹å¯†ç </strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#è‡ªå·±å¯†ç </span><br><span class="line"><span class="keyword">SET</span> PASSWORD <span class="operator">=</span> PASSWORD(<span class="string">&#x27;new password&#x27;</span>);</span><br><span class="line">#ä»–äººå¯†ç (éœ€è¦æœ‰æƒé™)</span><br><span class="line"><span class="keyword">SET</span> PASSWORD <span class="keyword">FOR</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;ç™»é™†ä½ç½®&#x27;</span> <span class="operator">=</span> PASSWORD(<span class="string">&#x27;new password&#x27;</span>);</span><br></pre></td></tr></table></figure>







<h3 id="MySQLçš„æƒé™ç®¡ç†"><a href="#MySQLçš„æƒé™ç®¡ç†" class="headerlink" title="MySQLçš„æƒé™ç®¡ç†"></a>MySQLçš„æƒé™ç®¡ç†</h3><h4 id="ç”¨æˆ·æˆæƒæ“ä½œ"><a href="#ç”¨æˆ·æˆæƒæ“ä½œ" class="headerlink" title="ç”¨æˆ·æˆæƒæ“ä½œ"></a>ç”¨æˆ·æˆæƒæ“ä½œ</h4><p><strong>æˆæƒ</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">grand æƒé™åˆ—è¡¨ <span class="keyword">on</span> åº“.å¯¹è±¡å <span class="keyword">to</span> <span class="string">&#x27;ç”¨æˆ·å&#x27;</span>@<span class="string">&#x27;ç™»é™†ä½ç½®&#x27;</span> [identified <span class="keyword">by</span> <span class="string">&#x27;å¯†ç &#x27;</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li><p>æƒé™åˆ—è¡¨ï¼Œå¤šä¸ªæƒé™ç”¨é€—å·åˆ†å¼€</p>
<p><code>grant select on .....</code></p>
<p><code>grant select, delete, create on ....</code></p>
<p><code>grant all [privileges] on ....</code> &#x2F;&#x2F;è¡¨ç¤ºèµ‹äºˆè¯¥ç”¨æˆ·åœ¨è¯¥å¯¹è±¡ä¸Šçš„æ‰€æœ‰æƒé™</p>
</li>
<li><p>ç‰¹åˆ«è¯´æ˜</p>
<p><strong>ï¼Š.ï¼Š</strong>  ä»£è¡¨æœ¬ç³»ç»Ÿä¸­çš„æ‰€æœ‰æ•°æ®åº“çš„æ‰€æœ‰å¯¹è±¡(è¡¨ï¼Œè§†å›¾ï¼Œå­˜å‚¨è¿‡ç¨‹)</p>
<p><strong>åº“.ï¼Š</strong> è¡¨ç¤ºæŸä¸ªæ•°æ®åº“ä¸­çš„æ‰€æœ‰æ•°æ®å¯¹è±¡ï¼ˆè¡¨ï¼Œè§†å›¾ï¼Œå­˜å‚¨è¿‡ç¨‹ç­‰)</p>
</li>
<li><p>identified by å¯ä»¥çœç•¥ï¼Œä¹Ÿå¯ä»¥å†™å‡º</p>
<p>(1)å¦‚æœç”¨æˆ·å­˜åœ¨ï¼Œå°±æ˜¯ä¿®æ”¹è¯¥ç”¨æˆ·çš„å¯†ç </p>
<p>(2)å¦‚æœç”¨æˆ·ä¸å­˜åœ¨ï¼Œå°±æ˜¯åˆ›å»ºè¯¥ç”¨æˆ·</p>
</li>
</ul>
<p><strong>æ”¶å›æƒé™</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">revoke</span> æƒé™åˆ—è¡¨ <span class="keyword">on</span> åº“.å¯¹è±¡å <span class="keyword">from</span> <span class="string">&#x27;ç”¨æˆ·å&#x27;</span>@<span class="string">&#x27;ç™»é™†ä½ç½®&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>æƒé™ç”Ÿæ•ˆæŒ‡ä»¤</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">flush privileges;</span><br></pre></td></tr></table></figure>



<table>
<thead>
<tr>
<th align="left"><strong>æƒ é™</strong></th>
<th align="left"><strong>ä½œç”¨èŒƒå›´</strong></th>
<th align="left"><strong>ä½œ ç”¨</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>all</strong></td>
<td align="left">æœåŠ¡å™¨</td>
<td align="left">æ‰€æœ‰æƒé™</td>
</tr>
<tr>
<td align="left"><strong>select</strong></td>
<td align="left">è¡¨ã€åˆ—</td>
<td align="left">é€‰æ‹©è¡Œ</td>
</tr>
<tr>
<td align="left"><strong>insert</strong></td>
<td align="left">è¡¨ã€åˆ—</td>
<td align="left">æ’å…¥è¡Œ</td>
</tr>
<tr>
<td align="left"><strong>update</strong></td>
<td align="left">è¡¨ã€åˆ—</td>
<td align="left">æ›´æ–°è¡Œ</td>
</tr>
<tr>
<td align="left"><strong>delete</strong></td>
<td align="left">è¡¨</td>
<td align="left">åˆ é™¤è¡Œ</td>
</tr>
<tr>
<td align="left"><strong>create</strong></td>
<td align="left">æ•°æ®åº“ã€è¡¨ã€ç´¢å¼•</td>
<td align="left">åˆ›å»º</td>
</tr>
<tr>
<td align="left"><strong>drop</strong></td>
<td align="left">æ•°æ®åº“ã€è¡¨ã€è§†å›¾</td>
<td align="left">åˆ é™¤</td>
</tr>
<tr>
<td align="left"><strong>reload</strong></td>
<td align="left">æœåŠ¡å™¨</td>
<td align="left">å…è®¸ä½¿ç”¨flushè¯­å¥</td>
</tr>
<tr>
<td align="left"><strong>shutdown</strong></td>
<td align="left">æœåŠ¡å™¨</td>
<td align="left">å…³é—­æœåŠ¡</td>
</tr>
<tr>
<td align="left"><strong>process</strong></td>
<td align="left">æœåŠ¡å™¨</td>
<td align="left">æŸ¥çœ‹çº¿ç¨‹ä¿¡æ¯</td>
</tr>
<tr>
<td align="left"><strong>file</strong></td>
<td align="left">æœåŠ¡å™¨</td>
<td align="left">æ–‡ä»¶æ“ä½œ</td>
</tr>
<tr>
<td align="left"><strong>grant option</strong></td>
<td align="left">æ•°æ®åº“ã€è¡¨ã€å­˜å‚¨è¿‡ç¨‹</td>
<td align="left">æˆæƒ</td>
</tr>
<tr>
<td align="left"><strong>references</strong></td>
<td align="left">æ•°æ®åº“ã€è¡¨</td>
<td align="left">å¤–é”®çº¦æŸçš„çˆ¶è¡¨</td>
</tr>
<tr>
<td align="left"><strong>index</strong></td>
<td align="left">è¡¨</td>
<td align="left">åˆ›å»º&#x2F;åˆ é™¤ç´¢å¼•</td>
</tr>
<tr>
<td align="left"><strong>alter</strong></td>
<td align="left">è¡¨</td>
<td align="left">ä¿®æ”¹è¡¨ç»“æ„</td>
</tr>
<tr>
<td align="left"><strong>show databases</strong></td>
<td align="left">æœåŠ¡å™¨</td>
<td align="left">æŸ¥çœ‹æ•°æ®åº“åç§°</td>
</tr>
<tr>
<td align="left"><strong>super</strong></td>
<td align="left">æœåŠ¡å™¨</td>
<td align="left">è¶…çº§æƒé™</td>
</tr>
<tr>
<td align="left"><strong>create temporary tables</strong></td>
<td align="left">è¡¨</td>
<td align="left">åˆ›å»ºä¸´æ—¶è¡¨</td>
</tr>
<tr>
<td align="left"><strong>lock tables</strong></td>
<td align="left">æ•°æ®åº“</td>
<td align="left">é”è¡¨</td>
</tr>
<tr>
<td align="left"><strong>execute</strong></td>
<td align="left">å­˜å‚¨è¿‡ç¨‹</td>
<td align="left">æ‰§è¡Œ</td>
</tr>
<tr>
<td align="left"><strong>replication client</strong></td>
<td align="left">æœåŠ¡å™¨</td>
<td align="left">å…è®¸æŸ¥çœ‹ä¸»&#x2F;ä»&#x2F;äºŒè¿›åˆ¶æ—¥å¿—çŠ¶æ€</td>
</tr>
<tr>
<td align="left"><strong>replication slave</strong></td>
<td align="left">æœåŠ¡å™¨</td>
<td align="left">ä¸»ä»å¤åˆ¶</td>
</tr>
<tr>
<td align="left"><strong>create view</strong></td>
<td align="left">è§†å›¾</td>
<td align="left">åˆ›å»ºè§†å›¾</td>
</tr>
<tr>
<td align="left"><strong>show view</strong></td>
<td align="left">è§†å›¾</td>
<td align="left">æŸ¥çœ‹è§†å›¾</td>
</tr>
<tr>
<td align="left"><strong>create routine</strong></td>
<td align="left">å­˜å‚¨è¿‡ç¨‹</td>
<td align="left">åˆ›å»ºå­˜å‚¨è¿‡ç¨‹</td>
</tr>
<tr>
<td align="left"><strong>alter routine</strong></td>
<td align="left">å­˜å‚¨è¿‡ç¨‹</td>
<td align="left">ä¿®æ”¹&#x2F;åˆ é™¤å­˜å‚¨è¿‡ç¨‹</td>
</tr>
<tr>
<td align="left"><strong>create user</strong></td>
<td align="left">æœåŠ¡å™¨</td>
<td align="left">åˆ›å»ºç”¨æˆ·</td>
</tr>
<tr>
<td align="left"><strong>event</strong></td>
<td align="left">æ•°æ®åº“</td>
<td align="left">åˆ›å»º&#x2F;æ›´æ”¹&#x2F;åˆ é™¤&#x2F;æŸ¥çœ‹äº‹ä»¶</td>
</tr>
<tr>
<td align="left"><strong>trigger</strong></td>
<td align="left">è¡¨</td>
<td align="left">è§¦å‘å™¨</td>
</tr>
<tr>
<td align="left"><strong>create tablespace</strong></td>
<td align="left">æœåŠ¡å™¨</td>
<td align="left">åˆ›å»º&#x2F;æ›´æ”¹&#x2F;åˆ é™¤è¡¨ç©ºé—´&#x2F;æ—¥å¿—æ–‡ä»¶</td>
</tr>
<tr>
<td align="left"><strong>proxy</strong></td>
<td align="left">æœåŠ¡å™¨</td>
<td align="left">ä»£ç†æˆä¸ºå…¶å®ƒç”¨æˆ·</td>
</tr>
<tr>
<td align="left"><strong>usage</strong></td>
<td align="left">æœåŠ¡å™¨</td>
<td align="left">æ²¡æœ‰æƒé™</td>
</tr>
</tbody></table>
<h4 id="MySQLæƒé™è¯´æ˜"><a href="#MySQLæƒé™è¯´æ˜" class="headerlink" title="MySQLæƒé™è¯´æ˜"></a>MySQLæƒé™è¯´æ˜</h4><h5 id="all-æœåŠ¡å™¨"><a href="#all-æœåŠ¡å™¨" class="headerlink" title="all,æœåŠ¡å™¨"></a>all,æœåŠ¡å™¨</h5><p>æˆäºˆæ‰€æœ‰æƒé™</p>
<h5 id="alter-è¡¨"><a href="#alter-è¡¨" class="headerlink" title="alter,è¡¨"></a>alter,è¡¨</h5><p>å¯ä»¥ä½¿ç”¨alter tableæ¥æ”¹å˜è¡¨çš„ç»“æ„ã€‚alter tableåŒæ—¶éœ€è¦createå’Œinsertæƒé™ï¼›é‡å‘½åè¡¨éœ€è¦æ—§è¡¨çš„alterå’Œdropæƒé™ï¼Œæ–°è¡¨çš„createå’Œinsertæƒé™</p>
<h5 id="alter-routine-å­˜å‚¨è¿‡ç¨‹"><a href="#alter-routine-å­˜å‚¨è¿‡ç¨‹" class="headerlink" title="alter routine,å­˜å‚¨è¿‡ç¨‹"></a>alter routine,å­˜å‚¨è¿‡ç¨‹</h5><p>æ›´æ”¹å’Œåˆ é™¤å­˜å‚¨è¿‡ç¨‹(è¿‡ç¨‹å’Œå‡½æ•°)</p>
<h5 id="create-æ•°æ®åº“-è¡¨-ç´¢å¼•"><a href="#create-æ•°æ®åº“-è¡¨-ç´¢å¼•" class="headerlink" title="create,æ•°æ®åº“&#x2F;è¡¨&#x2F;ç´¢å¼•"></a>create,æ•°æ®åº“&#x2F;è¡¨&#x2F;ç´¢å¼•</h5><p>å…è®¸åˆ›å»ºæ–°çš„æ•°æ®åº“å’Œè¡¨ä»¥åŠç´¢å¼•</p>
<h5 id="create-routine-å­˜å‚¨è¿‡ç¨‹"><a href="#create-routine-å­˜å‚¨è¿‡ç¨‹" class="headerlink" title="create routine,å­˜å‚¨è¿‡ç¨‹"></a>create routine,å­˜å‚¨è¿‡ç¨‹</h5><p>å…è®¸åˆ›å»ºå­˜å‚¨è¿‡ç¨‹(è¿‡ç¨‹å’Œå‡½æ•°)</p>
<h5 id="create-tablespace-æœåŠ¡å™¨"><a href="#create-tablespace-æœåŠ¡å™¨" class="headerlink" title="create tablespace,æœåŠ¡å™¨"></a>create tablespace,æœåŠ¡å™¨</h5><p>åˆ›å»ºã€æ›´æ”¹æˆ–åˆ é™¤è¡¨ç©ºé—´å’Œæ—¥å¿—æ–‡ä»¶ç»„</p>
<h5 id="create-temporary-tables-è¡¨"><a href="#create-temporary-tables-è¡¨" class="headerlink" title="create temporary tables,è¡¨"></a>create temporary tables,è¡¨</h5><p>ä½¿ç”¨create temporary tableåˆ›å»ºä¸´æ—¶è¡¨ã€‚ä¼šè¯åˆ›å»ºä¸´æ—¶è¡¨åï¼Œä¸å†å¯¹è¯¥è¡¨è¿›è¡Œæƒé™æ£€æŸ¥ï¼Œåˆ›å»ºä¼šè¯å¯ä»¥å¯¹è¯¥è¡¨æ‰§è¡Œä»»ä½•æ“ä½œ</p>
<h5 id="create-user-æœåŠ¡å™¨"><a href="#create-user-æœåŠ¡å™¨" class="headerlink" title="create user,æœåŠ¡å™¨"></a>create user,æœåŠ¡å™¨</h5><p>åˆ›å»ºç”¨æˆ·ï¼Œå…è®¸ä½¿ç”¨alter user&#x2F;create user&#x2F;drop user&#x2F;rename user&#x2F;revoke all privilegesè¯­å¥å¯¹ç”¨æˆ·æƒé™è¿›è¡Œæ“ä½œ</p>
<h5 id="create-view-è§†å›¾"><a href="#create-view-è§†å›¾" class="headerlink" title="create view,è§†å›¾"></a>create view,è§†å›¾</h5><p>åˆ›å»ºè§†å›¾ï¼Œå…è®¸ä½¿ç”¨create viewè¯­å¥</p>
<h5 id="delete-è¡¨"><a href="#delete-è¡¨" class="headerlink" title="delete,è¡¨"></a>delete,è¡¨</h5><p>å…è®¸åˆ é™¤è¡Œ</p>
<h5 id="drop-æ•°æ®åº“-è¡¨-è§†å›¾"><a href="#drop-æ•°æ®åº“-è¡¨-è§†å›¾" class="headerlink" title="drop,æ•°æ®åº“&#x2F;è¡¨&#x2F;è§†å›¾"></a>drop,æ•°æ®åº“&#x2F;è¡¨&#x2F;è§†å›¾</h5><p>åˆ é™¤ç°æœ‰æ•°æ®åº“ã€è¡¨å’Œè§†å›¾ã€‚åœ¨åˆ†åŒºè¡¨ä½¿ç”¨alter table â€¦ drop partitionè¯­å¥ï¼Œtruncate tableä¹Ÿéœ€è¦dropæƒé™ã€‚è‹¥å°†mysqlåº“çš„dropæƒé™æˆäºˆç”¨æˆ·ï¼Œåˆ™è¯¥ç”¨æˆ·å¯ä»¥åˆ é™¤æƒé™æ•°æ®åº“</p>
<h5 id="event-æ•°æ®åº“"><a href="#event-æ•°æ®åº“" class="headerlink" title="event,æ•°æ®åº“"></a>event,æ•°æ®åº“</h5><p>åˆ›å»ºã€æ›´æ”¹ã€åˆ é™¤æˆ–æŸ¥çœ‹äº‹ä»¶è°ƒåº¦ç¨‹åºçš„äº‹ä»¶</p>
<h5 id="execute-å­˜å‚¨è¿‡ç¨‹"><a href="#execute-å­˜å‚¨è¿‡ç¨‹" class="headerlink" title="execute,å­˜å‚¨è¿‡ç¨‹"></a>execute,å­˜å‚¨è¿‡ç¨‹</h5><p>æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹(è¿‡ç¨‹å’Œå‡½æ•°)</p>
<h5 id="file-æœåŠ¡å™¨"><a href="#file-æœåŠ¡å™¨" class="headerlink" title="file,æœåŠ¡å™¨"></a>file,æœåŠ¡å™¨</h5><p>å…è®¸ä½¿ç”¨load data infileå’Œselect â€¦ into outfileè¯­å¥ä»¥åŠload_file()å‡½æ•°ã€‚ä»5.7.17å¼€å§‹ï¼Œcreate tableè¯­å¥ä¸­çš„data directoryæˆ–è€…index directoryé€‰é¡¹ä¹Ÿéœ€è¦è¯¥æƒé™</p>
<h5 id="grant-option-æ•°æ®åº“-è¡¨-å­˜å‚¨è¿‡ç¨‹"><a href="#grant-option-æ•°æ®åº“-è¡¨-å­˜å‚¨è¿‡ç¨‹" class="headerlink" title="grant option,æ•°æ®åº“&#x2F;è¡¨&#x2F;å­˜å‚¨è¿‡ç¨‹"></a>grant option,æ•°æ®åº“&#x2F;è¡¨&#x2F;å­˜å‚¨è¿‡ç¨‹</h5><p>æˆäºˆå…¶å®ƒç”¨æˆ·æˆ–è€…ä»å…¶å®ƒç”¨æˆ·åˆ é™¤ä½ æ‰€æ‹¥æœ‰çš„æƒé™ã€‚ grant optionæƒé™ä½¿ç”¨æˆ·å¯ä»¥å°†å…¶æƒé™æˆäºˆå…¶ä»–ç”¨æˆ·ã€‚å…·æœ‰ä¸åŒç‰¹æƒå’Œgrant optionæƒé™çš„ä¸¤ä¸ªç”¨æˆ·å¯ä»¥ç»„åˆç‰¹æƒã€‚</p>
<h5 id="index-è¡¨"><a href="#index-è¡¨" class="headerlink" title="index,è¡¨"></a>index,è¡¨</h5><p>åˆ›å»ºæˆ–åˆ é™¤ç´¢å¼•ã€‚é€‚ç”¨äºç°æœ‰è¡¨ï¼Œå¦‚æœä½ å…·æœ‰createæƒé™ï¼Œåˆ™å¯ä»¥åœ¨åˆ›å»ºè¡¨è¯­å¥ä¸­åŒ…å«ç´¢å¼•å®šä¹‰</p>
<h5 id="insert-è¡¨-åˆ—"><a href="#insert-è¡¨-åˆ—" class="headerlink" title="insert,è¡¨&#x2F;åˆ—"></a>insert,è¡¨&#x2F;åˆ—</h5><p>æ’å…¥è¡Œã€‚analyze table&#x2F;optimize table&#x2F;repair tableè¡¨ç»´æŠ¤è¯­å¥ä¹Ÿéœ€è¦è¯¥æƒé™</p>
<h5 id="lock-tables-æ•°æ®åº“"><a href="#lock-tables-æ•°æ®åº“" class="headerlink" title="lock tables,æ•°æ®åº“"></a>lock tables,æ•°æ®åº“</h5><p>é”è¡¨ã€‚ä½¿ç”¨lock tablesè¯­å¥æ˜¾ç¤ºçš„é”å®šä½ æ‹¥æœ‰selectæƒé™çš„è¡¨ï¼ŒåŒ…æ‹¬å†™å…¥é”ï¼Œå¯ä»¥é˜²æ­¢å…¶å®ƒä»–è¯è¯»å–é”å®šçš„è¡¨</p>
<h5 id="process-æœåŠ¡å™¨"><a href="#process-æœåŠ¡å™¨" class="headerlink" title="process,æœåŠ¡å™¨"></a>process,æœåŠ¡å™¨</h5><p>æ˜¾ç¤ºçº¿ç¨‹ä¿¡æ¯ã€‚ä½¿ç”¨show processlist&#x2F;mysqladmin processlistæŸ¥çœ‹å…¶å®ƒç”¨æˆ·çš„çº¿ç¨‹ï¼Œè¿˜å¯ä»¥ä½¿ç”¨show engineè¯­å¥</p>
<h5 id="proxy-æœåŠ¡å™¨"><a href="#proxy-æœåŠ¡å™¨" class="headerlink" title="proxy,æœåŠ¡å™¨"></a>proxy,æœåŠ¡å™¨</h5><p>ä»£ç†æƒé™ã€‚å¯ä»¥ä»£ç†æˆä¸ºå¦ä¸€ä¸ªç”¨æˆ·</p>
<h5 id="references-æ•°æ®åº“-è¡¨"><a href="#references-æ•°æ®åº“-è¡¨" class="headerlink" title="references,æ•°æ®åº“&#x2F;è¡¨"></a>references,æ•°æ®åº“&#x2F;è¡¨</h5><p>åˆ›å»ºå¤–é”®çº¦æŸçš„çˆ¶è¡¨éœ€è¦è¯¥æƒé™</p>
<h5 id="reload-æœåŠ¡å™¨"><a href="#reload-æœåŠ¡å™¨" class="headerlink" title="reload,æœåŠ¡å™¨"></a>reload,æœåŠ¡å™¨</h5><p>å…è®¸ä½¿ç”¨flushè¯­å¥ã€‚åŒè¿›è¿˜å¯ç”¨ç­‰æ•ˆçš„mysqladminå‘½ä»¤ï¼šflush-hosts,flush-logs,flush-privileges,flush-status,flush-tables,flush-threads,refreshå’Œreload</p>
<h5 id="replication-client-æœåŠ¡å™¨"><a href="#replication-client-æœåŠ¡å™¨" class="headerlink" title="replication client,æœåŠ¡å™¨"></a>replication client,æœåŠ¡å™¨</h5><p>å…è®¸ä½¿ç”¨show master status&#x2F;show slave status&#x2F;show binary logsè¯­å¥</p>
<h5 id="replication-slave-æœåŠ¡å™¨"><a href="#replication-slave-æœåŠ¡å™¨" class="headerlink" title="replication slave,æœåŠ¡å™¨"></a>replication slave,æœåŠ¡å™¨</h5><p>å…è®¸ä»æœåŠ¡å™¨è¯·æ±‚å½“å‰ä¸»æœåŠ¡å™¨ä¸Šçš„æ›´æ–°</p>
<h5 id="select-è¡¨-åˆ—"><a href="#select-è¡¨-åˆ—" class="headerlink" title="select,è¡¨&#x2F;åˆ—"></a>select,è¡¨&#x2F;åˆ—</h5><p>é€‰æ‹©è¡Œã€‚å…¶ä»–è¯»å–åˆ—çš„è¯­å¥ä¹Ÿéœ€è¦è¯¥æƒé™ï¼Œå¦‚deleteæˆ–updateè¯­å¥ä¸­whereå­å¥æŒ‡å®šçš„åˆ—</p>
<h5 id="show-databases-æœåŠ¡å™¨"><a href="#show-databases-æœåŠ¡å™¨" class="headerlink" title="show databases,æœåŠ¡å™¨"></a>show databases,æœåŠ¡å™¨</h5><p>é€šè¿‡show databasesè¯­å¥æŸ¥çœ‹æ•°æ®åº“åç§°</p>
<h5 id="show-view-è§†å›¾"><a href="#show-view-è§†å›¾" class="headerlink" title="show view,è§†å›¾"></a>show view,è§†å›¾</h5><p>é€šè¿‡show create viewè¯­å¥æŸ¥çœ‹è§†å›¾ï¼Œä¸explainä¸€èµ·ä½¿ç”¨çš„è§†å›¾ä¹Ÿéœ€è¦æ­¤æƒé™</p>
<h5 id="shutdown-æœåŠ¡å™¨"><a href="#shutdown-æœåŠ¡å™¨" class="headerlink" title="shutdown,æœåŠ¡å™¨"></a>shutdown,æœåŠ¡å™¨</h5><p>ä½¿ç”¨shutdownè¯­å¥ï¼Œmysqladminå…³é—­ä»¥åŠmysql_shutdown()å‡½æ•°</p>
<h5 id="super-æœåŠ¡å™¨"><a href="#super-æœåŠ¡å™¨" class="headerlink" title="super,æœåŠ¡å™¨"></a>super,æœåŠ¡å™¨</h5><p>é€šè¿‡ä¿®æ”¹å…¨å±€ç³»ç»Ÿå˜é‡æ¥å¯ç”¨é…ç½®æ›´æ”¹ã€‚å¯¹æŸäº›ç³»ç»Ÿå˜é‡ï¼Œè®¾ç½®ä¼šè¯å€¼ä¹Ÿéœ€è¦è¯¥æƒé™ã€‚binlog_format,sql_log_bin,sql_log_off<br>å…¨å±€äº‹åŠ¡ç‰¹æ€§æ›´æ”¹<br>å¯åŠ¨å’Œåœæ­¢å¤åˆ¶ï¼ŒåŒ…æ‹¬ç»„å¤åˆ¶<br>å…è®¸ä½¿ç”¨change master toå’Œchange replication filterè¯­å¥<br>äºŒè¿›åˆ¶æ—¥å¿—æ§åˆ¶ï¼Œpurge binary logså’Œbinlogè¯­å¥<br>æ‰§è¡Œè§†å›¾æˆ–å­˜å‚¨ç¨‹åºæ—¶å¯ç”¨æˆæƒID<br>å…è®¸ä½¿ç”¨create server,alter serverå’Œdrop serverè¯­å¥<br>å…è®¸ä½¿ç”¨mysqladmin debugå‘½ä»¤<br>å¯ç”¨innodbå¯†é’¥è½®æ¢<br>ä½¿ç”¨des_encrypt()å‡½æ•°è¯»å–DESå¯†é’¥æ–‡ä»¶<br>ä½¿ç”¨ç‰ˆæœ¬ä»¤ç‰Œç”¨æˆ·å®šä¹‰å‡½æ•°<br>å¯¹ésuperå¸æˆ·å®¢æˆ·ç«¯è¿æ¥çš„æ§åˆ¶</p>
<blockquote>
<p>ä½¿ç”¨killè¯­å¥æˆ–è€…mysqladmin killå‘½ä»¤ç»ˆæ­¢å±äºå…¶ä»–ç”¨æˆ·çš„çº¿ç¨‹<br>å³ä½¿è¾¾åˆ°max_connectionsæ§åˆ¶çš„è¿æ¥é™åˆ¶ï¼ŒæœåŠ¡å™¨ä¹Ÿä¼šæˆå—æ¥è‡ªsuperå®¢æˆ·ç«¯çš„è¿æ¥<br>å³ä½¿ä½¿ç”¨äº†read_onlyç³»ç»Ÿå˜é‡ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œæ›´æ–°<br>superå®¢æˆ·ç«¯è¿æ¥æ—¶ï¼ŒæœåŠ¡å™¨ä¸æ‰§è¡Œinit_connectç³»ç»Ÿå˜é‡å†…å®¹<br>å¤„äºè„±æœºæ¨¡å¼offline_modeçš„æœåŠ¡å™¨ä¸ä¼šç»ˆæ­¢superå®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå¹¶æ¥å—æ¥è‡ªsuperå®¢æˆ·ç«¯çš„æ–°è¿æ¥<br>å¦‚æœå¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—è®°å½•ï¼Œå¯èƒ½è¿˜éœ€è¦superæƒé™åˆ›å»ºæˆ–æ›´æ”¹å­˜å‚¨è¿‡ç¨‹</p>
</blockquote>
<h5 id="trigger-æœåŠ¡å™¨"><a href="#trigger-æœåŠ¡å™¨" class="headerlink" title="trigger,æœåŠ¡å™¨"></a>trigger,æœåŠ¡å™¨</h5><p>è§¦å‘å™¨ã€‚åˆ›å»ºã€åˆ é™¤ã€æ‰§è¡Œã€æ˜¾ç¤ºè¯¥è¡¨çš„è§¦å‘å™¨</p>
<h5 id="update-è¡¨-åˆ—"><a href="#update-è¡¨-åˆ—" class="headerlink" title="update,è¡¨&#x2F;åˆ—"></a>update,è¡¨&#x2F;åˆ—</h5><p>æ›´æ–°è¡Œ</p>
<h5 id="usage-æœåŠ¡å™¨"><a href="#usage-æœåŠ¡å™¨" class="headerlink" title="usage,æœåŠ¡å™¨"></a>usage,æœåŠ¡å™¨</h5><p>æ²¡æœ‰ä»»ä½•æƒé™</p>
]]></content>
      <categories>
        <category>Database</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>gee-web</title>
    <url>/2023/09/16/gee-web/</url>
    <content><![CDATA[<h1 id="Gee"><a href="#Gee" class="headerlink" title="Gee"></a>Gee</h1><p><strong>The project is implement goweb frame,which is similar with gin that is a popular goweb frame</strong></p>
<p>Based on geektutuâ€™s project<br>it has the following <strong>advantages</strong> for me:<br>    -To solidify Go standard package as <code>net/http</code><br>    -To Learn Go more deeply<br>    -To know how gin frame work and learn the algorithm in it,for example I kown itâ€™s routes is based on a special tree<br>    -To learn CS English,as you can see,I write in English</p>
<p><a href="https://github.com/geektutu/7days-golang/tree/master">geektutu&#x2F;golang</a></p>
<p>to learn and implement this project,</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">gee/</span><br><span class="line">  |--gee.go</span><br><span class="line">  |--router.go</span><br><span class="line">  |--context.go</span><br><span class="line">  |--trie.go</span><br><span class="line">  |--go.mod</span><br><span class="line">main.go</span><br><span class="line">go.mod</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<h2 id="go-mod-outer"><a href="#go-mod-outer" class="headerlink" title="go mod (outer)"></a>go mod (outer)</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">//go mod</span></span><br><span class="line">module example</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="number">1.20</span></span><br><span class="line"></span><br><span class="line">require gee v0<span class="number">.0</span><span class="number">.0</span></span><br><span class="line"></span><br><span class="line">replace gee =&gt; ./gee</span><br></pre></td></tr></table></figure>


<h2 id="package-gee"><a href="#package-gee" class="headerlink" title="package gee"></a>package gee</h2><h3 id="go-mod-inner"><a href="#go-mod-inner" class="headerlink" title="go mod (inner)"></a>go mod (inner)</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">module gee</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="number">1.20</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="gee-go"><a href="#gee-go" class="headerlink" title="gee.go"></a>gee.go</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> gee</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;html/template&quot;</span></span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;path&quot;</span></span><br><span class="line">	<span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Group control is one of based function for web frame</span></span><br><span class="line"><span class="comment">most of the time,implementing it by the same prefix and supposing nested group</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// pattern</span></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	GET  = <span class="string">&quot;GET&quot;</span></span><br><span class="line">	POST = <span class="string">&quot;POST&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// RouterGroup contains a pointer point Engine,all frame sources unified coordination by Engine,</span></span><br><span class="line"><span class="comment">// then we can visit various interface by Engine</span></span><br><span class="line"><span class="keyword">type</span> RouterGroup <span class="keyword">struct</span> &#123;</span><br><span class="line">	prefix      <span class="type">string</span></span><br><span class="line">	middlewares []HandlerFunc</span><br><span class="line">	parent      *RouterGroup</span><br><span class="line">	engine      *Engine</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Engine implement the interface of ServeHTTP</span></span><br><span class="line"><span class="keyword">type</span> Engine <span class="keyword">struct</span> &#123;</span><br><span class="line">	*RouterGroup</span><br><span class="line">	router        *router</span><br><span class="line">	groups        []*RouterGroup     <span class="comment">// store all groups</span></span><br><span class="line">	htmlTemplates *template.Template <span class="comment">// for html render</span></span><br><span class="line">	funcMap       template.FuncMap   <span class="comment">// for html render</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// HandlerFunc defines the request handler used by gee</span></span><br><span class="line"><span class="keyword">type</span> HandlerFunc <span class="function"><span class="keyword">func</span><span class="params">(*Context)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// New is the constructor of gee.Engine</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">aNew</span><span class="params">()</span></span> *Engine &#123;</span><br><span class="line">	engine := &amp;Engine&#123;router: newRouter()&#125;</span><br><span class="line">	engine.RouterGroup = &amp;RouterGroup&#123;</span><br><span class="line">		engine: engine,</span><br><span class="line">	&#125;</span><br><span class="line">	engine.groups = []*RouterGroup&#123;engine.RouterGroup&#125;</span><br><span class="line">	<span class="keyword">return</span> engine</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Group creates a new RouterGroup , groups share the same engine</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(group *RouterGroup)</span></span> Group(prefix <span class="type">string</span>) *RouterGroup &#123;</span><br><span class="line">	engine := group.engine</span><br><span class="line">	newGroup := &amp;RouterGroup&#123;</span><br><span class="line">		prefix: group.prefix + prefix,</span><br><span class="line">		parent: group,</span><br><span class="line">		engine: engine,</span><br><span class="line">	&#125;</span><br><span class="line">	engine.groups = <span class="built_in">append</span>(engine.groups, newGroup)</span><br><span class="line">	<span class="keyword">return</span> newGroup</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// addRoute add new group</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(group *RouterGroup)</span></span> addRoute(method <span class="type">string</span>, comp <span class="type">string</span>, handler HandlerFunc) &#123;</span><br><span class="line">	pattern := group.prefix + comp</span><br><span class="line">	log.Printf(<span class="string">&quot;Route %4s - %s&quot;</span>, method, pattern)</span><br><span class="line">	group.engine.router.addRoute(method, pattern, handler)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GET defines the method to add GET request</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(group *RouterGroup)</span></span> GET(pattern <span class="type">string</span>, handler HandlerFunc) &#123;</span><br><span class="line">	group.addRoute(GET, pattern, handler)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// POST defines the method to add POST request</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(group *RouterGroup)</span></span> POST(pattern <span class="type">string</span>, handler HandlerFunc) &#123;</span><br><span class="line">	group.addRoute(POST, pattern, handler)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Static serve static files</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(group *RouterGroup)</span></span> Static(relativePath <span class="type">string</span>, root <span class="type">string</span>) &#123;</span><br><span class="line">	handler := group.createStaticHandler(relativePath, http.Dir(root))</span><br><span class="line">	urlPattern := path.Join(relativePath, <span class="string">&quot;/*filepath&quot;</span>)</span><br><span class="line">	<span class="comment">// Register GET handlers</span></span><br><span class="line">	group.GET(urlPattern, handler)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Use is defined to add middleware to the group</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(group *RouterGroup)</span></span> Use(middlewares ...HandlerFunc) &#123;</span><br><span class="line">	group.middlewares = <span class="built_in">append</span>(group.middlewares, middlewares...)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// createStaticHandler create static handler</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(group *RouterGroup)</span></span> createStaticHandler(relativePath <span class="type">string</span>, fs http.FileSystem) HandlerFunc &#123;</span><br><span class="line">	absolutePath := path.Join(group.prefix, relativePath)</span><br><span class="line">	fileServer := http.StripPrefix(absolutePath, http.FileServer(fs))</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *Context)</span></span> &#123;</span><br><span class="line">		file := c.Param(<span class="string">&quot;filepath&quot;</span>)</span><br><span class="line">		<span class="comment">// Check if file exists and/or if we have permission to access it</span></span><br><span class="line">		<span class="keyword">if</span> _, err := fs.Open(file); err != <span class="literal">nil</span> &#123;</span><br><span class="line">			c.Status(http.StatusNotFound)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		fileServer.ServeHTTP(c.Writer, c.Req)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(engine *Engine)</span></span> SetFuncMap(funcMap template.FuncMap) &#123;</span><br><span class="line">	engine.funcMap = funcMap</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(engine *Engine)</span></span> LoadHTMLGlob(pattern <span class="type">string</span>) &#123;</span><br><span class="line">	engine.htmlTemplates = template.Must(template.New(<span class="string">&quot;&quot;</span>).Funcs(engine.funcMap).ParseGlob(pattern))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Run defines the method to start a http server</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(engine *Engine)</span></span> Run(addr <span class="type">string</span>) (err <span class="type">error</span>) &#123;</span><br><span class="line">	<span class="keyword">return</span> http.ListenAndServe(addr, engine)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ServeHTTP Type of Handler always contains ServeHTTP method interface</span></span><br><span class="line"><span class="comment">// in code ServerHttp is defined on Engine struct to handle HTTP request</span></span><br><span class="line"><span class="comment">// When a http request arrives at the web server ,Go&#x27;s http package will use ServeHTTP method and pass some related params</span></span><br><span class="line"><span class="comment">// In method ,decide how to handle the request based on the method of the request (GET, POST, etc.) and the path of the request (URL routing)</span></span><br><span class="line"><span class="comment">// code can look up the route map, find the corresponding handler,</span></span><br><span class="line"><span class="comment">// and pass requests and responses to this handler to complete the logic.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(engine *Engine)</span></span> ServeHTTP(w http.ResponseWriter, req *http.Request) &#123;</span><br><span class="line">	<span class="keyword">var</span> middlewares []HandlerFunc</span><br><span class="line">	<span class="keyword">for</span> _, group := <span class="keyword">range</span> engine.groups &#123;</span><br><span class="line">		<span class="keyword">if</span> strings.HasPrefix(req.URL.Path, group.prefix) &#123;</span><br><span class="line">			middlewares = <span class="built_in">append</span>(middlewares, group.middlewares...)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	c := newContext(w, req)</span><br><span class="line">	c.handlers = middlewares</span><br><span class="line">	c.engine = engine</span><br><span class="line">	engine.router.handle(c)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="router-go"><a href="#router-go" class="headerlink" title="router.go"></a>router.go</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> gee</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//router is a container</span></span><br><span class="line"><span class="comment">//route is composed a URLPath and a func/method</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// router routerType</span></span><br><span class="line"><span class="comment">// roots key eg, roots[&#x27;GET&#x27;] roots[&#x27;POST&#x27;]</span></span><br><span class="line"><span class="comment">// handlers key eg, handlers[&#x27;GET-/p/:lang/doc&#x27;], handlers[&#x27;POST-/p/book&#x27;]</span></span><br><span class="line"><span class="keyword">type</span> router <span class="keyword">struct</span> &#123;</span><br><span class="line">	roots    <span class="keyword">map</span>[<span class="type">string</span>]*node</span><br><span class="line">	handlers <span class="keyword">map</span>[<span class="type">string</span>]HandlerFunc</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// newRouter init a new router</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newRouter</span><span class="params">()</span></span> *router &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;router&#123;</span><br><span class="line">		roots:    <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]*node),</span><br><span class="line">		handlers: <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]HandlerFunc),</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// parsePattern only one &#x27;*&#x27; is allowed</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">parsePattern</span><span class="params">(pattern <span class="type">string</span>)</span></span> []<span class="type">string</span> &#123;</span><br><span class="line">	vs := strings.Split(pattern, <span class="string">&quot;/&quot;</span>)</span><br><span class="line">	parts := <span class="built_in">make</span>([]<span class="type">string</span>, <span class="number">0</span>)</span><br><span class="line">	<span class="keyword">for</span> _, item := <span class="keyword">range</span> vs &#123;</span><br><span class="line">		<span class="keyword">if</span> item != <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">			parts = <span class="built_in">append</span>(parts, item)</span><br><span class="line">			<span class="keyword">if</span> item[<span class="number">0</span>] == <span class="string">&#x27;*&#x27;</span> &#123;</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> parts</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// addRoute add a new route</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *router)</span></span> addRoute(method <span class="type">string</span>, pattern <span class="type">string</span>, handler HandlerFunc) &#123;</span><br><span class="line">	<span class="comment">//parse the path pattern of the routing rule into a string slice</span></span><br><span class="line">	<span class="comment">//through `parsePattern` func</span></span><br><span class="line">	<span class="comment">//This slice contains the parts of the path pattern</span></span><br><span class="line">	parts := parsePattern(pattern)</span><br><span class="line">	<span class="comment">//Generate a unique key that connect HTTP request method and routing rule path together</span></span><br><span class="line">	<span class="comment">//to associate the handler func with the routing rule.</span></span><br><span class="line">	key := method + <span class="string">&quot;-&quot;</span> + pattern</span><br><span class="line">	<span class="comment">// if not existed,create a new node</span></span><br><span class="line">	_, ok := r.roots[method]</span><br><span class="line">	<span class="keyword">if</span> !ok &#123;</span><br><span class="line">		r.roots[method] = &amp;node&#123;&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//Call the Trie tree&#x27;s insert method to insert the routing rule&#x27;s path pattern into the Trie tree.</span></span><br><span class="line">	<span class="comment">//This builds the path structure of the Trie tree so that next routes match.</span></span><br><span class="line">	r.roots[method].insert(pattern, parts, <span class="number">0</span>)</span><br><span class="line">	<span class="comment">//Associates the handler with a unique key</span></span><br><span class="line">	<span class="comment">//that can be used to find the corresponding handler in next route matches.</span></span><br><span class="line">	r.handlers[key] = handler</span><br><span class="line">	log.Printf(<span class="string">&quot;Route %4s - %s&quot;</span>, method, pattern)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// getRoute getRoute</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *router)</span></span> getRoute(method, path <span class="type">string</span>) (*node, <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>) &#123;</span><br><span class="line">	searchParts := parsePattern(path)</span><br><span class="line">	<span class="comment">//create an empty map,to reflect params in path</span></span><br><span class="line">	params := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>)</span><br><span class="line">	<span class="comment">//get the Trie tree root node associated with a given HTTP request method,</span></span><br><span class="line">	<span class="comment">//and if no associated root node exists root , returns nil indicates that no routing rule was matched.</span></span><br><span class="line">	root, ok := r.roots[method]</span><br><span class="line">	<span class="keyword">if</span> !ok &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//Call the method of the Trie tree to find matching nodes in the Trie tree</span></span><br><span class="line">	<span class="comment">//based on the search path pattern n</span></span><br><span class="line">	n := root.search(searchParts, <span class="number">0</span>)</span><br><span class="line">	<span class="keyword">if</span> n != <span class="literal">nil</span> &#123;</span><br><span class="line">		parts := parsePattern(n.pattern)</span><br><span class="line">		<span class="keyword">for</span> index, part := <span class="keyword">range</span> parts &#123;</span><br><span class="line">			<span class="keyword">if</span> part[<span class="number">0</span>] == <span class="string">&#x27;:&#x27;</span> &#123;</span><br><span class="line">				<span class="comment">//store the part and delete &#x27;:&#x27;</span></span><br><span class="line">				params[part[<span class="number">1</span>:]] = searchParts[index]</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> part[<span class="number">0</span>] == <span class="string">&#x27;*&#x27;</span> &amp;&amp; <span class="built_in">len</span>(part) &gt; <span class="number">1</span> &#123;</span><br><span class="line">				params[part[<span class="number">1</span>:]] = strings.Join(searchParts[index:], <span class="string">&quot;/&quot;</span>)</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> n, params</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span>, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *router)</span></span> handle(c *Context) &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//key := req.Method + &quot;-&quot; + req.URL.Path</span></span><br><span class="line">	<span class="comment">//creates a key variable,</span></span><br><span class="line">	<span class="comment">//which is a string type connected from HTTP request ,method:req.Method and path:req.URL.Path</span></span><br><span class="line">	<span class="comment">//This key will be used to look up the route map to determine which handler should be used to handle the request.</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//Using the router&#x27;s method,</span></span><br><span class="line">	<span class="comment">//find the routing rule node that matches the request and the get parameters</span></span><br><span class="line">	<span class="comment">//based on the HTTP request&#x27;s getRoute method (c.Method) and path (c.Path)</span></span><br><span class="line">	n, params := r.getRoute(c.Method, c.Path)</span><br><span class="line">	<span class="keyword">if</span> n != <span class="literal">nil</span> &#123;</span><br><span class="line">		c.Params = params</span><br><span class="line">		key := c.Method + <span class="string">&quot;-&quot;</span> + n.pattern</span><br><span class="line">		<span class="comment">//(c):This is the syntax of the function call,</span></span><br><span class="line">		<span class="comment">//which means calling r.handlers[key] the obtained function and passing the context c as an argument to the function</span></span><br><span class="line">		c.handlers = <span class="built_in">append</span>(c.handlers, r.handlers[key])</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		c.handlers = <span class="built_in">append</span>(c.handlers, <span class="function"><span class="keyword">func</span><span class="params">(c *Context)</span></span> &#123;</span><br><span class="line">			c.String(http.StatusNotFound, <span class="string">&quot;404 NOT FOUND: %s\n&quot;</span>, c.Path)</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">	c.Next()</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="router-test-go"><a href="#router-test-go" class="headerlink" title="router_test.go"></a>router_test.go</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> gee</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;reflect&quot;</span></span><br><span class="line">	<span class="string">&quot;testing&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newTestRouter</span><span class="params">()</span></span> *router &#123;</span><br><span class="line">	r := newRouter()</span><br><span class="line">	r.addRoute(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;/&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">	r.addRoute(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;/hello/:name&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">	r.addRoute(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;/hello/b/c&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">	r.addRoute(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;/hi/:name&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">	r.addRoute(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;/assets/*filepath&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">	<span class="keyword">return</span> r</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestParsePattern</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">	ok := reflect.DeepEqual(parsePattern(<span class="string">&quot;/p/:name&quot;</span>), []<span class="type">string</span>&#123;<span class="string">&quot;p&quot;</span>, <span class="string">&quot;:name&quot;</span>&#125;)</span><br><span class="line">	ok = ok &amp;&amp; reflect.DeepEqual(parsePattern(<span class="string">&quot;/p/*&quot;</span>), []<span class="type">string</span>&#123;<span class="string">&quot;p&quot;</span>, <span class="string">&quot;*&quot;</span>&#125;)</span><br><span class="line">	ok = ok &amp;&amp; reflect.DeepEqual(parsePattern(<span class="string">&quot;/p/*name/*&quot;</span>), []<span class="type">string</span>&#123;<span class="string">&quot;p&quot;</span>, <span class="string">&quot;*name&quot;</span>&#125;)</span><br><span class="line">	<span class="keyword">if</span> !ok &#123;</span><br><span class="line">		t.Fatal(<span class="string">&quot;test parsePattern failed&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestGetRoute</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">	r := newTestRouter()</span><br><span class="line">	n, ps := r.getRoute(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;/hello/geektutu&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> n == <span class="literal">nil</span> &#123;</span><br><span class="line">		t.Fatal(<span class="string">&quot;nil shouldn&#x27;t be returned&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> n.pattern != <span class="string">&quot;/hello/:name&quot;</span> &#123;</span><br><span class="line">		t.Fatal(<span class="string">&quot;should match /hello/:name&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ps[<span class="string">&quot;name&quot;</span>] != <span class="string">&quot;geektutu&quot;</span> &#123;</span><br><span class="line">		t.Fatal(<span class="string">&quot;name should be equal to &#x27;geektutu&#x27;&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">&quot;matched path: %s, params[&#x27;name&#x27;]: %s\n&quot;</span>, n.pattern, ps[<span class="string">&quot;name&quot;</span>])</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="context-go"><a href="#context-go" class="headerlink" title="context.go"></a>context.go</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> gee</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;encoding/json&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// for web server delay *http.Request build http.ResponseWriter,</span></span><br><span class="line"><span class="comment">// to implement a complete response needing Header and Body</span></span><br><span class="line"><span class="comment">// Header holds StatusCode ContentType data,therefore,encapsulate these codes is necessary</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// H is similar with gin.H,a map type</span></span><br><span class="line"><span class="keyword">type</span> H <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Context holds much web information</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Context <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// origin objects</span></span><br><span class="line">	Writer http.ResponseWriter</span><br><span class="line">	Req    *http.Request</span><br><span class="line">	<span class="comment">// request info</span></span><br><span class="line">	Path   <span class="type">string</span></span><br><span class="line">	Method <span class="type">string</span></span><br><span class="line">	Params <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span></span><br><span class="line">	<span class="comment">// response info</span></span><br><span class="line">	StatusCode <span class="type">int</span></span><br><span class="line">	<span class="comment">// middleware</span></span><br><span class="line">	handlers []HandlerFunc</span><br><span class="line">	index    <span class="type">int</span></span><br><span class="line">	<span class="comment">// engine pointer</span></span><br><span class="line">	engine *Engine</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Context)</span></span> Param(key <span class="type">string</span>) <span class="type">string</span> &#123;</span><br><span class="line">	value, _ := c.Params[key]</span><br><span class="line">	<span class="keyword">return</span> value</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// newContext is to init Context type</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newContext</span><span class="params">(w http.ResponseWriter, req *http.Request)</span></span> *Context &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;Context&#123;</span><br><span class="line">		Writer: w,</span><br><span class="line">		Req:    req,</span><br><span class="line">		Path:   req.URL.Path,</span><br><span class="line">		Method: req.Method,</span><br><span class="line">		index:  <span class="number">-1</span>,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Context)</span></span> Next() &#123;</span><br><span class="line">	c.index++</span><br><span class="line">	s := <span class="built_in">len</span>(c.handlers)</span><br><span class="line">	<span class="keyword">for</span> ; c.index &lt; s; c.index++ &#123;</span><br><span class="line">		c.handlers[c.index](c)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// PostForm can get form params from front_end</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Context)</span></span> PostForm(key <span class="type">string</span>) <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> c.Req.FormValue(key)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Query can get params form users&#x27; search params</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Context)</span></span> Query(key <span class="type">string</span>) <span class="type">string</span> &#123;</span><br><span class="line">	<span class="comment">//codes get Req from c,which holds HTTP request info</span></span><br><span class="line">	<span class="comment">//then get request&#x27;s URL to query,</span></span><br><span class="line">	<span class="comment">//query key-value pairs from URL,which is always appear after url &#x27;?&#x27;</span></span><br><span class="line">	<span class="comment">//Get method get the specific key,return its value,</span></span><br><span class="line">	<span class="comment">//if there is no specific key,return empty string</span></span><br><span class="line">	<span class="keyword">return</span> c.Req.URL.Query().Get(key)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Status reflect web server status</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Context)</span></span> Status(code <span class="type">int</span>) &#123;</span><br><span class="line">	c.StatusCode = code</span><br><span class="line">	c.Writer.WriteHeader(code)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SetHeader implement method to set HTTP request header</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Context)</span></span> SetHeader(key <span class="type">string</span>, value <span class="type">string</span>) &#123;</span><br><span class="line">	c.Writer.Header().Set(key, value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// String return string data to client</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Context)</span></span> String(code <span class="type">int</span>, format <span class="type">string</span>, values ...<span class="keyword">interface</span>&#123;&#125;) &#123;</span><br><span class="line">	c.SetHeader(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json&quot;</span>)</span><br><span class="line">	c.Status(code)</span><br><span class="line">	<span class="comment">//writes the byte array to c.Writer ,</span></span><br><span class="line">	<span class="comment">//which is the write stream of the HTTP response.</span></span><br><span class="line">	<span class="comment">//This causes the formatted text to be sent to the client as the body of the HTTP response.</span></span><br><span class="line">	_, _ = c.Writer.Write([]<span class="type">byte</span>(fmt.Sprintf(format, values...)))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// JSON return json data to client</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Context)</span></span> JSON(code <span class="type">int</span>, obj <span class="keyword">interface</span>&#123;&#125;) &#123;</span><br><span class="line">	c.SetHeader(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json&quot;</span>)</span><br><span class="line">	c.Status(code)</span><br><span class="line">	<span class="comment">//Creates a new JSON encoder (json.Encoder) and c.Writer associates it with ,</span></span><br><span class="line">	<span class="comment">//which means that the encoded JSON data will be written to the write stream of the HTTP response.</span></span><br><span class="line">	encoder := json.NewEncoder(c.Writer)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//encode the Go dataStructure into JSON format using the JSON encoder created</span></span><br><span class="line">	<span class="comment">//and writes the result into c.Writer</span></span><br><span class="line">	<span class="comment">//This is done by serializing the data into a JSON string and writing it to the response body.</span></span><br><span class="line">	<span class="keyword">if</span> err := encoder.Encode(obj); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		http.Error(c.Writer, err.Error(), <span class="number">500</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Data return data info to client</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Context)</span></span> Data(code <span class="type">int</span>, data []<span class="type">byte</span>) &#123;</span><br><span class="line">	c.Status(code)</span><br><span class="line">	_, _ = c.Writer.Write(data)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Fail return false</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Context)</span></span> Fail(code <span class="type">int</span>, err <span class="type">string</span>) &#123;</span><br><span class="line">	c.index = <span class="built_in">len</span>(c.handlers)</span><br><span class="line">	c.JSON(code, H&#123;<span class="string">&quot;message&quot;</span>: err&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// HTML return html template page to client</span></span><br><span class="line"><span class="comment">// HTML template render</span></span><br><span class="line"><span class="comment">// refer https://golang.org/pkg/html/template/</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Context)</span></span> HTML(code <span class="type">int</span>, name <span class="type">string</span>, data <span class="keyword">interface</span>&#123;&#125;) &#123;</span><br><span class="line">	c.SetHeader(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;text/html&quot;</span>)</span><br><span class="line">	c.Status(code)</span><br><span class="line">	<span class="keyword">if</span> err := c.engine.htmlTemplates.ExecuteTemplate(c.Writer, name, data); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		c.Fail(<span class="number">500</span>, err.Error())</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="trie-go"><a href="#trie-go" class="headerlink" title="trie.go"></a>trie.go</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> gee</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;strings&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// gin/gee routes are stored on a trie tree</span></span><br><span class="line"><span class="comment">// not map or other structs</span></span><br><span class="line"><span class="comment">// The following features are required to implement dynamic routes</span></span><br><span class="line"><span class="comment">// Params match as &#x27;:&#x27;</span></span><br><span class="line"><span class="comment">// Wildcard match as &#x27;*&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// node holds info about routes</span></span><br><span class="line"><span class="keyword">type</span> node <span class="keyword">struct</span> &#123;</span><br><span class="line">	pattern  <span class="type">string</span>  <span class="comment">//The route to match (/p/:lang)</span></span><br><span class="line">	part     <span class="type">string</span>  <span class="comment">//a part of route (:lang)</span></span><br><span class="line">	children []*node <span class="comment">//child nodes</span></span><br><span class="line">	isWild   <span class="type">bool</span>    <span class="comment">//Whether it matches exactly, part holds &#x27;:&#x27;,&#x27;*&#x27; isWild is true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Unlike normal trees, the isWild parameter is added to achieve dynamic route matching.</span></span><br><span class="line"><span class="comment">//That is, when we match the `/p/go/doc/` route, the first node, `p` exactly matches to `p`,</span></span><br><span class="line"><span class="comment">//and the second node, `go` fuzzy matches to `:lang`,</span></span><br><span class="line"><span class="comment">//then the `lang` parameter will be assigned to `go`</span></span><br><span class="line"><span class="comment">//to continue the next matching.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// matchChild The first node that matches successfully and is used for insertion</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *node)</span></span> matchChild(part <span class="type">string</span>) *node &#123;</span><br><span class="line">	<span class="keyword">for</span> _, child := <span class="keyword">range</span> n.children &#123;</span><br><span class="line">		<span class="comment">// match or &#x27;:&#x27;&#x27;*&#x27; appear</span></span><br><span class="line">		<span class="keyword">if</span> child.part == part || child.isWild &#123;</span><br><span class="line">			<span class="keyword">return</span> child</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// matchChildren All successfully match nodes,are used to look up</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *node)</span></span> matchChildren(part <span class="type">string</span>) []*node &#123;</span><br><span class="line">	nodes := <span class="built_in">make</span>([]*node, <span class="number">0</span>)</span><br><span class="line">	<span class="keyword">for</span> _, child := <span class="keyword">range</span> n.children &#123;</span><br><span class="line">		<span class="keyword">if</span> child.part == part || child.isWild &#123;</span><br><span class="line">			nodes = <span class="built_in">append</span>(nodes, child)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> nodes</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// For routes,register and match are important</span></span><br><span class="line"><span class="comment">// Developing services, register routing rules and map handlers;</span></span><br><span class="line"><span class="comment">// Accessing, match the routing rule and find the corresponding handler</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// insert is necessary for Tire tree</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *node)</span></span> insert(pattern <span class="type">string</span>, parts []<span class="type">string</span>, height <span class="type">int</span>) &#123;</span><br><span class="line">	<span class="comment">//recursive stop condition.</span></span><br><span class="line">	<span class="comment">//When recursive to the last part means all the elements in the parts slice have been processed,</span></span><br><span class="line">	<span class="comment">//`pattern` assign to the `n.pattern` form current node</span></span><br><span class="line">	<span class="comment">//to indicate that the pattern is stored under that path.</span></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(parts) == height &#123;</span><br><span class="line">		n.pattern = pattern</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//gets the currently processed portion from parts the slice,</span></span><br><span class="line">	<span class="comment">//that is, the portion of the current recursive depth.</span></span><br><span class="line">	part := parts[height]</span><br><span class="line">	child := n.matchChild(part)</span><br><span class="line">	<span class="comment">//If no child node part is found that matches the current section,</span></span><br><span class="line">	<span class="comment">//a new child node needs to be created.</span></span><br><span class="line">	<span class="keyword">if</span> child == <span class="literal">nil</span> &#123;</span><br><span class="line">		child = &amp;node&#123;</span><br><span class="line">			part:   part,</span><br><span class="line">			isWild: part[<span class="number">0</span>] == <span class="string">&#x27;:&#x27;</span> || part[<span class="number">0</span>] == <span class="string">&#x27;*&#x27;</span>,</span><br><span class="line">		&#125;</span><br><span class="line">		n.children = <span class="built_in">append</span>(n.children, child)</span><br><span class="line">	&#125;</span><br><span class="line">	child.insert(pattern, parts, height+<span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// search /p/:lang/doc is only set to /p/:lang/doc only on the third level node, the doc node.</span></span><br><span class="line"><span class="comment">// The pattern p and :lang nodes are empty.</span></span><br><span class="line"><span class="comment">// Therefore, when the match ends, we can use n.pattern == &quot;&quot; to determine whether the routing rule is successfully matched.</span></span><br><span class="line"><span class="comment">// For example, /p/python can successfully match :lang, but the pattern value of :lang is empty, so the match fails.</span></span><br><span class="line"><span class="comment">// The query function is also a recursive query of nodes at each layer,</span></span><br><span class="line"><span class="comment">// and the exit rule is, match to `*`, match failed, or match to the `len(parts)` node</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *node)</span></span> search(parts []<span class="type">string</span>, height <span class="type">int</span>) *node &#123;</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(parts) == height || strings.HasPrefix(n.part, <span class="string">&quot;*&quot;</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> n.pattern == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> n</span><br><span class="line">	&#125;</span><br><span class="line">	part := parts[height]</span><br><span class="line">	children := n.matchChildren(part)</span><br><span class="line">	<span class="keyword">for</span> _, child := <span class="keyword">range</span> children &#123;</span><br><span class="line">		ret := child.search(parts, height+<span class="number">1</span>)</span><br><span class="line">		<span class="keyword">if</span> ret != <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> ret</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="logger-go-middleware"><a href="#logger-go-middleware" class="headerlink" title="logger.go(middleware)"></a>logger.go(middleware)</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> gee</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Logger</span><span class="params">()</span></span> HandlerFunc &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">// Start timer</span></span><br><span class="line">		t := time.Now()</span><br><span class="line">		<span class="comment">// Process request</span></span><br><span class="line">		c.Next()</span><br><span class="line">		<span class="comment">// Calculate resolution time</span></span><br><span class="line">		log.Printf(<span class="string">&quot;[%d] %s in %v&quot;</span>, c.StatusCode, c.Req.RequestURI, time.Since(t))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Golang</category>
      </categories>
      <tags>
        <tag>Golang</tag>
      </tags>
  </entry>
  <entry>
    <title>geeORM</title>
    <url>/2023/09/19/geeORM/</url>
    <content><![CDATA[<h1 id="GeeORM"><a href="#GeeORM" class="headerlink" title="GeeORM"></a>GeeORM</h1><p><strong>The project is implement orm frame,which is similar with gorm&#x2F;xorm that is a popular orm frame</strong></p>
<p>Object Relational Mapping ,the data describe object and sql relationship</p>
<p>In OOP language<br><code>table</code> reflect to <code>struct</code><br><code>record/row</code> reflect to <code>object</code><br><code>field col</code> reflect to <code>attritube</code></p>
<span id="more"></span>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">geeorm</span><br><span class="line">    |--log/          </span><br><span class="line">        |--log.go #log</span><br><span class="line">    |--session/    #database interaction</span><br><span class="line">        |--raw.go</span><br><span class="line">    |--geeorm.go   #user interaction</span><br><span class="line">    |--go.mod </span><br></pre></td></tr></table></figure>

<h1 id="log"><a href="#log" class="headerlink" title="log"></a>log</h1><h2 id="log-go"><a href="#log-go" class="headerlink" title="log.go"></a>log.go</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> log</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;io&quot;</span></span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create 2 log instances to print Info and Error log</span></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	<span class="comment">// log.Lshortfile show fileName and lineNum</span></span><br><span class="line">	errorLog = log.New(os.Stdout, <span class="string">&quot;\033[31m[error]\033[0m&quot;</span>, log.LstdFlags|log.Lshortfile) <span class="comment">//red</span></span><br><span class="line">	infoLog  = log.New(os.Stdout, <span class="string">&quot;\033[34m[error]\033[0m&quot;</span>, log.LstdFlags|log.Lshortfile) <span class="comment">//blue</span></span><br><span class="line">	loggers  = []*log.Logger&#123;errorLog, infoLog&#125;</span><br><span class="line">	mu       sync.Mutex</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// log method Exposing Error, Errorf, Info, Infof 4 methods</span></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	Error  = errorLog.Println</span><br><span class="line">	Errorf = errorLog.Printf</span><br><span class="line">	Info   = infoLog.Println</span><br><span class="line">	Infof  = infoLog.Printf</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// log level</span></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	InfoLevel = <span class="literal">iota</span></span><br><span class="line">	ErrorLevel</span><br><span class="line">	Disabled</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// SetLevel set corresponding level</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SetLevel</span><span class="params">(level <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">	mu.Lock()</span><br><span class="line">	<span class="keyword">defer</span> mu.Unlock()</span><br><span class="line">	<span class="keyword">for</span> _, logger := <span class="keyword">range</span> loggers &#123;</span><br><span class="line">		logger.SetOutput(os.Stdout)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//Discard(ä¸¢å¼ƒ) is a Writer on which all Write calls succeed without doing anything</span></span><br><span class="line">	<span class="keyword">if</span> ErrorLevel &lt; level &#123;</span><br><span class="line">		errorLog.SetOutput(io.Discard)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> InfoLevel &lt; level &#123;</span><br><span class="line">		infoLog.SetOutput(io.Discard)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h1><h2 id="raw-go"><a href="#raw-go" class="headerlink" title="raw.go"></a>raw.go</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> session</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;database/sql&quot;</span></span><br><span class="line">	<span class="string">&quot;geeorm/log&quot;</span></span><br><span class="line">	<span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Session <span class="keyword">struct</span> &#123;</span><br><span class="line">	db      *sql.DB</span><br><span class="line">	sql     strings.Builder <span class="comment">//string builder for constructing SQL query statements</span></span><br><span class="line">	sqlVars []<span class="keyword">interface</span>&#123;&#125;   <span class="comment">//slice that stores param values in SQL query.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">New</span><span class="params">(db *sql.DB)</span></span> *Session &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;Session&#123;db: db&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *Session)</span></span> Clear() &#123;</span><br><span class="line">	s.sql.Reset()</span><br><span class="line">	s.sqlVars = <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *Session)</span></span> DB() *sql.DB &#123;</span><br><span class="line">	<span class="keyword">return</span> s.db</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Exec raw sql with sqlVars</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *Session)</span></span> Exec() (result sql.Result, err <span class="type">error</span>) &#123;</span><br><span class="line">	<span class="keyword">defer</span> s.Clear()</span><br><span class="line">	<span class="comment">//returns SQL query string that has been constructed in the session</span></span><br><span class="line">	log.Info(s.sql.String(), s.sqlVars)</span><br><span class="line">	<span class="keyword">if</span> result, err = s.DB().Exec(s.sql.String(), s.sqlVars...); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Error(err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// QueryRow get record form database</span></span><br><span class="line"><span class="comment">// Executes a SQL query and returns a row of records of the query result</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *Session)</span></span> QueryRow() *sql.Row &#123;</span><br><span class="line">	<span class="keyword">defer</span> s.Clear()</span><br><span class="line">	log.Info(s.sql.String(), s.sqlVars)</span><br><span class="line">	<span class="keyword">return</span> s.DB().QueryRow(s.sql.String(), s.sqlVars...)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// QueryRows gets a list of records from db</span></span><br><span class="line"><span class="comment">// Executes a SQL query and returns multiple rows of records of the query results ( *sql.Rows )</span></span><br><span class="line"><span class="comment">// possible errors.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *Session)</span></span> QueryRows() (rows *sql.Rows, err <span class="type">error</span>) &#123;</span><br><span class="line">	<span class="keyword">defer</span> s.Clear()</span><br><span class="line">	log.Info(s.sql.String(), s.sqlVars)</span><br><span class="line">	<span class="keyword">if</span> rows, err = s.DB().Query(s.sql.String(), s.sqlVars...); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Error(err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Raw  call this method, it appends sql parameters to Session the sql string builder in the struct,</span></span><br><span class="line"><span class="comment">// while adding a space at the end of the SQL statement</span></span><br><span class="line"><span class="comment">// to ensure that the different parts of the SQL statement are properly separated.</span></span><br><span class="line"><span class="comment">// Raw appends sql and sqlVars</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *Session)</span></span> Raw(sql <span class="type">string</span>, values ...<span class="keyword">interface</span>&#123;&#125;) *Session &#123;</span><br><span class="line">	s.sql.WriteString(sql)</span><br><span class="line">	s.sql.WriteString(<span class="string">&quot; &quot;</span>)</span><br><span class="line">	<span class="comment">// returns a pointer to the original Session structure,</span></span><br><span class="line">	<span class="comment">//allowing to continue chaining other methods</span></span><br><span class="line">	<span class="comment">//after the method call to build the complete SQL query.</span></span><br><span class="line">	s.sqlVars = <span class="built_in">append</span>(s.sqlVars, values...)</span><br><span class="line">	<span class="keyword">return</span> s</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="test"><a href="#test" class="headerlink" title="test"></a>test</h1><h2 id="main-go-1"><a href="#main-go-1" class="headerlink" title="main.go(1)"></a>main.go(1)</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;geeorm&quot;</span></span><br><span class="line">	_ <span class="string">&quot;github.com/mattn/go-sqlite3&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	engine, _ := geeorm.NewEngine(<span class="string">&quot;sqlite3&quot;</span>, <span class="string">&quot;gee.db&quot;</span>)</span><br><span class="line">	<span class="keyword">defer</span> engine.Close()</span><br><span class="line">	s := engine.NewSession()</span><br><span class="line">	_, _ = s.Raw(<span class="string">&quot;DROP TABLE IF EXISTS User;&quot;</span>).Exec()</span><br><span class="line">	_, _ = s.Raw(<span class="string">&quot;CREATE TABLE User(Name text);&quot;</span>).Exec()</span><br><span class="line">	_, _ = s.Raw(<span class="string">&quot;CREATE TABLE User(Name text);&quot;</span>).Exec()</span><br><span class="line">	result, _ := s.Raw(<span class="string">&quot;INSERT INTO User(`Name`) values (?), (?)&quot;</span>, <span class="string">&quot;hello1&quot;</span>, <span class="string">&quot;golang1&quot;</span>).Exec()</span><br><span class="line">	count, _ := result.RowsAffected()</span><br><span class="line">	fmt.Printf(<span class="string">&quot;Exec success, %d affected\n&quot;</span>, count)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">go run main.go</span> </span><br><span class="line">[error]2023/09/19 21:52:46 geeorm.go:25: coon db success</span><br><span class="line">[error]2023/09/19 21:52:46 raw.go:30: DROP TABLE IF EXISTS User;  []</span><br><span class="line">[error]2023/09/19 21:52:46 raw.go:30: CREATE TABLE User(Name text);  []</span><br><span class="line">[error]2023/09/19 21:52:46 raw.go:30: INSERT INTO User(`Name`) values (?), (?)  [hello1 golang1]</span><br><span class="line">Exec success, 2 affected</span><br><span class="line">[error]2023/09/19 21:52:46 geeorm.go:32: close db success</span><br></pre></td></tr></table></figure>

<h2 id="gee-db"><a href="#gee-db" class="headerlink" title="gee.db"></a>gee.db</h2><p>generate  automaticly</p>
<h1 id="geeorm-go"><a href="#geeorm-go" class="headerlink" title="geeorm.go"></a>geeorm.go</h1><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> geeorm</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;database/sql&quot;</span></span><br><span class="line">	<span class="string">&quot;geeorm/log&quot;</span></span><br><span class="line">	<span class="string">&quot;geeorm/session&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Engine <span class="keyword">struct</span> &#123;</span><br><span class="line">	db *sql.DB</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewEngine</span><span class="params">(driver, source <span class="type">string</span>)</span></span> (e *Engine, err <span class="type">error</span>) &#123;</span><br><span class="line">	db, err := sql.Open(driver, source)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Error(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//ping</span></span><br><span class="line">	<span class="keyword">if</span> err = db.Ping(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Error(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	e = &amp;Engine&#123;db: db&#125;</span><br><span class="line">	log.Info(<span class="string">&quot;coon db success&quot;</span>)</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(engine *Engine)</span></span> Close() &#123;</span><br><span class="line">	<span class="keyword">if</span> err := engine.db.Close(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Error(<span class="string">&quot;Failed to close db&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	log.Info(<span class="string">&quot;close db success&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(engine *Engine)</span></span> NewSession() *session.Session &#123;</span><br><span class="line">	<span class="keyword">return</span> session.New(engine.db)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Database</category>
      </categories>
      <tags>
        <tag>Golang</tag>
      </tags>
  </entry>
  <entry>
    <title>Go-Gin</title>
    <url>/2023/08/31/gin/</url>
    <content><![CDATA[<h1 id="Gin-æ¡†æ¶çš„ä½¿ç”¨"><a href="#Gin-æ¡†æ¶çš„ä½¿ç”¨" class="headerlink" title="Gin æ¡†æ¶çš„ä½¿ç”¨"></a>Gin æ¡†æ¶çš„ä½¿ç”¨</h1><p><strong>Gin</strong> æ˜¯ä¸€ä¸ªç”¨ <strong>Go (Golang)</strong> ç¼–å†™çš„ HTTP Web æ¡†æ¶ã€‚ å®ƒå…·æœ‰ç±»ä¼¼ Martini çš„ APIï¼Œä½†æ€§èƒ½æ¯” Martini å¿« 40 å€ã€‚å¦‚æœä½ éœ€è¦æå¥½çš„æ€§èƒ½</p>
<span id="more"></span>

<h2 id="RESTfulçº¦å®š"><a href="#RESTfulçº¦å®š" class="headerlink" title="RESTfulçº¦å®š"></a>RESTfulçº¦å®š</h2><ul>
<li><code>GET</code>ç”¨æ¥è·å–èµ„æº</li>
<li><code>POST</code>ç”¨æ¥æ–°å»ºèµ„æº</li>
<li><code>PUT</code>ç”¨æ¥æ›´æ–°èµ„æº</li>
<li><code>DELETE</code>ç”¨æ¥åˆ é™¤èµ„æºã€‚</li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	r.GET(<span class="string">&quot;/book&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;message&quot;</span>: <span class="string">&quot;Get&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.POST(<span class="string">&quot;/book&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;message&quot;</span>: <span class="string">&quot;Post&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.PUT(<span class="string">&quot;/book&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;message&quot;</span>: <span class="string">&quot;Put&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.DELETE(<span class="string">&quot;/book&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;message&quot;</span>: <span class="string">&quot;Delete&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	err := r.Run()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="GINæ¸²æŸ“"><a href="#GINæ¸²æŸ“" class="headerlink" title="GINæ¸²æŸ“"></a>GINæ¸²æŸ“</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;html/template&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	<span class="comment">//è‡ªå®šä¹‰å‡½æ•°</span></span><br><span class="line">	r.SetFuncMap(template.FuncMap&#123;</span><br><span class="line">		<span class="string">&quot;safe&quot;</span>: <span class="function"><span class="keyword">func</span><span class="params">(str <span class="type">string</span>)</span></span> template.HTML &#123;</span><br><span class="line">			<span class="keyword">return</span> template.HTML(str)</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="comment">//åŠ è½½é™æ€æ–‡ä»¶css img</span></span><br><span class="line">	r.Static(<span class="string">&quot;/xxx&quot;</span>, <span class="string">&quot;./static&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//æ¨¡æ¿è§£æ</span></span><br><span class="line">	<span class="comment">//r.LoadHTMLFiles(&quot;templates/get/index.tmpl&quot;, &quot;templates/put/index.tmpl&quot;)</span></span><br><span class="line">	r.LoadHTMLGlob(<span class="string">&quot;./templates/**/*&quot;</span>)</span><br><span class="line">	r.GET(<span class="string">&quot;/get/index&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123; <span class="comment">//æ¨¡æ¿æ¸²æŸ“</span></span><br><span class="line">		c.HTML(http.StatusOK, <span class="string">&quot;get/index.tmpl&quot;</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;title&quot;</span>: <span class="string">&quot;&lt;a href=&#x27;https://bilibili.com&#x27;&gt;bilibili&lt;/a&gt;&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.POST(<span class="string">&quot;/post/index&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123; <span class="comment">//æ¨¡æ¿æ¸²æŸ“</span></span><br><span class="line">		c.HTML(http.StatusOK, <span class="string">&quot;post/index.tmpl&quot;</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;title&quot;</span>: <span class="string">&quot;genshin&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.DELETE(<span class="string">&quot;/delete/index&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123; <span class="comment">//æ¨¡æ¿æ¸²æŸ“</span></span><br><span class="line">		c.HTML(http.StatusOK, <span class="string">&quot;delete/index.tmpl&quot;</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;title&quot;</span>: <span class="string">&quot;genshin&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="comment">//ä¸‹è½½çš„æ¨¡æ¿è¿”å›</span></span><br><span class="line">	r.PUT(<span class="string">&quot;/put/home&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123; <span class="comment">//æ¨¡æ¿æ¸²æŸ“</span></span><br><span class="line">		c.HTML(http.StatusOK, <span class="string">&quot;home.html&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	err := r.Run(<span class="string">&quot;127.0.0.1:9090&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä»¥POSTä¸ºä¾‹,å…¶ä»–å¤§åŒå°å¼‚</p>
<p><code>./gin01template\templates\post\index.tmpl</code></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;&#123;define &quot;post/index.tmpl&quot;&#125;&#125;</span><br><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>get<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">&#123;&#123;.title|safe&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line">&#123;&#123;end&#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// gin è¿”å›jsonåˆ°å‰ç«¯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	r.GET(<span class="string">&quot;/json&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">//1.ä½¿ç”¨ map</span></span><br><span class="line">		data := <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">			<span class="string">&quot;name&quot;</span>:    <span class="string">&quot;king&quot;</span>,</span><br><span class="line">			<span class="string">&quot;message&quot;</span>: <span class="string">&quot;hello world&quot;</span>,</span><br><span class="line">			<span class="string">&quot;age&quot;</span>:     <span class="number">18</span>,</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//ginè‡ªå¸¦æ ¼å¼</span></span><br><span class="line">		data2 := gin.H&#123;</span><br><span class="line">			<span class="string">&quot;name&quot;</span>:    <span class="string">&quot;king&quot;</span>,</span><br><span class="line">			<span class="string">&quot;message&quot;</span>: <span class="string">&quot;hello world&quot;</span>,</span><br><span class="line">			<span class="string">&quot;age&quot;</span>:     <span class="number">18</span>,</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//ä½¿ç”¨ç»“æ„ä½“</span></span><br><span class="line">		<span class="keyword">type</span> msg <span class="keyword">struct</span> &#123;</span><br><span class="line">			<span class="comment">//goå¤§å†™ä¸å¯å¯¼å‡º,ä½¿ç”¨tagæ¥å®šåˆ¶åŒ–</span></span><br><span class="line">			Name    <span class="type">string</span> <span class="string">`json:&quot;name&quot;`</span></span><br><span class="line">			Message <span class="type">string</span> <span class="string">`json:&quot;message&quot;`</span></span><br><span class="line">			Age     <span class="type">int</span>    <span class="string">`json:&quot;age&quot;`</span></span><br><span class="line">		&#125;</span><br><span class="line">		data3 := msg&#123;</span><br><span class="line">			Name:    <span class="string">&quot;data3&quot;</span>,</span><br><span class="line">			Message: <span class="string">&quot;struct method build&quot;</span>,</span><br><span class="line">			Age:     <span class="number">1</span>,</span><br><span class="line">		&#125;</span><br><span class="line">		c.JSON(http.StatusOK, data)</span><br><span class="line">		c.JSON(http.StatusOK, data2)</span><br><span class="line">		c.JSON(http.StatusOK, data3)</span><br><span class="line">	&#125;)</span><br><span class="line">	err := r.Run(<span class="string">&quot;:9090&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Query"><a href="#Query" class="headerlink" title="Query"></a>Query</h2><p><code>querystring</code>æŒ‡çš„æ˜¯URLä¸­<code>?</code>åé¢æºå¸¦çš„å‚æ•°ï¼Œä¾‹å¦‚ï¼š<code>/user/search?username=zyuu&amp;address=tyue</code>ã€‚ è·å–è¯·æ±‚çš„querystringå‚æ•°çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å›querystringå‚æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	r.GET(<span class="string">&quot;/web&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">//è·å–æµè§ˆå™¨è¯·æ±‚æºå¸¦çš„query Stringå‚æ•°</span></span><br><span class="line">		<span class="comment">//å¤šä¸ªå‚æ•°ç”¨&amp;è¿æ¥</span></span><br><span class="line">		name1 := c.Query(<span class="string">&quot;name1&quot;</span>)</span><br><span class="line">		name2 := c.DefaultQuery(<span class="string">&quot;name2&quot;</span>, <span class="string">&quot;golang&quot;</span>) <span class="comment">//é»˜è®¤å€¼</span></span><br><span class="line">		name3, ok := c.GetQuery(<span class="string">&quot;name3&quot;</span>)</span><br><span class="line">		<span class="keyword">if</span> !ok &#123;</span><br><span class="line">			<span class="comment">//å–ä¸åˆ°</span></span><br><span class="line">			name3 = <span class="string">&quot;somebody&quot;</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">			http://127.0.0.1:8080/web?name1=hello&amp;name2=world&amp;name3=golang</span></span><br><span class="line"><span class="comment">		*/</span></span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;name1&quot;</span>: name1,</span><br><span class="line">			<span class="string">&quot;name2&quot;</span>: name2,</span><br><span class="line">			<span class="string">&quot;name3&quot;</span>: name3,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	err := r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="FORM"><a href="#FORM" class="headerlink" title="FORM"></a>FORM</h2><p>å½“å‰ç«¯è¯·æ±‚çš„æ•°æ®é€šè¿‡formè¡¨å•æäº¤æ—¶ï¼Œå‘é€ä¸€ä¸ªPOSTè¯·æ±‚ï¼Œè·å–è¯·æ±‚æ•°æ®çš„æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	r.LoadHTMLFiles(<span class="string">&quot;./login.html&quot;</span>, <span class="string">&quot;./index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/login&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.HTML(http.StatusOK, <span class="string">&quot;login.html&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="comment">// æ¥æ”¶ /loginçš„postè¯·æ±‚</span></span><br><span class="line">	r.POST(<span class="string">&quot;/login&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">//å’Œ indexçš„formä¸­çš„nameç»‘å®š,éœ€è¦ä¸€æ ·</span></span><br><span class="line">		username := c.DefaultPostForm(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;NO NAME&quot;</span>)</span><br><span class="line">		password, ok := c.GetPostForm(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">		<span class="keyword">if</span> !ok &#123;</span><br><span class="line">			password = <span class="string">&quot;no password get&quot;</span></span><br><span class="line">		&#125;</span><br><span class="line">		c.HTML(http.StatusOK, <span class="string">&quot;index.html&quot;</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;Name&quot;</span>:     username,</span><br><span class="line">			<span class="string">&quot;Password&quot;</span>: password,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	err := r.Run(<span class="string">&quot;:9090&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">./login.html</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>login<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/login&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;username&quot;</span>&gt;</span>username:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;password&quot;</span>&gt;</span>password:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&quot;password&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ç™»å½•&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">./index.html</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello,&#123;&#123; .Name &#125;&#125;!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>your password is:&#123;&#123; .Password&#125;&#125;!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–è¯·æ±‚pathå‚æ•°uri</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	r.GET(<span class="string">&quot;/user/:name/:age&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">//è·å–è·¯åŠ²å‚æ•°</span></span><br><span class="line">		name := c.Param(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">		age := c.Param(<span class="string">&quot;age&quot;</span>)</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;name&quot;</span>: name,</span><br><span class="line">			<span class="string">&quot;age&quot;</span>:  age,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.GET(<span class="string">&quot;/blog/:year/:month/:day&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		year := c.Param(<span class="string">&quot;year&quot;</span>)</span><br><span class="line">		month := c.Param(<span class="string">&quot;month&quot;</span>)</span><br><span class="line">		day := c.Param(<span class="string">&quot;day&quot;</span>)</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;year&quot;</span>:  year,</span><br><span class="line">			<span class="string">&quot;month&quot;</span>: month,</span><br><span class="line">			<span class="string">&quot;day&quot;</span>:   day,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	err := r.Run(<span class="string">&quot;:9090&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Bind"><a href="#Bind" class="headerlink" title="Bind"></a>Bind</h2><p>ä¸ºäº†èƒ½å¤Ÿæ›´æ–¹ä¾¿çš„è·å–è¯·æ±‚ç›¸å…³å‚æ•°ï¼Œæé«˜å¼€å‘æ•ˆç‡ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºè¯·æ±‚çš„<code>Content-Type</code>è¯†åˆ«è¯·æ±‚æ•°æ®ç±»å‹å¹¶åˆ©ç”¨åå°„æœºåˆ¶è‡ªåŠ¨æå–è¯·æ±‚ä¸­<code>QueryString</code>ã€<code>formè¡¨å•</code>ã€<code>JSON</code>ã€<code>XML</code>ç­‰å‚æ•°åˆ°ç»“æ„ä½“ä¸­ã€‚ ä¸‹é¢çš„ç¤ºä¾‹ä»£ç æ¼”ç¤ºäº†<code>.ShouldBind()</code>å¼ºå¤§çš„åŠŸèƒ½ï¼Œå®ƒèƒ½å¤ŸåŸºäºè¯·æ±‚è‡ªåŠ¨æå–<code>JSON</code>ã€<code>formè¡¨å•</code>å’Œ<code>QueryString</code>ç±»å‹çš„æ•°æ®ï¼Œå¹¶æŠŠå€¼ç»‘å®šåˆ°æŒ‡å®šçš„ç»“æ„ä½“å¯¹è±¡ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> userinfo <span class="keyword">struct</span> &#123;</span><br><span class="line">	Username <span class="type">string</span> <span class="string">`form:&quot;username&quot; json:&quot;username&quot;`</span></span><br><span class="line">	Password <span class="type">string</span> <span class="string">`form:&quot;password&quot; json:&quot;password&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	r.GET(<span class="string">&quot;/user&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		username := c.Query(<span class="string">&quot;username&quot;</span>)</span><br><span class="line">		password := c.Query(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">		u := userinfo&#123;</span><br><span class="line">			Username: username,</span><br><span class="line">			Password: password,</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;%#v\n&quot;</span>, u)</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;message&quot;</span>: <span class="string">&quot;ok&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="comment">/*ä¸ºäº†èƒ½å¤Ÿæ›´æ–¹ä¾¿çš„è·å–è¯·æ±‚ç›¸å…³å‚æ•°ï¼Œæé«˜å¼€å‘æ•ˆç‡ï¼Œ</span></span><br><span class="line"><span class="comment">	æˆ‘ä»¬å¯ä»¥åŸºäºè¯·æ±‚çš„Content-Typeè¯†åˆ«è¯·æ±‚æ•°æ®ç±»å‹</span></span><br><span class="line"><span class="comment">	å¹¶åˆ©ç”¨åå°„æœºåˆ¶è‡ªåŠ¨æå–è¯·æ±‚ä¸­QueryStringã€formè¡¨å•ã€JSONã€XMLç­‰å‚æ•°åˆ°ç»“æ„ä½“ä¸­ã€‚</span></span><br><span class="line"><span class="comment">	.ShouldBind()åŸºäºè¯·æ±‚è‡ªåŠ¨æå–JSONã€formè¡¨å•å’ŒQueryStringç±»å‹çš„æ•°æ®ï¼Œå¹¶æŠŠå€¼ç»‘å®šåˆ°æŒ‡å®šçš„ç»“æ„ä½“å¯¹è±¡ã€‚*/</span></span><br><span class="line">	<span class="comment">//ShouldBind() querystring</span></span><br><span class="line">	r.GET(<span class="string">&quot;/query&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="keyword">var</span> u userinfo <span class="comment">//å£°æ˜éå†</span></span><br><span class="line">		err := c.ShouldBind(&amp;u)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			c.JSON(http.StatusBadRequest, gin.H&#123;</span><br><span class="line">				<span class="string">&quot;error&quot;</span>: err.Error(),</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			c.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line">				<span class="string">&quot;status&quot;</span>: <span class="string">&quot;ok&quot;</span>,</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;%#v\n&quot;</span>, u)</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="comment">//ShouldBind() post</span></span><br><span class="line">	r.POST(<span class="string">&quot;/form&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="keyword">var</span> u userinfo <span class="comment">//å£°æ˜éå†</span></span><br><span class="line">		err := c.ShouldBind(&amp;u)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			c.JSON(http.StatusBadRequest, gin.H&#123;</span><br><span class="line">				<span class="string">&quot;error&quot;</span>: err.Error(),</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			c.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line">				<span class="string">&quot;status&quot;</span>: <span class="string">&quot;ok&quot;</span>,</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;%#v\n&quot;</span>, u)</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="comment">//ShouldBind() json</span></span><br><span class="line">	r.POST(<span class="string">&quot;/json&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="keyword">var</span> u userinfo</span><br><span class="line">		err := c.ShouldBind(&amp;u)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			c.JSON(http.StatusBadRequest, gin.H&#123;</span><br><span class="line">				<span class="string">&quot;error&quot;</span>: err.Error(),</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			c.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line">				<span class="string">&quot;status&quot;</span>: <span class="string">&quot;ok&quot;</span>,</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;%#v\n&quot;</span>, u)</span><br><span class="line"></span><br><span class="line">	&#125;)</span><br><span class="line">	err := r.Run(<span class="string">&quot;:9090&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="SaveFiles"><a href="#SaveFiles" class="headerlink" title="SaveFiles"></a>SaveFiles</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;path&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	r.LoadHTMLFiles(<span class="string">&quot;./index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/index&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.HTML(http.StatusOK, <span class="string">&quot;index.html&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="comment">//å•æ–‡ä»¶</span></span><br><span class="line">	r.POST(<span class="string">&quot;/upload&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">//ä»è¯·æ±‚ä¸­è¯»å–æ–‡ä»¶,å°†è¯»å–çš„æ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ°</span></span><br><span class="line">		f, err := c.FormFile(<span class="string">&quot;f1&quot;</span>) <span class="comment">//ä»è¯·æ±‚ä¸­è·å–</span></span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			c.JSON(http.StatusBadRequest, gin.H&#123;</span><br><span class="line">				<span class="string">&quot;error&quot;</span>: err.Error(),</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">//ä¿å­˜æœ¬åœ°</span></span><br><span class="line">			<span class="comment">//dst := fmt.Sprintf(&quot;./%s&quot;, f.Filename)</span></span><br><span class="line">			dst := path.Join(<span class="string">&quot;./&quot;</span>, f.Filename)</span><br><span class="line">			err = c.SaveUploadedFile(f, dst)</span><br><span class="line">			<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">				<span class="built_in">panic</span>(err)</span><br><span class="line">			&#125;</span><br><span class="line">			c.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line">				<span class="string">&quot;status&quot;</span>: <span class="string">&quot;ok&quot;</span>,</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="comment">//å¤šæ–‡ä»¶</span></span><br><span class="line">	r.POST(<span class="string">&quot;/uploadMultiFile&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">//å¤šä¸ªæ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line">		f, err := c.MultipartForm() <span class="comment">//ä»è¯·æ±‚ä¸­è·å–</span></span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			c.JSON(http.StatusBadRequest, gin.H&#123;</span><br><span class="line">				<span class="string">&quot;error&quot;</span>: err.Error(),</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">/*&lt;input type=&quot;file&quot; name=&quot;fs&quot; id=&quot;fs&quot; multiple=&quot;multiple&quot; /&gt;</span></span><br><span class="line"><span class="comment">			ä¸­çš„nameå­—æ®µä¸fs := form.File[&quot;fs&quot;]ä¸­çš„ç´¢å¼•&quot;fs&quot;ç›¸å¯¹åº”ï¼Œ</span></span><br><span class="line"><span class="comment">			åŒä¸€ä¸ªbatchçš„æ–‡ä»¶å…±äº«ä¸€ä¸ªname</span></span><br><span class="line"><span class="comment">			*/</span></span><br><span class="line">			files := f.File[<span class="string">&quot;file&quot;</span>]</span><br><span class="line">			<span class="keyword">for</span> index, file := <span class="keyword">range</span> files &#123;</span><br><span class="line">				log.Println(file.Filename)</span><br><span class="line">				dst := fmt.Sprintf(<span class="string">&quot;./%d_%s&quot;</span>, index, file.Filename)</span><br><span class="line">				err = c.SaveUploadedFile(file, dst)</span><br><span class="line">				<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">					<span class="built_in">panic</span>(err)</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;status&quot;</span>: <span class="string">&quot;ok&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	err := r.Run(<span class="string">&quot;:9090&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">./index.html</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>index<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/upload&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;f1&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ä¸Šä¼ &quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/uploadMultiFile&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">multiple</span>=<span class="string">&quot;multiple&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ä¸Šä¼ &quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Redirect-é‡å®šå‘"><a href="#Redirect-é‡å®šå‘" class="headerlink" title="Redirect é‡å®šå‘"></a>Redirect é‡å®šå‘</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	<span class="comment">//HTTPçš„é‡å®šå‘</span></span><br><span class="line">	r.GET(<span class="string">&quot;/redirect&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.Redirect(http.StatusMovedPermanently, <span class="string">&quot;https://www.bilibili.com&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="comment">//è·¯ç”±ä»é‡å®šå‘</span></span><br><span class="line">	r.GET(<span class="string">&quot;/a&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.Request.URL.Path = <span class="string">&quot;/b&quot;</span> <span class="comment">//æŠŠè¯·æ±‚çš„uriä¿®æ”¹</span></span><br><span class="line">		r.HandleContext(c)        <span class="comment">//ç»§ç»­åç»­å¤„ç†</span></span><br><span class="line">	&#125;)</span><br><span class="line">	r.GET(<span class="string">&quot;/b&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;message&quot;</span>: <span class="string">&quot;b&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	err := r.Run(<span class="string">&quot;:9090&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Group"><a href="#Group" class="headerlink" title="Group"></a>Group</h2><p>Ginæ¡†æ¶ä¸­çš„è·¯ç”±ä½¿ç”¨çš„æ˜¯<a href="https://github.com/julienschmidt/httprouter">httprouter</a>è¿™ä¸ªåº“ã€‚</p>
<p>å…¶åŸºæœ¬åŸç†å°±æ˜¯æ„é€ ä¸€ä¸ªè·¯ç”±åœ°å€çš„å‰ç¼€æ ‘ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	<span class="comment">//è·¯ç”± å•ç‹¬å†™</span></span><br><span class="line">	r.GET(<span class="string">&quot;/index&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;method&quot;</span>: <span class="string">&quot;GET&quot;</span>&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.POST(<span class="string">&quot;/index&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;method&quot;</span>: <span class="string">&quot;post&quot;</span>&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.PUT(<span class="string">&quot;/index&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;method&quot;</span>: <span class="string">&quot;put&quot;</span>&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.DELETE(<span class="string">&quot;/index&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;method&quot;</span>: <span class="string">&quot;delete&quot;</span>&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="comment">//any</span></span><br><span class="line">	r.Any(<span class="string">&quot;/user&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="keyword">switch</span> c.Request.Method &#123;</span><br><span class="line">		<span class="keyword">case</span> http.MethodGet:</span><br><span class="line">			c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;method&quot;</span>: <span class="string">&quot;GET&quot;</span>&#125;)</span><br><span class="line">		<span class="keyword">case</span> http.MethodPost:</span><br><span class="line">			c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;method&quot;</span>: <span class="string">&quot;POST&quot;</span>&#125;)</span><br><span class="line">		<span class="keyword">case</span> http.MethodPut:</span><br><span class="line">			c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;method&quot;</span>: <span class="string">&quot;PUT&quot;</span>&#125;)</span><br><span class="line">		<span class="keyword">case</span> http.MethodDelete:</span><br><span class="line">			c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;method&quot;</span>: <span class="string">&quot;DELETE&quot;</span>&#125;)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="comment">//NoRoute ä¸å­˜åœ¨çš„è·¯ç”±</span></span><br><span class="line">	r.NoRoute(<span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(http.StatusNoContent, gin.H&#123;<span class="string">&quot;MSG&quot;</span>: <span class="string">&quot;NOT FOUND&quot;</span>&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//åµŒå¥—</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//è·¯ç”±ç»„ æå–å…¬å…±å‰ç¼€</span></span><br><span class="line">	<span class="comment">//è§†é¢‘çš„é¦–é¡µå’Œè¯¦ç»†é¡µ</span></span><br><span class="line">	videoGroup := r.Group(<span class="string">&quot;/video&quot;</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		videoGroup.GET(<span class="string">&quot;/index&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">			c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;msg&quot;</span>: <span class="string">&quot;/video/index&quot;</span>&#125;)</span><br><span class="line">		&#125;)</span><br><span class="line">		videoGroup.GET(<span class="string">&quot;/login&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">			c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;msg&quot;</span>: <span class="string">&quot;/video/login&quot;</span>&#125;)</span><br><span class="line">		&#125;)</span><br><span class="line">		videoGroup.POST(<span class="string">&quot;/login&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">			c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;msg&quot;</span>: <span class="string">&quot;/video/login&quot;</span>&#125;)</span><br><span class="line">		&#125;)</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//å•†åŸçš„é¦–é¡µå’Œè¯¦ç»†é¡µ</span></span><br><span class="line">	ShopGroup := r.Group(<span class="string">&quot;/shop&quot;</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		ShopGroup.GET(<span class="string">&quot;/index&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">			c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;msg&quot;</span>: <span class="string">&quot;/shop/index&quot;</span>&#125;)</span><br><span class="line">		&#125;)</span><br><span class="line">		ShopGroup.GET(<span class="string">&quot;/page2&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">			c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;msg&quot;</span>: <span class="string">&quot;/shop/page2&quot;</span>&#125;)</span><br><span class="line">		&#125;)</span><br><span class="line">		ShopGroup.GET(<span class="string">&quot;/page3&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">			c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;msg&quot;</span>: <span class="string">&quot;/shop/page3&quot;</span>&#125;)</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">	err := r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="ä¸­é—´ä»¶"><a href="#ä¸­é—´ä»¶" class="headerlink" title="ä¸­é—´ä»¶"></a>ä¸­é—´ä»¶</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Ginæ¡†æ¶å…è®¸å¼€å‘è€…åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­ï¼Œ</span></span><br><span class="line"><span class="comment">åŠ å…¥ç”¨æˆ·è‡ªå·±çš„é’©å­ï¼ˆHookï¼‰å‡½æ•°ã€‚</span></span><br><span class="line"><span class="comment">è¿™ä¸ªé’©å­å‡½æ•°å°±å«ä¸­é—´ä»¶ï¼Œ</span></span><br><span class="line"><span class="comment">ä¸­é—´ä»¶é€‚åˆå¤„ç†ä¸€äº›å…¬å…±çš„ä¸šåŠ¡é€»è¾‘ï¼Œ</span></span><br><span class="line"><span class="comment">æ¯”å¦‚ç™»å½•è®¤è¯ã€æƒé™æ ¡éªŒã€æ•°æ®åˆ†é¡µã€è®°å½•æ—¥å¿—ã€è€—æ—¶ç»Ÿè®¡ç­‰</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	<span class="comment">//é»˜è®¤ä½¿ç”¨Defaultä¸­é—´ä»¶åŒ…å«Logger(), Recovery()</span></span><br><span class="line">	<span class="comment">//è‹¥ä¸æƒ³ç”¨</span></span><br><span class="line">	<span class="comment">//r:=gin.New()</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//æ³¨å†Œä¸­é—´ä»¶ åå¯åœ¨æ¥ä¸‹æ¥ä¸éœ€è¦å–åœ¨GETæ–¹æ³•ä¸­å†™StatCost()</span></span><br><span class="line">	r.Use(StatCost(), StatCost2())</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">		r.GET(&quot;/index&quot;, StatCost(), func(c *gin.Context) &#123;</span></span><br><span class="line"><span class="comment">			c.JSON(http.StatusOK, gin.H&#123;&quot;message&quot;: &quot;index&quot;&#125;)</span></span><br><span class="line"><span class="comment">		&#125;)</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	r.GET(<span class="string">&quot;/index1&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">//get()-&gt; StatCost2()çš„c.Set</span></span><br><span class="line">		name, ok := c.Get(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">		<span class="keyword">if</span> !ok &#123;</span><br><span class="line">			name = <span class="string">&quot;lambda name&quot;</span></span><br><span class="line">		&#125;</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;message&quot;</span>: name&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.GET(<span class="string">&quot;/index2&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;index2&quot;</span>&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//#region ä¸ºè·¯ç”±ç»„æ³¨å†Œ</span></span><br><span class="line">	<span class="comment">/*æ³•1*/</span></span><br><span class="line">	shopGroup := r.Group(<span class="string">&quot;/shop2&quot;</span>, StatCost())</span><br><span class="line">	&#123;</span><br><span class="line">		shopGroup.GET(<span class="string">&quot;/index&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">			c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;group&quot;</span>: <span class="string">&quot;get&quot;</span>&#125;)</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/*æ³•2*/</span></span><br><span class="line">	<span class="comment">/*	shopGroup2 := r.Group(&quot;/shop2&quot;)</span></span><br><span class="line"><span class="comment">		shopGroup2.Use(StatCost())</span></span><br><span class="line"><span class="comment">		&#123;</span></span><br><span class="line"><span class="comment">			shopGroup.GET(&quot;/index&quot;, func(c *gin.Context) &#123;</span></span><br><span class="line"><span class="comment">				c.JSON(http.StatusOK, gin.H&#123;&quot;m&quot;: &quot;m&quot;&#125;)</span></span><br><span class="line"><span class="comment">			&#125;)</span></span><br><span class="line"><span class="comment">		&#125;*/</span></span><br><span class="line">	<span class="comment">//#endregion</span></span><br><span class="line"></span><br><span class="line">	err := r.Run(<span class="string">&quot;:9090&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//StatCost ä¸ StatCost2 å‡å«æœ‰Next(),</span></span><br><span class="line"><span class="comment">//ç±»ä¼¼ä¸æ ˆ,stat1 -&gt; next() -&gt; stat2 -&gt; next() -&gt;lambdaFunc -&gt; stat2End -&gt; statEnd</span></span><br><span class="line"><span class="comment">//è‹¥statCost2 å«æœ‰Abort()ä¼šé˜»æ­¢åç»­è¿è¡Œ,è‡³æ­¤æ–¹æ³•ç»“æŸ</span></span><br><span class="line"><span class="comment">//ç±»ä¼¼ä¸æ ˆ,stat1 -&gt; next() -&gt; stat2 -&gt; Abort() -&gt; stat2End</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*æƒé™åˆ¤æ–­</span></span><br><span class="line"><span class="comment">if ç¬¦åˆ</span></span><br><span class="line"><span class="comment">Next()</span></span><br><span class="line"><span class="comment">else</span></span><br><span class="line"><span class="comment">Abort()*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// StatCost  å®šä¹‰ Ginä¸­çš„ä¸­é—´ä»¶å¿…é¡»æ˜¯ä¸€ä¸ªgin.HandlerFuncç±»å‹ã€‚</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//	@Description: ç»Ÿè®¡è€—æ—¶</span></span><br><span class="line"><span class="comment">//	@return gin.HandlerFunc</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">StatCost</span><span class="params">()</span></span> gin.HandlerFunc &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;------------start------------&quot;</span>)</span><br><span class="line">		start := time.Now()</span><br><span class="line">		<span class="comment">//å½“åœ¨ä¸­é—´ä»¶æˆ–handlerä¸­å¯åŠ¨æ–°çš„goroutineæ—¶</span></span><br><span class="line">		<span class="comment">//ä¸èƒ½ä½¿ç”¨åŸå§‹çš„ä¸Šä¸‹æ–‡ï¼ˆc *gin.Contextï¼‰</span></span><br><span class="line">		<span class="comment">//å¿…é¡»ä½¿ç”¨å…¶åªè¯»å‰¯æœ¬ï¼ˆc.Copy()ï¼‰</span></span><br><span class="line">		<span class="comment">/*go funcXXX(c.Copy())*/</span></span><br><span class="line">		c.Next() <span class="comment">//è°ƒç”¨åç»­çš„å‡½æ•°</span></span><br><span class="line">		<span class="comment">//c.Abort()//ç»„ç»‡è°ƒç”¨åç»­å‡½æ•°</span></span><br><span class="line">		cost := time.Since(start)</span><br><span class="line">		fmt.Println(<span class="string">&quot;------------end------------&quot;</span>)</span><br><span class="line">		log.Printf(<span class="string">&quot;[Log] cost:%v\n&quot;</span>, cost)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// StatCost2</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//	@Description: æ ˆæ€æƒ³</span></span><br><span class="line"><span class="comment">//	@return gin.HandlerFunc</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">StatCost2</span><span class="params">()</span></span> gin.HandlerFunc &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;------start------&quot;</span>)</span><br><span class="line">		c.Set(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;SetSuccess&quot;</span>)</span><br><span class="line">		c.Next() <span class="comment">//è°ƒç”¨åç»­çš„å‡½æ•°</span></span><br><span class="line">		fmt.Println(<span class="string">&quot;------end-------&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>Golang</category>
      </categories>
      <tags>
        <tag>Golang</tag>
        <tag>Gin</tag>
        <tag>GoWeb</tag>
      </tags>
  </entry>
  <entry>
    <title>lc9_14</title>
    <url>/2023/09/14/lc9-14/</url>
    <content><![CDATA[<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1222  2023-09-14 09:52:09</span></span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">queensAttacktheKing</span><span class="params">(queens [][]<span class="type">int</span>, king []<span class="type">int</span>)</span></span> [][]<span class="type">int</span> &#123;</span><br><span class="line">	board := <span class="built_in">make</span>([][]<span class="type">bool</span>, <span class="number">8</span>)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="keyword">range</span> board &#123;</span><br><span class="line">		board[i] = <span class="built_in">make</span>([]<span class="type">bool</span>, <span class="number">8</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> _, queen := <span class="keyword">range</span> queens &#123;</span><br><span class="line">		board[queen[<span class="number">0</span>]][queen[<span class="number">1</span>]] = <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//å…«ä¸ªæ–¹å‘traverse</span></span><br><span class="line">	dirs := [][<span class="number">2</span>]<span class="type">int</span>&#123;&#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">-1</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">1</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">-1</span>&#125;&#125;</span><br><span class="line">	<span class="keyword">var</span> ret [][]<span class="type">int</span></span><br><span class="line">	<span class="keyword">for</span> _, dir := <span class="keyword">range</span> dirs &#123;</span><br><span class="line">		dx, dy := dir[<span class="number">0</span>], dir[<span class="number">1</span>]</span><br><span class="line">		x, y := king[<span class="number">0</span>], king[<span class="number">1</span>]</span><br><span class="line">		<span class="keyword">for</span> x &gt;= <span class="number">0</span> &amp;&amp; x &lt; <span class="number">8</span> &amp;&amp; y &gt;= <span class="number">0</span> &amp;&amp; y &lt; <span class="number">8</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> board[x][y] &#123;</span><br><span class="line">				ret = <span class="built_in">append</span>(ret, []<span class="type">int</span>&#123;x, y&#125;)</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">			&#125;</span><br><span class="line">			x += dx</span><br><span class="line">			y += dy</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>lc9.13</title>
    <url>/2023/09/13/lc9-13/</url>
    <content><![CDATA[<p><a href="https://leetcode.cn/problems/check-knight-tour-configuration/">2596. æ£€æŸ¥éª‘å£«å·¡è§†æ–¹æ¡ˆ</a></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2596  2023-09-13 09:19:33</span></span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">checkValidGrid</span><span class="params">(grid [][]<span class="type">int</span>)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> grid[<span class="number">0</span>][<span class="number">0</span>] != <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	n := <span class="built_in">len</span>(grid)</span><br><span class="line">	coord := <span class="built_in">make</span>([][<span class="number">2</span>]<span class="type">int</span>, n*n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; n; j++ &#123;</span><br><span class="line">			coord[grid[i][j]][<span class="number">0</span>], coord[grid[i][j]][<span class="number">1</span>] = i, j</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt; n*n; i++ &#123;</span><br><span class="line">		deltaX, deltaY := coord[i][<span class="number">0</span>]-coord[i<span class="number">-1</span>][<span class="number">0</span>], coord[i][<span class="number">1</span>]-coord[i<span class="number">-1</span>][<span class="number">1</span>]</span><br><span class="line">		<span class="keyword">if</span> abs(deltaX*deltaY) != <span class="number">2</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">abs</span><span class="params">(x <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> x &gt; <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> x</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> -x</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
  </entry>
  <entry>
    <title>lc9_15</title>
    <url>/2023/09/15/lc9-15/</url>
    <content><![CDATA[<h1 id="LCP-50-å®çŸ³è¡¥ç»™"><a href="#LCP-50-å®çŸ³è¡¥ç»™" class="headerlink" title="LCP 50. å®çŸ³è¡¥ç»™"></a><a href="https://leetcode.cn/problems/WHnhjV/">LCP 50. å®çŸ³è¡¥ç»™</a></h1><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="comment">// LCP 50  2023-09-15 09:00:56</span></span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">giveGem</span><span class="params">(gem []<span class="type">int</span>, operations [][]<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">    min := <span class="function"><span class="keyword">func</span><span class="params">(a, b <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">       <span class="keyword">if</span> a &lt; b &#123;</span><br><span class="line">          <span class="keyword">return</span> a</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> b</span><br><span class="line">    &#125;</span><br><span class="line">    max := <span class="function"><span class="keyword">func</span><span class="params">(a, b <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">       <span class="keyword">if</span> a &gt; b &#123;</span><br><span class="line">          <span class="keyword">return</span> a</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> b</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> _, operation := <span class="keyword">range</span> operations &#123;</span><br><span class="line">       <span class="comment">//fmt.Println(operation)</span></span><br><span class="line">       a, b := operation[<span class="number">0</span>], operation[<span class="number">1</span>]</span><br><span class="line">       num := gem[a] / <span class="number">2</span></span><br><span class="line">       gem[a] -= num</span><br><span class="line">       gem[b] += num</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    minN, maxN := gem[<span class="number">0</span>], gem[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> _, v := <span class="keyword">range</span> gem &#123;</span><br><span class="line">       minN = min(minN, v)</span><br><span class="line">       maxN = max(maxN, v)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> maxN - minN</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
  </entry>
  <entry>
    <title>javaScript</title>
    <url>/2024/01/27/javaScript/</url>
    <content><![CDATA[<h1 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h1><hr>
<p>JavaScript æ˜¯ä¸€é—¨è·¨å¹³å°ã€é¢å‘å¯¹è±¡çš„è„šæœ¬è¯­è¨€ï¼Œå®ƒèƒ½ä½¿ç½‘é¡µå¯äº¤äº’ï¼ˆä¾‹å¦‚æ‹¥æœ‰å¤æ‚çš„åŠ¨ç”»ï¼Œå¯ç‚¹å‡»çš„æŒ‰é’®ï¼Œé€šä¿—çš„èœå•ç­‰ï¼‰ã€‚å¦å¤–è¿˜æœ‰é«˜çº§çš„æœåŠ¡ç«¯ Javascript ç‰ˆæœ¬ï¼Œä¾‹å¦‚ Node.jsï¼Œå®ƒå¯ä»¥è®©ä½ åœ¨ç½‘é¡µä¸Šæ·»åŠ æ›´å¤šåŠŸèƒ½ï¼Œä¸ä»…ä»…æ˜¯ä¸‹è½½æ–‡ä»¶ï¼ˆä¾‹å¦‚åœ¨å¤šå°ç”µè„‘ä¹‹é—´çš„ååŒåˆä½œï¼‰ã€‚åœ¨å®¿ä¸»ç¯å¢ƒï¼ˆä¾‹å¦‚ web æµè§ˆå™¨ï¼‰ä¸­ï¼ŒJavaScript èƒ½å¤Ÿé€šè¿‡å…¶æ‰€è¿æ¥çš„ç¯å¢ƒæä¾›çš„ç¼–ç¨‹æ¥å£è¿›è¡Œæ§åˆ¶ã€‚</p>
<span id="more"></span>

<h3 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h3><blockquote>
<figure class="highlight plaintext"><figcaption><span>src</span></figcaption><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### è¾“å…¥è¾“å‡º</span><br><span class="line"></span><br><span class="line">`prompt()`</span><br><span class="line"></span><br><span class="line">`alert()`</span><br><span class="line"></span><br><span class="line">`console.log()`</span><br><span class="line"></span><br><span class="line">`document.write()`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### å˜é‡</span><br><span class="line"></span><br><span class="line">`let`</span><br><span class="line"></span><br><span class="line">1. å…è®¸å£°æ˜å’Œèµ‹å€¼åŒæ—¶è¿›è¡Œ</span><br><span class="line"></span><br><span class="line">2. ä¸å…è®¸é‡å¤å£°æ˜</span><br><span class="line"></span><br><span class="line">3. å…è®¸åŒæ—¶å£°æ˜å¤šä¸ªå˜é‡å¹¶èµ‹å€¼</span><br><span class="line"></span><br><span class="line">4. JavaScript ä¸­å†…ç½®çš„ä¸€äº›å…³é”®å­—ä¸èƒ½è¢«å½“åšå˜é‡å</span><br><span class="line"></span><br><span class="line"> `typeof`  æ£€æµ‹å˜é‡ç±»å‹  </span><br><span class="line"></span><br><span class="line">æ•°å€¼ç±»å‹</span><br><span class="line">`number` æ­£æ•°ã€è´Ÿæ•°ã€å°æ•° (`toFixed` ç”¨äºè®¾ç½®ä¿ç•™å°æ•°ä½çš„é•¿åº¦)</span><br><span class="line">`string` `bool`</span><br><span class="line">`undefined`åªå£°æ˜å˜é‡ï¼Œä¸èµ‹å€¼çš„æƒ…å†µä¸‹ï¼Œå˜é‡çš„é»˜è®¤å€¼ä¸º undefined</span><br><span class="line">æ˜¾å¼è½¬åŒ–</span><br><span class="line"></span><br><span class="line">```js</span><br><span class="line">let t = &#x27;12&#x27;</span><br><span class="line">// æ˜¾å¼å°†å­—ç¬¦ä¸² 12 è½¬æ¢æˆæ•°å€¼ 12</span><br><span class="line">t = Number(t)</span><br><span class="line">// å¹¶ä¸æ˜¯æ‰€æœ‰çš„å€¼éƒ½å¯ä»¥è¢«è½¬æˆæ•°å€¼ç±»å‹</span><br><span class="line">let str = &#x27;hello&#x27;</span><br><span class="line">// å°† hello è½¬æˆæ•°å€¼æ˜¯ä¸ç°å®çš„ï¼Œå½“æ— æ³•è½¬æ¢æˆ</span><br><span class="line">// æ•°å€¼æ—¶ï¼Œå¾—åˆ°çš„ç»“æœä¸º NaN ï¼ˆNot a Numberï¼‰</span><br></pre></td></tr></table></figure>

<p>JavaScript ä¸­é™¤äº†å˜é‡å¤–è¿˜æœ‰å¸¸é‡ï¼Œ</p>
<p>å¸¸é‡ä¸å˜é‡æœ¬è´¨çš„åŒºåˆ«æ˜¯ã€å¸¸é‡å¿…é¡»è¦æœ‰å€¼ä¸”ä¸å…è®¸è¢«é‡æ–°èµ‹å€¼ã€‘ï¼Œ</p>
<p>å¸¸é‡å€¼ä¸ºå¯¹è±¡æ—¶å…¶å±æ€§å’Œæ–¹æ³•å…è®¸é‡æ–°èµ‹å€¼</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¿…é¡»è¦æœ‰å€¼</span></span><br><span class="line"><span class="keyword">const</span> version = <span class="string">&#x27;1.0.0&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸èƒ½é‡æ–°èµ‹å€¼</span></span><br><span class="line"><span class="comment">// version = &#x27;1.0.1&#x27;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¸¸é‡å€¼ä¸ºå¯¹è±¡ç±»å‹</span></span><br><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸èƒ½é‡æ–°èµ‹å€¼</span></span><br><span class="line">user = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å±æ€§å’Œæ–¹æ³•å…è®¸è¢«ä¿®æ”¹</span></span><br><span class="line">user.<span class="property">name</span> = <span class="string">&#x27;å°å°æ˜&#x27;</span>;</span><br><span class="line">user.<span class="property">gender</span> = <span class="string">&#x27;ç”·&#x27;</span>;</span><br></pre></td></tr></table></figure>


</blockquote>
<h3 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h3><blockquote>
<p>ç®—æœ¯ <code>+ - * / % </code></p>
<p>èµ‹å€¼ <code>+= -= /= %= </code></p>
<p>è‡ªå¢è‡ªå‡ <code>++ --</code></p>
<p>æ¯”è¾ƒ <code>&gt; &lt; = &gt;= &lt;= == ===(æ¯”è¾ƒtype) != !== </code></p>
<p>é€»è¾‘ <code>&amp;&amp; || !</code> <strong>ï¼&gt; &amp;&amp; &gt;  ||</strong>  </p>
</blockquote>
<h3 id="åˆ†æ”¯"><a href="#åˆ†æ”¯" class="headerlink" title="åˆ†æ”¯"></a>åˆ†æ”¯</h3><blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">if</span>(æ¡ä»¶è¡¨è¾¾å¼) &#123;&#125;<span class="keyword">else</span> <span class="keyword">if</span>()&#123;&#125;<span class="keyword">else</span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;condition?<span class="attr">case1</span>:case2</span><br></pre></td></tr></table></figure>

<p><strong>switch ä¸€å®šè¦æ³¨æ„ å¿…é¡»æ˜¯ &#x3D;&#x3D;&#x3D;  å…¨ç­‰</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">switch</span>()&#123;</span><br><span class="line">&gt;<span class="keyword">case</span> <span class="attr">value1</span>: <span class="keyword">break</span>;</span><br><span class="line">&gt;<span class="keyword">case</span> <span class="attr">value2</span>: <span class="keyword">break</span>;</span><br><span class="line">&gt;<span class="attr">default</span>: <span class="keyword">break</span>;    </span><br><span class="line">&gt;&#125;</span><br></pre></td></tr></table></figure>


</blockquote>
<h3 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h3><blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">while</span> () &#123;&#125;</span><br><span class="line">&gt;<span class="keyword">for</span> (; ;) &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨<code>continue breakæ¥æ§åˆ¶å¾ªç¯</code></p>
</blockquote>
<h3 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h3><blockquote>
<p>é—­åŒ…æ˜¯ä¸€ç§æ¯”è¾ƒç‰¹æ®Šå’Œå‡½æ•°ï¼Œä½¿ç”¨é—­åŒ…èƒ½å¤Ÿè®¿é—®å‡½æ•°ä½œç”¨åŸŸä¸­çš„å˜é‡ã€‚</p>
<p>ä»ä»£ç å½¢å¼ä¸Šçœ‹é—­åŒ…æ˜¯ä¸€ä¸ªåšä¸ºè¿”å›å€¼çš„å‡½æ•°ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤º</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="comment">//é—­åŒ…çš„åº”ç”¨ï¼š å®ç°æ•°æ®çš„ç§æœ‰</span></span><br><span class="line">&gt;<span class="keyword">function</span> <span class="title function_">outer</span>(<span class="params"></span>) &#123;</span><br><span class="line">&gt;<span class="keyword">let</span> count = <span class="number">1</span></span><br><span class="line">&gt;<span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">count++</span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`å‡½æ•°è¢«è°ƒç”¨<span class="subst">$&#123;count&#125;</span>æ¬¡`</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> fn</span><br><span class="line">&gt;&#125;</span><br></pre></td></tr></table></figure>

<p>é—­åŒ… &#x3D; å†…å±‚å‡½æ•° + å¤–å±‚å‡½æ•°çš„å˜é‡</p>
<ul>
<li>å°é—­æ•°æ®ï¼Œå®ç°æ•°æ®ç§æœ‰ï¼Œå¤–éƒ¨ä¹Ÿå¯ä»¥è®¿é—®å‡½æ•°å†…éƒ¨çš„å˜é‡</li>
<li>é—­åŒ…å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸å°†å‡½æ•°ä¸å…¶æ‰€æ“ä½œçš„æŸäº›æ•°æ®ï¼ˆç¯å¢ƒï¼‰å…³è”èµ·æ¥</li>
</ul>
</blockquote>
<h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><blockquote>
<ul>
<li><strong>å®ä¾‹å±æ€§ <code>length</code> ç”¨æ¥è·å–å­—ç¬¦ä¸²çš„åº¦é•¿(é‡ç‚¹)</strong></li>
<li><strong>å®ä¾‹æ–¹æ³• <code>split(&#39;åˆ†éš”ç¬¦&#39;)</code> ç”¨æ¥å°†å­—ç¬¦ä¸²æ‹†åˆ†æˆæ•°ç»„(é‡ç‚¹)</strong></li>
<li><strong>å®ä¾‹æ–¹æ³• <code>substringï¼ˆéœ€è¦æˆªå–çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ç´¢å¼•[,ç»“æŸçš„ç´¢å¼•å·]ï¼‰</code> ç”¨äºå­—ç¬¦ä¸²æˆªå–(é‡ç‚¹)</strong></li>
<li><strong>å®ä¾‹æ–¹æ³• <code>startsWith(æ£€æµ‹å­—ç¬¦ä¸²[, æ£€æµ‹ä½ç½®ç´¢å¼•å·])</code> æ£€æµ‹æ˜¯å¦ä»¥æŸå­—ç¬¦å¼€å¤´(é‡ç‚¹)</strong></li>
<li><strong>å®ä¾‹æ–¹æ³• <code>includes(æœç´¢çš„å­—ç¬¦ä¸²[, æ£€æµ‹ä½ç½®ç´¢å¼•å·])</code> åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ…å«åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œæ ¹æ®æƒ…å†µè¿”å› true æˆ– false(é‡ç‚¹)</strong></li>
<li><strong>å®ä¾‹æ–¹æ³• <code>toUpperCase</code> ç”¨äºå°†å­—æ¯è½¬æ¢æˆå¤§å†™</strong></li>
<li><strong>å®ä¾‹æ–¹æ³• <code>toLowerCase</code> ç”¨äºå°†å°±è½¬æ¢æˆå°å†™</strong></li>
<li><strong>å®ä¾‹æ–¹æ³• <code>indexOf</code>  æ£€æµ‹æ˜¯å¦åŒ…å«æŸå­—ç¬¦</strong></li>
<li><strong>å®ä¾‹æ–¹æ³• <code>endsWith</code> æ£€æµ‹æ˜¯å¦ä»¥æŸå­—ç¬¦ç»“å°¾</strong></li>
<li><strong>å®ä¾‹æ–¹æ³• <code>replace</code> ç”¨äºæ›¿æ¢å­—ç¬¦ä¸²ï¼Œæ”¯æŒæ­£åˆ™åŒ¹é…</strong></li>
<li><strong>å®ä¾‹æ–¹æ³• <code>match</code> ç”¨äºæŸ¥æ‰¾å­—ç¬¦ä¸²ï¼Œæ”¯æŒæ­£åˆ™åŒ¹é…</strong></li>
</ul>
<p>æ³¨ï¼šString ä¹Ÿå¯ä»¥å½“åšæ™®é€šå‡½æ•°ä½¿ç”¨ï¼Œè¿™æ—¶å®ƒçš„ä½œç”¨æ˜¯å¼ºåˆ¶è½¬æ¢æˆå­—ç¬¦ä¸²æ•°æ®ç±»å‹ã€‚</p>
</blockquote>
<h3 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h3><blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">let</span> array1 = [];</span><br><span class="line">&gt;<span class="keyword">let</span> array2=<span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1</span>);<span class="comment">//é•¿åº¦</span></span><br><span class="line">&gt;<span class="keyword">let</span> array2=<span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>);<span class="comment">//å†…å®¹[1,2,3,4,5]</span></span><br></pre></td></tr></table></figure>

<p>push åŠ¨æ€å‘æ•°ç»„çš„å°¾éƒ¨æ·»åŠ ä¸€ä¸ªå•å…ƒ<br>unshit åŠ¨æ€å‘æ•°ç»„å¤´éƒ¨æ·»åŠ ä¸€ä¸ªå•å…ƒ<br>pop åˆ é™¤æœ€åä¸€ä¸ªå•å…ƒ<br>shift åˆ é™¤ç¬¬ä¸€ä¸ªå•å…ƒ<br>splice åŠ¨æ€åˆ é™¤ä»»æ„å•å…ƒ</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&gt;åˆ é™¤</span><br><span class="line">&gt;<span class="title function_">splice</span>(èµ·å§‹ä½ç½®ï¼Œ åˆ é™¤çš„ä¸ªæ•°)</span><br><span class="line">&gt;<span class="keyword">let</span> arr = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;green&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>]</span><br><span class="line">&gt;arr.<span class="title function_">splice</span>(<span class="number">1</span>,<span class="number">1</span>) <span class="comment">// åˆ é™¤greenå…ƒç´ </span></span><br><span class="line"></span><br><span class="line">&gt;æ·»åŠ å…ƒç´ </span><br><span class="line">&gt;<span class="keyword">let</span> arr = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;green&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>]</span><br><span class="line">&gt;<span class="comment">//arr.splice(1, 0, &#x27;pink&#x27;) // åœ¨ç´¢å¼•å·æ˜¯1çš„ä½ç½®æ·»åŠ  pink</span></span><br><span class="line">&gt;<span class="comment">//console.log(arr) // [&#x27;red&#x27;, &#x27;pink&#x27;, &#x27;green&#x27;, &#x27;blue&#x27;]</span></span><br><span class="line">&gt;arr.<span class="title function_">splice</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="string">&#x27;pink&#x27;</span>, <span class="string">&#x27;hotpink&#x27;</span>) <span class="comment">// åœ¨ç´¢å¼•å·æ˜¯1çš„ä½ç½®æ·»åŠ  pink  hotpink</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(arr) <span class="comment">// [&#x27;red&#x27;, &#x27;pink&#x27;, &#x27;hotpink&#x27;, &#x27;green&#x27;, &#x27;blue&#x27;]</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>æ¨èä½¿ç”¨å­—é¢é‡æ–¹å¼å£°æ˜æ•°ç»„ï¼Œè€Œä¸æ˜¯ <code>Array</code> æ„é€ å‡½æ•°</strong></p>
</li>
<li><p><strong>å®ä¾‹æ–¹æ³• <code>forEach</code> ç”¨äºéå†æ•°ç»„ï¼Œæ›¿ä»£ <code>for</code> å¾ªç¯ (é‡ç‚¹)</strong></p>
</li>
<li><p><strong>å®ä¾‹æ–¹æ³• <code>filter</code> è¿‡æ»¤æ•°ç»„å•å…ƒå€¼ï¼Œç”Ÿæˆæ–°æ•°ç»„(é‡ç‚¹)</strong></p>
</li>
<li><p><strong>å®ä¾‹æ–¹æ³• <code>map</code> è¿­ä»£åŸæ•°ç»„ï¼Œç”Ÿæˆæ–°æ•°ç»„(é‡ç‚¹)</strong></p>
</li>
<li><p><strong>å®ä¾‹æ–¹æ³• <code>join</code> æ•°ç»„å…ƒç´ æ‹¼æ¥ä¸ºå­—ç¬¦ä¸²ï¼Œè¿”å›å­—ç¬¦ä¸²(é‡ç‚¹)</strong></p>
</li>
<li><p><strong>å®ä¾‹æ–¹æ³•  <code>find</code>  æŸ¥æ‰¾å…ƒç´ ï¼Œ è¿”å›ç¬¦åˆæµ‹è¯•æ¡ä»¶çš„ç¬¬ä¸€ä¸ªæ•°ç»„å…ƒç´ å€¼ï¼Œå¦‚æœæ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„åˆ™è¿”å› undefined(é‡ç‚¹)</strong></p>
</li>
<li><p><strong>å®ä¾‹æ–¹æ³•<code>every</code> æ£€æµ‹æ•°ç»„æ‰€æœ‰å…ƒç´ æ˜¯å¦éƒ½ç¬¦åˆæŒ‡å®šæ¡ä»¶ï¼Œå¦‚æœæ‰€æœ‰å…ƒç´ éƒ½é€šè¿‡æ£€æµ‹è¿”å› trueï¼Œå¦åˆ™è¿”å› false(é‡ç‚¹)</strong></p>
</li>
<li><p><strong>å®ä¾‹æ–¹æ³•<code>some</code> æ£€æµ‹æ•°ç»„ä¸­çš„å…ƒç´ æ˜¯å¦æ»¡è¶³æŒ‡å®šæ¡ä»¶   å¦‚æœæ•°ç»„ä¸­æœ‰å…ƒç´ æ»¡è¶³æ¡ä»¶è¿”å› trueï¼Œå¦åˆ™è¿”å› false</strong></p>
</li>
<li><p><strong>å®ä¾‹æ–¹æ³• <code>concat</code>  åˆå¹¶ä¸¤ä¸ªæ•°ç»„ï¼Œè¿”å›ç”Ÿæˆæ–°æ•°ç»„</strong></p>
</li>
<li><p><strong>å®ä¾‹æ–¹æ³• <code>sort</code> å¯¹åŸæ•°ç»„å•å…ƒå€¼æ’åº</strong></p>
</li>
<li><p><strong>å®ä¾‹æ–¹æ³• <code>splice</code> åˆ é™¤æˆ–æ›¿æ¢åŸæ•°ç»„å•å…ƒ</strong></p>
</li>
<li><p><strong>å®ä¾‹æ–¹æ³• <code>reverse</code> åè½¬æ•°ç»„</strong></p>
</li>
<li><p><strong>å®ä¾‹æ–¹æ³• <code>findIndex</code>  æŸ¥æ‰¾å…ƒç´ çš„ç´¢å¼•å€¼</strong></p>
</li>
</ul>
</blockquote>
<h4 id="mapæ–¹æ³•"><a href="#mapæ–¹æ³•" class="headerlink" title="mapæ–¹æ³•"></a>mapæ–¹æ³•</h4><blockquote>
<p>map å¯ä»¥éå†æ•°ç»„å¤„ç†æ•°æ®ï¼Œå¹¶ä¸”è¿”å›æ–°çš„æ•°ç»„</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> arr = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>, <span class="string">&#x27;pink&#x27;</span>] </span><br><span class="line">&gt;<span class="keyword">const</span> newArr = arr.<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">ele, index</span>) &#123;</span><br><span class="line">&gt;<span class="keyword">return</span> ele + <span class="string">&#x27;é¢œè‰²&#x27;</span></span><br><span class="line">&gt;&#125;)</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="joinæ–¹æ³•"><a href="#joinæ–¹æ³•" class="headerlink" title="joinæ–¹æ³•"></a>joinæ–¹æ³•</h4><blockquote>
<p>join() æ–¹æ³•ç”¨äºæŠŠæ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ è½¬æ¢ä¸€ä¸ªå­—ç¬¦ä¸²</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> arr = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>, <span class="string">&#x27;pink&#x27;</span>];</span><br><span class="line">&gt;<span class="comment">// å°æ‹¬å·ä¸ºç©ºåˆ™é€—å·åˆ†å‰²</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(newArr.<span class="title function_">join</span>())  <span class="comment">// red,blue,pink</span></span><br><span class="line">&gt;<span class="comment">// å°æ‹¬å·æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œåˆ™å…ƒç´ ä¹‹é—´æ²¡æœ‰åˆ†éš”ç¬¦</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(newArr.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>))  <span class="comment">//redbluepink</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(newArr.<span class="title function_">join</span>(<span class="string">&#x27;|&#x27;</span>))  <span class="comment">//red|blue|pink</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="forEach"><a href="#forEach" class="headerlink" title="forEach"></a>forEach</h4><blockquote>
<p>1.forEach ä¸»è¦æ˜¯éå†æ•°ç»„</p>
<p>2.å‚æ•°å½“å‰æ•°ç»„å…ƒç´ æ˜¯å¿…é¡»è¦å†™çš„ï¼Œ ç´¢å¼•å·å¯é€‰</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> result = arr.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">item, index</span>) &#123;&#125;);</span><br><span class="line">&gt;<span class="keyword">const</span> result = arr.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;&#125;);</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="filterç­›é€‰æ•°ç»„"><a href="#filterç­›é€‰æ•°ç»„" class="headerlink" title="filterç­›é€‰æ•°ç»„"></a>filterç­›é€‰æ•°ç»„</h4><blockquote>
<p>filter() æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œæ–°æ•°ç»„ä¸­çš„å…ƒç´ æ˜¯é€šè¿‡æ£€æŸ¥æŒ‡å®šæ•°ç»„ä¸­ç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰å…ƒç´ </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> newArr = arr.<span class="title function_">filter</span>(<span class="keyword">function</span> (<span class="params">item, index</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> item &gt;= <span class="number">20</span></span><br><span class="line">&gt;&#125;)</span><br><span class="line"></span><br><span class="line">&gt;<span class="comment">//ç®­å¤´</span></span><br><span class="line">&gt;<span class="keyword">const</span> newArr = arr.<span class="title function_">filter</span>(<span class="function">(<span class="params">item</span>) =&gt;</span>&#123;item &gt;= <span class="number">20</span>&#125;);</span><br><span class="line">&gt;<span class="comment">//åªæœ‰ä¸€ä¸ªè¿”å›å€¼æ—¶ç®­å¤´å‡½æ•°å¯ä»¥çœç•¥return</span></span><br><span class="line">&gt;<span class="keyword">const</span> newArr = arr.<span class="title function_">filter</span>(<span class="function">(<span class="params">item</span>) =&gt;</span>&#123; <span class="keyword">return</span> item &gt;= <span class="number">20</span>&#125;);</span><br></pre></td></tr></table></figure>


</blockquote>
<h3 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h3><blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">function</span> <span class="title function_">func</span>(<span class="params">[params]</span>)&#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&gt;&#125;</span><br></pre></td></tr></table></figure>

<p>é»˜è®¤å€¼</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="comment">// è®¾ç½®å‚æ•°é»˜è®¤å€¼</span></span><br><span class="line">&gt;<span class="keyword">function</span> <span class="title function_">sayHi</span>(<span class="params">name=<span class="string">&quot;å°æ˜&quot;</span>, age=<span class="number">18</span></span>) &#123;</span><br><span class="line">&gt;<span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">`&lt;p&gt;å¤§å®¶å¥½ï¼Œæˆ‘å«<span class="subst">$&#123;name&#125;</span>ï¼Œæˆ‘ä»Šå¹´<span class="subst">$&#123;age&#125;</span>å²äº†ã€‚&lt;/p&gt;`</span>);</span><br><span class="line">&gt;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>arguments</strong> </p>
<p><code>arguments</code> æ˜¯å‡½æ•°å†…éƒ¨å†…ç½®çš„<strong>ä¼ªæ•°ç»„</strong>å˜é‡ï¼Œå®ƒåŒ…å«äº†è°ƒç”¨å‡½æ•°æ—¶ä¼ å…¥çš„æ‰€æœ‰å®å‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params"></span>) &#123;</span><br><span class="line">&gt;<span class="keyword">let</span> s = <span class="number">0</span></span><br><span class="line">&gt;<span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">arguments</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">s += <span class="variable language_">arguments</span>[i]</span><br><span class="line">&gt;&#125;</span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(s)</span><br><span class="line">&gt;&#125;</span><br><span class="line">&gt;<span class="title function_">sum</span>(<span class="number">5</span>, <span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<p>å‰©ä½™å‚æ•°</p>
<ol>
<li><code>...</code> æ˜¯è¯­æ³•ç¬¦å·ï¼Œç½®äºæœ€æœ«å‡½æ•°å½¢å‚ä¹‹å‰ï¼Œç”¨äºè·å–å¤šä½™çš„å®å‚</li>
<li>å€ŸåŠ© <code>...</code> è·å–çš„å‰©ä½™å®å‚ï¼Œæ˜¯ä¸ª<strong>çœŸæ•°ç»„</strong></li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">config</span>(<span class="params">baseURL, ...other</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(baseURL) <span class="comment">// å¾—åˆ° &#x27;http://baidu.com&#x27;</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(other)  <span class="comment">// other  å¾—åˆ° [&#x27;get&#x27;, &#x27;json&#x27;]</span></span><br><span class="line">&#125;</span><br><span class="line">&gt;<span class="title function_">config</span>(<span class="string">&#x27;http://baidu.com&#x27;</span>, <span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;json&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>ç«‹åˆ»æ‰§è¡Œå‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;(<span class="keyword">function</span>(<span class="params"></span>)&#123; xxx  &#125;)();</span><br></pre></td></tr></table></figure>

<p>åŒ¿åå‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">let</span> fn = <span class="keyword">function</span>(<span class="params"></span>) &#123; </span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å‡½æ•°è¡¨è¾¾å¼&#x27;</span>)</span><br><span class="line">&gt;&#125;</span><br><span class="line">&gt;<span class="keyword">let</span> <span class="title function_">fn</span> = (<span class="params"></span>)=&gt; &#123; </span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ç®­å¤´å‡½æ•°è¡¨è¾¾å¼&#x27;</span>)</span><br><span class="line">&gt;&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>ç®­å¤´å‡½æ•°å±äºè¡¨è¾¾å¼å‡½æ•°ï¼Œå› æ­¤ä¸å­˜åœ¨å‡½æ•°æå‡</li>
<li>ç®­å¤´å‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°æ—¶å¯ä»¥çœç•¥åœ†æ‹¬å· <code>()</code></li>
<li>ç®­å¤´å‡½æ•°å‡½æ•°ä½“åªæœ‰ä¸€è¡Œä»£ç æ—¶å¯ä»¥çœç•¥èŠ±æ‹¬å· <code>&#123;&#125;</code>ï¼Œå¹¶è‡ªåŠ¨åšä¸ºè¿”å›å€¼è¢«è¿”å›</li>
<li>ç®­å¤´å‡½æ•°ä¸­æ²¡æœ‰ <code>arguments</code>ï¼Œåªèƒ½ä½¿ç”¨ <code>...</code> åŠ¨æ€è·å–å®å‚</li>
<li>ç®­å¤´å‡½æ•°ä¸ä¼šåˆ›å»ºè‡ªå·±çš„this,å®ƒåªä¼šä»è‡ªå·±çš„ä½œç”¨åŸŸé“¾çš„ä¸Šä¸€å±‚æ²¿ç”¨thisã€‚</li>
</ol>
</blockquote>
<h3 id="è§£æèµ‹å€¼"><a href="#è§£æèµ‹å€¼" class="headerlink" title="è§£æèµ‹å€¼"></a>è§£æèµ‹å€¼</h3><blockquote>
<p><strong>æ•°ç»„è§£æ„</strong></p>
<p>æ•°ç»„è§£æ„æ˜¯å°†æ•°ç»„çš„å•å…ƒå€¼å¿«é€Ÿæ‰¹é‡èµ‹å€¼ç»™ä¸€ç³»åˆ—å˜é‡çš„ç®€æ´è¯­æ³•</p>
<ol>
<li>èµ‹å€¼è¿ç®—ç¬¦ <code>=</code> å·¦ä¾§çš„ <code>[]</code> ç”¨äºæ‰¹é‡å£°æ˜å˜é‡ï¼Œå³ä¾§æ•°ç»„çš„å•å…ƒå€¼å°†è¢«èµ‹å€¼ç»™å·¦ä¾§çš„å˜é‡</li>
<li>å˜é‡çš„é¡ºåºå¯¹åº”æ•°ç»„å•å…ƒå€¼çš„ä½ç½®ä¾æ¬¡è¿›è¡Œèµ‹å€¼æ“ä½œ</li>
<li>å˜é‡çš„æ•°é‡å¤§äºå•å…ƒå€¼æ•°é‡æ—¶ï¼Œå¤šä½™çš„å˜é‡å°†è¢«èµ‹å€¼ä¸º  <code>undefined</code></li>
<li>å˜é‡çš„æ•°é‡å°äºå•å…ƒå€¼æ•°é‡æ—¶ï¼Œå¯ä»¥é€šè¿‡ <code>...</code> è·å–å‰©ä½™å•å…ƒå€¼ï¼Œä½†åªèƒ½ç½®äºæœ€æœ«ä½</li>
<li>å…è®¸åˆå§‹åŒ–å˜é‡çš„é»˜è®¤å€¼ï¼Œä¸”åªæœ‰å•å…ƒå€¼ä¸º <code>undefined</code> æ—¶é»˜è®¤å€¼æ‰ä¼šç”Ÿæ•ˆ</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="comment">// æ‰¹é‡å£°æ˜å˜é‡ a b c </span></span><br><span class="line"><span class="comment">// åŒæ—¶å°†æ•°ç»„å•å…ƒå€¼ 1 2 3 ä¾æ¬¡èµ‹å€¼ç»™å˜é‡ a b c</span></span><br><span class="line"><span class="keyword">let</span> [a, b, c] = arr</span><br></pre></td></tr></table></figure>

<p><strong>å¯¹è±¡è§£æ„</strong></p>
<ol>
<li>èµ‹å€¼è¿ç®—ç¬¦ <code>=</code> å·¦ä¾§çš„ <code>&#123;&#125;</code> ç”¨äºæ‰¹é‡å£°æ˜å˜é‡ï¼Œå³ä¾§å¯¹è±¡çš„å±æ€§å€¼å°†è¢«èµ‹å€¼ç»™å·¦ä¾§çš„å˜é‡</li>
<li>å¯¹è±¡å±æ€§çš„å€¼å°†è¢«èµ‹å€¼ç»™ä¸å±æ€§åç›¸åŒçš„å˜é‡</li>
<li>å¯¹è±¡ä¸­æ‰¾ä¸åˆ°ä¸å˜é‡åä¸€è‡´çš„å±æ€§æ—¶å˜é‡å€¼ä¸º <code>undefined</code></li>
<li>å…è®¸åˆå§‹åŒ–å˜é‡çš„é»˜è®¤å€¼ï¼Œå±æ€§ä¸å­˜åœ¨æˆ–å•å…ƒå€¼ä¸º <code>undefined</code> æ—¶é»˜è®¤å€¼æ‰ä¼šç”Ÿæ•ˆ</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> user = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// æ‰¹é‡å£°æ˜å˜é‡ name age</span></span><br><span class="line"><span class="comment">// åŒæ—¶å°†æ•°ç»„å•å…ƒå€¼ å°æ˜  18 ä¾æ¬¡èµ‹å€¼ç»™å˜é‡ name  age</span></span><br><span class="line"><span class="keyword">const</span> &#123;name, age&#125; = user</span><br><span class="line"></span><br><span class="line">&gt;<span class="comment">//å¯¹è±¡è§£æ„çš„å˜é‡å å¯ä»¥é‡æ–°æ”¹å  æ—§å˜é‡å: æ–°å˜é‡å</span></span><br><span class="line">&gt;<span class="keyword">const</span> &#123;<span class="attr">username</span>: newUsername, age1&#125; = &#123;<span class="attr">username</span>: <span class="string">&#x27;helo&#x27;</span>, <span class="attr">age1</span>: <span class="number">123</span>&#125;;</span><br><span class="line"></span><br><span class="line">&gt;<span class="comment">//åµŒå¥—</span></span><br><span class="line">&gt;<span class="keyword">const</span> pig = &#123;</span><br><span class="line">  <span class="attr">pname</span>: <span class="string">&#x27;ä½©å¥‡&#x27;</span>,</span><br><span class="line">  <span class="attr">pfamily</span>: &#123;</span><br><span class="line">      <span class="attr">pm</span>: <span class="string">&#x27;çŒªå¦ˆå¦ˆ&#x27;</span>,</span><br><span class="line">      <span class="attr">pf</span>: <span class="string">&#x27;çŒªçˆ¸çˆ¸&#x27;</span>,</span><br><span class="line">      <span class="attr">ps</span>: <span class="string">&#x27;ä¹”æ²»&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&gt;&#125;</span><br><span class="line">&gt;<span class="keyword">const</span> &#123;pname, <span class="attr">pfamily</span>: &#123;pm, pf, ps&#125;&#125; = pig;</span><br></pre></td></tr></table></figure>

<p><strong>æ•°ç»„å¯¹è±¡</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> pigArr = [</span><br><span class="line">  &#123;</span><br><span class="line">      <span class="attr">uname</span>: <span class="string">&#x27;ä½©å¥‡&#x27;</span>,</span><br><span class="line">      <span class="attr">age</span>: <span class="number">6</span></span><br><span class="line">  &#125;</span><br><span class="line">&gt;]</span><br><span class="line">&gt;<span class="keyword">const</span> [&#123;uname, age&#125;] = pigArr;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> piga = [</span><br><span class="line">  &#123;</span><br><span class="line">      <span class="attr">paname</span>: <span class="string">&#x27;ä½©å¥‡&#x27;</span>,</span><br><span class="line">      <span class="attr">pafamily</span>: &#123;</span><br><span class="line">          <span class="attr">pam</span>: <span class="string">&#x27;çŒªå¦ˆå¦ˆ&#x27;</span>,</span><br><span class="line">          <span class="attr">paf</span>: <span class="string">&#x27;çŒªçˆ¸çˆ¸&#x27;</span>,</span><br><span class="line">          <span class="attr">pas</span>: <span class="string">&#x27;ä¹”æ²»&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&gt;];</span><br><span class="line">&gt;<span class="keyword">const</span> [&#123;<span class="attr">paname</span>:name1, <span class="attr">pafamily</span>: &#123;<span class="attr">pam</span>:p1, <span class="attr">paf</span>:p2, <span class="attr">pas</span>:p3&#125;&#125;] = piga;<span class="comment">//æ”¹å</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(name1, p1, p2, p3)</span><br></pre></td></tr></table></figure>


</blockquote>
<h3 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h3><blockquote>
<ol>
<li>å±æ€§éƒ½æ˜¯æˆ å¯¹å‡ºç°çš„ï¼ŒåŒ…æ‹¬å±æ€§åå’Œå€¼ï¼Œå®ƒä»¬ä¹‹é—´ä½¿ç”¨è‹±æ–‡ <code>:</code> åˆ†éš”</li>
<li>å¤šä¸ªå±æ€§ä¹‹é—´ä½¿ç”¨è‹±æ–‡ <code>,</code> åˆ†éš”</li>
<li>å±æ€§å°±æ˜¯ä¾é™„åœ¨å¯¹è±¡ä¸Šçš„å˜é‡</li>
<li>å±æ€§åå¯ä»¥ä½¿ç”¨ <code>&quot;&quot;</code> æˆ– <code>&#39;&#39;</code>ï¼Œä¸€èˆ¬æƒ…å†µä¸‹çœç•¥ï¼Œé™¤éåç§°é‡åˆ°ç‰¹æ®Šç¬¦å·å¦‚ç©ºæ ¼ã€ä¸­æ¨ªçº¿ç­‰</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">let</span> person = &#123;</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span>, <span class="comment">// æè¿°äººçš„å§“å</span></span><br><span class="line">   <span class="attr">age</span>: <span class="number">18</span>, <span class="comment">// æè¿°äººçš„å¹´é¾„</span></span><br><span class="line">   <span class="attr">stature</span>: <span class="number">185</span>, <span class="comment">// æè¿°äººçš„èº«é«˜</span></span><br><span class="line">   <span class="attr">gender</span>: <span class="string">&#x27;ç”·&#x27;</span>, <span class="comment">// æè¿°äººçš„æ€§åˆ«</span></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// å£°æ˜ä¸€ä¸ªç©ºçš„å¯¹è±¡ï¼ˆæ²¡æœ‰ä»»ä½•å±æ€§ï¼‰</span></span><br><span class="line"><span class="keyword">let</span> user = &#123;&#125;</span><br><span class="line"> <span class="comment">// åŠ¨æ€è¿½åŠ å±æ€§</span></span><br><span class="line"> user.<span class="property">name</span> = <span class="string">&#x27;å°æ˜&#x27;</span></span><br><span class="line"> user[<span class="string">&#x27;age&#x27;</span>] = <span class="number">18</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">// åŠ¨æ€æ·»åŠ ä¸ç›´æ¥å®šä¹‰æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯è¯­æ³•ä¸Šæ›´çµæ´»</span></span><br></pre></td></tr></table></figure>

<p>method</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">let</span> person = &#123;</span><br><span class="line">   <span class="comment">// æ–¹æ³•æ˜¯ç”±æ–¹æ³•åå’Œå‡½æ•°ä¸¤éƒ¨åˆ†æ„æˆï¼Œå®ƒä»¬ä¹‹é—´ä½¿ç”¨ : åˆ†éš”</span></span><br><span class="line">   <span class="attr">singing</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">   &#125;,</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">&gt;<span class="comment">// åŠ¨æ€æ·»åŠ æ–¹æ³•</span></span><br><span class="line">&gt;person.<span class="property">move</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;  </span><br></pre></td></tr></table></figure>

<p>éå†</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">for</span>(<span class="keyword">let</span> k <span class="keyword">in</span> obj) &#123;</span><br><span class="line"> <span class="comment">// k å±æ€§å  å­—ç¬¦ä¸²  å¸¦å¼•å·    obj.&#x27;uname&#x27;     k ===  &#x27;uname&#x27;</span></span><br><span class="line"> <span class="comment">// obj[k]  å±æ€§å€¼    obj[&#x27;uname&#x27;]   obj[k]</span></span><br><span class="line">&gt;&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li><strong>æ¨èä½¿ç”¨å­—é¢é‡æ–¹å¼å£°æ˜å¯¹è±¡ï¼Œè€Œä¸æ˜¯ <code>Object</code> æ„é€ å‡½æ•°</strong></li>
<li><strong><code>Object.assign</code> é™æ€æ–¹æ³•åˆ›å»ºæ–°çš„å¯¹è±¡</strong></li>
<li><strong><code>Object.keys</code> é™æ€æ–¹æ³•è·å–å¯¹è±¡ä¸­æ‰€æœ‰å±æ€§</strong></li>
<li><strong><code>Object.values</code> è¡¨æ€æ–¹æ³•è·å–å¯¹è±¡ä¸­æ‰€æœ‰å±æ€§å€¼</strong></li>
</ol>
</blockquote>
<h4 id="Math"><a href="#Math" class="headerlink" title="Math"></a>Math</h4><blockquote>
<p>Math.PI</p>
<p>Math.random</p>
<p>Math.ceil</p>
<p>Math.floor</p>
<p>Math.round</p>
<p>Math.max&#x2F;min</p>
<p>Math.pow</p>
<p>Math.sqrt</p>
</blockquote>
<h4 id="æ—¥æœŸå¯¹è±¡"><a href="#æ—¥æœŸå¯¹è±¡" class="headerlink" title="æ—¥æœŸå¯¹è±¡"></a>æ—¥æœŸå¯¹è±¡</h4><blockquote>
<p>å®ä¾‹åŒ–</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>(); <span class="comment">// ç³»ç»Ÿé»˜è®¤æ—¶é—´</span></span><br><span class="line">&gt;<span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;2020-05-01&#x27;</span>) <span class="comment">// æŒ‡å®šæ—¶é—´</span></span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•</p>
<p><code>getFullYear</code> è·å–å››ä½å¹´ä»½</p>
<p><code>getMonth</code> è·å–æœˆä»½ï¼Œå–å€¼ä¸º 0 ~ 11 (å®é™…æœˆä»½éœ€è¦+1)</p>
<p><code>getDate</code> è·å–æœˆä»½ä¸­çš„æ¯ä¸€å¤©ï¼Œä¸åŒæœˆä»½å–å€¼ä¹Ÿä¸ç›¸åŒ</p>
<p><code>getDay</code> è·å–æ˜ŸæœŸï¼Œå–å€¼ä¸º 0 ~ 6</p>
<p><code>getHours</code> è·å–å°æ—¶ï¼Œå–å€¼ä¸º 0 ~ 23</p>
<p><code>getMinutes</code> è·å–åˆ†é’Ÿï¼Œå–å€¼ä¸º 0 ~ 59</p>
<p><code>getSeconds</code> è·å–ç§’ï¼Œå–å€¼ä¸º 0 ~ 59</p>
<p><strong>æ—¶é—´æˆ³</strong></p>
<p>æ—¶é—´æˆ³æ˜¯æŒ‡1970å¹´01æœˆ01æ—¥00æ—¶00åˆ†00ç§’èµ·è‡³ç°åœ¨çš„æ€»ç§’æ•°æˆ–æ¯«ç§’æ•°ï¼Œå®ƒæ˜¯ä¸€ç§ç‰¹æ®Šçš„è®¡é‡æ—¶é—´çš„æ–¹å¼ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="comment">//è·å–æ—¶é—´æˆ³</span></span><br><span class="line">&gt;<span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">&gt;date.<span class="title function_">getTime</span>()</span><br><span class="line">&gt;+<span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">&gt;<span class="title class_">Date</span>.<span class="title function_">now</span>()</span><br></pre></td></tr></table></figure>


</blockquote>
<h3 id="OOP"><a href="#OOP" class="headerlink" title="OOP"></a>OOP</h3><blockquote>
<p><strong>æ„é€ å‡½æ•°</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">function</span> <span class="title function_">Init</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&gt;<span class="keyword">let</span> obj=<span class="keyword">new</span> <span class="title class_">Init</span>();</span><br></pre></td></tr></table></figure>

<p>æ„é€ å‡½æ•°æ˜¯ä¸“é—¨ç”¨äºåˆ›å»ºå¯¹è±¡çš„å‡½æ•°ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°ä½¿ç”¨ <code>new</code> å…³é”®å­—è°ƒç”¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å°±æ˜¯æ„é€ å‡½æ•°</p>
<p>ä½¿ç”¨ <code>new</code> å…³é”®å­—è°ƒç”¨å‡½æ•°çš„è¡Œä¸ºè¢«ç§°ä¸ºå®ä¾‹åŒ–</p>
<p>å®ä¾‹åŒ–æ„é€ å‡½æ•°æ—¶æ²¡æœ‰å‚æ•°æ—¶å¯ä»¥çœç•¥ <code>()</code></p>
<p>æ„é€ å‡½æ•°çš„è¿”å›å€¼å³ä¸ºæ–°åˆ›å»ºçš„å¯¹è±¡</p>
<p>æ„é€ å‡½æ•°å†…éƒ¨çš„ <code>return</code> è¿”å›çš„å€¼æ— æ•ˆï¼</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;</span><br><span class="line">&gt;<span class="comment">// æ„é€ å‡½æ•°å†…éƒ¨çš„ this å°±æ˜¯å®ä¾‹å¯¹è±¡</span></span><br><span class="line">&gt;<span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;å°æ˜&#x27;</span></span><br><span class="line">&gt;<span class="variable language_">this</span>.<span class="property">sayHi</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">&gt;&#125;</span><br><span class="line">&gt;&#125;</span><br><span class="line">&gt;<span class="comment">// å®ä¾‹åŒ– p1æ˜¯å®ä¾‹å¯¹è±¡</span></span><br><span class="line">&gt;<span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>()</span><br></pre></td></tr></table></figure>

<ol>
<li>æ„é€ å‡½æ•°å†…éƒ¨ <code>this</code> å®é™…ä¸Šå°±æ˜¯å®ä¾‹å¯¹è±¡ï¼Œä¸ºå…¶åŠ¨æ€æ·»åŠ çš„å±æ€§å’Œæ–¹æ³•å³ä¸ºå®ä¾‹æˆå‘˜</li>
<li>ä¸ºæ„é€ å‡½æ•°ä¼ å…¥å‚æ•°ï¼ŒåŠ¨æ€åˆ›å»ºç»“æ„ç›¸åŒä½†å€¼ä¸åŒçš„å¯¹è±¡</li>
</ol>
<p><strong>é™æ€æˆå‘˜</strong></p>
<p>åœ¨ JavaScript ä¸­åº•å±‚å‡½æ•°æœ¬è´¨ä¸Šä¹Ÿæ˜¯å¯¹è±¡ç±»å‹ï¼Œ</p>
<p>å› æ­¤å…è®¸ç›´æ¥ä¸ºå‡½æ•°åŠ¨æ€æ·»åŠ å±æ€§æˆ–æ–¹æ³•ï¼Œæ„é€ å‡½æ•°çš„å±æ€§å’Œæ–¹æ³•è¢«ç§°ä¸ºé™æ€æˆå‘˜ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line"> <span class="comment">// çœç•¥å®ä¾‹æˆå‘˜</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é™æ€å±æ€§</span></span><br><span class="line"><span class="title class_">Person</span>.<span class="property">eyes</span> = <span class="number">2</span></span><br><span class="line"><span class="title class_">Person</span>.<span class="property">arms</span> = <span class="number">2</span></span><br><span class="line"><span class="comment">//é™æ€æ–¹æ³•</span></span><br><span class="line"><span class="title class_">Person</span>.<span class="property">walk</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"><span class="comment">// this æŒ‡å‘ Person</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">eyes</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>é™æ€æˆå‘˜æŒ‡çš„æ˜¯æ·»åŠ åˆ°æ„é€ å‡½æ•°æœ¬èº«çš„å±æ€§å’Œæ–¹æ³•</li>
<li>ä¸€èˆ¬å…¬å…±ç‰¹å¾çš„å±æ€§æˆ–æ–¹æ³•é™æ€æˆå‘˜è®¾ç½®ä¸ºé™æ€æˆå‘˜</li>
<li>é™æ€æˆå‘˜æ–¹æ³•ä¸­çš„ <code>this</code> æŒ‡å‘æ„é€ å‡½æ•°æœ¬èº«</li>
</ol>
<p><strong>å°è£…</strong></p>
<p>å°è£…æ˜¯é¢å‘å¯¹è±¡æ€æƒ³ä¸­æ¯”è¾ƒé‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œjsé¢å‘å¯¹è±¡å¯ä»¥é€šè¿‡æ„é€ å‡½æ•°å®ç°çš„å°è£…ã€‚</p>
<ol>
<li>æ„é€ å‡½æ•°ä½“ç°äº†é¢å‘å¯¹è±¡çš„å°è£…ç‰¹æ€§</li>
<li>æ„é€ å‡½æ•°å®ä¾‹åˆ›å»ºçš„å¯¹è±¡å½¼æ­¤ç‹¬ç«‹ã€äº’ä¸å½±å“</li>
</ol>
</blockquote>
<h3 id="åŸå‹-å¯¹è±¡"><a href="#åŸå‹-å¯¹è±¡" class="headerlink" title="åŸå‹&amp;å¯¹è±¡"></a>åŸå‹&amp;å¯¹è±¡</h3><h4 id="åŸå‹å¯¹è±¡"><a href="#åŸå‹å¯¹è±¡" class="headerlink" title="åŸå‹å¯¹è±¡"></a>åŸå‹å¯¹è±¡</h4><blockquote>
<ul>
<li>JavaScript è§„å®šï¼Œæ¯ä¸€ä¸ªæ„é€ å‡½æ•°éƒ½æœ‰ä¸€ä¸ª <strong>prototype</strong> å±æ€§ï¼ŒæŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿç§°ä¸ºåŸå‹å¯¹è±¡</li>
<li>è¿™ä¸ªå¯¹è±¡å¯ä»¥æŒ‚è½½å‡½æ•°ï¼Œå¯¹è±¡å®ä¾‹åŒ–ä¸ä¼šå¤šæ¬¡åˆ›å»ºåŸå‹ä¸Šå‡½æ•°ï¼ŒèŠ‚çº¦å†…å­˜</li>
<li>æˆ‘ä»¬å¯ä»¥æŠŠé‚£äº›ä¸å˜çš„æ–¹æ³•ï¼Œç›´æ¥å®šä¹‰åœ¨ prototype å¯¹è±¡ä¸Šï¼Œè¿™æ ·æ‰€æœ‰å¯¹è±¡çš„å®ä¾‹å°±å¯ä»¥å…±äº«è¿™äº›æ–¹æ³•ã€‚</li>
<li>æ„é€ å‡½æ•°å’ŒåŸå‹å¯¹è±¡ä¸­çš„this éƒ½æŒ‡å‘ å®ä¾‹åŒ–çš„å¯¹è±¡</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="comment">// æ¯ä¸ªå‡½æ•°éƒ½æœ‰ prototype å±æ€§</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="comment">// ä¸ºæ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡æ·»åŠ æ–¹æ³•</span></span><br><span class="line"> <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayHi</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Hi~&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å½“è®¿é—®å¯¹è±¡çš„å±æ€§æˆ–æ–¹æ³•æ—¶ï¼Œå…ˆåœ¨å½“å‰å®ä¾‹å¯¹è±¡æ˜¯æŸ¥æ‰¾ï¼Œ</strong></p>
<p><strong>ç„¶åå†å»åŸå‹å¯¹è±¡æŸ¥æ‰¾ï¼Œå¹¶ä¸”åŸå‹å¯¹è±¡è¢«æ‰€æœ‰å®ä¾‹å…±äº«</strong></p>
<p><strong>constructor</strong></p>
<p>æ¯ä¸ªåŸå‹å¯¹è±¡é‡Œé¢éƒ½æœ‰ä¸ªconstructor å±æ€§ï¼ˆconstructor æ„é€ å‡½æ•°ï¼‰</p>
<p>è¯¥å±æ€§æŒ‡å‘è¯¥åŸå‹å¯¹è±¡çš„æ„é€ å‡½æ•°</p>
<blockquote>
<p>å¦‚æœæœ‰å¤šä¸ªå¯¹è±¡çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ç»™åŸå‹å¯¹è±¡é‡‡å–å¯¹è±¡å½¢å¼èµ‹å€¼.</p>
</blockquote>
<blockquote>
<p>ä½†æ˜¯è¿™æ ·å°±ä¼šè¦†ç›–æ„é€ å‡½æ•°åŸå‹å¯¹è±¡åŸæ¥çš„å†…å®¹ï¼Œè¿™æ ·ä¿®æ”¹åçš„åŸå‹å¯¹è±¡ constructor å°±ä¸å†æŒ‡å‘å½“å‰æ„é€ å‡½æ•°äº†</p>
</blockquote>
<blockquote>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¿®æ”¹åçš„åŸå‹å¯¹è±¡ä¸­ï¼Œæ·»åŠ ä¸€ä¸ª constructor æŒ‡å‘åŸæ¥çš„æ„é€ å‡½æ•°ã€‚</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="comment">//æ¯ä¸€ä¸ªconstruct func éƒ½æœ‰ä¸€ä¸ªprototypeå±æ€§æŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡,ç§°ä¹‹ä¸ºåŸå‹å¯¹è±¡</span></span><br><span class="line">&gt;<span class="comment">//å¯¹è±¡å®ä¾‹åŒ–ä¸ä¼šåˆ›å»ºåŸå‹å¯¹è±¡,è§£å†³å†…å­˜ </span></span><br><span class="line">&gt;<span class="keyword">function</span> <span class="title function_">Star</span>(<span class="params">uname,myage</span>)&#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span>=uname;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span>=myage;</span><br><span class="line">&gt;&#125;</span><br><span class="line">&gt;<span class="title class_">Star</span>.<span class="property"><span class="keyword">prototype</span></span>=&#123;</span><br><span class="line">  <span class="attr">constructor</span>:<span class="title class_">Star</span>,<span class="comment">//æ·»åŠ ä¸€ä¸ª constructor æŒ‡å‘åŸæ¥çš„æ„é€ å‡½æ•°ã€‚</span></span><br><span class="line">  <span class="attr">sing</span>:<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;prototype sing &#x27;</span>,<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">say</span>:<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>,<span class="string">&#x27; say &#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&gt;&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="å¯¹è±¡åŸå‹"><a href="#å¯¹è±¡åŸå‹" class="headerlink" title="å¯¹è±¡åŸå‹"></a>å¯¹è±¡åŸå‹</h4><blockquote>
<p>å¯¹è±¡éƒ½ä¼šæœ‰ä¸€ä¸ªå±æ€§ <code>__proto__</code> æŒ‡å‘æ„é€ å‡½æ•°çš„ prototype åŸå‹å¯¹è±¡ï¼Œä¹‹æ‰€ä»¥æˆ‘ä»¬å¯¹è±¡å¯ä»¥ä½¿ç”¨æ„é€ å‡½æ•° prototype </p>
<p>åŸå‹å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼Œå°±æ˜¯å› ä¸ºå¯¹è±¡æœ‰ <code>__proto__</code> åŸå‹çš„å­˜åœ¨ã€‚</p>
<ul>
<li><code>__proto__</code>  æ˜¯JSéæ ‡å‡†å±æ€§</li>
<li>[[prototype]]å’Œ<code>__proto__</code> æ„ä¹‰ç›¸åŒ</li>
<li>ç”¨æ¥è¡¨æ˜å½“å‰å®ä¾‹å¯¹è±¡æŒ‡å‘å“ªä¸ªåŸå‹å¯¹è±¡prototype</li>
<li><code>__proto__</code> å¯¹è±¡åŸå‹é‡Œé¢ä¹Ÿæœ‰ä¸€ä¸ª constructorå±æ€§ï¼ŒæŒ‡å‘åˆ›å»ºè¯¥å®ä¾‹å¯¹è±¡çš„æ„é€ å‡½æ•°</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">function</span> <span class="title function_">Star</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&gt;<span class="keyword">let</span> s1 = <span class="keyword">new</span> <span class="title class_">Star</span>();</span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(s1.<span class="property">__proto__</span>===<span class="title class_">Star</span>.<span class="property"><span class="keyword">prototype</span></span>);<span class="comment">//true</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(s1.<span class="property">__proto__</span>.<span class="property">constructor</span>===<span class="title class_">Star</span>);<span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<p><strong>åŸå‹ç»§æ‰¿</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>)&#123;</span><br><span class="line"> <span class="variable language_">this</span>.<span class="property">eyes</span>=<span class="number">2</span>;</span><br><span class="line"> <span class="variable language_">this</span>.<span class="property">head</span>=<span class="number">1</span>;</span><br><span class="line">&gt;&#125;</span><br><span class="line"></span><br><span class="line">&gt;<span class="comment">//é€šè¿‡åŸå‹å‡½æ•°ç»§æ‰¿Person</span></span><br><span class="line">&gt;<span class="keyword">function</span> <span class="title function_">Woman</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Woman init succeed&#x27;</span>);</span><br><span class="line">&gt;&#125;</span><br><span class="line"></span><br><span class="line">&gt;<span class="title class_">Woman</span>.<span class="property"><span class="keyword">prototype</span></span>=<span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">&gt;<span class="title class_">Woman</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span>=<span class="title class_">Woman</span>;<span class="comment">//æŒ‡å›å»</span></span><br><span class="line">&gt;<span class="title class_">Woman</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">baby</span>=<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;baby&#x27;</span>)</span><br><span class="line">&gt;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;<span class="keyword">const</span> red = <span class="keyword">new</span> <span class="title class_">Woman</span>();</span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(red.<span class="property">head</span>)<span class="comment">//1 </span></span><br><span class="line">&gt;red.<span class="title function_">baby</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>åŸå‹é“¾</strong></p>
<p>åŸºäºåŸå‹å¯¹è±¡çš„ç»§æ‰¿ä½¿å¾—ä¸åŒæ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡å…³è”åœ¨ä¸€èµ·ï¼Œå¹¶ä¸”è¿™ç§å…³è”çš„å…³ç³»æ˜¯ä¸€ç§é“¾çŠ¶çš„ç»“æ„ï¼Œæˆ‘ä»¬å°†åŸå‹è±¡çš„é“¾çŠ¶ç»“æ„å…³ç³»ç§°ä¸ºåŸå‹é“¾</p>
<p><img src="/./../pic/javaScript/image-20240127225346885.png" alt="image-20240127225346885"></p>
<p>â‘  å½“è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼ˆåŒ…æ‹¬æ–¹æ³•)æ—¶ï¼Œé¦–å…ˆæŸ¥æ‰¾è¿™ä¸ªå¯¹è±¡è‡ªèº«æœ‰æ²¡æœ‰è¯¥å±æ€§ã€‚</p>
<p>â‘¡ å¦‚æœæ²¡æœ‰å°±æŸ¥æ‰¾å®ƒçš„åŸå‹ï¼ˆä¹Ÿå°±æ˜¯ <code>__proto__</code>æŒ‡å‘çš„ prototype åŸå‹å¯¹è±¡ï¼‰</p>
<p>â‘¢ å¦‚æœè¿˜æ²¡æœ‰å°±æŸ¥æ‰¾åŸå‹å¯¹è±¡çš„åŸå‹ï¼ˆObjectçš„åŸå‹å¯¹è±¡ï¼‰</p>
<p>â‘£ ä¾æ­¤ç±»æ¨ä¸€ç›´æ‰¾åˆ° Object ä¸ºæ­¢ï¼ˆnullï¼‰</p>
<p>â‘¤ <code>__proto__</code>å¯¹è±¡åŸå‹çš„æ„ä¹‰å°±åœ¨äºä¸ºå¯¹è±¡æˆå‘˜æŸ¥æ‰¾æœºåˆ¶æä¾›ä¸€ä¸ªæ–¹å‘ï¼Œæˆ–è€…è¯´ä¸€æ¡è·¯çº¿</p>
<p>â‘¥ å¯ä»¥ä½¿ç”¨ instanceof è¿ç®—ç¬¦ç”¨äºæ£€æµ‹æ„é€ å‡½æ•°çš„ prototype å±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Š</p>
</blockquote>
<h3 id="WEB-APIS"><a href="#WEB-APIS" class="headerlink" title="WEB APIS"></a>WEB APIS</h3><h4 id="BOMå¯¹è±¡"><a href="#BOMå¯¹è±¡" class="headerlink" title="BOMå¯¹è±¡"></a>BOMå¯¹è±¡</h4><h5 id="location"><a href="#location" class="headerlink" title="location"></a>location</h5><blockquote>
<p>location (åœ°å€) å®ƒæ‹†åˆ†å¹¶ä¿å­˜äº† URL åœ°å€çš„å„ä¸ªç»„æˆéƒ¨åˆ†ï¼Œ å®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡</p>
<table>
<thead>
<tr>
<th>å±æ€§&#x2F;æ–¹æ³•</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>href</td>
<td>å±æ€§ï¼Œè·å–å®Œæ•´çš„ URL åœ°å€ï¼Œèµ‹å€¼æ—¶ç”¨äºåœ°å€çš„è·³è½¬</td>
</tr>
<tr>
<td>search</td>
<td>å±æ€§ï¼Œè·å–åœ°å€ä¸­æºå¸¦çš„å‚æ•°ï¼Œç¬¦å· ï¼Ÿåé¢éƒ¨åˆ†</td>
</tr>
<tr>
<td>hash</td>
<td>å±æ€§ï¼Œè·å–åœ°å€ä¸­çš„å•¥å¸Œå€¼ï¼Œç¬¦å· # åé¢éƒ¨åˆ†</td>
</tr>
<tr>
<td>reload()</td>
<td>æ–¹æ³•ï¼Œç”¨æ¥åˆ·æ–°å½“å‰é¡µé¢ï¼Œä¼ å…¥å‚æ•° true æ—¶è¡¨ç¤ºå¼ºåˆ¶åˆ·æ–°</td>
</tr>
</tbody></table>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="comment">// 1. hrefå±æ€§ ï¼ˆé‡ç‚¹ï¼‰ å¾—åˆ°å®Œæ•´åœ°å€ï¼Œèµ‹å€¼åˆ™æ˜¯è·³è½¬åˆ°æ–°åœ°å€</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(location.<span class="property">href</span>)</span><br><span class="line">&gt;<span class="comment">// location.href = &#x27;http://www.abc.cn&#x27;</span></span><br><span class="line"></span><br><span class="line">&gt;<span class="comment">// 2. searchå±æ€§  å¾—åˆ° ? åé¢çš„åœ°å€ </span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(location.<span class="property">search</span>)  <span class="comment">// ?search=ç¬”è®°æœ¬</span></span><br><span class="line"></span><br><span class="line">&gt;<span class="comment">// 3. hashå±æ€§  å¾—åˆ° # åé¢çš„åœ°å€</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(location.<span class="property">hash</span>)</span><br><span class="line"></span><br><span class="line">&gt;<span class="comment">// 4. reload æ–¹æ³•  åˆ·æ–°é¡µé¢</span></span><br><span class="line">&gt;<span class="keyword">const</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.reload&#x27;</span>)</span><br><span class="line">&gt;btn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"><span class="comment">// location.reload() // é¡µé¢åˆ·æ–°</span></span><br><span class="line">location.<span class="title function_">reload</span>(<span class="literal">true</span>) <span class="comment">// å¼ºåˆ¶é¡µé¢åˆ·æ–° ctrl+f5</span></span><br><span class="line">&gt;&#125;)</span><br></pre></td></tr></table></figure>


</blockquote>
<h5 id="navigator"><a href="#navigator" class="headerlink" title="navigator"></a>navigator</h5><blockquote>
<p>è¯¥å¯¹è±¡ä¸‹è®°å½•äº†æµè§ˆå™¨è‡ªèº«çš„ç›¸å…³ä¿¡æ¯</p>
<ul>
<li>é€šè¿‡ userAgent æ£€æµ‹æµè§ˆå™¨çš„ç‰ˆæœ¬åŠå¹³å°</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="comment">//Â æ£€æµ‹Â userAgentï¼ˆæµè§ˆå™¨ä¿¡æ¯ï¼‰</span></span><br><span class="line">&gt;(<span class="keyword">function</span>Â (<span class="params"></span>)Â &#123;</span><br><span class="line"><span class="keyword">const</span>Â userAgentÂ =Â navigator.<span class="property">userAgent</span></span><br><span class="line"><span class="comment">//Â éªŒè¯æ˜¯å¦ä¸ºAndroidæˆ–iPhone</span></span><br><span class="line"><span class="keyword">const</span>Â androidÂ =Â userAgent.<span class="title function_">match</span>(<span class="regexp">/(Android);?[\s\/]+([\d.]+)?/</span>)</span><br><span class="line"><span class="keyword">const</span>Â iphoneÂ =Â userAgent.<span class="title function_">match</span>(<span class="regexp">/(iPhone\sOS)\s([\d_]+)/</span>)</span><br><span class="line"><span class="comment">//Â å¦‚æœæ˜¯Androidæˆ–iPhoneï¼Œåˆ™è·³è½¬è‡³ç§»åŠ¨ç«™ç‚¹</span></span><br><span class="line"><span class="keyword">if</span>Â (androidÂ ||Â iphone)Â &#123;</span><br><span class="line">  location.<span class="property">href</span>Â =Â <span class="string">&#x27;http://m.itcast.cn&#x27;</span></span><br><span class="line">&#125;&#125;)();</span><br></pre></td></tr></table></figure>


</blockquote>
<h5 id="history"><a href="#history" class="headerlink" title="history"></a>history</h5><blockquote>
<p>history (å†å²)æ˜¯å¯¹è±¡ï¼Œä¸»è¦ç®¡ç†å†å²è®°å½•ï¼Œ è¯¥å¯¹è±¡ä¸æµè§ˆå™¨åœ°å€æ çš„æ“ä½œç›¸å¯¹åº”ï¼Œå¦‚å‰è¿›ã€åé€€ç­‰</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="comment">// 1.å‰è¿›</span></span><br><span class="line">&gt;<span class="keyword">const</span> forward = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.forward&#x27;</span>)</span><br><span class="line">&gt;forward.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"><span class="comment">// history.forward() </span></span><br><span class="line">history.<span class="title function_">go</span>(<span class="number">1</span>)</span><br><span class="line">&gt;&#125;)</span><br><span class="line">&gt;<span class="comment">// 2.åé€€</span></span><br><span class="line">&gt;<span class="keyword">const</span> back = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.back&#x27;</span>)</span><br><span class="line">&gt;back.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"><span class="comment">// history.back()</span></span><br><span class="line">history.<span class="title function_">go</span>(-<span class="number">1</span>)</span><br><span class="line">&gt;&#125;)</span><br></pre></td></tr></table></figure>


</blockquote>
<h5 id="storage"><a href="#storage" class="headerlink" title="storage"></a>storage</h5><blockquote>
<p><strong>localStorage</strong></p>
<ul>
<li>æ•°æ®å¯ä»¥é•¿æœŸä¿ç•™åœ¨æœ¬åœ°æµè§ˆå™¨ä¸­ï¼Œåˆ·æ–°é¡µé¢å’Œå…³é—­é¡µé¢ï¼Œæ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±</li>
<li>ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨ï¼Œå¹¶ä¸”å­˜å‚¨çš„æ˜¯å­—ç¬¦ä¸²ï¼Œ çœç•¥äº†window</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;age&#x27;</span>, <span class="number">18</span>)</span><br><span class="line">&gt;<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;age&#x27;</span>)</span><br><span class="line">&gt;<span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&#x27;age&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>localStorage å­˜å‚¨å¤æ‚æ•°æ®ç±»å‹</strong></p>
<p>æœ¬åœ°åªèƒ½å­˜å‚¨å­—ç¬¦ä¸²,æ— æ³•å­˜å‚¨å¤æ‚æ•°æ®ç±»å‹,éœ€è¦å°†å¤æ‚æ•°æ®ç±»å‹è½¬æ¢æˆ JSONå­—ç¬¦ä¸²,åœ¨å­˜å‚¨åˆ°æœ¬åœ°</p>
<p><code>JSON.stringify(å¤æ‚æ•°æ®ç±»å‹)</code></p>
<ul>
<li>é¦–å…ˆæ˜¯1ä¸ªå­—ç¬¦ä¸²</li>
<li>å±æ€§åä½¿ç”¨åŒå¼•å·å¼•èµ·æ¥ï¼Œä¸èƒ½å•å¼•å·</li>
<li>å±æ€§å€¼å¦‚æœæ˜¯å­—ç¬¦ä¸²å‹ä¹Ÿå¿…é¡»åŒå¼•å·</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> goods = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;å°ç±³&#x27;</span>,</span><br><span class="line">  <span class="attr">price</span>: <span class="number">1999</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;goods&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(goods))</span><br></pre></td></tr></table></figure>

<p>æŠŠå–å‡ºæ¥çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¯¹è±¡</p>
<p><code>JSON.parse(JSONå­—ç¬¦ä¸²)</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;goods&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p><strong>sessionStorage</strong></p>
<ul>
<li>ç”¨æ³•è·ŸlocalStorageåŸºæœ¬ç›¸åŒ</li>
<li>åŒºåˆ«æ˜¯ï¼šå½“é¡µé¢æµè§ˆå™¨è¢«å…³é—­æ—¶ï¼Œå­˜å‚¨åœ¨ sessionStorage çš„æ•°æ®ä¼šè¢«æ¸…é™¤</li>
</ul>
</blockquote>
<h4 id="DOM"><a href="#DOM" class="headerlink" title="DOM"></a>DOM</h4><blockquote>
<p>DOM æ˜¯ç”¨æ¥åŠ¨æ€ä¿®æ”¹ HTML çš„ï¼Œå…¶ç›®çš„æ˜¯å¼€å‘ç½‘é¡µç‰¹æ•ˆåŠç”¨æˆ·äº¤äº’ã€‚</p>
<p><strong>è·å–domå¯¹è±¡</strong></p>
<p><code>querySelector</code> <code>querySelectorAll</code> <code>getElementById</code> <code>getElementsByTagName</code></p>
<p><strong>æ“ä½œå…ƒç´ å†…å®¹</strong></p>
<p><code>innerText</code> å°†æ–‡æœ¬å†…å®¹æ·»åŠ &#x2F;æ›´æ–°åˆ°ä»»æ„æ ‡ç­¾ä½ç½®ï¼Œæ–‡æœ¬ä¸­åŒ…å«çš„æ ‡ç­¾ä¸ä¼šè¢«è§£æ</p>
<p><code>innerHTML</code> å°†æ–‡æœ¬å†…å®¹æ·»åŠ &#x2F;æ›´æ–°åˆ°ä»»æ„æ ‡ç­¾ä½ç½®ï¼Œæ–‡æœ¬ä¸­åŒ…å«çš„æ ‡ç­¾ä¼šè¢«è§£æ</p>
<p><strong>æ“ä½œå…ƒç´ å±æ€§</strong></p>
<p>ç›´æ¥å±æ€§åä¿®æ”¹</p>
<blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> pic = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.pic&#x27;</span>)</span><br><span class="line">&gt;<span class="comment">// 2. ä¿®æ”¹å±æ€§</span></span><br><span class="line">&gt;pic.<span class="property">src</span> = <span class="string">&#x27;./images/lion.webp&#x27;</span></span><br><span class="line">&gt;pic.<span class="property">width</span> = <span class="number">400</span>;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>ä¿®æ”¹style</p>
<blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.intro&#x27;</span>)</span><br><span class="line">&gt;box.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&#x27;red&#x27;</span></span><br><span class="line">&gt;box.<span class="property">style</span>.<span class="property">width</span> = <span class="string">&#x27;300px&#x27;</span></span><br><span class="line">&gt;<span class="comment">//æ”¹æˆé©¼å³°æ³•</span></span><br><span class="line">&gt;box.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&#x27;pink&#x27;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>æ“ä½œclassList</p>
<blockquote>
<p>å…ƒç´ .classList.contains() çœ‹çœ‹æœ‰æ²¡æœ‰åŒ…å«æŸä¸ªç±»ï¼Œå¦‚æœæœ‰åˆ™è¿”å›trueï¼Œä¹ˆæœ‰åˆ™è¿”å›false</p>
<p>classList.add(â€˜ â€˜) å¢åŠ ç±»</p>
<p>classList.remove(â€˜ â€˜)åˆ é™¤ç±»</p>
<p>classList.toggle(â€˜ â€˜)åˆ‡æ¢ç±»</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"> &lt;style&gt;</span><br><span class="line">&gt;div &#123;</span><br><span class="line"> <span class="attr">width</span>: 200px;</span><br><span class="line"> <span class="attr">height</span>: 200px;</span><br><span class="line"> background-<span class="attr">color</span>: pink;</span><br><span class="line">&gt;&#125;</span><br><span class="line"></span><br><span class="line">&gt;.<span class="property">active</span> &#123;</span><br><span class="line"> <span class="attr">width</span>: 300px;</span><br><span class="line"> <span class="attr">height</span>: 300px;</span><br><span class="line"> background-<span class="attr">color</span>: hotpink;</span><br><span class="line"> margin-<span class="attr">left</span>: 100px;</span><br><span class="line">&gt;&#125;</span><br><span class="line">&gt;&lt;/style&gt;</span><br><span class="line">&gt;<span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">&gt;<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;one&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&gt;<span class="keyword">let</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&gt;<span class="comment">// addæ˜¯ä¸ªæ–¹æ³• æ·»åŠ   è¿½åŠ </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&gt;box.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;active&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&gt;<span class="comment">// remove() ç§»é™¤ ç±»</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&gt;box.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;one&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&gt;<span class="comment">// åˆ‡æ¢ç±»</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&gt;box.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">&#x27;one&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">&gt;<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p><strong>æ“ä½œè¡¨å•å…ƒç´ å±æ€§</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;è¯·è¾“å…¥&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">disabled</span>&gt;</span>æŒ‰é’®<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;agree&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// 1. è·å–å…ƒç´ </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">let</span> input = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;input&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// 2. å–å€¼æˆ–è€…è®¾ç½®å€¼  å¾—åˆ°inputé‡Œé¢çš„å€¼å¯ä»¥ç”¨ value</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        input.<span class="property">value</span> = <span class="string">&#x27;å°ç±³æ‰‹æœº&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        input.<span class="property">type</span> = <span class="string">&#x27;password&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// 2. å¯ç”¨æŒ‰é’®</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">let</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// disabled ä¸å¯ç”¨   =  false  è¿™æ ·å¯ä»¥è®©æŒ‰é’®å¯ç”¨</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        btn.<span class="property">disabled</span> = <span class="literal">false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// 3. å‹¾é€‰å¤é€‰æ¡†</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">let</span> checkbox = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.agree&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        checkbox.<span class="property">checked</span> = <span class="literal">false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br></pre></td></tr></table></figure>



<p><strong>è‡ªå®šä¹‰å±æ€§</strong></p>
<blockquote>
<p>åœ¨html5ä¸­æ¨å‡ºæ¥äº†ä¸“é—¨çš„data-è‡ªå®šä¹‰å±æ€§  </p>
<p>åœ¨æ ‡ç­¾ä¸Šä¸€å¾‹ä»¥data-å¼€å¤´</p>
<p>åœ¨DOMå¯¹è±¡ä¸Šä¸€å¾‹ä»¥datasetå¯¹è±¡æ–¹å¼è·å–</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&gt;<span class="tag">&lt;<span class="name">div</span> <span class="attr">data-id</span>=<span class="string">&quot;1&quot;</span>&gt;</span> è‡ªå®šä¹‰å±æ€§ <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&gt;// 1. è·å–å…ƒç´ </span><br><span class="line">&gt;let div = document.querySelector(&#x27;div&#x27;)// 2. è·å–è‡ªå®šä¹‰å±æ€§å€¼</span><br><span class="line">&gt;console.log(div.dataset.id)</span><br></pre></td></tr></table></figure>


</blockquote>
</blockquote>
<h4 id="domèŠ‚ç‚¹å¢åˆ "><a href="#domèŠ‚ç‚¹å¢åˆ " class="headerlink" title="domèŠ‚ç‚¹å¢åˆ "></a>domèŠ‚ç‚¹å¢åˆ </h4><blockquote>
<p><strong>å¢åŠ </strong></p>
<ul>
<li><p><code>createElement</code> åŠ¨æ€åˆ›å»ºä»»æ„ DOM èŠ‚ç‚¹</p>
</li>
<li><p><code>cloneNode</code> å¤åˆ¶ç°æœ‰çš„ DOM èŠ‚ç‚¹ï¼Œä¼ å…¥å‚æ•° true ä¼šå¤åˆ¶æ‰€æœ‰å­èŠ‚ç‚¹</p>
</li>
<li><p><code>insertBefore</code> åœ¨çˆ¶èŠ‚ç‚¹ä¸­ä»»æ„å­èŠ‚ç‚¹ä¹‹å‰æ’å…¥æ–°èŠ‚ç‚¹</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> p = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">&gt;p.<span class="property">innerText</span> = <span class="string">&#x27;åˆ›å»ºçš„æ–°çš„pæ ‡ç­¾&#x27;</span></span><br><span class="line">&gt;p.<span class="property">className</span> = <span class="string">&#x27;info&#x27;</span></span><br></pre></td></tr></table></figure>

<p>å¤åˆ¶</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> p2 = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;p&#x27;</span>).<span class="title function_">cloneNode</span>(<span class="literal">true</span>)</span><br><span class="line">&gt;p2.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&#x27;red&#x27;</span></span><br></pre></td></tr></table></figure>

<p>æ’å…¥ç›’å­</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.box&#x27;</span>).<span class="title function_">appendChild</span>(p)</span><br><span class="line">&gt;<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.box&#x27;</span>).<span class="title function_">appendChild</span>(p2)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> relative = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;li:nth-child(2)&#x27;</span>)</span><br><span class="line">&gt;<span class="keyword">const</span> li1 = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;li&#x27;</span>)</span><br><span class="line">&gt;<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;ul&#x27;</span>).<span class="title function_">insertBefore</span>(li1, relative)</span><br></pre></td></tr></table></figure>

<p><strong>åˆ é™¤</strong></p>
<p><code>removeChild</code> åˆ é™¤èŠ‚ç‚¹æ—¶ä¸€å®šæ˜¯ç”±çˆ¶å­å…³ç³»</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">let</span> ul = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;ul&#x27;</span>) <span class="comment">// è·å– ul çˆ¶èŠ‚ç‚¹</span></span><br><span class="line">&gt;<span class="keyword">let</span> lis = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;li&#x27;</span>) <span class="comment">// å¾…åˆ é™¤çš„å­èŠ‚ç‚¹</span></span><br><span class="line">&gt;ul.<span class="title function_">removeChild</span>(lis[<span class="number">0</span>]) <span class="comment">// åˆ é™¤èŠ‚ç‚¹</span></span><br></pre></td></tr></table></figure>



<p><strong>æŸ¥æ‰¾</strong></p>
<ul>
<li><code>childNodes</code> è·å–å…¨éƒ¨çš„å­èŠ‚ç‚¹ï¼Œå›è½¦æ¢è¡Œä¼šè¢«è®¤ä¸ºæ˜¯ç©ºç™½æ–‡æœ¬èŠ‚ç‚¹</li>
<li><code>children</code> åªè·å–å…ƒç´ ç±»å‹èŠ‚ç‚¹</li>
<li><code>parentNode</code>è·å–çˆ¶èŠ‚ç‚¹</li>
<li><code>previousSibling</code> è·å–å‰ä¸€ä¸ªèŠ‚ç‚¹</li>
<li><code>nextSibling</code> è·å–åä¸€ä¸ªèŠ‚ç‚¹</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> ul = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;ul&#x27;</span>)</span><br><span class="line">&gt;<span class="comment">// æ‰€æœ‰çš„å­èŠ‚ç‚¹</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(ul.<span class="property">childNodes</span>)</span><br><span class="line">&gt;<span class="comment">// åªåŒ…å«å…ƒç´ å­èŠ‚ç‚¹</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(ul.<span class="property">children</span>)</span><br><span class="line">&gt;<span class="comment">// çˆ¶èŠ‚ç‚¹</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">parentNode</span>);</span><br><span class="line">&gt;<span class="comment">// çˆ·çˆ·èŠ‚ç‚¹</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">parentNode</span>.<span class="property">parentNode</span>); </span><br><span class="line">&gt;<span class="comment">// å‰ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">previousSibling</span>)</span><br><span class="line">&gt;<span class="comment">// ä¸‹ä¸€ä¸‹èŠ‚ç‚¹</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">nextSibling</span>)</span><br></pre></td></tr></table></figure>


</blockquote>
<h4 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶</h4><blockquote>
<p><code>addEventListener</code> æ˜¯ DOM å¯¹è±¡ä¸“é—¨ç”¨æ¥æ·»åŠ äº‹ä»¶ç›‘å¬çš„æ–¹æ³•ï¼Œå®ƒçš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«ä¸ºã€äº‹ä»¶ç±»å‹ã€‘å’Œã€äº‹ä»¶å›è°ƒã€‘ã€‚</p>
<ol>
<li>è·å– DOM å…ƒç´ </li>
<li>é€šè¿‡ <code>addEventListener</code> æ–¹æ³•ä¸º DOM èŠ‚ç‚¹æ·»åŠ äº‹ä»¶ç›‘å¬</li>
<li>ç­‰å¾…äº‹ä»¶è§¦å‘ï¼Œå¦‚ç”¨æˆ·ç‚¹å‡»äº†æŸä¸ªæŒ‰é’®æ—¶ä¾¿ä¼šè§¦å‘ <code>click</code> äº‹ä»¶ç±»å‹</li>
<li>äº‹ä»¶è§¦å‘åï¼Œç›¸å¯¹åº”çš„å›è°ƒå‡½æ•°ä¼šè¢«æ‰§è¡Œ</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#btn&#x27;</span>)</span><br><span class="line"><span class="comment">// 2. æ·»åŠ äº‹ä»¶ç›‘å¬</span></span><br><span class="line">btn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// æ”¹å˜ p æ ‡ç­¾çš„æ–‡å­—é¢œè‰²</span></span><br><span class="line">  <span class="keyword">let</span> text = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;text&#x27;</span>)</span><br><span class="line">  text.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&#x27;red&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>äº‹ä»¶ç±»å‹</strong></p>
<blockquote>
<p><code>mouseenter/mouseleave </code> ç›‘å¬é¼ æ ‡æ˜¯å¦ç§»å…¥&#x2F;ç§»é™¤ DOM å…ƒç´  </p>
</blockquote>
<blockquote>
<p><code>keydown/keyup</code>é”®ç›˜æŒ‰ä¸‹&#x2F;æŠ¬èµ·è§¦å‘</p>
</blockquote>
<blockquote>
<p><code>focus/blur</code>è·å¾—&#x2F;å¤±å»ç„¦ç‚¹</p>
</blockquote>
<blockquote>
<p><code>input</code>æ–‡æœ¬æ¡†è¾“å‡ºäº‹ä»¶</p>
</blockquote>
<blockquote>
<p><code>click</code>é¼ æ ‡ç‚¹å‡»</p>
</blockquote>
<blockquote>
<p><code>change </code>ç»™inputæ³¨å†Œ,å€¼è¢«ä¿®æ”¹åå¹¶ä¸”å¤±å»ç„¦ç‚¹åè§¦å‘</p>
</blockquote>
<p><strong>äº‹ä»¶å¯¹è±¡</strong></p>
<p>ä»»æ„äº‹ä»¶ç±»å‹è¢«è§¦å‘æ—¶ä¸äº‹ä»¶ç›¸å…³çš„ä¿¡æ¯ä¼šè¢«ä»¥å¯¹è±¡çš„å½¢å¼è®°å½•ä¸‹æ¥ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªå¯¹è±¡ä¸ºäº‹ä»¶å¯¹è±¡ã€‚</p>
<blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;&gt;box.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ä»»æ„äº‹ä»¶ç±»å‹è¢«è§¦å‘åï¼Œç›¸å…³ä¿¡æ¯ä¼šä»¥å¯¹è±¡å½¢å¼è¢«è®°å½•ä¸‹æ¥...&#x27;</span>);</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<pre><code> // äº‹ä»¶å›è°ƒå‡½æ•°çš„ç¬¬1ä¸ªå‚æ•°å³æ‰€è°“çš„äº‹ä»¶å¯¹è±¡
 console.log(e)
 &#125;)

 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">     </span><br></pre></td></tr></table></figure>
</code></pre>
</blockquote>
<blockquote>
<ol>
<li><code>e.type</code> å½“å‰äº‹ä»¶çš„ç±»å‹</li>
<li><code>e.clientX/Y</code> å…‰æ ‡ç›¸å¯¹æµè§ˆå™¨çª—å£çš„ä½ç½®</li>
<li><code>e.offsetX/Y</code> å…‰æ ‡ç›¸äºå½“å‰ DOM å…ƒç´ çš„ä½ç½®</li>
</ol>
</blockquote>
<p><strong>äº‹ä»¶æµ</strong></p>
<p>äº‹ä»¶æµæ˜¯å¯¹äº‹ä»¶æ‰§è¡Œè¿‡ç¨‹çš„æè¿°</p>
<p>ä»»æ„äº‹ä»¶è¢«è§¦å‘æ—¶æ€»ä¼šç»å†ä¸¤ä¸ªé˜¶æ®µï¼šã€æ•è·é˜¶æ®µã€‘å’Œã€å†’æ³¡é˜¶æ®µã€‘ã€‚</p>
<p>æ•è·é˜¶æ®µæ˜¯ã€ä»çˆ¶åˆ°å­ã€‘çš„ä¼ å¯¼è¿‡ç¨‹ï¼Œå†’æ³¡é˜¶æ®µæ˜¯ã€ä»å­å‘çˆ¶ã€‘çš„ä¼ å¯¼è¿‡ç¨‹ã€‚</p>
<ol>
<li>addEventListener&#96; ç¬¬3ä¸ªå‚æ•°å†³å®šäº†äº‹ä»¶æ˜¯åœ¨æ•è·é˜¶æ®µè§¦å‘è¿˜æ˜¯åœ¨å†’æ³¡é˜¶æ®µè§¦å‘</li>
<li><code>addEventListener</code> ç¬¬3ä¸ªå‚æ•°ä¸º  <code>true</code> è¡¨ç¤ºæ•è·é˜¶æ®µè§¦å‘ï¼Œ<code>false</code> è¡¨ç¤ºå†’æ³¡é˜¶æ®µè§¦å‘ï¼Œé»˜è®¤å€¼ä¸º <code>false</code></li>
<li>äº‹ä»¶æµåªä¼šåœ¨çˆ¶å­å…ƒç´ å…·æœ‰ç›¸åŒäº‹ä»¶ç±»å‹æ—¶æ‰ä¼šäº§ç”Ÿå½±å“</li>
<li>ç»å¤§éƒ¨åˆ†åœºæ™¯éƒ½é‡‡ç”¨é»˜è®¤çš„å†’æ³¡æ¨¡å¼ï¼ˆå…¶ä¸­ä¸€ä¸ªåŸå› æ˜¯æ—©æœŸ IE ä¸æ”¯æŒæ•è·ï¼‰</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">&gt;<span class="tag">&lt;<span class="name">h3</span>&gt;</span>äº‹ä»¶æµ<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">&gt;<span class="tag">&lt;<span class="name">p</span>&gt;</span>äº‹ä»¶æµæ˜¯äº‹ä»¶åœ¨æ‰§è¡Œæ—¶çš„åº•å±‚æœºåˆ¶ï¼Œä¸»è¦ä½“ç°åœ¨çˆ¶å­ç›’å­ä¹‹é—´äº‹ä»¶çš„æ‰§è¡Œä¸Šã€‚<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">&gt;<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;child&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">&gt;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> <span class="comment">// è·å–åµŒå¥—çš„3ä¸ªèŠ‚ç‚¹</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> <span class="keyword">const</span> outer = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.outer&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> <span class="keyword">const</span> inner = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.inner&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> <span class="keyword">const</span> child = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.child&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> <span class="comment">// html å…ƒç´ æ·»åŠ äº‹ä»¶</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;html...&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> &#125;)	</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> <span class="comment">// body å…ƒç´ æ·»åŠ äº‹ä»¶</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;body...&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> <span class="comment">// å¤–å±‚çš„ç›’å­æ·»åŠ äº‹ä»¶</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> outer.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;outer...&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> <span class="comment">// ä¸­é—´çš„ç›’å­æ·»åŠ äº‹ä»¶</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> outer.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;inner...&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> <span class="comment">// å†…å±‚çš„ç›’å­æ·»åŠ äº‹ä»¶</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> outer.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;child...&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">&gt;<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>äº‹ä»¶æµæ˜¯äº‹ä»¶åœ¨æ‰§è¡Œæ—¶çš„åº•å±‚æœºåˆ¶ï¼Œä¸»è¦ä½“ç°åœ¨çˆ¶å­ç›’å­ä¹‹é—´äº‹ä»¶çš„æ‰§è¡Œä¸Š</p>
<p>å½“å•å‡»äº‹ä»¶è§¦å‘æ—¶ï¼Œå…¶ç¥–å…ˆå…ƒç´ çš„å•å‡»äº‹ä»¶ä¹Ÿã€ç›¸ç»§è§¦å‘ã€‘</p>
<p>å½“æŸä¸ªå…ƒç´ çš„äº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œäº‹ä»¶æ€»æ˜¯ä¼šå…ˆç»è¿‡å…¶ç¥–å…ˆæ‰èƒ½åˆ°è¾¾å½“å‰å…ƒç´ ï¼Œç„¶åå†ç”±å½“å‰å…ƒç´ å‘ç¥–å…ˆä¼ é€’ï¼Œäº‹ä»¶åœ¨æµåŠ¨çš„è¿‡ç¨‹ä¸­é‡åˆ°ç›¸åŒçš„äº‹ä»¶ä¾¿ä¼šè¢«è§¦å‘ã€‚</p>
<p>å¦‚æœäº‹ä»¶æ˜¯åœ¨å†’æ³¡é˜¶æ®µæ‰§è¡Œçš„ï¼Œæˆ‘ä»¬ç§°ä¸ºå†’æ³¡æ¨¡å¼ï¼Œå®ƒä¼šå…ˆæ‰§è¡Œå­ç›’å­äº‹ä»¶å†å»æ‰§è¡Œçˆ¶ç›’å­äº‹ä»¶ï¼Œé»˜è®¤æ˜¯å†’æ³¡æ¨¡å¼ã€‚</p>
<p>å¦‚æœäº‹ä»¶æ˜¯åœ¨æ•è·é˜¶æ®µæ‰§è¡Œçš„ï¼Œæˆ‘ä»¬ç§°ä¸ºæ•è·æ¨¡å¼ï¼Œå®ƒä¼šå…ˆæ‰§è¡Œçˆ¶ç›’å­äº‹ä»¶å†å»æ‰§è¡Œå­ç›’å­äº‹ä»¶ã€‚</p>
<p><strong>é˜»æ­¢å†’æ³¡</strong></p>
<p>é˜»æ­¢å†’æ³¡æ˜¯æŒ‡é˜»æ–­äº‹ä»¶çš„æµåŠ¨ï¼Œä¿è¯äº‹ä»¶åªåœ¨å½“å‰å…ƒç´ è¢«æ‰§è¡Œï¼Œè€Œä¸å†å»å½±å“åˆ°å…¶å¯¹åº”çš„ç¥–å…ˆå…ƒç´ ã€‚</p>
<p>äº‹ä»¶å¯¹è±¡ä¸­çš„ <code>ev.stopPropagation</code> æ–¹æ³•ï¼Œä¸“é—¨ç”¨æ¥é˜»æ­¢äº‹ä»¶å†’æ³¡ã€‚</p>
<p><strong>äº‹ä»¶å§”æ‰˜</strong></p>
<p>äº‹ä»¶çš„çš„å†’æ³¡æ¨¡å¼æ€»æ˜¯ä¼šå°†äº‹ä»¶æµå‘å…¶çˆ¶å…ƒç´ çš„ï¼Œå¦‚æœçˆ¶å…ƒç´ ç›‘å¬äº†ç›¸åŒçš„äº‹ä»¶ç±»å‹ï¼Œé‚£ä¹ˆçˆ¶å…ƒç´ çš„äº‹ä»¶å°±ä¼šè¢«è§¦å‘å¹¶æ‰§è¡Œ</p>
<p>äº‹ä»¶å¯¹è±¡ä¸­çš„å±æ€§ <code>target</code> æˆ– <code>srcElement</code>å±æ€§è¡¨ç¤ºçœŸæ­£è§¦å‘äº‹ä»¶çš„å…ƒç´ ï¼Œå®ƒæ˜¯ä¸€ä¸ªå…ƒç´ ç±»å‹çš„èŠ‚ç‚¹ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="comment">// å‡è®¾é¡µé¢ä¸­æœ‰ 10000 ä¸ª button å…ƒç´ </span></span><br><span class="line">&gt;<span class="keyword">const</span> buttons = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;table button&#x27;</span>)</span><br><span class="line"></span><br><span class="line">&gt;<span class="comment">// å‡è®¾ä¸Šè¿°çš„ 10000 ä¸ª buttom å…ƒç´ å…±åŒçš„ç¥–å…ˆå…ƒç´ æ˜¯ table</span></span><br><span class="line">&gt;<span class="keyword">const</span> parents = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;table&#x27;</span>)</span><br><span class="line">&gt;parents.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params">ev</span>) &#123;</span><br><span class="line"> <span class="keyword">if</span>(ev.<span class="property">target</span>.<span class="property">tagName</span> === <span class="string">&#x27;BUTTON&#x27;</span>) &#123;&#125;</span><br><span class="line">&gt;&#125;)</span><br></pre></td></tr></table></figure>


</blockquote>
<h3 id="é—´æ­‡å‡½æ•°"><a href="#é—´æ­‡å‡½æ•°" class="headerlink" title="é—´æ­‡å‡½æ•°"></a>é—´æ­‡å‡½æ•°</h3><blockquote>
<p><code>setInterval</code> æ˜¯ JavaScript ä¸­å†…ç½®çš„å‡½æ•°ï¼Œå®ƒçš„ä½œç”¨æ˜¯é—´éš”å›ºå®šçš„æ—¶é—´è‡ªåŠ¨é‡å¤æ‰§è¡Œå¦ä¸€ä¸ªå‡½æ•°ï¼Œä¹Ÿå«å®šæ—¶å™¨å‡½æ•°ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="comment">// 1. å®šä¹‰ä¸€ä¸ªæ™®é€šå‡½æ•°</span></span><br><span class="line">&gt;<span class="keyword">function</span> <span class="title function_">repeat</span>(<span class="params"></span>) &#123;</span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;....&#x27;</span>);</span><br><span class="line">&gt;&#125;</span><br><span class="line"></span><br><span class="line">&gt;<span class="comment">// 2. ä½¿ç”¨ setInterval è°ƒç”¨ repeat å‡½æ•°</span></span><br><span class="line">&gt;<span class="comment">// é—´éš” 1000 æ¯«ç§’ï¼Œé‡å¤è°ƒç”¨ repeat</span></span><br><span class="line">&gt;<span class="keyword">let</span> timerid=<span class="built_in">setInterval</span>(repeat, <span class="number">1000</span>);</span><br><span class="line">&gt;<span class="built_in">clearInterval</span>(timerid);</span><br></pre></td></tr></table></figure>


</blockquote>
<h3 id="å»¶è¿Ÿå‡½æ•°"><a href="#å»¶è¿Ÿå‡½æ•°" class="headerlink" title="å»¶è¿Ÿå‡½æ•°"></a>å»¶è¿Ÿå‡½æ•°</h3><blockquote>
<ol>
<li>å»¶æ—¶å‡½æ•°éœ€è¦ç­‰å¾…,æ‰€ä»¥åé¢çš„ä»£ç å…ˆæ‰§è¡Œ</li>
<li>è¿”å›å€¼æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œè¡¨ç¤ºå®šæ—¶å™¨çš„ç¼–å·</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="built_in">setTimeout</span>(å›è°ƒå‡½æ•°, å»¶è¿Ÿæ—¶é—´)</span><br><span class="line">&gt;<span class="built_in">clearTimeout</span>(timerId)</span><br></pre></td></tr></table></figure>


</blockquote>
<h3 id="æ­£åˆ™è¡¨è¾¾å¼regex"><a href="#æ­£åˆ™è¡¨è¾¾å¼regex" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼regex"></a>æ­£åˆ™è¡¨è¾¾å¼regex</h3><blockquote>
<p><strong>å®šä¹‰è§„åˆ™</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> reg =  <span class="regexp">/è¡¨è¾¾å¼/</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å…¶ä¸­<code>/   /</code>æ˜¯æ­£åˆ™è¡¨è¾¾å¼å­—é¢é‡</li>
<li>æ­£åˆ™è¡¨è¾¾å¼ä¹Ÿæ˜¯<code>å¯¹è±¡ </code></li>
</ul>
<p><strong>ä½¿ç”¨æ­£åˆ™</strong></p>
<ul>
<li><code>test()æ–¹æ³•</code>   ç”¨æ¥æŸ¥çœ‹æ­£åˆ™è¡¨è¾¾å¼ä¸æŒ‡å®šçš„å­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…</li>
<li>å¦‚æœæ­£åˆ™è¡¨è¾¾å¼ä¸æŒ‡å®šçš„å­—ç¬¦ä¸²åŒ¹é… ï¼Œè¿”å›<code>true</code>ï¼Œå¦åˆ™<code>false</code></li>
</ul>
<h4 id="è¾¹ç•Œç¬¦"><a href="#è¾¹ç•Œç¬¦" class="headerlink" title="è¾¹ç•Œç¬¦"></a>è¾¹ç•Œç¬¦</h4><p>æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„è¾¹ç•Œç¬¦ï¼ˆä½ç½®ç¬¦ï¼‰ç”¨æ¥æç¤ºå­—ç¬¦æ‰€å¤„çš„ä½ç½®ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªå­—ç¬¦</p>
<p><code>^ </code> è¡¨ç¤ºåŒ¹é…è¡Œé¦–çš„æ–‡æœ¬</p>
<p><code>$</code> è¡¨ç¤ºåŒ¹é…è¡Œå°¾çš„æ–‡æœ¬</p>
<p>å¦‚æœ ^ å’Œ $ åœ¨ä¸€èµ·ï¼Œè¡¨ç¤ºå¿…é¡»æ˜¯ç²¾ç¡®åŒ¹é…</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="comment">//^$</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="regexp">/^h/</span>.<span class="title function_">test</span>(<span class="string">&#x27;hello&#x27;</span>)) <span class="comment">//true</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="regexp">/^h$/</span>.<span class="title function_">test</span>(<span class="string">&#x27;hello&#x27;</span>)) <span class="comment">//false</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="regexp">/^a$/</span>.<span class="title function_">test</span>(<span class="string">&#x27;abca&#x27;</span>)) <span class="comment">//false</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="regexp">/^a$/</span>.<span class="title function_">test</span>(<span class="string">&#x27;a&#x27;</span>)) <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<p><strong>é‡è¯</strong></p>
<p><code>*</code>é‡å¤é›¶æ¬¡æˆ–å¤šæ¬¡</p>
<p><code>+</code>é‡å¤ä¸€æ¬¡æˆ–å¤šæ¬¡</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="comment">//* &gt;=0</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="regexp">/^h*/</span>.<span class="title function_">test</span>(<span class="string">&#x27;hhh&#x27;</span>));<span class="comment">//true</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="regexp">/^h*/</span>.<span class="title function_">test</span>(<span class="string">&#x27;x&#x27;</span>));<span class="comment">//true</span></span><br><span class="line">&gt;<span class="comment">//+ &gt;=1</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="regexp">/^h+/</span>.<span class="title function_">test</span>(<span class="string">&#x27;hhh&#x27;</span>));<span class="comment">//true</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="regexp">/^h+/</span>.<span class="title function_">test</span>(<span class="string">&#x27;x&#x27;</span>));<span class="comment">//false</span></span><br></pre></td></tr></table></figure>

<p><code>?</code> é‡å¤æ¬¡æ•°  0 || 1</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="comment">//  é‡è¯ ? ç±»ä¼¼  0 || 1 è¦ä¹ˆæœ‰è¦ä¹ˆæ²¡æœ‰</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="regexp">/^å“ˆ?$/</span>.<span class="title function_">test</span>(<span class="string">&#x27;&#x27;</span>)) <span class="comment">// true</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="regexp">/^å“ˆ?$/</span>.<span class="title function_">test</span>(<span class="string">&#x27;å“ˆ&#x27;</span>)) <span class="comment">// true</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="regexp">/^å“ˆ?$/</span>.<span class="title function_">test</span>(<span class="string">&#x27;å“ˆå“ˆ&#x27;</span>)) <span class="comment">// true</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="regexp">/^å“ˆ?$/</span>.<span class="title function_">test</span>(<span class="string">&#x27;äºŒå“ˆå¾ˆå‚»&#x27;</span>)) <span class="comment">//  false</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="regexp">/^å“ˆ?$/</span>.<span class="title function_">test</span>(<span class="string">&#x27;å“ˆå¾ˆå‚»&#x27;</span>)) <span class="comment">//  false</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="regexp">/^å“ˆ?$/</span>.<span class="title function_">test</span>(<span class="string">&#x27;å“ˆå¾ˆå“ˆ&#x27;</span>)) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p><code>&#123;n,&#125;</code>é‡å¤næ¬¡æˆ–æ›´å¤šæ¬¡ </p>
<p><code>&#123;n,m&#125;</code> n&lt;&#x3D;x&lt;&#x3D;m</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;console.log(/^h&#123;2,3&#125;$/.test(&#x27;h&#x27;))//false</span><br><span class="line">&gt;console.log(/^h&#123;2,3&#125;$/.test(&#x27;hh&#x27;))//true</span><br><span class="line">&gt;console.log(/^h&#123;2,3&#125;$/.test(&#x27;hhhh&#x27;))//false</span><br></pre></td></tr></table></figure>

<p><strong>èŒƒå›´</strong></p>
<p><code>[abc]</code>åŒ¹é…åŒ…å«çš„å•ä¸ªå­—ç¬¦</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="comment">// 1. [abc] åŒ¹é…åŒ…å«çš„å•ä¸ªå­—ç¬¦</span></span><br><span class="line">&gt;<span class="keyword">const</span> reg1 = <span class="regexp">/^[abc]$/</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(reg1.<span class="title function_">test</span>(<span class="string">&#x27;a&#x27;</span>))  <span class="comment">// true</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(reg1.<span class="title function_">test</span>(<span class="string">&#x27;b&#x27;</span>))  <span class="comment">// true</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(reg1.<span class="title function_">test</span>(<span class="string">&#x27;c&#x27;</span>))  <span class="comment">// true</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(reg1.<span class="title function_">test</span>(<span class="string">&#x27;d&#x27;</span>))  <span class="comment">// false</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(reg1.<span class="title function_">test</span>(<span class="string">&#x27;ab&#x27;</span>))  <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p><code>[a-z] </code>è¿å­—ç¬¦ å•ä¸ª</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> reg2 = <span class="regexp">/^[a-z]$/</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(reg2.<span class="title function_">test</span>(<span class="string">&#x27;a&#x27;</span>))  <span class="comment">// true</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(reg2.<span class="title function_">test</span>(<span class="string">&#x27;p&#x27;</span>))  <span class="comment">// true</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(reg2.<span class="title function_">test</span>(<span class="string">&#x27;A&#x27;</span>))  <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p><code>[^a-z]</code>å–åç¬¦</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> reg3 = <span class="regexp">/^[^a-z]$/</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(reg3.<span class="title function_">test</span>(<span class="string">&#x27;a&#x27;</span>))  <span class="comment">// false </span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(reg3.<span class="title function_">test</span>(<span class="string">&#x27;A&#x27;</span>))  <span class="comment">// true</span></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(reg3.<span class="title function_">test</span>(<span class="number">8</span>))  <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p><strong>å­—ç¬¦ç±»</strong></p>
<p><code>\d</code> â€“ <code>[0-9]</code><br><code>\D</code> â€“ <code>[^0-9]</code><br><code>\w</code>  â€“ <code>[a-zA-Z0-9_]</code><br><code>\W </code>  â€“ <code>[^a-zA-Z0-9_]</code><br><code>\s</code>  â€“  <code>åŒ¹é…ç©ºæ ¼[\t\r\n\v\f]</code><br><code>\S </code>  â€“ <code>ä¸åŒ¹é…ç©ºæ ¼[^\t\r\n\v\f</code>]</p>
<p><strong>ä¿®é¥°ç¬¦</strong></p>
<p>ä¿®é¥°ç¬¦çº¦æŸæ­£åˆ™æ‰§è¡Œçš„æŸäº›ç»†èŠ‚è¡Œä¸ºï¼Œå¦‚æ˜¯å¦åŒºåˆ†å¤§å°å†™ã€æ˜¯å¦æ”¯æŒå¤šè¡ŒåŒ¹é…ç­‰</p>
<ul>
<li>i æ˜¯å•è¯ ignore çš„ç¼©å†™ï¼Œæ­£åˆ™åŒ¹é…æ—¶å­—æ¯ä¸åŒºåˆ†å¤§å°å†™</li>
<li>g æ˜¯å•è¯ global çš„ç¼©å†™ï¼ŒåŒ¹é…æ‰€æœ‰æ»¡è¶³æ­£åˆ™è¡¨è¾¾å¼çš„ç»“æœ</li>
</ul>
<p><strong>replaceæ–¹æ³•</strong></p>
<p><code>console.log(&#39;JAVAæ˜¯éå¸¸æ£’çš„åç«¯è¯­è¨€&#39;.replace(/java/ig,&#39;go&#39;));</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> str = <span class="string">&#x27;å‰ç«¯å‰ç«¯å‰ç«¯å‰ç«¯å‰ç«¯å‰ç«¯å‰ç«¯å‰ç«¯å‰ç«¯å‰ç«¯å‰ç«¯å‰ç«¯å‰ç«¯å‰ç«¯å‰ç«¯å‰ç«¯å‰ç«¯&#x27;</span></span><br><span class="line">&gt;<span class="keyword">const</span> strEnd = str.<span class="title function_">replace</span>(<span class="regexp">/å‰ç«¯/</span>, <span class="string">&#x27;web&#x27;</span>) <span class="comment">//åªèƒ½æ›¿æ¢ä¸€ä¸ª</span></span><br><span class="line">&gt;<span class="keyword">const</span> strEnd = str.<span class="title function_">replace</span>(<span class="regexp">/å‰ç«¯/g</span>, <span class="string">&#x27;web&#x27;</span>) <span class="comment">//å…¨éƒ¨æ›¿æ¢</span></span><br></pre></td></tr></table></figure>


</blockquote>
<h3 id="æ‹·è´"><a href="#æ‹·è´" class="headerlink" title="æ‹·è´"></a>æ‹·è´</h3><h4 id="æµ…æ‹·è´"><a href="#æµ…æ‹·è´" class="headerlink" title="æµ…æ‹·è´"></a>æµ…æ‹·è´</h4><blockquote>
<p>é¦–å…ˆæµ…æ‹·è´å’Œæ·±æ‹·è´åªé’ˆå¯¹å¼•ç”¨ç±»å‹</p>
<p>æµ…æ‹·è´ï¼šæ‹·è´çš„æ˜¯åœ°å€</p>
<p>å¸¸è§æ–¹æ³•ï¼š</p>
<ol>
<li>æ‹·è´å¯¹è±¡ï¼šObject.assgin() &#x2F; å±•å¼€è¿ç®—ç¬¦ {â€¦obj} æ‹·è´å¯¹è±¡</li>
<li>æ‹·è´æ•°ç»„ï¼šArray.prototype.concat() æˆ–è€… [â€¦arr]</li>
</ol>
<blockquote>
<p>å¦‚æœæ˜¯ç®€å•æ•°æ®ç±»å‹æ‹·è´å€¼ï¼Œå¼•ç”¨æ•°æ®ç±»å‹æ‹·è´çš„æ˜¯åœ°å€ (ç®€å•ç†è§£ï¼š å¦‚æœæ˜¯å•å±‚å¯¹è±¡ï¼Œæ²¡é—®é¢˜ï¼Œå¦‚æœæœ‰å¤šå±‚å°±æœ‰é—®é¢˜)</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">uname</span>: <span class="string">&#x27;helo&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">  <span class="attr">family</span>:&#123;</span><br><span class="line">      <span class="attr">baby</span>:<span class="string">&#x27;Go&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&gt;&#125;</span><br><span class="line">&gt;<span class="keyword">const</span> copy1 = &#123;...obj&#125;;</span><br><span class="line">&gt;<span class="keyword">const</span> copy2=&#123;&#125;;</span><br><span class="line">&gt;<span class="title class_">Object</span>.<span class="title function_">assign</span>(copy2,obj);</span><br><span class="line">&gt;copy1.<span class="property">uname</span> = <span class="string">&#x27;copy1&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(obj)<span class="comment">//&#123; uname: &#x27;helo&#x27;, age: 18 &#125;</span></span><br><span class="line">&gt;<span class="comment">//æµ…æ‹·è´é—®é¢˜:åªæ‹·è´å¤–å±‚ </span></span><br><span class="line">&gt;copy1.<span class="property">family</span>.<span class="property">baby</span>=<span class="string">&#x27;Golang&#x27;</span>;</span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(obj)<span class="comment">//&#123; uname: &#x27;helo&#x27;, age: 18, family: &#123; baby: &#x27;Golang&#x27; &#125; &#125;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="æ·±æ‹·è´"><a href="#æ·±æ‹·è´" class="headerlink" title="æ·±æ‹·è´"></a>æ·±æ‹·è´</h4><blockquote>
<p>é¦–å…ˆæµ…æ‹·è´å’Œæ·±æ‹·è´åªé’ˆå¯¹å¼•ç”¨ç±»å‹</p>
<p>æ·±æ‹·è´ï¼šæ‹·è´çš„æ˜¯å¯¹è±¡ï¼Œä¸æ˜¯åœ°å€</p>
<p>å¸¸è§æ–¹æ³•ï¼š</p>
<ul>
<li>é€šè¿‡é€’å½’å®ç°æ·±æ‹·è´</li>
<li>é€šè¿‡JSON.stringify()å®ç°</li>
</ul>
<p><strong>é€’å½’</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">function</span> <span class="title function_">deepCopy</span>(<span class="params">newObj, oldObj</span>) &#123;</span><br><span class="line">  <span class="comment">// å¤„ç†æ•°ç»„çš„é—®é¢˜  ä¸€å®šå…ˆå†™æ•°ç»„ åœ¨å†™ å¯¹è±¡ ä¸èƒ½é¢ å€’</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> k <span class="keyword">in</span> oldObj) &#123;</span><br><span class="line">      <span class="keyword">if</span> (oldObj[k] <span class="keyword">instanceof</span> <span class="title class_">Array</span>) &#123;</span><br><span class="line">          newObj[k] = [];</span><br><span class="line">          <span class="title function_">deepCopy</span>(newObj[k], oldObj[k]);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (oldObj[k] <span class="keyword">instanceof</span> <span class="title class_">Object</span>) &#123;</span><br><span class="line">          newObj[k] = &#123;&#125;;</span><br><span class="line">          <span class="title function_">deepCopy</span>(newObj[k], oldObj[k]);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          newObj[k] = oldObj[k]</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&gt;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>JSON</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> o=<span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj))</span><br></pre></td></tr></table></figure>


</blockquote>
<h3 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h3><blockquote>
<p><strong>throw</strong></p>
<ol>
<li>throw æŠ›å‡ºå¼‚å¸¸ä¿¡æ¯ï¼Œç¨‹åºä¹Ÿä¼šç»ˆæ­¢æ‰§è¡Œ</li>
<li>throw åé¢è·Ÿçš„æ˜¯é”™è¯¯æç¤ºä¿¡æ¯</li>
<li>Error å¯¹è±¡é…åˆ throw ä½¿ç”¨ï¼Œèƒ½å¤Ÿè®¾ç½®æ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">function</span> <span class="title function_">counter</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line"> <span class="keyword">if</span>(!x || !y) &#123;</span><br><span class="line">   <span class="comment">// throw &#x27;å‚æ•°ä¸èƒ½ä¸ºç©º!&#x27;;</span></span><br><span class="line">   <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;å‚æ•°ä¸èƒ½ä¸ºç©º!&#x27;</span>)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> x + y</span><br><span class="line">&gt;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>try â€¦ catch</strong></p>
<ol>
<li><p><code>try...catch</code> ç”¨äºæ•è·é”™è¯¯ä¿¡æ¯</p>
</li>
<li><p>å°†é¢„ä¼°å¯èƒ½å‘ç”Ÿé”™è¯¯çš„ä»£ç å†™åœ¨ <code>try</code> ä»£ç æ®µä¸­</p>
</li>
<li><p>å¦‚æœ <code>try</code> ä»£ç æ®µä¸­å‡ºç°é”™è¯¯åï¼Œä¼šæ‰§è¡Œ <code>catch</code> ä»£ç æ®µï¼Œå¹¶æˆªè·åˆ°é”™è¯¯ä¿¡æ¯</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">   <span class="keyword">try</span> &#123;</span><br><span class="line">     <span class="comment">// æŸ¥æ‰¾ DOM èŠ‚ç‚¹</span></span><br><span class="line">     <span class="keyword">const</span> p = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.p&#x27;</span>)</span><br><span class="line">     p.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&#x27;red&#x27;</span></span><br><span class="line">   &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">     <span class="comment">// try ä»£ç æ®µä¸­æ‰§è¡Œæœ‰é”™è¯¯æ—¶ï¼Œä¼šæ‰§è¡Œ catch ä»£ç æ®µ</span></span><br><span class="line">     <span class="comment">// æŸ¥çœ‹é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(error.<span class="property">message</span>)</span><br><span class="line">     <span class="comment">// ç»ˆæ­¢ä»£ç ç»§ç»­æ‰§è¡Œ</span></span><br><span class="line">     <span class="keyword">return</span></span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">finally</span> &#123;</span><br><span class="line">       <span class="title function_">alert</span>(<span class="string">&#x27;æ‰§è¡Œ&#x27;</span>)</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å¦‚æœå‡ºç°é”™è¯¯ï¼Œæˆ‘çš„è¯­å¥ä¸ä¼šæ‰§è¡Œ&#x27;</span>)</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="This"><a href="#This" class="headerlink" title="This"></a>This</h3><blockquote>
<p><strong>æ™®é€šå‡½æ•°</strong></p>
<p>æ™®é€šå‡½æ•°çš„è°ƒç”¨æ–¹å¼å†³å®šäº† <code>this</code> çš„å€¼ï¼Œå³ã€è°è°ƒç”¨ <code>this</code> çš„å€¼æŒ‡å‘è°ã€‘</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="comment">// æ™®é€šå‡½æ•°</span></span><br><span class="line">&gt;<span class="keyword">function</span> <span class="title function_">sayHi</span>(<span class="params"></span>) &#123;</span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)  </span><br><span class="line">&gt;&#125;</span><br><span class="line">&gt;<span class="comment">// å‡½æ•°çš„è°ƒç”¨æ–¹å¼å†³å®šäº† this çš„å€¼</span></span><br><span class="line">&gt;<span class="title function_">sayHi</span>() <span class="comment">// window</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;<span class="comment">// æ™®é€šå¯¹è±¡ thisæŒ‡å‘å®ä¾‹å¯¹è±¡</span></span><br><span class="line">&gt;<span class="keyword">const</span> user = &#123;</span><br><span class="line">&gt;<span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span>,</span><br><span class="line">&gt;<span class="attr">walk</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">&gt;&#125;</span><br><span class="line">&gt;&#125;</span><br><span class="line">&gt;<span class="comment">// åŠ¨æ€ä¸º user æ·»åŠ æ–¹æ³•</span></span><br><span class="line">&gt;user.<span class="property">sayHi</span> = sayHi</span><br><span class="line">&gt;uesr.<span class="property">sayHello</span> = sayHello</span><br><span class="line">&gt;<span class="comment">// å‡½æ•°è°ƒç”¨æ–¹å¼ï¼Œå†³å®šäº† this çš„å€¼</span></span><br><span class="line">&gt;user.<span class="title function_">sayHi</span>()</span><br><span class="line">&gt;user.<span class="title function_">sayHello</span>()</span><br></pre></td></tr></table></figure>

<p>ç®­å¤´å‡½æ•°</p>
<p>ç®­å¤´å‡½æ•°ä¸­å¹¶ä¸å­˜åœ¨ <code>this</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="keyword">const</span> user = &#123;</span><br><span class="line">&gt;<span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span>,</span><br><span class="line">&gt;<span class="comment">// è¯¥ç®­å¤´å‡½æ•°ä¸­çš„ this ä¸ºå‡½æ•°å£°æ˜ç¯å¢ƒä¸­ this ä¸€è‡´</span></span><br><span class="line">&gt;<span class="attr">walk</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)<span class="comment">//windows</span></span><br><span class="line">&gt;&#125;,</span><br><span class="line"></span><br><span class="line">&gt;<span class="attr">sleep</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)<span class="comment">//&#123;name: &#x27;å°æ˜&#x27;, walk: Æ’, sleep: Æ’, sayHi: Æ’&#125;</span></span><br><span class="line">  <span class="keyword">let</span> <span class="title function_">fn</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      <span class="comment">//&#123;name: &#x27;å°æ˜&#x27;, walk: Æ’, sleep: Æ’, sayHi: Æ’&#125;</span></span><br><span class="line">      <span class="comment">// è¯¥ç®­å¤´å‡½æ•°ä¸­çš„ this ä¸ sleep ä¸­çš„ thisä¸€è‡´,æŒ‡å‘å®ä¾‹å¯¹è±¡</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>) </span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è°ƒç”¨ç®­å¤´å‡½æ•°</span></span><br><span class="line">  <span class="title function_">fn</span>();</span><br><span class="line">&gt;&#125;</span><br><span class="line">&gt;&#125;</span><br><span class="line">&gt;<span class="comment">// åŠ¨æ€æ·»åŠ æ–¹æ³•</span></span><br><span class="line">&gt;user.<span class="property">sayHi</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">&gt;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)<span class="comment">//windows</span></span><br><span class="line">&gt;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åœ¨å¼€å‘ä¸­ã€ä½¿ç”¨ç®­å¤´å‡½æ•°å‰éœ€è¦è€ƒè™‘å‡½æ•°ä¸­ <code>this</code> çš„å€¼ã€‘ï¼Œ<strong>äº‹ä»¶å›è°ƒå‡½æ•°</strong>ä½¿ç”¨ç®­å¤´å‡½æ•°æ—¶ï¼Œ<code>this</code> ä¸ºå…¨å±€çš„ <code>window</code>ï¼Œå› æ­¤DOMäº‹ä»¶å›è°ƒå‡½æ•°ä¸æ¨èä½¿ç”¨ç®­å¤´å‡½æ•°</p>
<p>åŒæ ·ç”±äºç®­å¤´å‡½æ•° <code>this</code> çš„åŸå› ï¼ŒåŸºäºåŸå‹çš„é¢å‘å¯¹è±¡ä¹Ÿä¸æ¨èé‡‡ç”¨ç®­å¤´å‡½æ•°</p>
<p><strong>æ”¹å˜thisæŒ‡å‘</strong></p>
<p><strong>call</strong></p>
<p>ä»¥ä¸Šå½’çº³äº†æ™®é€šå‡½æ•°å’Œç®­å¤´å‡½æ•°ä¸­å…³äº <code>this</code> é»˜è®¤å€¼çš„æƒ…å½¢ï¼Œä¸ä»…å¦‚æ­¤ JavaScript ä¸­è¿˜å…è®¸æŒ‡å®šå‡½æ•°ä¸­ <code>this</code> çš„æŒ‡å‘ï¼Œæœ‰ 3 ä¸ªæ–¹æ³•å¯ä»¥åŠ¨æ€æŒ‡å®šæ™®é€šå‡½æ•°ä¸­ <code>this</code> çš„æŒ‡å‘ï¼š</p>
<ol>
<li><code>call</code> æ–¹æ³•èƒ½å¤Ÿåœ¨è°ƒç”¨å‡½æ•°çš„åŒæ—¶æŒ‡å®š <code>this</code> çš„å€¼</li>
<li>ä½¿ç”¨ <code>call</code> æ–¹æ³•è°ƒç”¨å‡½æ•°æ—¶ï¼Œç¬¬1ä¸ªå‚æ•°ä¸º <code>this</code> æŒ‡å®šçš„å€¼</li>
<li><code>call</code> æ–¹æ³•çš„å…¶ä½™å‚æ•°ä¼šä¾æ¬¡è‡ªåŠ¨ä¼ å…¥å‡½æ•°åšä¸ºå‡½æ•°çš„å‚æ•°</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">  <span class="comment">// 1. è°ƒç”¨å‡½æ•°  </span></span><br><span class="line">  <span class="comment">// 2. æ”¹å˜ this æŒ‡å‘</span></span><br><span class="line">  <span class="comment">// func.call(thisArg,arg1,arg2)</span></span><br><span class="line">  <span class="comment">// thisArg å‡½æ•°è¿è¡Œæ—¶æŒ‡å®šthisçš„å€¼</span></span><br><span class="line">  <span class="comment">// arg1 arg2 å…¶ä»–å‚æ•°  </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;<span class="keyword">function</span> <span class="title function_">sayHi</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> user = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> student = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;å°çº¢&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">16</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨å‡½æ•°å¹¶æŒ‡å®š this çš„å€¼</span></span><br><span class="line">sayHi.<span class="title function_">call</span>(user); <span class="comment">// this å€¼ä¸º user</span></span><br><span class="line">sayHi.<span class="title function_">call</span>(student); <span class="comment">// this å€¼ä¸º student</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ±‚å’Œå‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">counter</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨ counter å‡½æ•°ï¼Œå¹¶ä¼ å…¥å‚æ•°</span></span><br><span class="line"><span class="keyword">let</span> result = counter.<span class="title function_">call</span>(<span class="literal">null</span>, <span class="number">5</span>, <span class="number">10</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br></pre></td></tr></table></figure>

<p><strong>apply</strong></p>
<ol>
<li><code>apply</code> æ–¹æ³•èƒ½å¤Ÿåœ¨è°ƒç”¨å‡½æ•°çš„åŒæ—¶æŒ‡å®š <code>this</code> çš„å€¼</li>
<li>ä½¿ç”¨ <code>apply</code> æ–¹æ³•è°ƒç”¨å‡½æ•°æ—¶ï¼Œç¬¬1ä¸ªå‚æ•°ä¸º <code>this</code> æŒ‡å®šçš„å€¼</li>
<li><code>apply</code> æ–¹æ³•ç¬¬2ä¸ªå‚æ•°ä¸ºæ•°ç»„ï¼Œæ•°ç»„çš„å•å…ƒå€¼ä¾æ¬¡è‡ªåŠ¨ä¼ å…¥å‡½æ•°åšä¸ºå‡½æ•°çš„å‚æ•°</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sayHi</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> user = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> student = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;å°çº¢&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">16</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨å‡½æ•°å¹¶æŒ‡å®š this çš„å€¼</span></span><br><span class="line">sayHi.<span class="title function_">apply</span>(user) <span class="comment">// this å€¼ä¸º user</span></span><br><span class="line">sayHi.<span class="title function_">apply</span>(student) <span class="comment">// this å€¼ä¸º student</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">counter</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> x + y</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> result = counter.<span class="title function_">apply</span>(<span class="literal">null</span>, [<span class="number">5</span>, <span class="number">10</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>bind</strong></p>
<p><code>bind</code> æ–¹æ³•å¹¶<strong>ä¸ä¼šè°ƒç”¨å‡½æ•°</strong>ï¼Œè€Œæ˜¯åˆ›å»ºä¸€ä¸ªæŒ‡å®šäº† <code>this</code> å€¼çš„æ–°å‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&gt;<span class="comment">// func.bind(thisArg,arg1,arg2)</span></span><br><span class="line">&gt;<span class="comment">// thisArg å‡½æ•°è¿è¡Œæ—¶æŒ‡å®šthisçš„å€¼</span></span><br><span class="line">&gt;<span class="comment">// arg1 arg2 å…¶ä»–å‚æ•° </span></span><br><span class="line">&gt;<span class="comment">//ä¸è°ƒç”¨</span></span><br><span class="line"></span><br><span class="line">&gt;<span class="comment">// æ™®é€šå‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sayHi</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> user = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è°ƒç”¨ bind æŒ‡å®š this çš„å€¼</span></span><br><span class="line"><span class="keyword">let</span> sayHello = sayHi.<span class="title function_">bind</span>(user);</span><br><span class="line"><span class="comment">// è°ƒç”¨ä½¿ç”¨ bind åˆ›å»ºçš„æ–°å‡½æ•°</span></span><br><span class="line"><span class="title function_">sayHello</span>()</span><br></pre></td></tr></table></figure>


</blockquote>
<h3 id="é˜²æŠ–èŠ‚æµ"><a href="#é˜²æŠ–èŠ‚æµ" class="headerlink" title="é˜²æŠ–èŠ‚æµ"></a>é˜²æŠ–èŠ‚æµ</h3><ol>
<li>é˜²æŠ–ï¼ˆdebounceï¼‰<br>æ‰€è°“é˜²æŠ–ï¼Œå°±æ˜¯æŒ‡è§¦å‘äº‹ä»¶ååœ¨ n ç§’å†…å‡½æ•°åªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœåœ¨ n ç§’å†…åˆè§¦å‘äº†äº‹ä»¶ï¼Œåˆ™ä¼šé‡æ–°è®¡ç®—å‡½æ•°æ‰§è¡Œæ—¶é—´</li>
</ol>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.box</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-color</span>: <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">font-size</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.box&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> i = <span class="number">1</span>  <span class="comment">// è®©è¿™ä¸ªå˜é‡++</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// é¼ æ ‡ç§»åŠ¨å‡½æ•°</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">mouseMove</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      box.<span class="property">innerHTML</span> = ++i</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// å¦‚æœé‡Œé¢å­˜åœ¨å¤§é‡æ“ä½œ dom çš„æƒ…å†µï¼Œå¯èƒ½ä¼šå¡é¡¿</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// é˜²æŠ–å‡½æ•°</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">fn, t</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> timeId</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// å¦‚æœæœ‰å®šæ—¶å™¨å°±æ¸…é™¤</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (timeId) <span class="built_in">clearTimeout</span>(timeId)</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// å¼€å¯å®šæ—¶å™¨ 200</span></span></span><br><span class="line"><span class="language-javascript">        timeId = <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">fn</span>()</span></span><br><span class="line"><span class="language-javascript">        &#125;, t)</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    box.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, <span class="title function_">debounce</span>(mouseMove, <span class="number">200</span>))</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<ol>
<li>èŠ‚æµï¼ˆthrottleï¼‰<br>æ‰€è°“èŠ‚æµï¼Œå°±æ˜¯æŒ‡è¿ç»­è§¦å‘äº‹ä»¶ä½†æ˜¯åœ¨ n ç§’ä¸­åªæ‰§è¡Œä¸€æ¬¡å‡½æ•°</li>
</ol>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.box1</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-color</span>: <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-size</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.box2</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-color</span>: <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-size</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> box1 = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.box1&#x27;</span>)<span class="comment">//debounce</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> box2 = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.box2&#x27;</span>)<span class="comment">//throttle</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> i = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> j = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">mouseMove1</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        box1.<span class="property">innerText</span> = ++i;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">mouseMove2</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        box2.<span class="property">innerText</span> = ++j;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//èŠ‚æµ: n ç§’å†…åªè¿è¡Œä¸€æ¬¡ï¼Œè‹¥åœ¨ n ç§’å†…é‡å¤è§¦å‘ï¼Œåªæœ‰ä¸€æ¬¡ç”Ÿæ•ˆ</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//é˜²æŠ–: n ç§’ååœ¨æ‰§è¡Œè¯¥äº‹ä»¶ï¼Œè‹¥åœ¨ n ç§’å†…è¢«é‡å¤è§¦å‘ï¼Œåˆ™é‡æ–°è®¡æ—¶</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//debounce </span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">fn, t</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> timeId;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (timeId) <span class="built_in">clearTimeout</span>(timeId);</span></span><br><span class="line"><span class="language-javascript">            timeId = <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">fn</span>();</span></span><br><span class="line"><span class="language-javascript">            &#125;, t);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// throttleèŠ‚æµå‡½æ•°</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">throttle</span>(<span class="params">fn, t</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> startTime = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> now = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (now - startTime &gt;= t) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">fn</span>();</span></span><br><span class="line"><span class="language-javascript">                startTime = now;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    box1.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, <span class="title function_">debounce</span>(mouseMove1, <span class="number">300</span>));</span></span><br><span class="line"><span class="language-javascript">    box2.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, <span class="title function_">throttle</span>(mouseMove2, <span class="number">300</span>));</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>FrontEnd</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>lc-9_16</title>
    <url>/2023/09/16/lc9-16/</url>
    <content><![CDATA[<p><a href="https://leetcode.cn/problems/house-robber/">198. æ‰“å®¶åŠ«èˆ</a></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">rob</span><span class="params">(nums []<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	n:=<span class="built_in">len</span>(nums)</span><br><span class="line">	max := <span class="function"><span class="keyword">func</span><span class="params">(a, b <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> a &gt; b &#123;</span><br><span class="line">			<span class="keyword">return</span> a</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> b</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> n == <span class="number">1</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> nums[<span class="number">0</span>]</span><br><span class="line">	&#125;</span><br><span class="line">	dp := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	dp[<span class="number">0</span>] = nums[<span class="number">0</span>]</span><br><span class="line">	dp[<span class="number">1</span>] = max(nums[<span class="number">0</span>], nums[<span class="number">1</span>])</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">2</span>; i &lt; n; i++ &#123;</span><br><span class="line">		dp[i]=max(dp[i<span class="number">-1</span>],dp[i<span class="number">-2</span>]+nums[i])</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> dp[n<span class="number">-1</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>dp</tag>
      </tags>
  </entry>
  <entry>
    <title>lc9-17</title>
    <url>/2023/09/17/lc9-17/</url>
    <content><![CDATA[<h1 id="213-House-Robber-II"><a href="#213-House-Robber-II" class="headerlink" title="213. House Robber II"></a><a href="https://leetcode.cn/problems/house-robber-ii/">213. House Robber II</a></h1><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">rob213</span><span class="params">(nums []<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">    n := <span class="built_in">len</span>(nums)</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> nums[<span class="number">0</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    max := <span class="function"><span class="keyword">func</span><span class="params">(a, b <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">       <span class="keyword">if</span> a &gt; b &#123;</span><br><span class="line">          <span class="keyword">return</span> a</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> b</span><br><span class="line">    &#125;</span><br><span class="line">    robCase := <span class="function"><span class="keyword">func</span><span class="params">(start, end <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">       <span class="keyword">if</span> start == end &#123;</span><br><span class="line">          <span class="keyword">return</span> nums[start]</span><br><span class="line">       &#125;</span><br><span class="line">       dp := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">       dp[start] = nums[start]</span><br><span class="line">       dp[start+<span class="number">1</span>] = max(nums[start], nums[start+<span class="number">1</span>])</span><br><span class="line">       <span class="keyword">for</span> i := <span class="number">2</span>; i &lt;= end; i++ &#123;</span><br><span class="line">          dp[i] = max(dp[i<span class="number">-1</span>], dp[i<span class="number">-2</span>]+nums[i])</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> dp[end]</span><br><span class="line">    &#125;</span><br><span class="line">    case1 := robCase(<span class="number">0</span>, n<span class="number">-2</span>)</span><br><span class="line">    case2 := robCase(<span class="number">1</span>, n<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">return</span> max(case1, case2)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Golang</category>
      </categories>
      <tags>
        <tag>dp</tag>
      </tags>
  </entry>
  <entry>
    <title>lc9-18</title>
    <url>/2023/09/18/lc9-18/</url>
    <content><![CDATA[<h1 id="337-House-Robber-III"><a href="#337-House-Robber-III" class="headerlink" title="337. House Robber III"></a><a href="https://leetcode.cn/problems/house-robber-iii/">337. House Robber III</a></h1><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> TreeNode <span class="keyword">struct</span> &#123;</span><br><span class="line">    Val   <span class="type">int</span></span><br><span class="line">    Left  *TreeNode</span><br><span class="line">    Right *TreeNode</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">rob</span><span class="params">(root *TreeNode)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">    max := <span class="function"><span class="keyword">func</span><span class="params">(a, b <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">       <span class="keyword">if</span> a &gt; b &#123;</span><br><span class="line">          <span class="keyword">return</span> a</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> b</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> TreeDp <span class="function"><span class="keyword">func</span><span class="params">(cur *TreeNode)</span></span> []<span class="type">int</span></span><br><span class="line">    TreeDp = <span class="function"><span class="keyword">func</span><span class="params">(cur *TreeNode)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">       <span class="keyword">if</span> cur == <span class="literal">nil</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> []<span class="type">int</span>&#123;<span class="number">0</span>, <span class="number">0</span>&#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">//dp[0] means not rob</span></span><br><span class="line">       <span class="comment">//dp[1] means rob</span></span><br><span class="line">       ldp := TreeDp(cur.Left)</span><br><span class="line">       rdp := TreeDp(cur.Right)</span><br><span class="line">       <span class="comment">//If don&#x27;t steal the current node,</span></span><br><span class="line">       <span class="comment">//then the left and right children can steal,</span></span><br><span class="line">       <span class="comment">//and as for whether to steal or not, you must choose the largest</span></span><br><span class="line">       noGet := max(ldp[<span class="number">0</span>], ldp[<span class="number">1</span>]) + max(rdp[<span class="number">0</span>], rdp[<span class="number">1</span>])</span><br><span class="line">       <span class="comment">//if rot the current node,then left and right can not be robbed</span></span><br><span class="line">       get := cur.Val + ldp[<span class="number">0</span>] + rdp[<span class="number">0</span>]</span><br><span class="line">       <span class="keyword">return</span> []<span class="type">int</span>&#123;noGet, get&#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    ret := TreeDp(root)</span><br><span class="line">    <span class="keyword">return</span> max(ret[<span class="number">0</span>], ret[<span class="number">1</span>])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>dp</tag>
      </tags>
  </entry>
  <entry>
    <title>lc9-22</title>
    <url>/2023/09/22/lc9-22/</url>
    <content><![CDATA[<h1 id="2591-å°†é’±åˆ†ç»™æœ€å¤šçš„å„¿ç«¥"><a href="#2591-å°†é’±åˆ†ç»™æœ€å¤šçš„å„¿ç«¥" class="headerlink" title="2591. å°†é’±åˆ†ç»™æœ€å¤šçš„å„¿ç«¥"></a><a href="https://leetcode.cn/problems/distribute-money-to-maximum-children/">2591. å°†é’±åˆ†ç»™æœ€å¤šçš„å„¿ç«¥</a></h1><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2591  2023-09-22 08:29:13</span></span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">distMoney1</span><span class="params">(money <span class="type">int</span>, children <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> children &gt; money &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> children*<span class="number">8</span> &lt; money &#123;</span><br><span class="line">       <span class="keyword">return</span> children - <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> children*<span class="number">8</span>-money == <span class="number">4</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> children - <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (money - children) / <span class="number">7</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">distMoney</span><span class="params">(money <span class="type">int</span>, children <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">    min:= <span class="function"><span class="keyword">func</span><span class="params">(a,b <span class="type">int</span>)</span></span><span class="type">int</span> &#123;<span class="keyword">if</span> a&lt;b&#123;<span class="keyword">return</span> a&#125;;<span class="keyword">return</span> b&#125;</span><br><span class="line">    <span class="keyword">if</span> children &gt; money &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">    &#125;</span><br><span class="line">    money-=children</span><br><span class="line">    ret:=min(children,money/<span class="number">7</span>)</span><br><span class="line">    children-=ret</span><br><span class="line">    money-=ret*<span class="number">7</span></span><br><span class="line">    <span class="keyword">if</span> children==<span class="number">0</span>&amp;&amp;money&gt;<span class="number">0</span>||children==<span class="number">1</span>&amp;&amp;money==<span class="number">3</span>&#123;</span><br><span class="line">       <span class="keyword">return</span> ret<span class="number">-1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Golang</tag>
      </tags>
  </entry>
  <entry>
    <title>lc9-23</title>
    <url>/2023/09/23/lc9-23/</url>
    <content><![CDATA[<h1 id="1993-æ ‘ä¸Šçš„æ“ä½œ"><a href="#1993-æ ‘ä¸Šçš„æ“ä½œ" class="headerlink" title="1993. æ ‘ä¸Šçš„æ“ä½œ"></a><a href="https://leetcode.cn/problems/operations-on-tree/">1993. æ ‘ä¸Šçš„æ“ä½œ</a></h1><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1993  2023-09-23 09:50:46</span></span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="keyword">type</span> LockingTree <span class="keyword">struct</span> &#123;</span><br><span class="line">	locked   []<span class="type">int</span></span><br><span class="line">	parent   []<span class="type">int</span></span><br><span class="line">	children [][]<span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Constructor</span><span class="params">(parent []<span class="type">int</span>)</span></span> LockingTree &#123;</span><br><span class="line">	n := <span class="built_in">len</span>(parent)</span><br><span class="line">	Locked := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="keyword">range</span> Locked &#123;</span><br><span class="line">		Locked[i] = <span class="number">-1</span></span><br><span class="line">	&#125;</span><br><span class="line">	children := <span class="built_in">make</span>([][]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt; n; i++ &#123;</span><br><span class="line">		children[parent[i]] = <span class="built_in">append</span>(children[parent[i]], i)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> LockingTree&#123;</span><br><span class="line">		locked:   Locked,</span><br><span class="line">		parent:   parent,</span><br><span class="line">		children: children,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *LockingTree)</span></span> Lock(num <span class="type">int</span>, user <span class="type">int</span>) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> this.locked[num] == <span class="number">-1</span> &#123;</span><br><span class="line">		this.locked[num] = user</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *LockingTree)</span></span> Unlock(num <span class="type">int</span>, user <span class="type">int</span>) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> this.locked[num] == <span class="number">-1</span> || this.locked[num] != user &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	this.locked[num] = <span class="number">-1</span></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *LockingTree)</span></span> Upgrade(num <span class="type">int</span>, user <span class="type">int</span>) <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> this.locked[num] != <span class="number">-1</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	node := num</span><br><span class="line">	<span class="keyword">for</span> ; node != <span class="number">-1</span>; node = this.parent[node] &#123;</span><br><span class="line">		<span class="keyword">if</span> this.locked[node] != <span class="number">-1</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	hasLocked := <span class="literal">false</span></span><br><span class="line">	<span class="keyword">var</span> dfs <span class="function"><span class="keyword">func</span><span class="params">(<span class="type">int</span>)</span></span></span><br><span class="line">	dfs = <span class="function"><span class="keyword">func</span><span class="params">(node <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">		<span class="keyword">for</span> _, child := <span class="keyword">range</span> this.children[node] &#123;</span><br><span class="line">			<span class="keyword">if</span> this.locked[child] != <span class="number">-1</span> &#123;</span><br><span class="line">				hasLocked = <span class="literal">true</span></span><br><span class="line">				this.locked[child] = <span class="number">-1</span></span><br><span class="line">			&#125;</span><br><span class="line">			dfs(child)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	dfs(num)</span><br><span class="line">	<span class="keyword">if</span> !hasLocked &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	this.locked[num] = user</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your LockingTree object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * obj := Constructor(parent);</span></span><br><span class="line"><span class="comment"> * param_1 := obj.Lock(num,user);</span></span><br><span class="line"><span class="comment"> * param_2 := obj.Unlock(num,user);</span></span><br><span class="line"><span class="comment"> * param_3 := obj.Upgrade(num,user);</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Golang</tag>
      </tags>
  </entry>
  <entry>
    <title>lc9_27</title>
    <url>/2023/09/27/lc9-27/</url>
    <content><![CDATA[<p><a href="https://leetcode.cn/problems/filter-restaurants-by-vegan-friendly-price-and-distance/">1333. é¤å…è¿‡æ»¤å™¨</a></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;sort&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1333  2023-09-27 08:11:03</span></span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">filterRestaurants</span><span class="params">(restaurants [][]<span class="type">int</span>, veganFriendly <span class="type">int</span>, maxPrice <span class="type">int</span>, maxDistance <span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> collect [][]<span class="type">int</span></span><br><span class="line">    <span class="keyword">for</span> _, restaurant := <span class="keyword">range</span> restaurants &#123;</span><br><span class="line">       <span class="keyword">if</span> restaurant[<span class="number">3</span>] &lt;= maxPrice &amp;&amp; restaurant[<span class="number">4</span>] &lt;= maxDistance &amp;&amp; !(veganFriendly == <span class="number">1</span> &amp;&amp; restaurant[<span class="number">2</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="comment">//(0,0)âˆ¨(1,1)âˆ¨(0,1)</span></span><br><span class="line">          <span class="comment">//there not (1,0) can be ok</span></span><br><span class="line">          collect = <span class="built_in">append</span>(collect, restaurant)</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sort.Slice(collect, <span class="function"><span class="keyword">func</span><span class="params">(i, j <span class="type">int</span>)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> (collect[i][<span class="number">1</span>] &gt; collect[j][<span class="number">1</span>]) || (collect[i][<span class="number">1</span>] == collect[j][<span class="number">1</span>] &amp;&amp; collect[i][<span class="number">0</span>] &gt; collect[j][<span class="number">0</span>])</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">var</span> ret []<span class="type">int</span></span><br><span class="line">    <span class="keyword">for</span> _, v := <span class="keyword">range</span> collect &#123;</span><br><span class="line">       ret = <span class="built_in">append</span>(ret, v[<span class="number">0</span>])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>8.24leetcode1267</title>
    <url>/2023/08/24/leetcode8-24/</url>
    <content><![CDATA[<h1 id="1267-Count-Servers-that-Communicate"><a href="#1267-Count-Servers-that-Communicate" class="headerlink" title="1267.Count Servers that Communicate"></a>1267.Count Servers that Communicate</h1><p>You are given a map of a server center,<br> represented as a <code>m * n</code> integer matrix <code>grid</code>,<br>where 1 means that on that cell there is a server and 0 means that it is no server.<br>Two servers are said to communicate if they are on the same row or on the same column.</p>
<p>Return the number of servers that communicate with any other server.</p>
<p><img src="/./../pic/leetcode8-24/image-20230903003258130.png" alt="image-20230903003258130"></p>
<span id="more"></span>

<h2 id="Resolution"><a href="#Resolution" class="headerlink" title="Resolution"></a>Resolution</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="comment">// 1267</span></span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">countServers</span><span class="params">(grid [][]<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	ret := <span class="number">0</span></span><br><span class="line">	rowLen, colLen := <span class="built_in">len</span>(grid), <span class="built_in">len</span>(grid[<span class="number">0</span>])</span><br><span class="line">	row, col := <span class="built_in">make</span>([]<span class="type">int</span>, rowLen), <span class="built_in">make</span>([]<span class="type">int</span>, colLen)</span><br><span class="line">	<span class="comment">//Count the number of servers per row and column</span></span><br><span class="line">	<span class="keyword">for</span> rowIdx := <span class="keyword">range</span> grid &#123;</span><br><span class="line">		<span class="keyword">for</span> colIdx, v := <span class="keyword">range</span> grid[rowIdx] &#123;</span><br><span class="line">			<span class="keyword">if</span> v == <span class="number">1</span> &#123;</span><br><span class="line">				row[rowIdx]++</span><br><span class="line">				col[colIdx]++</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">// Traverse per row&amp;col,check servers&#x27; nums are whether nums&gt;1</span></span><br><span class="line">	<span class="keyword">for</span> rowIdx := <span class="keyword">range</span> grid &#123;</span><br><span class="line">		<span class="keyword">for</span> colIdx, v := <span class="keyword">range</span> grid[rowIdx] &#123;</span><br><span class="line">			<span class="keyword">if</span> v == <span class="number">1</span> &amp;&amp; (row[rowIdx] &gt; <span class="number">1</span> || col[colIdx] &gt; <span class="number">1</span>) &#123;</span><br><span class="line">				ret++</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Graph</tag>
      </tags>
  </entry>
  <entry>
    <title>lc9.7</title>
    <url>/2023/09/07/lc9-7/</url>
    <content><![CDATA[<p>You are given an integer array <code>ranks</code> representing the <strong>ranks</strong> of some mechanics. ranksi is the rank of the ith mechanic. A mechanic with a rank <code>r</code> can repair n cars in <code>r * n2</code> minutes.</p>
<p>You are also given an integer <code>cars</code> representing the total number of cars waiting in the garage to be repaired.</p>
<p>Return <em>the <strong>minimum</strong> time taken to repair all the cars.</em></p>
<p><strong>Note:</strong> All the mechanics can repair the cars simultaneously.</p>
 <span id="more"></span>

<p><strong>Example 1:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: ranks = [4,2,3,1], cars = 10</span><br><span class="line">Output: 16</span><br><span class="line">Explanation: </span><br><span class="line">- The first mechanic will repair two cars. The time required is 4 * 2 * 2 = 16 minutes.</span><br><span class="line">- The second mechanic will repair two cars. The time required is 2 * 2 * 2 = 8 minutes.</span><br><span class="line">- The third mechanic will repair two cars. The time required is 3 * 2 * 2 = 12 minutes.</span><br><span class="line">- The fourth mechanic will repair four cars. The time required is 1 * 4 * 4 = 16 minutes.</span><br><span class="line">It can be proved that the cars cannot be repaired in less than 16 minutes.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: ranks = [5,1,8], cars = 6</span><br><span class="line">Output: 16</span><br><span class="line">Explanation: </span><br><span class="line">- The first mechanic will repair one car. The time required is 5 * 1 * 1 = 5 minutes.</span><br><span class="line">- The second mechanic will repair four cars. The time required is 1 * 4 * 4 = 16 minutes.</span><br><span class="line">- The third mechanic will repair one car. The time required is 8 * 1 * 1 = 8 minutes.</span><br><span class="line">It can be proved that the cars cannot be repaired in less than 16 minutes.</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;math&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2594  2023-09-07 08:28:57</span></span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">repairCars</span><span class="params">(ranks []<span class="type">int</span>, cars <span class="type">int</span>)</span></span> <span class="type">int64</span> &#123;</span><br><span class="line">	minr := ranks[<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">for</span> _, rank := <span class="keyword">range</span> ranks &#123;</span><br><span class="line">		<span class="keyword">if</span> rank &lt; minr &#123;</span><br><span class="line">			minr = rank</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	l, r := <span class="number">1</span>, minr*cars*cars</span><br><span class="line">	<span class="keyword">var</span> check = <span class="function"><span class="keyword">func</span><span class="params">(m <span class="type">int</span>)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">		ret := <span class="number">0</span></span><br><span class="line">		<span class="keyword">for</span> _, rank := <span class="keyword">range</span> ranks &#123;</span><br><span class="line">			ret += <span class="type">int</span>(math.Sqrt(<span class="type">float64</span>(m / rank)))</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ret &gt;= cars</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> l &lt; r &#123;</span><br><span class="line">		m := (l + r) &gt;&gt; <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> check(m) &#123;</span><br><span class="line">			r = m</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			l = m + <span class="number">1</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="type">int64</span>(l)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">min</span><span class="params">(a, b <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> a &lt; b &#123;</span><br><span class="line">		<span class="keyword">return</span> a</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>äºŒåˆ†</tag>
      </tags>
  </entry>
  <entry>
    <title>9.1leetcode2240</title>
    <url>/2023/09/01/leetcode9-1/</url>
    <content><![CDATA[<p>You are given an integer <code>total</code> indicating the amount of money you have. You are also given two integers <code>cost1</code> and <code>cost2</code> indicating the price of a pen and pencil respectively. You can spend <strong>part or all</strong> of your money to buy multiple quantities (or none) of each kind of writing utensil.</p>
<p>Return <em>the <strong>number of distinct ways</strong> you can buy some number of pens and pencils.</em></p>
<span id="more"></span>

<p><strong>Example 1:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: total = 20, cost1 = 10, cost2 = 5</span><br><span class="line">Output: 9</span><br><span class="line">Explanation: The price of a pen is 10 and the price of a pencil is 5.</span><br><span class="line">- If you buy 0 pens, you can buy 0, 1, 2, 3, or 4 pencils.</span><br><span class="line">- If you buy 1 pen, you can buy 0, 1, or 2 pencils.</span><br><span class="line">- If you buy 2 pens, you cannot buy any pencils.</span><br><span class="line">The total number of ways to buy pens and pencils is 5 + 3 + 1 = 9.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: total = 5, cost1 = 10, cost2 = 10</span><br><span class="line">Output: 1</span><br><span class="line">Explanation: The price of both pens and pencils are 10, which cost more than total, so you cannot buy any writing utensils. Therefore, there is only 1 way: buy 0 pens and 0 pencils.</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= total, cost1, cost2 &lt;= 106</code></li>
</ul>
<p>ä¸€ä¸ªæ•´æ•° <code>total</code> ï¼Œè¡¨ç¤ºä½ æ‹¥æœ‰çš„æ€»é’±æ•°ã€‚åŒæ—¶ç»™ä½ ä¸¤ä¸ªæ•´æ•° <code>cost1</code> å’Œ <code>cost2</code> ï¼Œåˆ†åˆ«è¡¨ç¤ºä¸€æ”¯é’¢ç¬”å’Œä¸€æ”¯é“…ç¬”çš„ä»·æ ¼ã€‚ä½ å¯ä»¥èŠ±è´¹ä½ éƒ¨åˆ†æˆ–è€…å…¨éƒ¨çš„é’±ï¼Œå»ä¹°ä»»æ„æ•°ç›®çš„ä¸¤ç§ç¬”ã€‚</p>
<p>è¯·ä½ è¿”å›è´­ä¹°é’¢ç¬”å’Œé“…ç¬”çš„ <strong>ä¸åŒæ–¹æ¡ˆæ•°ç›®</strong> ã€‚</p>
<p>Resolution</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="comment">// 2240  2023-09-01 09:08:04</span></span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">waysToBuyPensPencils</span><span class="params">(total <span class="type">int</span>, cost1 <span class="type">int</span>, cost2 <span class="type">int</span>)</span></span> <span class="type">int64</span> &#123;</span><br><span class="line">	ret, nums := <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> nums*cost1 &lt;= total &#123;</span><br><span class="line">		ret += (total - nums*cost1) / cost2+<span class="number">1</span></span><br><span class="line">		nums++</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="type">int64</span>(ret)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Math</tag>
      </tags>
  </entry>
  <entry>
    <title>9.2leetcode2511</title>
    <url>/2023/09/02/leetcode9-2/</url>
    <content><![CDATA[<p>You are given a <strong>0-indexed</strong> integer array <code>forts</code> of length <code>n</code> representing the positions of several forts. <code>forts[i]</code> can be <code>-1</code>, <code>0</code>, or <code>1</code> where:</p>
<ul>
<li><code>-1</code> represents there is <strong>no fort</strong> at the <code>ith</code> position.</li>
<li><code>0</code> indicates there is an <strong>enemy</strong> fort at the <code>ith</code> position.</li>
<li><code>1</code> indicates the fort at the <code>ith</code> the position is under your command.</li>
</ul>
<p>Now you have decided to move your army from one of your forts at position <code>i</code> to an empty position <code>j</code> such that:</p>
<ul>
<li><code>0 &lt;= i, j &lt;= n - 1</code></li>
<li>The army travels over enemy forts <strong>only</strong>. Formally, for all <code>k</code> where <code>min(i,j) &lt; k &lt; max(i,j)</code>, <code>forts[k] == 0.</code></li>
</ul>
<p>While moving the army, all the enemy forts that come in the way are <strong>captured</strong>.</p>
<p>Return <em>the <strong>maximum</strong> number of enemy forts that can be captured</em>. In case it is <strong>impossible</strong> to move your army, or you do not have any fort under your command, return <code>0</code><em>.</em></p>
<span id="more"></span>

<p><strong>Example 1:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: forts = [1,0,0,-1,0,0,0,0,1]</span><br><span class="line">Output: 4</span><br><span class="line">Explanation:</span><br><span class="line">- Moving the army from position 0 to position 3 captures 2 enemy forts, at 1 and 2.</span><br><span class="line">- Moving the army from position 8 to position 3 captures 4 enemy forts.</span><br><span class="line">Since 4 is the maximum number of enemy forts that can be captured, we return 4.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: forts = [0,0,1,-1]</span><br><span class="line">Output: 0</span><br><span class="line">Explanation: Since no enemy fort can be captured, 0 is returned.</span><br></pre></td></tr></table></figure>





<p>ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º <code>n</code> ï¼Œä¸‹æ ‡ä» <strong>0</strong> å¼€å§‹çš„æ•´æ•°æ•°ç»„ <code>forts</code> ï¼Œè¡¨ç¤ºä¸€äº›åŸå ¡ã€‚<code>forts[i]</code> å¯ä»¥æ˜¯ <code>-1</code> ï¼Œ<code>0</code> æˆ–è€… <code>1</code> ï¼Œå…¶ä¸­ï¼š</p>
<ul>
<li><code>-1</code> è¡¨ç¤ºç¬¬ <code>i</code> ä¸ªä½ç½® <strong>æ²¡æœ‰</strong> åŸå ¡ã€‚</li>
<li><code>0</code> è¡¨ç¤ºç¬¬ <code>i</code> ä¸ªä½ç½®æœ‰ä¸€ä¸ª <strong>æ•Œäºº</strong> çš„åŸå ¡ã€‚</li>
<li><code>1</code> è¡¨ç¤ºç¬¬ <code>i</code> ä¸ªä½ç½®æœ‰ä¸€ä¸ªä½ æ§åˆ¶çš„åŸå ¡ã€‚</li>
</ul>
<p>ç°åœ¨ï¼Œä½ éœ€è¦å†³å®šï¼Œå°†ä½ çš„å†›é˜Ÿä»æŸä¸ªä½ æ§åˆ¶çš„åŸå ¡ä½ç½® <code>i</code> ç§»åŠ¨åˆ°ä¸€ä¸ªç©ºçš„ä½ç½® <code>j</code> ï¼Œæ»¡è¶³ï¼š</p>
<ul>
<li><code>0 &lt;= i, j &lt;= n - 1</code></li>
<li>å†›é˜Ÿç»è¿‡çš„ä½ç½® <strong>åªæœ‰</strong> æ•Œäººçš„åŸå ¡ã€‚æ­£å¼çš„ï¼Œå¯¹äºæ‰€æœ‰ <code>min(i,j) &lt; k &lt; max(i,j)</code> çš„ <code>k</code> ï¼Œéƒ½æ»¡è¶³ <code>forts[k] == 0</code> ã€‚</li>
</ul>
<p>å½“å†›é˜Ÿç§»åŠ¨æ—¶ï¼Œæ‰€æœ‰é€”ä¸­ç»è¿‡çš„æ•ŒäººåŸå ¡éƒ½ä¼šè¢« <strong>æ‘§æ¯</strong> ã€‚</p>
<p><strong>Resolution</strong></p>
<p>è®¡ç®—-1å’Œ1ä¹‹é—´å…¨æ˜¯0æƒ…å†µä¸‹æœ€å¤§çš„0çš„æ•°é‡</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;math&quot;</span></span><br><span class="line"><span class="comment">// 2511  2023-09-02 00:02:31</span></span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">captureForts</span><span class="params">(forts []<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	pre := math.MinInt <span class="comment">//pre non-0 element</span></span><br><span class="line">	ret := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> idx, val := <span class="keyword">range</span> forts &#123;</span><br><span class="line">		<span class="keyword">if</span> val != <span class="number">0</span> &#123;</span><br><span class="line">			<span class="comment">//The subscript of the current non-0 element is idx, </span></span><br><span class="line">			<span class="comment">//and the subscript of the previous non-0 element is pre</span></span><br><span class="line">			<span class="comment">//forts[i] != forts[pre] means one is -1 and another is 1</span></span><br><span class="line">			<span class="keyword">if</span> pre &gt;= <span class="number">0</span> &amp;&amp; forts[idx] != forts[pre] &#123;</span><br><span class="line">				ret = max(ret, idx-pre<span class="number">-1</span>)</span><br><span class="line">			&#125;</span><br><span class="line">			pre = idx</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">max</span><span class="params">(a, b <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;<span class="keyword">if</span> b &gt; a &#123;<span class="keyword">return</span> b&#125;;<span class="keyword">return</span> a&#125;</span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Traverse</tag>
      </tags>
  </entry>
  <entry>
    <title>9.3leetcode1921</title>
    <url>/2023/09/03/leetcode9-3-1921/</url>
    <content><![CDATA[<h1 id="LeetCode1921-Eliminate-Max-nums-of-Monsters"><a href="#LeetCode1921-Eliminate-Max-nums-of-Monsters" class="headerlink" title="LeetCode1921-Eliminate Max nums of Monsters"></a>LeetCode1921-Eliminate Max nums of Monsters</h1><p>You are playing a video game<br>where you are defending your city from a group of <code>n</code> monsters.<br> You are given a <strong>0-indexed</strong> integer array <code>dist</code> of size <code>n</code>,<br>where <code>dist[i]</code> is the <strong>initial distance</strong> in kilometers of the <code>ith</code> monster from the city.</p>
<p>The monsters walk toward the city at a <strong>constant</strong> speed.<br>The speed of each monster is given to you in an integer array <code>speed</code> of size <code>n</code>,<br>where <code>speed[i]</code> is the speed of the <code>ith</code> monster in kilometers per minute.</p>
<p>You have a weapon that, can kill a <strong>single</strong> monster.<br>However, the weapon takes <strong>one minute</strong> to charge.<br>The weapon is fully charged at the very start.</p>
<p>You lose when any monster reaches your city.<br>If a monster reaches the city at the exact moment the weapon is fully charged,<br>it counts as a <strong>loss</strong>,<br>and the game ends before you can use your weapon.</p>
<p>Return the <strong>maximum</strong> number of monsters<br>that you can kill before you lose,<br><em>or</em> <code>n</code> if you can kill all the monsters before they reach the city.</p>
<span id="more"></span>

<p><strong>Example 1:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: dist = [1,3,4], speed = [1,1,1]</span><br><span class="line">Output: 3</span><br><span class="line">Explanation:</span><br><span class="line">In the beginning, the distances of the monsters are [1,3,4]. You eliminate the first monster.</span><br><span class="line">After a minute, the distances of the monsters are [X,2,3]. You eliminate the second monster.</span><br><span class="line">After a minute, the distances of the monsters are [X,X,2]. You eliminate the thrid monster.</span><br><span class="line">All 3 monsters can be eliminated.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: dist = [1,1,2,3], speed = [1,1,1,1]</span><br><span class="line">Output: 1</span><br><span class="line">Explanation:</span><br><span class="line">In the beginning, the distances of the monsters are [1,1,2,3]. You eliminate the first monster.</span><br><span class="line">After a minute, the distances of the monsters are [X,0,1,2], so you lose.</span><br><span class="line">You can only eliminate 1 monster.</span><br></pre></td></tr></table></figure>

<p><strong>Example 3:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: dist = [3,2,4], speed = [5,3,2]</span><br><span class="line">Output: 1</span><br><span class="line">Explanation:</span><br><span class="line">In the beginning, the distances of the monsters are [3,2,4]. You eliminate the first monster.</span><br><span class="line">After a minute, the distances of the monsters are [X,0,2], so you lose.</span><br><span class="line">You can only eliminate 1 monster. </span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>n == dist.length == speed.length</code></li>
<li><code>1 &lt;= n &lt;= 105</code></li>
<li><code>1 &lt;= dist[i], speed[i] &lt;= 105</code></li>
</ul>
<h2 id="Resolution"><a href="#Resolution" class="headerlink" title="Resolution"></a>Resolution</h2><p>greedy algorithm</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;sort&quot;</span></span><br><span class="line"><span class="comment">// leetcode submit region begin(Prohibit modification and deletion)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">eliminateMaximum</span><span class="params">(dist []<span class="type">int</span>, speed []<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	n:=<span class="built_in">len</span>(dist)</span><br><span class="line">	comeTime := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">if</span> dist[i]%speed[i]==<span class="number">0</span>&#123;</span><br><span class="line">			comeTime[i]=dist[i]/speed[i]</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			comeTime[i]=dist[i]/speed[i]+<span class="number">1</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	sort.Ints(comeTime)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">		<span class="keyword">if</span> comeTime[i]&gt;=i+<span class="number">1</span>&#123;</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> i</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> n</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//leetcode submit region end(Prohibit modification and deletion)</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Greedy</tag>
      </tags>
  </entry>
  <entry>
    <title>leetcode9-6</title>
    <url>/2023/09/06/leetcode9-6/</url>
    <content><![CDATA[<p><a href="https://leetcode.cn/problems/lowest-common-ancestor-of-deepest-leaves/">1123. Lowest Common Ancestor of Deepest Leaves</a></p>
<p>Given the <code>root</code> of a binary tree, return <em>the lowest common ancestor of its deepest leaves</em>.</p>
<p>Recall that:</p>
<ul>
<li>The node of a binary tree is a leaf if and only if it has no children</li>
<li>The depth of the root of the tree is <code>0</code>. if the depth of a node is <code>d</code>, the depth of each of its children is <code>d + 1</code>.</li>
<li>The lowest common ancestor of a set <code>S</code> of nodes, is the node <code>A</code> with the largest depth such that every node in <code>S</code> is in the subtree with root <code>A</code>.</li>
</ul>
<span id="more"></span>

<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">lcaDeepestLeaves</span><span class="params">(root *TreeNode)</span></span> *TreeNode &#123;</span><br><span class="line">	<span class="keyword">var</span> dfs <span class="function"><span class="keyword">func</span><span class="params">(node *TreeNode)</span></span> (<span class="type">int</span>, *TreeNode)</span><br><span class="line">	dfs = <span class="function"><span class="keyword">func</span><span class="params">(node *TreeNode)</span></span> (<span class="type">int</span>, *TreeNode) &#123;</span><br><span class="line">		<span class="keyword">if</span> node == <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>, <span class="literal">nil</span></span><br><span class="line">		&#125;</span><br><span class="line">		ldepth, lbranch := dfs(node.Left)</span><br><span class="line">		rdepth, rbranch := dfs(node.Right)</span><br><span class="line">		<span class="keyword">if</span> ldepth &gt; rdepth &#123;</span><br><span class="line">			<span class="keyword">return</span> ldepth + <span class="number">1</span>, lbranch</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> ldepth &lt; rdepth &#123;</span><br><span class="line">			<span class="keyword">return</span> rdepth + <span class="number">1</span>, rbranch</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> ldepth + <span class="number">1</span>, node</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	_,ret:=dfs(root)</span><br><span class="line">	<span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Tree</tag>
        <tag>dfs</tag>
      </tags>
  </entry>
  <entry>
    <title>leetcode9-5</title>
    <url>/2023/09/05/leetcode9-5/</url>
    <content><![CDATA[<h1 id="2605-Form-Smallest-Number-From-Two-Digit-Arrays"><a href="#2605-Form-Smallest-Number-From-Two-Digit-Arrays" class="headerlink" title="2605. Form Smallest Number From Two Digit Arrays"></a><a href="https://leetcode.cn/problems/form-smallest-number-from-two-digit-arrays/">2605. Form Smallest Number From Two Digit Arrays</a></h1><p>Given two arrays of <strong>unique</strong> digits <code>nums1</code> and <code>nums2</code>, return <em>the <strong>smallest</strong> number that contains <strong>at least</strong> one digit from each array</em>.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums1 = [4,1,3], nums2 = [5,7]</span><br><span class="line">Output: 15</span><br><span class="line">Explanation: The number 15 contains the digit 1 from nums1 and the digit 5 from nums2. It can be proven that 15 is the smallest number we can have.</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums1 = [3,5,2,6], nums2 = [3,1,7]</span><br><span class="line">Output: 3</span><br><span class="line">Explanation: The number 3 contains the digit 3 which exists in both arrays.</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= nums1.length, nums2.length &lt;= 9</code></li>
<li><code>1 &lt;= nums1[i], nums2[i] &lt;= 9</code></li>
<li>All digits in each array are <strong>unique</strong>.</li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;sort&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">minNumber</span><span class="params">(nums1 []<span class="type">int</span>, nums2 []<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> same <span class="function"><span class="keyword">func</span><span class="params">()</span></span> <span class="type">int</span></span><br><span class="line">	same = <span class="function"><span class="keyword">func</span><span class="params">()</span></span> <span class="type">int</span> &#123;</span><br><span class="line">		ret := <span class="number">10</span></span><br><span class="line">		hash := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">int</span>]<span class="type">bool</span>)</span><br><span class="line">		<span class="keyword">for</span> _, v := <span class="keyword">range</span> nums1 &#123;</span><br><span class="line">			hash[v] = <span class="literal">true</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> _, v := <span class="keyword">range</span> nums2 &#123;</span><br><span class="line">			<span class="keyword">if</span> _, ok := hash[v]; ok &#123;</span><br><span class="line">				ret = min(ret, v)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> ret == <span class="number">10</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ret</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> ret := same(); ret != <span class="number">-1</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> ret</span><br><span class="line">	&#125;</span><br><span class="line">	sort.Ints(nums1)</span><br><span class="line">	sort.Ints(nums2)</span><br><span class="line">	<span class="keyword">return</span> min(nums1[<span class="number">0</span>]*<span class="number">10</span>+nums2[<span class="number">0</span>], nums2[<span class="number">0</span>]*<span class="number">10</span>+nums1[<span class="number">0</span>])</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">min</span><span class="params">(a, b <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> a &lt; b &#123;</span><br><span class="line">		<span class="keyword">return</span> a</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>Hash</tag>
      </tags>
  </entry>
</search>
